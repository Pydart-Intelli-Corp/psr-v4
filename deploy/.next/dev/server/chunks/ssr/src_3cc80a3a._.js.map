{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 67, "column": 0}, "map": {"version":3,"sources":["file:///P:/psr-cloud-v2/src/components/ratechart/RateChartUploadModal.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { Upload, Download } from 'lucide-react';\r\nimport { FormModal, FormSelect, FormActions } from '@/components';\r\nimport { useLanguage } from '@/contexts/LanguageContext';\r\n\r\ninterface Society {\r\n  id: number;\r\n  name: string;\r\n  society_id: string;\r\n}\r\n\r\ninterface RateChartUploadModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  societies: Society[];\r\n  onUploadSuccess: (message: string) => void;\r\n  onUploadError: (message: string) => void;\r\n  onUploadStart?: () => void;\r\n  onUploadEnd?: () => void;\r\n  onProgressUpdate?: (progress: number) => void;\r\n}\r\n\r\ntype ChannelType = 'COW' | 'BUF' | 'MIX';\r\n\r\n/**\r\n * Reusable rate chart upload modal\r\n * Handles CSV file selection, society and channel selection, and upload\r\n * Supports multiple society selection\r\n */\r\nconst RateChartUploadModal: React.FC<RateChartUploadModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  societies,\r\n  onUploadSuccess,\r\n  onUploadError,\r\n  onUploadStart,\r\n  onUploadEnd,\r\n  onProgressUpdate\r\n}) => {\r\n  const { t } = useLanguage();\r\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\r\n  const [selectedSocieties, setSelectedSocieties] = useState<number[]>([]);\r\n  const [channel, setChannel] = useState<ChannelType | ''>('');\r\n  const [isUploading, setIsUploading] = useState(false);\r\n\r\n  // Update progress and notify parent\r\n  const updateProgress = (progress: number) => {\r\n    onProgressUpdate?.(progress);\r\n  };\r\n\r\n  const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (file) {\r\n      if (!file.name.toLowerCase().endsWith('.csv')) {\r\n        onUploadError('Please select a CSV file');\r\n        return;\r\n      }\r\n      setSelectedFile(file);\r\n    }\r\n  };\r\n\r\n  const handleSocietyToggle = (societyId: number) => {\r\n    setSelectedSocieties(prev => {\r\n      if (prev.includes(societyId)) {\r\n        return prev.filter(id => id !== societyId);\r\n      } else {\r\n        return [...prev, societyId];\r\n      }\r\n    });\r\n  };\r\n\r\n  const handleSelectAll = () => {\r\n    if (selectedSocieties.length === societies.length) {\r\n      setSelectedSocieties([]);\r\n    } else {\r\n      setSelectedSocieties(societies.map(s => s.id));\r\n    }\r\n  };\r\n\r\n  const handleUpload = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (selectedSocieties.length === 0 || !channel || !selectedFile) {\r\n      onUploadError('Please select at least one society, channel, and CSV file');\r\n      return;\r\n    }\r\n\r\n    setIsUploading(true);\r\n    updateProgress(0);\r\n    onUploadStart?.();\r\n\r\n    try {\r\n      const token = localStorage.getItem('authToken');\r\n      updateProgress(10);\r\n\r\n      // Single API call with multiple society IDs\r\n      const uploadFormData = new FormData();\r\n      uploadFormData.append('file', selectedFile);\r\n      uploadFormData.append('societyIds', selectedSocieties.join(','));\r\n      uploadFormData.append('channel', channel);\r\n\r\n      updateProgress(30);\r\n\r\n      const response = await fetch('/api/user/ratechart/upload', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`\r\n        },\r\n        body: uploadFormData\r\n      });\r\n\r\n      updateProgress(70);\r\n\r\n      const data = await response.json();\r\n\r\n      updateProgress(90);\r\n\r\n      if (data.success) {\r\n        updateProgress(100);\r\n        const message = `Rate chart uploaded to ${selectedSocieties.length} ${selectedSocieties.length === 1 ? 'society' : 'societies'}! Total ${data.data.recordCount} records imported.`;\r\n        onUploadSuccess(message);\r\n        handleClose();\r\n      } else {\r\n        onUploadError(data.message || 'Failed to upload rate chart');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error uploading rate chart:', error);\r\n      onUploadError('Error uploading rate chart. Please try again.');\r\n    } finally {\r\n      setIsUploading(false);\r\n      updateProgress(0);\r\n      onUploadEnd?.();\r\n    }\r\n  };\r\n\r\n  const downloadSampleCSV = () => {\r\n    const csvContent = `CLR,FAT,SNF,RATE\r\n7,3,3,15\r\n8,3,3.1,15.25\r\n8,3,3.2,15.5\r\n8,3,3.3,15.75\r\n9,3,3.4,16\r\n9,3,3.5,16.25\r\n10,3,3.6,16.5`;\r\n\r\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n    const link = document.createElement('a');\r\n    const url = URL.createObjectURL(blob);\r\n    link.setAttribute('href', url);\r\n    link.setAttribute('download', 'ratechart_sample.csv');\r\n    link.style.visibility = 'hidden';\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n    URL.revokeObjectURL(url);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setSelectedFile(null);\r\n    setSelectedSocieties([]);\r\n    setChannel('');\r\n    onClose();\r\n  };\r\n\r\n  return (\r\n    <FormModal\r\n      isOpen={isOpen}\r\n      onClose={handleClose}\r\n      title={t.ratechartManagement.uploadRateChart}\r\n      maxWidth=\"lg\"\r\n    >\r\n      <form onSubmit={handleUpload} className=\"space-y-4 sm:space-y-6\">\r\n        {/* Instructions */}\r\n        <div className=\"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg\">\r\n          <h3 className=\"font-medium text-blue-900 dark:text-blue-100 mb-2 text-sm\">\r\n            {t.ratechartManagement.csvFormatRequirements}:\r\n          </h3>\r\n          <ul className=\"list-disc list-inside space-y-1 text-xs text-blue-800 dark:text-blue-200\">\r\n            <li>{t.ratechartManagement.headersRequired}: CLR, FAT, SNF, RATE</li>\r\n            <li>{t.ratechartManagement.clrDescription}: {t.ratechartManagement.colorDegreeNumeric}</li>\r\n            <li>{t.ratechartManagement.fatDescription}: {t.ratechartManagement.fatPercentageNumeric}</li>\r\n            <li>{t.ratechartManagement.snfDescription}: {t.ratechartManagement.snfPercentageNumeric}</li>\r\n            <li>{t.ratechartManagement.rateDescription}: {t.ratechartManagement.ratePerLiterNumeric}</li>\r\n            <li>{t.ratechartManagement.fileEncodingUTF8}</li>\r\n          </ul>\r\n          <button\r\n            type=\"button\"\r\n            onClick={downloadSampleCSV}\r\n            className=\"mt-3 flex items-center text-xs text-blue-600 dark:text-blue-400 hover:underline\"\r\n          >\r\n            <Download className=\"w-4 h-4 mr-1\" />\r\n            {t.ratechartManagement.downloadSampleCSV}\r\n          </button>\r\n        </div>\r\n\r\n        {/* Society Selection */}\r\n        <div>\r\n          <div className=\"flex items-center justify-between mb-3\">\r\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n              {t.ratechartManagement.selectSociety} <span className=\"text-red-500\">*</span>\r\n            </label>\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleSelectAll}\r\n              className=\"text-sm text-green-600 dark:text-green-400 hover:underline\"\r\n            >\r\n              {selectedSocieties.length === societies.length ? t.common.clearAll : t.common.selectAll}\r\n            </button>\r\n          </div>\r\n          <div className=\"border border-gray-300 dark:border-gray-600 rounded-lg p-3 max-h-48 overflow-y-auto space-y-2\">\r\n            {societies.length === 0 ? (\r\n              <p className=\"text-sm text-gray-500 dark:text-gray-400 text-center py-2\">\r\n                {t.ratechartManagement.noSocietiesAvailable}\r\n              </p>\r\n            ) : (\r\n              societies.map(society => (\r\n                <label\r\n                  key={society.id}\r\n                  className=\"flex items-center space-x-3 p-2 hover:bg-gray-50 dark:hover:bg-gray-700 rounded cursor-pointer\"\r\n                >\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={selectedSocieties.includes(society.id)}\r\n                    onChange={() => handleSocietyToggle(society.id)}\r\n                    className=\"w-4 h-4 text-green-600 border-gray-300 dark:border-gray-600 rounded focus:ring-green-500\"\r\n                  />\r\n                  <span className=\"text-sm text-gray-900 dark:text-white\">\r\n                    {society.name} ({society.society_id})\r\n                  </span>\r\n                </label>\r\n              ))\r\n            )}\r\n          </div>\r\n          {selectedSocieties.length > 0 && (\r\n            <p className=\"mt-2 text-xs text-gray-600 dark:text-gray-400\">\r\n              {selectedSocieties.length} {selectedSocieties.length === 1 ? t.ratechartManagement.society : t.ratechartManagement.societies} {t.common.selected}\r\n            </p>\r\n          )}\r\n        </div>\r\n\r\n        <FormSelect\r\n          label={t.ratechartManagement.milkChannel}\r\n          value={channel}\r\n          onChange={(value) => setChannel(value as ChannelType)}\r\n          options={[\r\n            { value: 'COW', label: t.ratechartManagement.cow },\r\n            { value: 'BUF', label: t.ratechartManagement.buffalo },\r\n            { value: 'MIX', label: t.ratechartManagement.mixed }\r\n          ]}\r\n          placeholder={t.ratechartManagement.selectChannel}\r\n          required\r\n        />\r\n\r\n        {/* File Upload */}\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n            {t.ratechartManagement.csvFile} <span className=\"text-red-500\">*</span>\r\n          </label>\r\n          <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center hover:border-green-400 dark:hover:border-green-500 transition-colors\">\r\n            <input\r\n              type=\"file\"\r\n              accept=\".csv\"\r\n              onChange={handleFileSelect}\r\n              className=\"hidden\"\r\n              id=\"csv-upload\"\r\n            />\r\n            <label\r\n              htmlFor=\"csv-upload\"\r\n              className=\"cursor-pointer flex flex-col items-center\"\r\n            >\r\n              <Upload className=\"w-12 h-12 text-gray-400 mb-3\" />\r\n              {selectedFile ? (\r\n                <div>\r\n                  <p className=\"text-sm font-medium text-gray-900 dark:text-white\">\r\n                    {selectedFile.name}\r\n                  </p>\r\n                  <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\r\n                    {(selectedFile.size / 1024).toFixed(2)} KB\r\n                  </p>\r\n                </div>\r\n              ) : (\r\n                <div>\r\n                  <p className=\"text-sm font-medium text-gray-900 dark:text-white\">\r\n                    {t.ratechartManagement.clickToUploadCSV}\r\n                  </p>\r\n                  <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\r\n                    {t.ratechartManagement.orDragAndDrop}\r\n                  </p>\r\n                </div>\r\n              )}\r\n            </label>\r\n          </div>\r\n        </div>\r\n\r\n        <FormActions\r\n          onCancel={handleClose}\r\n          submitText={`${t.common.upload} to ${selectedSocieties.length} ${selectedSocieties.length === 1 ? t.ratechartManagement.society : t.ratechartManagement.societies}`}\r\n          isLoading={isUploading}\r\n          isSubmitDisabled={selectedSocieties.length === 0 || !channel || !selectedFile}\r\n          submitType=\"submit\"\r\n        />\r\n      </form>\r\n    </FormModal>\r\n  );\r\n};\r\n\r\nexport default RateChartUploadModal;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 604, "column": 0}, "map": {"version":3,"sources":["file:///P:/psr-cloud-v2/src/components/ratechart/RateChartMinimalCard.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport { Receipt, Trash2, UserPlus, Power, PowerOff, Eye, RefreshCw, FileText, X, MoreVertical, ChevronDown, ChevronUp, Building2, CheckCircle, Download, Clock } from 'lucide-react';\r\nimport { ConfirmDeleteModal } from '@/components/management';\r\nimport { useLanguage } from '@/contexts/LanguageContext';\r\n\r\n// Helper function to convert database channel values to display format\r\nconst getChannelDisplay = (channel: string): string => {\r\n  const channelMap: { [key: string]: string } = {\r\n    'COW': 'COW',\r\n    'BUF': 'BUFFALO',\r\n    'MIX': 'MIXED',\r\n    'BUFFALO': 'BUFFALO',\r\n    'MIXED': 'MIXED'\r\n  };\r\n  return channelMap[channel] || channel;\r\n};\r\n\r\ninterface DownloadStatus {\r\n  allDownloaded: boolean;\r\n  totalMachines: number;\r\n  totalDownloaded: number;\r\n  totalPending: number;\r\n  societies: Record<number, {\r\n    societyId: number;\r\n    societyName: string;\r\n    societyIdentifier: string;\r\n    totalMachines: number;\r\n    downloadedMachines: number;\r\n    pendingMachines: number;\r\n    machines: Array<{\r\n      id: number;\r\n      machineId: string;\r\n      machineType: string;\r\n      location: string | null;\r\n      downloaded: boolean;\r\n      downloadedAt: string | null;\r\n    }>;\r\n  }>;\r\n}\r\n\r\n// Helper function to highlight matching text\r\nconst highlightText = (text: string, searchQuery: string) => {\r\n  if (!searchQuery) return text;\r\n  \r\n  const regex = new RegExp(`(${searchQuery.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')})`, 'gi');\r\n  const parts = text.split(regex);\r\n  \r\n  return parts.map((part, index) => \r\n    regex.test(part) ? (\r\n      <span key={index} className=\"bg-yellow-200 dark:bg-yellow-800 px-0.5 rounded\">\r\n        {part}\r\n      </span>\r\n    ) : (\r\n      part\r\n    )\r\n  );\r\n};\r\n\r\n// Helper function to render status indicator with download info\r\nconst getStatusIndicator = (\r\n  status: number, \r\n  downloadStatus: DownloadStatus | null, \r\n  isLoading: boolean,\r\n  onClick?: () => void,\r\n  hasDropdown?: boolean\r\n) => {\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex items-center gap-1.5\">\r\n        <div className=\"w-2 h-2 rounded-full bg-gray-400 dark:bg-gray-500 animate-pulse\" />\r\n        <span className=\"text-xs font-medium text-gray-600 dark:text-gray-400\">Loading...</span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Status 0 means chart is inactive\r\n  if (status === 0) {\r\n    return (\r\n      <div className=\"flex items-center gap-1.5\">\r\n        <div className=\"w-2 h-2 rounded-full bg-gray-500 dark:bg-gray-400\" />\r\n        <span className=\"text-xs font-medium text-gray-600 dark:text-gray-400\">Inactive</span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // If we have download status data\r\n  if (downloadStatus) {\r\n    const { allDownloaded, totalDownloaded, totalMachines } = downloadStatus;\r\n\r\n    if (totalMachines === 0) {\r\n      // No machines assigned\r\n      return (\r\n        <div className=\"flex items-center gap-1.5\">\r\n          <div className=\"w-2 h-2 rounded-full bg-amber-500 dark:bg-amber-400 animate-pulse\" />\r\n          <span className=\"text-xs font-medium text-amber-600 dark:text-amber-400\">Ready</span>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    const baseClasses = \"flex items-center gap-1.5\";\r\n    const clickableClasses = onClick \r\n      ? \"cursor-pointer hover:opacity-80 transition-opacity\" \r\n      : \"\";\r\n\r\n    if (allDownloaded) {\r\n      // All machines have downloaded\r\n      return (\r\n        <div className={`${baseClasses} ${clickableClasses}`} onClick={onClick}>\r\n          <CheckCircle className=\"w-3.5 h-3.5 text-green-600 dark:text-green-400\" />\r\n          <span className=\"text-xs font-medium text-green-600 dark:text-green-400\">\r\n            Downloaded ({totalDownloaded}/{totalMachines})\r\n          </span>\r\n          {hasDropdown && <ChevronDown className=\"w-3 h-3 text-green-600 dark:text-green-400\" />}\r\n        </div>\r\n      );\r\n    } else {\r\n      // Partial downloads\r\n      return (\r\n        <div className={`${baseClasses} ${clickableClasses}`} onClick={onClick}>\r\n          <Clock className=\"w-3.5 h-3.5 text-blue-600 dark:text-blue-400\" />\r\n          <span className=\"text-xs font-medium text-blue-600 dark:text-blue-400\">\r\n            Pending ({totalDownloaded}/{totalMachines})\r\n          </span>\r\n          {hasDropdown && <ChevronDown className=\"w-3 h-3 text-blue-600 dark:text-blue-400\" />}\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n\r\n  // Fallback to old behavior\r\n  return (\r\n    <div className=\"flex items-center gap-1.5\">\r\n      <div className=\"w-2 h-2 rounded-full bg-amber-500 dark:bg-amber-400 animate-pulse\" />\r\n      <span className=\"text-xs font-medium text-amber-600 dark:text-amber-400\">Ready</span>\r\n    </div>\r\n  );\r\n};\r\n\r\ninterface Society {\r\n  societyId: number;\r\n  societyName: string;\r\n  societyIdentifier: string;\r\n  chartRecordId: number;\r\n}\r\n\r\ninterface RateChartMinimalCardProps {\r\n  chartId: number;\r\n  fileName: string;\r\n  channel: string;\r\n  uploadedBy: string;\r\n  createdAt: string;\r\n  societies: Society[];\r\n  status: number;\r\n  isSelected: boolean;\r\n  onToggleSelection: () => void;\r\n  onDelete: () => void;\r\n  onAssignSociety: () => void;\r\n  onToggleStatus: (chartId: number, currentStatus: number) => void;\r\n  onView: () => void;\r\n  onResetDownload: () => void;\r\n  onRemoveSociety?: (chartRecordId: number, societyId: number, societyName: string) => void;\r\n  searchQuery?: string;\r\n}\r\n\r\nexport default function RateChartMinimalCard({\r\n  chartId,\r\n  fileName,\r\n  channel,\r\n  uploadedBy,\r\n  createdAt,\r\n  societies,\r\n  status,\r\n  isSelected,\r\n  onToggleSelection,\r\n  onDelete,\r\n  onAssignSociety,\r\n  onToggleStatus,\r\n  onView,\r\n  onResetDownload,\r\n  onRemoveSociety,\r\n  searchQuery = '',\r\n}: RateChartMinimalCardProps) {\r\n  const { t } = useLanguage();\r\n  const [showActionsMenu, setShowActionsMenu] = React.useState(false);\r\n  const [showSocietiesDropdown, setShowSocietiesDropdown] = React.useState(false);\r\n  const [showMachineStatusDropdown, setShowMachineStatusDropdown] = React.useState(false);\r\n  const [societyToRemove, setSocietyToRemove] = React.useState<{ chartRecordId: number; societyId: number; societyName: string } | null>(null);\r\n  const [downloadStatus, setDownloadStatus] = React.useState<DownloadStatus | null>(null);\r\n  const [loadingStatus, setLoadingStatus] = React.useState(false);\r\n  const menuRef = React.useRef<HTMLDivElement>(null);\r\n\r\n  // Fetch download status when component mounts or chartId changes\r\n  React.useEffect(() => {\r\n    const fetchDownloadStatus = async () => {\r\n      if (status === 0) return; // Don't fetch if chart is inactive\r\n      \r\n      setLoadingStatus(true);\r\n      try {\r\n        const token = localStorage.getItem('authToken');\r\n        if (!token) return;\r\n\r\n        const response = await fetch(`/api/user/ratechart/download-status?chartId=${chartId}`, {\r\n          headers: {\r\n            'Authorization': `Bearer ${token}`\r\n          }\r\n        });\r\n\r\n        const data = await response.json();\r\n        if (data.success) {\r\n          setDownloadStatus(data.data);\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching download status:', error);\r\n      } finally {\r\n        setLoadingStatus(false);\r\n      }\r\n    };\r\n\r\n    fetchDownloadStatus();\r\n  }, [chartId, status]);\r\n\r\n  // Close menu when clicking outside\r\n  React.useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (menuRef.current && !menuRef.current.contains(event.target as Node)) {\r\n        setShowActionsMenu(false);\r\n      }\r\n    };\r\n\r\n    if (showActionsMenu) {\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside);\r\n    };\r\n  }, [showActionsMenu]);\r\n\r\n  return (\r\n    <div\r\n      className={`relative border rounded-xl p-5 transition-all duration-300 hover:shadow-lg ${\r\n        isSelected\r\n          ? 'border-green-500 dark:border-green-400 bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/30 dark:to-emerald-900/30 shadow-md ring-2 ring-green-200 dark:ring-green-700'\r\n          : 'border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 hover:border-green-300 dark:hover:border-green-600'\r\n      }`}\r\n    >\r\n      {/* Header Section */}\r\n      <div className=\"flex items-start justify-between mb-4\">\r\n        {/* Left: Checkbox */}\r\n        <div className=\"flex items-start gap-3\">\r\n          <input\r\n            type=\"checkbox\"\r\n            checked={isSelected}\r\n            onChange={onToggleSelection}\r\n            className=\"mt-1 w-4 h-4 text-green-600 dark:text-green-500 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded focus:ring-green-500 dark:focus:ring-green-400 focus:ring-2 cursor-pointer transition-transform hover:scale-110\"\r\n          />\r\n          \r\n          {/* File Info */}\r\n          <div className=\"flex-1 min-w-0\">\r\n            <div className=\"flex items-center gap-2 mb-2\">\r\n              <Receipt className=\"w-4 h-4 text-gray-400 dark:text-gray-500 flex-shrink-0\" />\r\n              <h3 className=\"text-sm font-semibold text-gray-900 dark:text-gray-100 truncate\" title={fileName}>\r\n                {highlightText(fileName, searchQuery)}\r\n              </h3>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <span className={`inline-flex items-center px-2.5 py-0.5 rounded-md text-xs font-semibold ${\r\n                channel === 'COW' \r\n                  ? 'bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300'\r\n                  : channel === 'BUF'\r\n                  ? 'bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300'\r\n                  : 'bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300'\r\n              }`}>\r\n                {highlightText(getChannelDisplay(channel), searchQuery)}\r\n              </span>\r\n              \r\n              {/* Status Indicator - Now Clickable with Dropdown */}\r\n              <div className=\"relative\">\r\n                <div className={`inline-flex items-center px-2.5 py-0.5 rounded-md ${\r\n                  status === 0\r\n                    ? 'bg-gray-50 dark:bg-gray-900/20 border border-gray-200 dark:border-gray-800'\r\n                    : downloadStatus?.allDownloaded\r\n                    ? 'bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800'\r\n                    : downloadStatus?.totalMachines === 0\r\n                    ? 'bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800'\r\n                    : 'bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800'\r\n                }`}>\r\n                  {getStatusIndicator(\r\n                    status,\r\n                    downloadStatus,\r\n                    loadingStatus,\r\n                    downloadStatus && downloadStatus.totalMachines > 0\r\n                      ? () => setShowMachineStatusDropdown(!showMachineStatusDropdown)\r\n                      : undefined,\r\n                    !!(downloadStatus && downloadStatus.totalMachines > 0)\r\n                  )}\r\n                </div>\r\n\r\n                {/* Compact Machine Status Dropdown */}\r\n                {showMachineStatusDropdown && downloadStatus && downloadStatus.totalMachines > 0 && (\r\n                  <div className=\"absolute top-full left-0 mt-1 w-64 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 z-10 max-h-80 overflow-y-auto\">\r\n                    {/* Dropdown Header */}\r\n                    <div className=\"px-3 py-2 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700 rounded-t-lg flex items-center justify-between\">\r\n                      <div className=\"flex-1 min-w-0\">\r\n                        <h4 className=\"text-xs font-semibold text-gray-900 dark:text-gray-100 truncate\">\r\n                          {downloadStatus.totalDownloaded}/{downloadStatus.totalMachines} Downloaded\r\n                        </h4>\r\n                      </div>\r\n                      <button\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          setShowMachineStatusDropdown(false);\r\n                        }}\r\n                        className=\"ml-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors\"\r\n                      >\r\n                        <X className=\"w-3.5 h-3.5\" />\r\n                      </button>\r\n                    </div>\r\n\r\n                    {/* Society-wise Machine List */}\r\n                    <div className=\"divide-y divide-gray-200 dark:divide-gray-700\">\r\n                      {Object.entries(downloadStatus.societies).map(([societyName, societyData]) => (\r\n                        <div key={societyName} className=\"p-2\">\r\n                          <div className=\"flex items-center justify-between mb-1.5\">\r\n                            <h5 className=\"text-xs font-medium text-gray-700 dark:text-gray-300 truncate\">\r\n                              {societyName}\r\n                            </h5>\r\n                            <span className=\"text-xs text-gray-500 dark:text-gray-400 ml-2\">\r\n                              {societyData.downloadedMachines}/{societyData.totalMachines}\r\n                            </span>\r\n                          </div>\r\n\r\n                          {/* Downloaded Machines */}\r\n                          {societyData.machines.filter(m => m.downloaded).length > 0 && (\r\n                            <div className=\"mb-1.5\">\r\n                              <div className=\"text-xs font-medium text-green-600 dark:text-green-400 mb-1 flex items-center gap-1\">\r\n                                <CheckCircle className=\"w-2.5 h-2.5\" />\r\n                                <span>Done</span>\r\n                              </div>\r\n                              <div className=\"space-y-0.5\">\r\n                                {societyData.machines\r\n                                  .filter(m => m.downloaded)\r\n                                  .map((machine) => (\r\n                                    <div\r\n                                      key={machine.id}\r\n                                      className=\"text-xs bg-green-50 dark:bg-green-900/20 rounded px-1.5 py-1\"\r\n                                    >\r\n                                      <div className=\"font-medium text-green-700 dark:text-green-300 truncate\">\r\n                                        {machine.machineId}\r\n                                      </div>\r\n                                      <div className=\"text-[10px] text-green-600 dark:text-green-400 truncate\">\r\n                                        {machine.machineType} • {machine.location}\r\n                                      </div>\r\n                                    </div>\r\n                                  ))}\r\n                              </div>\r\n                            </div>\r\n                          )}\r\n\r\n                          {/* Pending Machines */}\r\n                          {societyData.machines.filter(m => !m.downloaded).length > 0 && (\r\n                            <div>\r\n                              <div className=\"text-xs font-medium text-amber-600 dark:text-amber-400 mb-1 flex items-center gap-1\">\r\n                                <Clock className=\"w-2.5 h-2.5\" />\r\n                                <span>Pending</span>\r\n                              </div>\r\n                              <div className=\"space-y-0.5\">\r\n                                {societyData.machines\r\n                                  .filter(m => !m.downloaded)\r\n                                  .map((machine) => (\r\n                                    <div\r\n                                      key={machine.id}\r\n                                      className=\"text-xs bg-amber-50 dark:bg-amber-900/20 rounded px-1.5 py-1\"\r\n                                    >\r\n                                      <div className=\"font-medium text-amber-700 dark:text-amber-300 truncate\">\r\n                                        {machine.machineId}\r\n                                      </div>\r\n                                      <div className=\"text-[10px] text-amber-600 dark:text-amber-400 truncate\">\r\n                                        {machine.machineType} • {machine.location}\r\n                                      </div>\r\n                                    </div>\r\n                                  ))}\r\n                              </div>\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Right: Actions Menu */}\r\n        <div className=\"relative\" ref={menuRef}>\r\n          <button\r\n            onClick={() => setShowActionsMenu(!showActionsMenu)}\r\n            className=\"p-1.5 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors\"\r\n            title=\"Actions\"\r\n          >\r\n            <MoreVertical className=\"w-5 h-5\" />\r\n          </button>\r\n\r\n          {/* Dropdown Menu */}\r\n          {showActionsMenu && (\r\n            <div className=\"absolute right-0 mt-2 w-56 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 z-50 py-1\">\r\n              <button\r\n                onClick={() => {\r\n                  onView();\r\n                  setShowActionsMenu(false);\r\n                }}\r\n                className=\"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors\"\r\n              >\r\n                <Eye className=\"w-4 h-4 text-blue-600 dark:text-blue-400\" />\r\n                <span>{t.common.view || 'View'} {t.ratechartManagement.rateChart}</span>\r\n              </button>\r\n              <button\r\n                onClick={() => {\r\n                  onAssignSociety();\r\n                  setShowActionsMenu(false);\r\n                }}\r\n                className=\"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors\"\r\n              >\r\n                <UserPlus className=\"w-4 h-4 text-green-600 dark:text-green-400\" />\r\n                <span>{t.common.add} {t.ratechartManagement.societies}</span>\r\n              </button>\r\n              <button\r\n                onClick={() => {\r\n                  onResetDownload();\r\n                  setShowActionsMenu(false);\r\n                }}\r\n                className=\"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors\"\r\n              >\r\n                <RefreshCw className=\"w-4 h-4 text-purple-600 dark:text-purple-400\" />\r\n                <span>{t.ratechartManagement.resetDownload}</span>\r\n              </button>\r\n              <button\r\n                onClick={() => {\r\n                  onToggleStatus(chartId, status);\r\n                  setShowActionsMenu(false);\r\n                }}\r\n                className=\"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors\"\r\n              >\r\n                {status === 1 ? (\r\n                  <>\r\n                    <PowerOff className=\"w-4 h-4 text-gray-600 dark:text-gray-400\" />\r\n                    <span>{t.ratechartManagement.inactive}</span>\r\n                  </>\r\n                ) : (\r\n                  <>\r\n                    <Power className=\"w-4 h-4 text-green-600 dark:text-green-400\" />\r\n                    <span>{t.ratechartManagement.active}</span>\r\n                  </>\r\n                )}\r\n              </button>\r\n              <div className=\"border-t border-gray-200 dark:border-gray-700 my-1\"></div>\r\n              <button\r\n                onClick={() => {\r\n                  onDelete();\r\n                  setShowActionsMenu(false);\r\n                }}\r\n                className=\"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors\"\r\n              >\r\n                <Trash2 className=\"w-4 h-4\" />\r\n                <span>{t.common.delete}</span>\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Metadata Section */}\r\n      <div className=\"flex items-center gap-4 mb-4 text-xs text-gray-500 dark:text-gray-400\">\r\n        <div className=\"flex items-center gap-1.5\">\r\n          <FileText className=\"w-3.5 h-3.5\" />\r\n          <span>{uploadedBy}</span>\r\n        </div>\r\n        <div className=\"flex items-center gap-1.5\">\r\n          <span>•</span>\r\n          <span>{new Date(createdAt).toLocaleDateString('en-US', { \r\n            month: 'short', \r\n            day: 'numeric',\r\n            year: 'numeric'\r\n          })}</span>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Societies Section */}\r\n      <div className=\"relative bg-gray-50 dark:bg-gray-900/50 rounded-lg p-3 border border-gray-200 dark:border-gray-700 mb-3\">\r\n        <button\r\n          onClick={() => setShowSocietiesDropdown(!showSocietiesDropdown)}\r\n          className=\"w-full flex items-center justify-between text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100 transition-colors\"\r\n        >\r\n          <div className=\"flex items-center gap-2\">\r\n            <Building2 className=\"w-4 h-4 text-green-600 dark:text-green-400\" />\r\n            <span>{t.ratechartManagement.societies} ({societies.length})</span>\r\n          </div>\r\n          {showSocietiesDropdown ? (\r\n            <ChevronUp className=\"w-4 h-4\" />\r\n          ) : (\r\n            <ChevronDown className=\"w-4 h-4\" />\r\n          )}\r\n        </button>\r\n\r\n        {/* Societies Dropdown */}\r\n        {showSocietiesDropdown && (\r\n          <div className=\"absolute left-0 right-0 top-full mt-2 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 z-50 overflow-hidden max-h-64 overflow-y-auto\">\r\n            {societies.map((society) => (\r\n              <div\r\n                key={society.societyId}\r\n                className=\"group flex items-center justify-between p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors border-b border-gray-100 dark:border-gray-700 last:border-b-0\"\r\n              >\r\n                <div className=\"flex items-center gap-3 flex-1 min-w-0\">\r\n                  <div className=\"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0\">\r\n                    <span className=\"text-xs font-bold text-green-700 dark:text-green-300\">\r\n                      {society.societyName.charAt(0).toUpperCase()}\r\n                    </span>\r\n                  </div>\r\n                  \r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <p className=\"text-sm font-medium text-gray-900 dark:text-gray-100 truncate\" title={society.societyName}>\r\n                      {highlightText(society.societyName, searchQuery)}\r\n                    </p>\r\n                    {society.societyIdentifier && (\r\n                      <p className=\"text-xs text-gray-500 dark:text-gray-400 truncate\">\r\n                        {highlightText(society.societyIdentifier, searchQuery)}\r\n                      </p>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n                \r\n                {onRemoveSociety && societies.length > 1 && (\r\n                  <button\r\n                    onClick={() => {\r\n                      setSocietyToRemove({\r\n                        chartRecordId: society.chartRecordId,\r\n                        societyId: society.societyId,\r\n                        societyName: society.societyName\r\n                      });\r\n                    }}\r\n                    className=\"ml-2 p-1.5 text-red-500 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-all opacity-0 group-hover:opacity-100\"\r\n                    title={`Remove ${society.societyName}`}\r\n                  >\r\n                    <X className=\"w-4 h-4\" />\r\n                  </button>\r\n                )}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Remove Society Confirmation Modal */}\r\n      <ConfirmDeleteModal\r\n        isOpen={!!societyToRemove}\r\n        onClose={() => setSocietyToRemove(null)}\r\n        onConfirm={() => {\r\n          if (societyToRemove && onRemoveSociety) {\r\n            onRemoveSociety(societyToRemove.chartRecordId, societyToRemove.societyId, societyToRemove.societyName);\r\n            if (societies.length === 2) {\r\n              setShowSocietiesDropdown(false);\r\n            }\r\n          }\r\n          setSocietyToRemove(null);\r\n        }}\r\n        itemName={societyToRemove?.societyName || ''}\r\n        itemType={t.ratechartManagement.society}\r\n        title={`${t.common.delete} ${t.ratechartManagement.society}`}\r\n        message={t.common.confirm}\r\n        confirmText={`${t.common.delete} ${t.ratechartManagement.society}`}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1686, "column": 0}, "map": {"version":3,"sources":["file:///P:/psr-cloud-v2/src/components/ratechart/AssignSocietyModal.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Users, Plus, AlertTriangle } from 'lucide-react';\r\nimport { FormModal, FormActions } from '@/components/forms';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { useLanguage } from '@/contexts/LanguageContext';\r\n\r\ninterface Society {\r\n  id: number;\r\n  name: string;\r\n  society_id: string;\r\n}\r\n\r\ninterface AssignSocietyModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onAssign: (societyIds: number[], replaceExisting: boolean) => Promise<{ requiresConfirmation?: boolean; conflicts?: Array<{ societyId: number; societyName: string; currentFileName: string }> } | void>;\r\n  chartId: number;\r\n  fileName: string;\r\n  currentSocieties: Array<{ societyId: number; societyName: string; societyIdentifier: string }>;\r\n  allSocieties: Society[];\r\n}\r\n\r\nexport default function AssignSocietyModal({\r\n  isOpen,\r\n  onClose,\r\n  onAssign,\r\n  fileName,\r\n  currentSocieties,\r\n  allSocieties,\r\n}: AssignSocietyModalProps) {\r\n  const { t } = useLanguage();\r\n  const [selectedSocieties, setSelectedSocieties] = useState<Set<number>>(new Set());\r\n  const [isAssigning, setIsAssigning] = useState(false);\r\n  const [conflicts, setConflicts] = useState<Array<{\r\n    societyId: number;\r\n    societyName: string;\r\n    currentFileName: string;\r\n  }> | null>(null);\r\n  const [showConflictWarning, setShowConflictWarning] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      setSelectedSocieties(new Set());\r\n      setConflicts(null);\r\n      setShowConflictWarning(false);\r\n    }\r\n  }, [isOpen]);\r\n\r\n  if (!isOpen) return null;\r\n\r\n  // Get societies that are not already assigned\r\n  const currentSocietyIds = new Set(currentSocieties.map(s => s.societyId));\r\n  const availableSocieties = allSocieties.filter(s => !currentSocietyIds.has(s.id));\r\n\r\n  const handleToggleSociety = (societyId: number) => {\r\n    const newSelected = new Set(selectedSocieties);\r\n    if (newSelected.has(societyId)) {\r\n      newSelected.delete(societyId);\r\n    } else {\r\n      newSelected.add(societyId);\r\n    }\r\n    setSelectedSocieties(newSelected);\r\n  };\r\n\r\n  const handleSelectAll = () => {\r\n    if (selectedSocieties.size === availableSocieties.length) {\r\n      setSelectedSocieties(new Set());\r\n    } else {\r\n      setSelectedSocieties(new Set(availableSocieties.map(s => s.id)));\r\n    }\r\n  };\r\n\r\n  const handleAssign = async (replaceExisting = false) => {\r\n    if (selectedSocieties.size === 0) return;\r\n\r\n    setIsAssigning(true);\r\n    try {\r\n      const result = await onAssign(Array.from(selectedSocieties), replaceExisting);\r\n      \r\n      // Check if result indicates conflicts\r\n      if (result && result.requiresConfirmation && result.conflicts) {\r\n        setConflicts(result.conflicts);\r\n        setShowConflictWarning(true);\r\n        setIsAssigning(false);\r\n        return;\r\n      }\r\n      \r\n      onClose();\r\n    } catch (error: unknown) {\r\n      if (error && typeof error === 'object' && 'requiresConfirmation' in error && 'conflicts' in error) {\r\n        const err = error as { requiresConfirmation: boolean; conflicts: Array<{ societyId: number; societyName: string; currentFileName: string }> };\r\n        setConflicts(err.conflicts);\r\n        setShowConflictWarning(true);\r\n      } else {\r\n        console.error('Error assigning societies:', error);\r\n      }\r\n    } finally {\r\n      setIsAssigning(false);\r\n    }\r\n  };\r\n\r\n  const handleConfirmReplace = () => {\r\n    setShowConflictWarning(false);\r\n    handleAssign(true);\r\n  };\r\n\r\n  const handleCancelReplace = () => {\r\n    setShowConflictWarning(false);\r\n    setConflicts(null);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <FormModal\r\n        isOpen={isOpen}\r\n        onClose={onClose}\r\n        title={t.ratechartManagement.chartAssignedSuccessfully.split(' ')[0] + ' ' + t.ratechartManagement.societies}\r\n        maxWidth=\"2xl\"\r\n      >\r\n        <div className=\"space-y-6\">\r\n          {/* File Name */}\r\n          <div className=\"bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 rounded-xl p-4 border border-green-200 dark:border-green-800\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <div className=\"p-2 bg-green-500 dark:bg-green-600 rounded-lg\">\r\n                <Users className=\"w-5 h-5 text-white\" />\r\n              </div>\r\n              <div className=\"flex-1 min-w-0\">\r\n                <p className=\"text-xs font-medium text-green-700 dark:text-green-300 mb-0.5\">Rate Chart File</p>\r\n                <p className=\"text-sm font-semibold text-gray-900 dark:text-gray-100 truncate\" title={fileName}>\r\n                  {fileName}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Currently Assigned */}\r\n          <div>\r\n            <h3 className=\"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3 flex items-center gap-2\">\r\n              <div className=\"w-1.5 h-1.5 rounded-full bg-green-500\" />\r\n              Currently Assigned ({currentSocieties.length})\r\n            </h3>\r\n            <div className=\"flex flex-wrap gap-2\">\r\n              {currentSocieties.map(society => (\r\n                <span\r\n                  key={society.societyId}\r\n                  className=\"inline-flex items-center px-3 py-1.5 rounded-lg text-sm font-medium bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600\"\r\n                >\r\n                  {society.societyName}\r\n                </span>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Divider */}\r\n          <div className=\"border-t border-gray-200 dark:border-gray-700\" />\r\n\r\n          {/* Available Societies */}\r\n          <div>\r\n            <div className=\"flex items-center justify-between mb-3\">\r\n              <h3 className=\"text-sm font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2\">\r\n                <div className=\"w-1.5 h-1.5 rounded-full bg-blue-500\" />\r\n                Available Societies ({availableSocieties.length})\r\n              </h3>\r\n              {availableSocieties.length > 0 && (\r\n                <button\r\n                  onClick={handleSelectAll}\r\n                  className=\"text-xs text-green-600 dark:text-green-400 hover:text-green-700 dark:hover:text-green-300 font-semibold transition-colors\"\r\n                >\r\n                  {selectedSocieties.size === availableSocieties.length ? 'Deselect All' : 'Select All'}\r\n                </button>\r\n              )}\r\n            </div>\r\n\r\n            {/* Society List */}\r\n            {availableSocieties.length === 0 ? (\r\n              <div className=\"text-center py-12 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl\">\r\n                <Users className=\"w-12 h-12 mx-auto mb-3 text-gray-400 dark:text-gray-500\" />\r\n                <p className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">All societies assigned</p>\r\n                <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">All available societies already have this chart</p>\r\n              </div>\r\n            ) : (\r\n              <div className=\"border border-gray-200 dark:border-gray-700 rounded-xl overflow-hidden max-h-80 overflow-y-auto bg-gray-50 dark:bg-gray-900/50\">\r\n                <div className=\"divide-y divide-gray-200 dark:divide-gray-700\">\r\n                  {availableSocieties.map(society => (\r\n                    <label\r\n                      key={society.id}\r\n                      className=\"flex items-center gap-3 p-4 hover:bg-white dark:hover:bg-gray-800 cursor-pointer transition-colors group\"\r\n                    >\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={selectedSocieties.has(society.id)}\r\n                        onChange={() => handleToggleSociety(society.id)}\r\n                        className=\"w-4 h-4 text-green-600 dark:text-green-500 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded focus:ring-green-500 dark:focus:ring-green-400 focus:ring-2 cursor-pointer transition-all\"\r\n                      />\r\n                      <div className=\"w-8 h-8 rounded-full bg-gradient-to-br from-green-100 to-emerald-100 dark:from-green-900/50 dark:to-emerald-900/50 flex items-center justify-center flex-shrink-0 group-hover:scale-110 transition-transform\">\r\n                        <span className=\"text-xs font-bold text-green-700 dark:text-green-300\">\r\n                          {society.name.charAt(0).toUpperCase()}\r\n                        </span>\r\n                      </div>\r\n                      <div className=\"flex-1 min-w-0\">\r\n                        <p className=\"text-sm font-semibold text-gray-900 dark:text-gray-100 truncate\">{society.name}</p>\r\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400 truncate\">{society.society_id}</p>\r\n                      </div>\r\n                    </label>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Selected Count */}\r\n            {selectedSocieties.size > 0 && (\r\n              <div className=\"mt-3 flex items-center gap-2 text-sm\">\r\n                <div className=\"flex items-center justify-center w-6 h-6 rounded-full bg-green-100 dark:bg-green-900/30\">\r\n                  <span className=\"text-xs font-bold text-green-600 dark:text-green-400\">\r\n                    {selectedSocieties.size}\r\n                  </span>\r\n                </div>\r\n                <span className=\"text-gray-700 dark:text-gray-300 font-medium\">\r\n                  {selectedSocieties.size} {selectedSocieties.size === 1 ? 'society' : 'societies'} selected\r\n                </span>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Form Actions */}\r\n          <FormActions\r\n            onCancel={onClose}\r\n            onSubmit={() => handleAssign(false)}\r\n            submitText={selectedSocieties.size > 0 ? `Assign to ${selectedSocieties.size} ${selectedSocieties.size === 1 ? 'Society' : 'Societies'}` : 'Select Societies'}\r\n            isLoading={isAssigning}\r\n            isSubmitDisabled={selectedSocieties.size === 0}\r\n            loadingText=\"Assigning...\"\r\n            submitIcon={<Plus className=\"w-4 h-4\" />}\r\n            submitType=\"button\"\r\n          />\r\n        </div>\r\n      </FormModal>\r\n\r\n      {/* Conflict Warning Modal */}\r\n      <AnimatePresence>\r\n        {showConflictWarning && conflicts && conflicts.length > 0 && (\r\n          <motion.div\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            className=\"fixed inset-0 bg-black/60 dark:bg-black/80 flex items-center justify-center z-[10000] p-4\"\r\n            onClick={handleCancelReplace}\r\n          >\r\n            <motion.div\r\n              initial={{ scale: 0.9, opacity: 0 }}\r\n              animate={{ scale: 1, opacity: 1 }}\r\n              exit={{ scale: 0.9, opacity: 0 }}\r\n              transition={{ type: 'spring', damping: 25, stiffness: 300 }}\r\n              className=\"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-md\"\r\n              onClick={(e) => e.stopPropagation()}\r\n            >\r\n              <div className=\"p-6\">\r\n                {/* Warning Icon */}\r\n                <div className=\"flex items-start gap-4 mb-4\">\r\n                  <div className=\"flex-shrink-0 w-12 h-12 rounded-full bg-yellow-100 dark:bg-yellow-900/30 flex items-center justify-center\">\r\n                    <AlertTriangle className=\"w-6 h-6 text-yellow-600 dark:text-yellow-400\" />\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <h3 className=\"text-lg font-bold text-gray-900 dark:text-gray-100 mb-1\">\r\n                      Replace Existing Charts?\r\n                    </h3>\r\n                    <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n                      The following {conflicts.length === 1 ? 'society already has' : 'societies already have'} a rate chart assigned:\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Conflicts List */}\r\n                <div className=\"space-y-2 mb-5 max-h-48 overflow-y-auto\">\r\n                  {conflicts.map((conflict) => (\r\n                    <div \r\n                      key={conflict.societyId}\r\n                      className=\"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-3\"\r\n                    >\r\n                      <p className=\"text-sm font-semibold text-gray-900 dark:text-gray-100\">{conflict.societyName}</p>\r\n                      <p className=\"text-xs text-gray-600 dark:text-gray-400 mt-0.5\">\r\n                        Current: <span className=\"font-medium\">{conflict.currentFileName}</span>\r\n                      </p>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n\r\n                <p className=\"text-sm font-medium text-gray-900 dark:text-gray-100 mb-6\">\r\n                  Do you want to replace {conflicts.length === 1 ? 'this chart' : 'these charts'} with the new one?\r\n                </p>\r\n\r\n                {/* Actions */}\r\n                <div className=\"flex gap-3\">\r\n                  <button\r\n                    onClick={handleCancelReplace}\r\n                    disabled={isAssigning}\r\n                    className=\"flex-1 px-4 py-2.5 text-sm font-semibold text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-xl transition-colors disabled:opacity-50\"\r\n                  >\r\n                    Cancel\r\n                  </button>\r\n                  <button\r\n                    onClick={handleConfirmReplace}\r\n                    disabled={isAssigning}\r\n                    className=\"flex-1 px-4 py-2.5 text-sm font-semibold text-white bg-yellow-600 dark:bg-yellow-600 hover:bg-yellow-700 dark:hover:bg-yellow-500 rounded-xl transition-colors disabled:opacity-50 flex items-center justify-center gap-2\"\r\n                  >\r\n                    {isAssigning ? (\r\n                      <>\r\n                        <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />\r\n                        Replacing...\r\n                      </>\r\n                    ) : (\r\n                      'Yes, Replace'\r\n                    )}\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </motion.div>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2318, "column": 0}, "map": {"version":3,"sources":["file:///P:/psr-cloud-v2/src/components/ratechart/TotalAssignmentsModal.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { Receipt } from 'lucide-react';\r\nimport { FormModal } from '@/components/forms';\r\nimport { useLanguage } from '@/contexts/LanguageContext';\r\n\r\n// Helper function to convert database channel values to display format\r\nconst getChannelDisplay = (channel: string): string => {\r\n  const channelMap: { [key: string]: string } = {\r\n    'COW': 'COW',\r\n    'BUF': 'BUFFALO',\r\n    'MIX': 'MIXED',\r\n    'BUFFALO': 'BUFFALO',\r\n    'MIXED': 'MIXED'\r\n  };\r\n  return channelMap[channel] || channel;\r\n};\r\n\r\ninterface RateChart {\r\n  id: number;\r\n  societyId: number;\r\n  societyName: string;\r\n  societyIdentifier: string;\r\n  channel: 'COW' | 'BUF' | 'MIX';\r\n  uploadedAt: string;\r\n  uploadedBy: string;\r\n  fileName: string;\r\n  recordCount: number;\r\n  shared_chart_id: number | null;\r\n}\r\n\r\ninterface TotalAssignmentsModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  rateCharts: RateChart[];\r\n}\r\n\r\nexport default function TotalAssignmentsModal({\r\n  isOpen,\r\n  onClose,\r\n  rateCharts,\r\n}: TotalAssignmentsModalProps) {\r\n  const { t } = useLanguage();\r\n  const [channelFilter, setChannelFilter] = useState<string>('all');\r\n\r\n  if (!isOpen) return null;\r\n\r\n  // Filter assignments\r\n  const filteredAssignments = rateCharts.filter(chart => {\r\n    if (channelFilter !== 'all' && chart.channel !== channelFilter) return false;\r\n    return true;\r\n  });\r\n\r\n  // Group by channel\r\n  const cowAssignments = filteredAssignments.filter(c => c.channel === 'COW');\r\n  const bufAssignments = filteredAssignments.filter(c => c.channel === 'BUF');\r\n  const mixAssignments = filteredAssignments.filter(c => c.channel === 'MIX');\r\n\r\n  return (\r\n    <FormModal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title={`${t.ratechartManagement.totalAssignments} (${rateCharts.length})`}\r\n      maxWidth=\"2xl\"\r\n    >\r\n      <div className=\"space-y-6\">\r\n        {/* Info Text */}\r\n        <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n          {t.ratechartManagement.allRateChartAssignments}\r\n        </p>\r\n\r\n        {/* Channel Filter Tabs */}\r\n        <div className=\"flex gap-2 flex-wrap\">\r\n          <button\r\n            onClick={() => setChannelFilter('all')}\r\n            className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${\r\n              channelFilter === 'all'\r\n                ? 'bg-blue-600 dark:bg-blue-500 text-white'\r\n                : 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'\r\n            }`}\r\n          >\r\n            {t.dashboard.all} ({rateCharts.length})\r\n          </button>\r\n          <button\r\n            onClick={() => setChannelFilter('COW')}\r\n            className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${\r\n              channelFilter === 'COW'\r\n                ? 'bg-green-600 dark:bg-green-500 text-white'\r\n                : 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'\r\n            }`}\r\n          >\r\n            {t.ratechartManagement.cow} ({rateCharts.filter(c => c.channel === 'COW').length})\r\n          </button>\r\n          <button\r\n            onClick={() => setChannelFilter('BUF')}\r\n            className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${\r\n              channelFilter === 'BUF'\r\n                ? 'bg-blue-600 dark:bg-blue-500 text-white'\r\n                : 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'\r\n            }`}\r\n          >\r\n            {t.ratechartManagement.buf} ({rateCharts.filter(c => c.channel === 'BUF').length})\r\n          </button>\r\n          <button\r\n            onClick={() => setChannelFilter('MIX')}\r\n            className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${\r\n              channelFilter === 'MIX'\r\n                ? 'bg-purple-600 dark:bg-purple-500 text-white'\r\n                : 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'\r\n            }`}\r\n          >\r\n            {t.ratechartManagement.mix} ({rateCharts.filter(c => c.channel === 'MIX').length})\r\n          </button>\r\n        </div>\r\n\r\n        {/* Assignments List */}\r\n        <div className=\"max-h-96 overflow-y-auto space-y-2 border border-gray-200 dark:border-gray-700 rounded-xl p-3 bg-gray-50 dark:bg-gray-900/50\">\r\n          {filteredAssignments.length === 0 ? (\r\n            <div className=\"text-center py-12\">\r\n              <Receipt className=\"w-12 h-12 mx-auto mb-3 text-gray-400 dark:text-gray-500\" />\r\n              <p className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">{t.ratechartManagement.noAssignmentsFound}</p>\r\n              <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">{t.ratechartManagement.tryChangingFilter}</p>\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-4\">\r\n              {/* COW Assignments */}\r\n              {(channelFilter === 'all' || channelFilter === 'COW') && cowAssignments.length > 0 && (\r\n                <div>\r\n                  <h3 className=\"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2\">\r\n                    <span className=\"inline-block w-2 h-2 rounded-full bg-green-500\"></span>\r\n                    {t.ratechartManagement.cow} {t.ratechartManagement.channel} ({cowAssignments.length})\r\n                  </h3>\r\n                  <div className=\"space-y-2\">\r\n                    {cowAssignments.map((chart) => (\r\n                      <AssignmentRow key={chart.id} chart={chart} />\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* BUF Assignments */}\r\n              {(channelFilter === 'all' || channelFilter === 'BUF') && bufAssignments.length > 0 && (\r\n                <div>\r\n                  <h3 className=\"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2\">\r\n                    <span className=\"inline-block w-2 h-2 rounded-full bg-blue-500\"></span>\r\n                    {t.ratechartManagement.buffalo} {t.ratechartManagement.channel} ({bufAssignments.length})\r\n                  </h3>\r\n                  <div className=\"space-y-2\">\r\n                    {bufAssignments.map((chart) => (\r\n                      <AssignmentRow key={chart.id} chart={chart} />\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* MIX Assignments */}\r\n              {(channelFilter === 'all' || channelFilter === 'MIX') && mixAssignments.length > 0 && (\r\n                <div>\r\n                  <h3 className=\"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2\">\r\n                    <span className=\"inline-block w-2 h-2 rounded-full bg-purple-500\"></span>\r\n                    {t.ratechartManagement.mixed} {t.ratechartManagement.channel} ({mixAssignments.length})\r\n                  </h3>\r\n                  <div className=\"space-y-2\">\r\n                    {mixAssignments.map((chart) => (\r\n                      <AssignmentRow key={chart.id} chart={chart} />\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Footer Info */}\r\n        <div className=\"flex items-center justify-between pt-2 border-t border-gray-200 dark:border-gray-700\">\r\n          <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n            {t.ratechartManagement.showing} {filteredAssignments.length} {t.ratechartManagement.of} {rateCharts.length} {t.ratechartManagement.assignments}\r\n          </p>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 dark:bg-blue-500 rounded-lg hover:bg-blue-700 dark:hover:bg-blue-600 transition-colors\"\r\n          >\r\n            {t.common.close}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </FormModal>\r\n  );\r\n}\r\n\r\n// Assignment Row Component\r\nfunction AssignmentRow({ chart }: { chart: RateChart }) {\r\n  const getChannelColor = (channel: string) => {\r\n    switch (channel) {\r\n      case 'COW': return 'bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 border-green-200 dark:border-green-800';\r\n      case 'BUF': return 'bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400 border-blue-200 dark:border-blue-800';\r\n      case 'MIX': return 'bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400 border-yellow-200 dark:border-yellow-800';\r\n      default: return 'bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-200 dark:border-gray-700';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex items-center justify-between p-3 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-700 transition-colors\">\r\n      <div className=\"flex-1 min-w-0\">\r\n        <div className=\"flex items-center gap-2 mb-1\">\r\n          <p className=\"text-sm font-medium text-gray-900 dark:text-gray-100\">\r\n            {chart.societyName}\r\n          </p>\r\n          <span className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n            ({chart.societyIdentifier})\r\n          </span>\r\n          <span className={`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium border ${getChannelColor(chart.channel)}`}>\r\n            {getChannelDisplay(chart.channel)}\r\n          </span>\r\n          {chart.shared_chart_id && (\r\n            <span className=\"inline-flex items-center px-2 py-0.5 rounded text-xs bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400 border border-purple-200 dark:border-purple-800\">\r\n              Shared\r\n            </span>\r\n          )}\r\n        </div>\r\n        <p className=\"text-xs text-gray-600 dark:text-gray-400 truncate\">\r\n          {chart.fileName}\r\n        </p>\r\n      </div>\r\n      <div className=\"text-right ml-4 flex-shrink-0\">\r\n        <p className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n          {new Date(chart.uploadedAt).toLocaleDateString('en-US', { \r\n            month: 'short', \r\n            day: 'numeric',\r\n            year: 'numeric'\r\n          })}\r\n        </p>\r\n        <p className=\"text-xs text-gray-400 dark:text-gray-500\">{chart.recordCount} records</p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2788, "column": 0}, "map": {"version":3,"sources":["file:///P:/psr-cloud-v2/src/components/ratechart/ResetDownloadModal.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { RefreshCw } from 'lucide-react';\r\nimport { FlowerSpinner } from '@/components';\r\nimport { FormModal, FormActions, FormSelect } from '@/components/forms';\r\nimport { useLanguage } from '@/contexts/LanguageContext';\r\n\r\ninterface Machine {\r\n  id: number;\r\n  machineId: string;\r\n  machineType: string;\r\n  societyName: string;\r\n  societyId: number;\r\n  societyIdentifier?: string;\r\n  location?: string;\r\n}\r\n\r\ninterface ResetDownloadModalProps {\r\n  show: boolean;\r\n  onClose: () => void;\r\n  onConfirm: (machineIds: number[]) => Promise<void>;\r\n  chartId: number;\r\n  fileName: string;\r\n  channel: string;\r\n  societies: Array<{ societyId: number; societyName: string }>;\r\n}\r\n\r\nexport default function ResetDownloadModal({\r\n  show,\r\n  onClose,\r\n  onConfirm,\r\n  chartId,\r\n  fileName,\r\n  channel,\r\n  societies\r\n}: ResetDownloadModalProps) {\r\n  const { t } = useLanguage();\r\n  const [machines, setMachines] = useState<Machine[]>([]);\r\n  const [selectedMachines, setSelectedMachines] = useState<Set<number>>(new Set());\r\n  const [loading, setLoading] = useState(false);\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const [societyFilter, setSocietyFilter] = useState<number | 'all'>('all');\r\n\r\n  useEffect(() => {\r\n    const fetchMachines = async () => {\r\n      if (!show) return;\r\n      \r\n      setLoading(true);\r\n      try {\r\n        const token = localStorage.getItem('authToken');\r\n        if (!token) return;\r\n\r\n        const response = await fetch(`/api/user/ratechart/data?chartId=${chartId}`, {\r\n          headers: { 'Authorization': `Bearer ${token}` }\r\n        });\r\n\r\n        if (response.ok) {\r\n          const result = await response.json();\r\n          setMachines(result.data?.machines || []);\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching machines:', error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    if (show) {\r\n      fetchMachines();\r\n      setSelectedMachines(new Set());\r\n      setSocietyFilter('all');\r\n    }\r\n  }, [show, chartId]);\r\n\r\n  const handleToggleSelection = (machineId: number) => {\r\n    setSelectedMachines(prev => {\r\n      const newSet = new Set(prev);\r\n      if (newSet.has(machineId)) {\r\n        newSet.delete(machineId);\r\n      } else {\r\n        newSet.add(machineId);\r\n      }\r\n      return newSet;\r\n    });\r\n  };\r\n\r\n  const handleSelectAll = () => {\r\n    if (selectedMachines.size === filteredMachines.length) {\r\n      setSelectedMachines(new Set());\r\n    } else {\r\n      setSelectedMachines(new Set(filteredMachines.map(m => m.id)));\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    if (selectedMachines.size === 0) return;\r\n\r\n    setSubmitting(true);\r\n    try {\r\n      await onConfirm(Array.from(selectedMachines));\r\n      onClose();\r\n    } catch (error) {\r\n      console.error('Error resetting download:', error);\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const filteredMachines = machines.filter(machine => {\r\n    const matchesSociety = societyFilter === 'all' || \r\n      societies.find(s => s.societyId === societyFilter && s.societyName === machine.societyName);\r\n\r\n    return matchesSociety;\r\n  });\r\n\r\n  if (!show) return null;\r\n\r\n  return (\r\n    <FormModal\r\n      isOpen={show}\r\n      onClose={onClose}\r\n      title={`${t.common.reset} ${t.ratechartManagement.channelDownloadStatus}`}\r\n      maxWidth=\"2xl\"\r\n    >\r\n      <div className=\"space-y-6\">\r\n        {/* Channel Badge */}\r\n        <div className=\"flex items-center gap-2\">\r\n          <span className={`px-2.5 py-1 rounded-lg text-xs font-semibold ${\r\n            channel === 'COW' ? 'bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300' :\r\n            channel === 'BUF' ? 'bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300' :\r\n            'bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300'\r\n          }`}>\r\n            {channel} {t.ratechartManagement.channel}\r\n          </span>\r\n        </div>\r\n\r\n        {/* File Info */}\r\n        <div className=\"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-xl p-4 border border-blue-200 dark:border-blue-800\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <div className=\"p-2 bg-blue-500 dark:bg-blue-600 rounded-lg\">\r\n              <RefreshCw className=\"w-5 h-5 text-white\" />\r\n            </div>\r\n            <div className=\"flex-1 min-w-0\">\r\n              <p className=\"text-xs font-medium text-blue-700 dark:text-blue-300 mb-0.5\">{t.ratechartManagement.rateChartFile}</p>\r\n              <p className=\"text-sm font-semibold text-gray-900 dark:text-gray-100 truncate\" title={fileName}>\r\n                {fileName}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Info Text */}\r\n        <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n          {t.ratechartManagement.selectMachinesToReset} <span className=\"font-semibold text-gray-900 dark:text-gray-100\">{channel} {t.ratechartManagement.channel}</span> {t.ratechartManagement.downloadStatusAllowRedownload} {channel} {t.ratechartManagement.milkType}.\r\n        </p>\r\n\r\n        {/* Society Filter */}\r\n        <FormSelect\r\n          label={t.ratechartManagement.filterBySociety}\r\n          value={societyFilter.toString()}\r\n          onChange={(value) => setSocietyFilter(value === 'all' ? 'all' : parseInt(value))}\r\n          options={[\r\n            { value: 'all', label: t.ratechartManagement.allSocieties },\r\n            ...societies.map(society => ({\r\n              value: society.societyId.toString(),\r\n              label: society.societyName\r\n            }))\r\n          ]}\r\n        />\r\n\r\n        {/* Select All */}\r\n        {filteredMachines.length > 0 && (\r\n          <div className=\"flex items-center justify-between pb-3 border-b border-gray-200 dark:border-gray-700\">\r\n            <label className=\"flex items-center gap-2 cursor-pointer group\">\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={selectedMachines.size === filteredMachines.length && filteredMachines.length > 0}\r\n                onChange={handleSelectAll}\r\n                className=\"w-4 h-4 text-blue-600 dark:text-blue-500 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded focus:ring-blue-500 dark:focus:ring-blue-400 focus:ring-2 cursor-pointer transition-all\"\r\n              />\r\n              <span className=\"text-sm font-semibold text-gray-900 dark:text-gray-100 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors\">\r\n                {t.common.selectAll} ({filteredMachines.length})\r\n              </span>\r\n            </label>\r\n            {selectedMachines.size > 0 && (\r\n              <div className=\"flex items-center gap-2\">\r\n                <div className=\"flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 dark:bg-blue-900/30\">\r\n                  <span className=\"text-xs font-bold text-blue-600 dark:text-blue-400\">\r\n                    {selectedMachines.size}\r\n                  </span>\r\n                </div>\r\n                <span className=\"text-sm text-gray-700 dark:text-gray-300 font-medium\">selected</span>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Machines List */}\r\n        <div className=\"max-h-80 overflow-y-auto space-y-2 border border-gray-200 dark:border-gray-700 rounded-xl p-3 bg-gray-50 dark:bg-gray-900/50\">\r\n          {loading ? (\r\n            <div className=\"flex flex-col items-center justify-center py-12\">\r\n              <FlowerSpinner size={32} />\r\n              <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-3\">{t.ratechartManagement.loadingMachines}</p>\r\n            </div>\r\n          ) : filteredMachines.length === 0 ? (\r\n            <div className=\"text-center py-12\">\r\n              <RefreshCw className=\"w-12 h-12 mx-auto mb-3 text-gray-400 dark:text-gray-500\" />\r\n              <p className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">{t.ratechartManagement.noMachinesFound}</p>\r\n              <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">{t.ratechartManagement.tryChangingSocietyFilter}</p>\r\n            </div>\r\n          ) : (\r\n            filteredMachines.map(machine => (\r\n              <label\r\n                key={machine.id}\r\n                className={`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-all group ${\r\n                  selectedMachines.has(machine.id)\r\n                    ? 'border-blue-500 dark:border-blue-400 bg-blue-50 dark:bg-blue-900/20'\r\n                    : 'border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 hover:border-blue-300 dark:hover:border-blue-600 hover:bg-blue-50/50 dark:hover:bg-blue-900/10'\r\n                }`}\r\n              >\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={selectedMachines.has(machine.id)}\r\n                  onChange={() => handleToggleSelection(machine.id)}\r\n                  className=\"w-4 h-4 text-blue-600 dark:text-blue-500 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded focus:ring-blue-500 dark:focus:ring-blue-400 focus:ring-2 cursor-pointer transition-all\"\r\n                />\r\n                <div className=\"w-8 h-8 rounded-full bg-gradient-to-br from-blue-100 to-indigo-100 dark:from-blue-900/50 dark:to-indigo-900/50 flex items-center justify-center flex-shrink-0 group-hover:scale-110 transition-transform\">\r\n                  <span className=\"text-xs font-bold text-blue-700 dark:text-blue-300\">\r\n                    {machine.machineId.charAt(0).toUpperCase()}\r\n                  </span>\r\n                </div>\r\n                <div className=\"flex-1 min-w-0\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <p className=\"text-sm font-semibold text-gray-900 dark:text-gray-100\">\r\n                      {machine.machineId}\r\n                    </p>\r\n                    <span className=\"text-xs px-2 py-0.5 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded font-medium\">\r\n                      {machine.machineType}\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex items-center gap-2 mt-1 text-xs\">\r\n                    <span className=\"font-medium text-gray-700 dark:text-gray-300\">{machine.societyName}</span>\r\n                    <span className=\"text-gray-400 dark:text-gray-500\">•</span>\r\n                    <span className=\"text-gray-500 dark:text-gray-400\">\r\n                      {machine.societyIdentifier || `ID: ${machine.societyId}`}\r\n                    </span>\r\n                    {machine.location && (\r\n                      <>\r\n                        <span className=\"text-gray-400 dark:text-gray-500\">•</span>\r\n                        <span className=\"text-gray-500 dark:text-gray-400\">{machine.location}</span>\r\n                      </>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </label>\r\n            ))\r\n          )}\r\n        </div>\r\n\r\n        {/* Form Actions */}\r\n        <FormActions\r\n          onCancel={onClose}\r\n          onSubmit={handleSubmit}\r\n          submitText={selectedMachines.size > 0 ? `${t.common.reset} ${channel} ${t.ratechartManagement.download} (${selectedMachines.size})` : t.ratechartManagement.selectMachines}\r\n          isLoading={submitting}\r\n          isSubmitDisabled={selectedMachines.size === 0}\r\n          loadingText={`${t.ratechartManagement.resetting} ${channel}...`}\r\n          submitIcon={<RefreshCw className=\"w-4 h-4\" />}\r\n          submitType=\"button\"\r\n        />\r\n      </div>\r\n    </FormModal>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3305, "column": 0}, "map": {"version":3,"sources":["file:///P:/psr-cloud-v2/src/app/admin/ratechart/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useUser } from '@/contexts/UserContext';\r\nimport { useLanguage } from '@/contexts/LanguageContext';\r\nimport { Receipt, Trash2, Eye, FileText, Upload } from 'lucide-react';\r\nimport { \r\n  FlowerSpinner,\r\n  StatusMessage,\r\n  StatsCard,\r\n  EmptyState,\r\n  LoadingSnackbar\r\n} from '@/components';\r\nimport { BulkActionsToolbar, FloatingActionButton } from '@/components/management';\r\nimport BulkDeleteConfirmModal from '@/components/management/BulkDeleteConfirmModal';\r\nimport RateChartUploadModal from '@/components/ratechart/RateChartUploadModal';\r\nimport RateChartMinimalCard from '@/components/ratechart/RateChartMinimalCard';\r\nimport AssignSocietyModal from '@/components/ratechart/AssignSocietyModal';\r\nimport TotalAssignmentsModal from '@/components/ratechart/TotalAssignmentsModal';\r\nimport ResetDownloadModal from '@/components/ratechart/ResetDownloadModal';\r\nimport ManagementPageHeader from '@/components/management/ManagementPageHeader';\r\nimport FilterDropdown from '@/components/management/FilterDropdown';\r\n\r\n// Helper function to convert database channel values to display format\r\nconst getChannelDisplay = (channel: string): string => {\r\n  const channelMap: { [key: string]: string } = {\r\n    'COW': 'COW',\r\n    'BUF': 'BUFFALO',\r\n    'MIX': 'MIXED',\r\n    'BUFFALO': 'BUFFALO',\r\n    'MIXED': 'MIXED'\r\n  };\r\n  return channelMap[channel] || channel;\r\n};\r\n\r\ninterface Society {\r\n  id: number;\r\n  name: string;\r\n  society_id: string;\r\n  bmc_id?: number;\r\n}\r\n\r\ninterface RateChart {\r\n  id: number;\r\n  societyId: number;\r\n  societyName: string;\r\n  societyIdentifier: string;\r\n  channel: 'COW' | 'BUF' | 'MIX';\r\n  uploadedAt: string;\r\n  uploadedBy: string;\r\n  fileName: string;\r\n  recordCount: number;\r\n  shared_chart_id: number | null;\r\n  status: number;\r\n}\r\n\r\nexport default function RatechartManagement() {\r\n  const router = useRouter();\r\n  const { user } = useUser();\r\n  const { t } = useLanguage();\r\n  \r\n  // State management\r\n  const [rateCharts, setRateCharts] = useState<RateChart[]>([]);\r\n  const [societies, setSocieties] = useState<Society[]>([]);\r\n  const [dairies, setDairies] = useState<Array<{ id: number; name: string; dairyId: string }>>([]);\r\n  const [bmcs, setBmcs] = useState<Array<{ id: number; name: string; bmcId: string; dairyFarmId?: number }>>([]);\r\n  const [machines, setMachines] = useState<Array<{ id: number; machineId: string; machineType: string; societyId?: number }>>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [showUploadModal, setShowUploadModal] = useState(false);\r\n  const [success, setSuccess] = useState('');\r\n  const [error, setError] = useState('');\r\n  const [isUploading, setIsUploading] = useState(false);\r\n  const [uploadProgress, setUploadProgress] = useState(0);\r\n\r\n  // Filter states\r\n  const [dairyFilter, setDairyFilter] = useState<string[]>([]);\r\n  const [bmcFilter, setBmcFilter] = useState<string[]>([]);\r\n  const [societyFilter, setSocietyFilter] = useState<string[]>([]);\r\n  const [machineFilter, setMachineFilter] = useState<string[]>([]);\r\n  const [channelFilter, setChannelFilter] = useState<string>('all');\r\n  const [searchQuery, setSearchQuery] = useState<string>('');\r\n\r\n  // Selection and bulk operations\r\n  const [selectedCharts, setSelectedCharts] = useState<Set<number>>(new Set());\r\n  const [selectAll, setSelectAll] = useState(false);\r\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\r\n  const [isDeletingBulk, setIsDeletingBulk] = useState(false);\r\n\r\n  // Single delete confirmation\r\n  const [showSingleDeleteConfirm, setShowSingleDeleteConfirm] = useState(false);\r\n  const [chartToDelete, setChartToDelete] = useState<number | null>(null);\r\n  const [chartToDeleteSocieties, setChartToDeleteSocieties] = useState<string>('');\r\n\r\n  // Assign society modal\r\n  const [showAssignModal, setShowAssignModal] = useState(false);\r\n  const [selectedChartForAssign, setSelectedChartForAssign] = useState<{\r\n    chartId: number;\r\n    fileName: string;\r\n    societies: Array<{ societyId: number; societyName: string; societyIdentifier: string }>;\r\n  } | null>(null);\r\n\r\n  // Bulk status\r\n  const [bulkStatus, setBulkStatus] = useState<string>('active');\r\n\r\n  // Total assignments modal\r\n  const [showAssignmentsModal, setShowAssignmentsModal] = useState(false);\r\n\r\n  // Rate chart view modal\r\n  const [showRateChartModal, setShowRateChartModal] = useState(false);\r\n  const [selectedRateChart, setSelectedRateChart] = useState<{ fileName: string; channel: string; societyId: number } | null>(null);\r\n  const [rateChartData, setRateChartData] = useState<Array<{ fat: string; snf: string; clr: string; rate: string }>>([]);\r\n  const [loadingChartData, setLoadingChartData] = useState(false);\r\n  const [searchFat, setSearchFat] = useState('');\r\n  const [searchSnf, setSearchSnf] = useState('');\r\n  const [searchClr, setSearchClr] = useState('');\r\n\r\n  // Reset download modal\r\n  const [showResetDownloadModal, setShowResetDownloadModal] = useState(false);\r\n  const [selectedChartForReset, setSelectedChartForReset] = useState<{\r\n    chartId: number;\r\n    fileName: string;\r\n    channel: string;\r\n    societies: Array<{ societyId: number; societyName: string }>;\r\n    chartRecordIds: number[];\r\n  } | null>(null);\r\n\r\n  // Redirect if not admin\r\n  useEffect(() => {\r\n    if (user && user.role !== 'admin' && user.role !== 'super_admin') {\r\n      router.push('/dashboard');\r\n    }\r\n  }, [user, router]);\r\n\r\n  // Fetch rate charts\r\n  const fetchRateCharts = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n      const token = localStorage.getItem('authToken');\r\n      if (!token) return;\r\n\r\n      const response = await fetch('/api/user/ratechart', {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`\r\n        }\r\n      });\r\n\r\n      const data = await response.json();\r\n      if (data.success) {\r\n        setRateCharts(data.data || []);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching rate charts:', error);\r\n      setError(t.ratechartManagement.failedToLoadCharts);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  // Fetch societies\r\n  const fetchSocieties = useCallback(async () => {\r\n    try {\r\n      const token = localStorage.getItem('authToken');\r\n      if (!token) return;\r\n\r\n      const response = await fetch('/api/user/society', {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`\r\n        }\r\n      });\r\n\r\n      const data = await response.json();\r\n      console.log('Societies API response:', data);\r\n      if (data.success) {\r\n        const societiesList = data.data || [];\r\n        console.log('Societies list:', societiesList);\r\n        setSocieties(societiesList);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching societies:', error);\r\n    }\r\n  }, []);\r\n\r\n  // Fetch dairies\r\n  const fetchDairies = useCallback(async () => {\r\n    try {\r\n      const token = localStorage.getItem('authToken');\r\n      if (!token) return;\r\n\r\n      const response = await fetch('/api/user/dairy', {\r\n        headers: { 'Authorization': `Bearer ${token}` }\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setDairies(data.data || []);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching dairies:', error);\r\n    }\r\n  }, []);\r\n\r\n  // Fetch BMCs\r\n  const fetchBmcs = useCallback(async () => {\r\n    try {\r\n      const token = localStorage.getItem('authToken');\r\n      if (!token) return;\r\n\r\n      const response = await fetch('/api/user/bmc', {\r\n        headers: { 'Authorization': `Bearer ${token}` }\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setBmcs(data.data || []);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching BMCs:', error);\r\n    }\r\n  }, []);\r\n\r\n  // Fetch machines\r\n  const fetchMachines = useCallback(async () => {\r\n    try {\r\n      const token = localStorage.getItem('authToken');\r\n      if (!token) return;\r\n\r\n      const response = await fetch('/api/user/machine', {\r\n        headers: { 'Authorization': `Bearer ${token}` }\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setMachines(data.data || []);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching machines:', error);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      fetchRateCharts();\r\n      fetchSocieties();\r\n      fetchDairies();\r\n      fetchBmcs();\r\n      fetchMachines();\r\n    }\r\n  }, [user, fetchRateCharts, fetchSocieties, fetchDairies, fetchBmcs, fetchMachines]);\r\n\r\n  // Listen for global search events from header\r\n  useEffect(() => {\r\n    const handleGlobalSearch = (event: Event) => {\r\n      const customEvent = event as CustomEvent;\r\n      const query = customEvent.detail?.query || '';\r\n      setSearchQuery(query);\r\n    };\r\n\r\n    window.addEventListener('globalSearch', handleGlobalSearch);\r\n    return () => {\r\n      window.removeEventListener('globalSearch', handleGlobalSearch);\r\n    };\r\n  }, []);\r\n\r\n  // Fetch rate chart data\r\n  const fetchRateChartData = async (fileName: string, channel: string, societyId: number) => {\r\n    try {\r\n      setLoadingChartData(true);\r\n      const token = localStorage.getItem('authToken');\r\n      if (!token) return;\r\n\r\n      const response = await fetch(`/api/user/ratechart/data?fileName=${encodeURIComponent(fileName)}&channel=${channel}&societyId=${societyId}`, {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`\r\n        }\r\n      });\r\n\r\n      const data = await response.json();\r\n      if (data.success) {\r\n        setRateChartData(data.data || []);\r\n      } else {\r\n        setError(typeof data.error === 'string' ? data.error : data.error?.message || t.ratechartManagement.failedToFetchData);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching rate chart data:', error);\r\n      setError(t.ratechartManagement.failedToFetchData);\r\n    } finally {\r\n      setLoadingChartData(false);\r\n    }\r\n  };\r\n\r\n  // Handle view rate chart\r\n  const handleViewRateChart = (fileName: string, channel: string, societyId: number) => {\r\n    setSelectedRateChart({ fileName, channel, societyId });\r\n    setShowRateChartModal(true);\r\n    fetchRateChartData(fileName, channel, societyId);\r\n  };\r\n\r\n  // Close rate chart modal\r\n  const closeRateChartModal = () => {\r\n    setShowRateChartModal(false);\r\n    setSelectedRateChart(null);\r\n    setRateChartData([]);\r\n    setSearchFat('');\r\n    setSearchSnf('');\r\n    setSearchClr('');\r\n  };\r\n\r\n  // Handle delete - open confirmation modal\r\n  const handleDelete = async (id: number) => {\r\n    setChartToDelete(id);\r\n    \r\n    // Find the group that contains this chart ID to get society information\r\n    const group = Object.values(groupedCharts).find(g => \r\n      g.chartRecordIds.includes(id) || g.chartId === id\r\n    );\r\n    \r\n    if (group && group.societies.length > 0) {\r\n      const societyIds = group.societies\r\n        .map(s => s.societyIdentifier || s.societyId.toString())\r\n        .join(', ');\r\n      setChartToDeleteSocieties(societyIds);\r\n    } else {\r\n      setChartToDeleteSocieties('');\r\n    }\r\n    \r\n    setShowSingleDeleteConfirm(true);\r\n  };\r\n\r\n  // Confirm single delete\r\n  const confirmSingleDelete = async () => {\r\n    if (!chartToDelete) return;\r\n\r\n    try {\r\n      const token = localStorage.getItem('authToken');\r\n      const response = await fetch(`/api/user/ratechart/${chartToDelete}`, {\r\n        method: 'DELETE',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`\r\n        }\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (data.success) {\r\n        setSuccess('Rate chart deleted successfully');\r\n        fetchRateCharts();\r\n        // Auto-hide success message after 5 seconds\r\n        setTimeout(() => {\r\n          setSuccess('');\r\n        }, 5000);\r\n      } else {\r\n        setError(data.message || 'Failed to delete rate chart');\r\n        // Auto-hide error message after 5 seconds\r\n        setTimeout(() => {\r\n          setError('');\r\n        }, 5000);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error deleting rate chart:', error);\r\n      setError('Error deleting rate chart');\r\n      // Auto-hide error message after 5 seconds\r\n      setTimeout(() => {\r\n        setError('');\r\n      }, 5000);\r\n    } finally {\r\n      setShowSingleDeleteConfirm(false);\r\n      setChartToDelete(null);\r\n      setChartToDeleteSocieties('');\r\n    }\r\n  };\r\n\r\n  // Upload success/error handlers\r\n  const handleUploadSuccess = (message: string) => {\r\n    setSuccess(message);\r\n    fetchRateCharts();\r\n    // Auto-hide success message after 5 seconds\r\n    setTimeout(() => {\r\n      setSuccess('');\r\n    }, 5000);\r\n  };\r\n\r\n  const handleUploadError = (message: string) => {\r\n    setError(message);\r\n    // Auto-hide error message after 5 seconds\r\n    setTimeout(() => {\r\n      setError('');\r\n    }, 5000);\r\n  };\r\n\r\n  // Toggle status (active/inactive)\r\n  const handleToggleStatus = async (chartId: number, currentStatus: number) => {\r\n    try {\r\n      const token = localStorage.getItem('authToken');\r\n      if (!token) return;\r\n\r\n      const newStatus = currentStatus === 1 ? 0 : 1;\r\n\r\n      // Find the group and get all chart record IDs (master + shared)\r\n      const group = Object.values(groupedCharts).find(g => g.chartId === chartId);\r\n      const chartIds = group?.chartRecordIds || [chartId];\r\n\r\n      const response = await fetch('/api/user/ratechart/status', {\r\n        method: 'PATCH',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({ chartIds, status: newStatus })\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (data.success) {\r\n        setSuccess(`${t.ratechartManagement.statusUpdatedSuccessfully} ${newStatus === 1 ? t.ratechartManagement.active.toLowerCase() : t.ratechartManagement.inactive.toLowerCase()}`);\r\n        fetchRateCharts();\r\n        // Auto-hide success message after 5 seconds\r\n        setTimeout(() => {\r\n          setSuccess('');\r\n        }, 5000);\r\n      } else {\r\n        setError(data.message || t.ratechartManagement.failedToUpdateStatus);\r\n        // Auto-hide error message after 5 seconds\r\n        setTimeout(() => {\r\n          setError('');\r\n        }, 5000);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error updating status:', error);\r\n      setError(t.ratechartManagement.errorUpdatingStatus);\r\n      // Auto-hide error message after 5 seconds\r\n      setTimeout(() => {\r\n        setError('');\r\n      }, 5000);\r\n    }\r\n  };\r\n\r\n  // Handle bulk status update\r\n  const handleBulkStatusUpdate = async (status: string) => {\r\n    try {\r\n      const token = localStorage.getItem('authToken');\r\n      if (!token) return;\r\n\r\n      const newStatus = status === 'active' ? 1 : 0;\r\n      \r\n      // Get all chart IDs from selected groups\r\n      const selectedGroups = Object.values(groupedCharts).filter(group => \r\n        group.chartRecordIds.some(id => selectedCharts.has(id))\r\n      );\r\n\r\n      const allChartIds = selectedGroups.flatMap(group => group.chartRecordIds);\r\n\r\n      const response = await fetch('/api/user/ratechart/status', {\r\n        method: 'PATCH',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({ chartIds: allChartIds, status: newStatus })\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (data.success) {\r\n        setSuccess(`✅ ${selectedGroups.length} ${t.ratechartManagement.bulkStatusUpdated} ${status === 'active' ? t.ratechartManagement.active.toLowerCase() : t.ratechartManagement.inactive.toLowerCase()}`);\r\n        setTimeout(() => setSuccess(''), 5000);\r\n        // Clear selection and refresh\r\n        setSelectedCharts(new Set());\r\n        setSelectAll(false);\r\n        await fetchRateCharts();\r\n      } else {\r\n        setError(data.message || t.ratechartManagement.failedToUpdateStatus);\r\n        setTimeout(() => setError(''), 5000);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error updating bulk status:', error);\r\n      setError(t.ratechartManagement.errorUpdatingStatus);\r\n      setTimeout(() => setError(''), 5000);\r\n    }\r\n  };\r\n\r\n  // Filter rate charts - DON'T apply society filter here, apply after grouping\r\n  const filteredRateCharts = rateCharts.filter(chart => {\r\n    // Handle channel filter including 'unique' option\r\n    if (channelFilter !== 'all') {\r\n      if (channelFilter === 'unique') {\r\n        // For unique filter, only show charts that are not shared\r\n        // This means: shared_chart_id is null AND no other charts reference this chart\r\n        const isShared = rateCharts.some(c => c.shared_chart_id === chart.id);\r\n        if (chart.shared_chart_id !== null || isShared) return false;\r\n      } else {\r\n        // For specific channel filters (COW, BUFFALO, MIXED)\r\n        // Convert database channel value to display format for comparison\r\n        const displayChannel = getChannelDisplay(chart.channel);\r\n        if (displayChannel !== channelFilter) return false;\r\n      }\r\n    }\r\n    \r\n    // Search functionality\r\n    if (searchQuery !== '') {\r\n      const query = searchQuery.toLowerCase();\r\n      const matchesSearch = \r\n        chart.societyName.toLowerCase().includes(query) ||\r\n        chart.societyIdentifier.toLowerCase().includes(query) ||\r\n        chart.channel.toLowerCase().includes(query) ||\r\n        chart.fileName.toLowerCase().includes(query) ||\r\n        chart.uploadedBy.toLowerCase().includes(query);\r\n      \r\n      if (!matchesSearch) return false;\r\n    }\r\n    \r\n    return true;\r\n  });\r\n\r\n  // Get only master charts (where shared_chart_id is null)\r\n  const masterCharts = filteredRateCharts.filter(chart => chart.shared_chart_id === null);\r\n  \r\n  // For each master chart, find all societies using it (including shared references)\r\n  const groupedCharts = masterCharts.reduce((acc, masterChart) => {\r\n    acc[masterChart.id] = {\r\n      chartId: masterChart.id,\r\n      fileName: masterChart.fileName,\r\n      channel: masterChart.channel,\r\n      uploadedBy: masterChart.uploadedBy,\r\n      createdAt: masterChart.uploadedAt,\r\n      recordCount: masterChart.recordCount,\r\n      status: masterChart.status,\r\n      societies: [],\r\n      chartRecordIds: [masterChart.id] // Start with master chart ID\r\n    };\r\n    \r\n    // Add the master chart's society with its chart record ID\r\n    acc[masterChart.id].societies.push({\r\n      societyId: masterChart.societyId,\r\n      societyName: masterChart.societyName,\r\n      societyIdentifier: masterChart.societyIdentifier,\r\n      chartRecordId: masterChart.id // Add the chart record ID for this society\r\n    });\r\n    \r\n    // Find all societies that share this chart\r\n    filteredRateCharts.forEach(chart => {\r\n      if (chart.shared_chart_id === masterChart.id) {\r\n        acc[masterChart.id].societies.push({\r\n          societyId: chart.societyId,\r\n          societyName: chart.societyName,\r\n          societyIdentifier: chart.societyIdentifier,\r\n          chartRecordId: chart.id // Add the chart record ID for this society\r\n        });\r\n        acc[masterChart.id].chartRecordIds.push(chart.id);\r\n      }\r\n    });\r\n    \r\n    return acc;\r\n  }, {} as Record<number, { \r\n    chartId: number; \r\n    fileName: string; \r\n    channel: string; \r\n    uploadedBy: string; \r\n    createdAt: string;\r\n    recordCount: number;\r\n    status: number;\r\n    societies: { societyId: number; societyName: string; societyIdentifier: string; chartRecordId: number }[];\r\n    chartRecordIds: number[];\r\n  }>);\r\n\r\n  // Apply dairy, BMC, society, and machine filters AFTER grouping\r\n  const societyFilteredGroupedCharts = Object.values(groupedCharts).filter(group => {\r\n    // Check each society in the group for filter matches\r\n    return group.societies.some(groupSociety => {\r\n      // Get society details\r\n      const society = societies.find(s => s.id === groupSociety.societyId);\r\n      if (!society) return false;\r\n\r\n      // Get BMC and dairy for this society\r\n      const societyBmc = society.bmc_id ? bmcs.find(b => b.id === society.bmc_id) : null;\r\n      const societyDairy = societyBmc?.dairyFarmId ? dairies.find(d => d.id === societyBmc.dairyFarmId) : null;\r\n\r\n      // Check dairy filter (now array-based)\r\n      const matchesDairy = dairyFilter.length === 0 || dairyFilter.includes(societyDairy?.id.toString() || '');\r\n      if (!matchesDairy) return false;\r\n\r\n      // Check BMC filter (now array-based)\r\n      const matchesBmc = bmcFilter.length === 0 || bmcFilter.includes(societyBmc?.id.toString() || '');\r\n      if (!matchesBmc) return false;\r\n\r\n      // Check society filter\r\n      const matchesSociety = societyFilter.length === 0 || societyFilter.includes(groupSociety.societyId.toString());\r\n      if (!matchesSociety) return false;\r\n\r\n      // Check machine filter\r\n      if (machineFilter.length > 0) {\r\n        const societyMachines = machines.filter(m => m.societyId === groupSociety.societyId);\r\n        const hasMachine = societyMachines.some(m => machineFilter.includes(m.id.toString()));\r\n        if (!hasMachine) return false;\r\n      }\r\n\r\n      return true;\r\n    });\r\n  });\r\n\r\n  // Selection handlers\r\n  const handleSelectAll = () => {\r\n    if (selectAll) {\r\n      setSelectedCharts(new Set());\r\n      setSelectAll(false);\r\n    } else {\r\n      setSelectedCharts(new Set(filteredRateCharts.map(c => c.id)));\r\n      setSelectAll(true);\r\n    }\r\n  };\r\n\r\n  // Clear selections when filters change\r\n  useEffect(() => {\r\n    if (selectedCharts.size > 0) {\r\n      const visibleChartIds = new Set(filteredRateCharts.map(c => c.id));\r\n      const updatedSelection = new Set(\r\n        Array.from(selectedCharts).filter(id => visibleChartIds.has(id))\r\n      );\r\n      \r\n      if (updatedSelection.size !== selectedCharts.size) {\r\n        setSelectedCharts(updatedSelection);\r\n        setSelectAll(false);\r\n      }\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [societyFilter, channelFilter, searchQuery, rateCharts]);\r\n\r\n  // Bulk delete handler\r\n  const handleBulkDelete = async () => {\r\n    if (selectedCharts.size === 0) return;\r\n\r\n    setShowDeleteConfirm(false);\r\n    setIsDeletingBulk(true);\r\n    setUploadProgress(0);\r\n\r\n    try {\r\n      const token = localStorage.getItem('authToken');\r\n      setUploadProgress(10);\r\n\r\n      const ids = Array.from(selectedCharts);\r\n      const deletePromises = ids.map(id =>\r\n        fetch(`/api/user/ratechart/${id}`, {\r\n          method: 'DELETE',\r\n          headers: { Authorization: `Bearer ${token}` }\r\n        })\r\n      );\r\n\r\n      setUploadProgress(30);\r\n      await Promise.all(deletePromises);\r\n      setUploadProgress(70);\r\n\r\n      await fetchRateCharts();\r\n      setUploadProgress(95);\r\n\r\n      setSelectedCharts(new Set());\r\n      setSelectAll(false);\r\n      setSuccess(`Successfully deleted ${ids.length} rate chart(s)`);\r\n      setError('');\r\n      \r\n      setUploadProgress(100);\r\n      setTimeout(() => {\r\n        setSuccess('');\r\n      }, 5000);\r\n    } catch (error) {\r\n      console.error('Error deleting rate charts:', error);\r\n      setError('Error deleting selected rate charts');\r\n      setTimeout(() => {\r\n        setError('');\r\n      }, 5000);\r\n    } finally {\r\n      setIsDeletingBulk(false);\r\n      setUploadProgress(0);\r\n    }\r\n  };\r\n\r\n  // Handle opening assign modal\r\n  const handleOpenAssignModal = (chartId: number, fileName: string, societies: Array<{ societyId: number; societyName: string; societyIdentifier: string }>) => {\r\n    setSelectedChartForAssign({ chartId, fileName, societies });\r\n    setShowAssignModal(true);\r\n  };\r\n\r\n  // Handle assigning chart to additional societies\r\n  const handleAssignSocieties = async (societyIds: number[], replaceExisting: boolean) => {\r\n    if (!selectedChartForAssign) return;\r\n\r\n    try {\r\n      const token = localStorage.getItem('authToken');\r\n      if (!token) return;\r\n\r\n      const response = await fetch('/api/user/ratechart/assign', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({\r\n          masterChartId: selectedChartForAssign.chartId,\r\n          societyIds,\r\n          replaceExisting\r\n        })\r\n      });\r\n\r\n      const data = await response.json();\r\n      \r\n      // Handle conflict scenario (409 status)\r\n      if (response.status === 409 && data.requiresConfirmation) {\r\n        return {\r\n          requiresConfirmation: true,\r\n          conflicts: data.conflicts\r\n        };\r\n      }\r\n      \r\n      if (data.success) {\r\n        setSuccess(`Successfully assigned chart to ${data.data.assignedCount} ${data.data.assignedCount === 1 ? 'society' : 'societies'}`);\r\n        setTimeout(() => setSuccess(''), 5000);\r\n        \r\n        // Refresh rate charts to show updated assignments\r\n        await fetchRateCharts();\r\n        \r\n        setShowAssignModal(false);\r\n        setSelectedChartForAssign(null);\r\n        return;\r\n      } else {\r\n        setError(data.message || 'Failed to assign chart to societies');\r\n        setTimeout(() => setError(''), 5000);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error assigning chart to societies:', error);\r\n      setError('Error assigning chart to societies');\r\n      setTimeout(() => setError(''), 5000);\r\n    }\r\n  };\r\n\r\n  // Handle opening reset download modal\r\n  const handleOpenResetDownloadModal = (chartId: number, fileName: string, channel: string, societies: Array<{ societyId: number; societyName: string; societyIdentifier: string }>, chartRecordIds: number[]) => {\r\n    setSelectedChartForReset({\r\n      chartId,\r\n      fileName,\r\n      channel,\r\n      societies: societies.map(s => ({ societyId: s.societyId, societyName: s.societyName })),\r\n      chartRecordIds\r\n    });\r\n    setShowResetDownloadModal(true);\r\n  };\r\n\r\n  // Handle resetting download history\r\n  const handleResetDownload = async (machineIds: number[]) => {\r\n    if (!selectedChartForReset) return;\r\n\r\n    try {\r\n      const token = localStorage.getItem('authToken');\r\n      if (!token) return;\r\n\r\n      const response = await fetch('/api/user/ratechart/reset-download', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({\r\n          chartIds: selectedChartForReset.chartRecordIds || [selectedChartForReset.chartId],\r\n          machineIds,\r\n          channel: selectedChartForReset.channel\r\n        })\r\n      });\r\n\r\n      const data = await response.json();\r\n      \r\n      if (data.success) {\r\n        const machineCount = machineIds.length;\r\n        const chartName = selectedChartForReset.fileName;\r\n        const channel = selectedChartForReset.channel;\r\n        setSuccess(`✅ Successfully reset ${channel} channel download status for ${machineCount} machine${machineCount > 1 ? 's' : ''}. Chart \"${chartName}\" can now be re-downloaded by selected machines.`);\r\n        setTimeout(() => setSuccess(''), 6000);\r\n        setShowResetDownloadModal(false);\r\n        setSelectedChartForReset(null);\r\n      } else {\r\n        setError(data.message || 'Failed to reset download history');\r\n        setTimeout(() => setError(''), 5000);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error resetting download history:', error);\r\n      setError('❌ Error resetting download history. Please try again.');\r\n      setTimeout(() => setError(''), 5000);\r\n    }\r\n  };\r\n\r\n  // Handle removing society from rate chart\r\n  const handleRemoveSociety = async (chartRecordId: number, societyId: number, societyName: string) => {\r\n    try {\r\n      const token = localStorage.getItem('authToken');\r\n      if (!token) return;\r\n\r\n      const response = await fetch('/api/user/ratechart/remove-society', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({ chartId: chartRecordId, societyId })\r\n      });\r\n\r\n      const data = await response.json();\r\n      \r\n      if (data.success) {\r\n        setSuccess(`✅ Successfully removed ${societyName} from rate chart`);\r\n        setTimeout(() => setSuccess(''), 5000);\r\n        // Force a fresh fetch to update the UI\r\n        setRateCharts([]);\r\n        await fetchRateCharts();\r\n      } else {\r\n        setError(data.message || 'Failed to remove society');\r\n        setTimeout(() => setError(''), 5000);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error removing society:', error);\r\n      setError('❌ Error removing society. Please try again.');\r\n      setTimeout(() => setError(''), 5000);\r\n    }\r\n  };\r\n\r\n  // Calculate stats - only count unique master charts\r\n  const allMasterCharts = rateCharts.filter(chart => chart.shared_chart_id === null);\r\n  // Count unique charts (master charts that are NOT being shared by others)\r\n  const uniqueCharts = allMasterCharts.filter(chart => {\r\n    const isShared = rateCharts.some(c => c.shared_chart_id === chart.id);\r\n    return !isShared;\r\n  }).length;\r\n  // Count only valid assignments (those with a master chart or valid shared reference)\r\n  const totalAssignments = rateCharts.length;\r\n  const cowCharts = allMasterCharts.filter(c => c.channel === 'COW').length;\r\n  const bufCharts = allMasterCharts.filter(c => c.channel === 'BUF').length;\r\n  const mixCharts = allMasterCharts.filter(c => c.channel === 'MIX').length;\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen\">\r\n        <FlowerSpinner size={48} isLoading={true} />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n    {/* Loading Snackbar */}\r\n    <LoadingSnackbar\r\n      isVisible={isUploading || isDeletingBulk}\r\n      message={isDeletingBulk ? t.ratechartManagement.deletingRateCharts : t.ratechartManagement.uploadingRateChart}\r\n      submessage={isDeletingBulk ? t.ratechartManagement.pleaseWaitDeleting : t.ratechartManagement.pleaseWaitUploading}\r\n      progress={uploadProgress}\r\n      showProgress={true}\r\n    />\r\n\r\n    <div className=\"p-4 sm:p-6 lg:p-8 space-y-4 sm:space-y-6 lg:pb-8\">\r\n      {/* Page Header */}\r\n      <ManagementPageHeader\r\n        title={t.ratechartManagement.title}\r\n        subtitle={t.ratechartManagement.subtitle}\r\n        icon={<Receipt className=\"w-5 h-5 sm:w-6 sm:h-6\" />}\r\n        onRefresh={fetchRateCharts}\r\n      />\r\n\r\n      {/* Success/Error Messages */}\r\n      <StatusMessage \r\n        success={success} \r\n        error={error}\r\n        onClose={() => {\r\n          setSuccess('');\r\n          setError('');\r\n        }}\r\n      />\r\n\r\n      {/* Stats Cards */}\r\n      <div className=\"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-2 sm:gap-3\">\r\n        <StatsCard\r\n          title={t.ratechartManagement.uniqueCharts}\r\n          value={uniqueCharts}\r\n          icon={<Receipt className=\"w-4 h-4\" />}\r\n          color=\"blue\"\r\n          onClick={() => setChannelFilter('unique')}\r\n          clickable={true}\r\n          isActive={channelFilter === 'unique'}\r\n        />\r\n        <StatsCard\r\n          title={t.ratechartManagement.totalAssignments}\r\n          value={totalAssignments}\r\n          icon={<Receipt className=\"w-4 h-4\" />}\r\n          color=\"gray\"\r\n          onClick={() => {\r\n            setChannelFilter('all');\r\n            setShowAssignmentsModal(true);\r\n          }}\r\n          clickable={true}\r\n          isActive={channelFilter === 'all'}\r\n        />\r\n        <StatsCard\r\n          title={t.ratechartManagement.cowCharts}\r\n          value={cowCharts}\r\n          icon={<Receipt className=\"w-4 h-4\" />}\r\n          color=\"green\"\r\n          onClick={() => setChannelFilter('COW')}\r\n          clickable={true}\r\n          isActive={channelFilter === 'COW'}\r\n        />\r\n        <StatsCard\r\n          title={t.ratechartManagement.buffaloCharts}\r\n          value={bufCharts}\r\n          icon={<Receipt className=\"w-4 h-4\" />}\r\n          color=\"blue\"\r\n          onClick={() => setChannelFilter('BUFFALO')}\r\n          clickable={true}\r\n          isActive={channelFilter === 'BUFFALO'}\r\n        />\r\n        <StatsCard\r\n          title={t.ratechartManagement.mixedCharts}\r\n          value={mixCharts}\r\n          icon={<Receipt className=\"w-4 h-4\" />}\r\n          color=\"yellow\"\r\n          onClick={() => setChannelFilter('MIXED')}\r\n          clickable={true}\r\n          isActive={channelFilter === 'MIXED'}\r\n        />\r\n      </div>\r\n\r\n      {/* Filter Controls */}\r\n      <FilterDropdown\r\n        statusFilter={'all'}\r\n        onStatusChange={() => {}}\r\n        dairyFilter={dairyFilter}\r\n        onDairyChange={(value) => setDairyFilter(Array.isArray(value) ? value : [value])}\r\n        bmcFilter={bmcFilter}\r\n        onBmcChange={(value) => setBmcFilter(Array.isArray(value) ? value : [value])}\r\n        societyFilter={societyFilter}\r\n        onSocietyChange={(value) => setSocietyFilter(Array.isArray(value) ? value : [value])}\r\n        machineFilter={machineFilter}\r\n        onMachineChange={(value) => setMachineFilter(Array.isArray(value) ? value : [value])}\r\n        channelFilter={channelFilter}\r\n        onChannelChange={setChannelFilter}\r\n        dairies={dairies}\r\n        bmcs={bmcs}\r\n        societies={societies}\r\n        machines={machines}\r\n        filteredCount={societyFilteredGroupedCharts.length}\r\n        totalCount={rateCharts.length}\r\n        searchQuery={searchQuery}\r\n        onSearchChange={setSearchQuery}\r\n        icon={<Receipt className=\"w-5 h-5\" />}\r\n        showChannelFilter={true}\r\n        hideMainFilterButton={true}\r\n      />\r\n\r\n      {/* Bulk Actions Toolbar */}\r\n      {selectedCharts.size > 0 && (\r\n        <BulkActionsToolbar\r\n          selectedCount={(() => {\r\n            const selectedGroupCount = societyFilteredGroupedCharts.filter(group => \r\n              group.chartRecordIds.some(id => selectedCharts.has(id))\r\n            ).length;\r\n            return selectedGroupCount;\r\n          })()}\r\n          totalCount={societyFilteredGroupedCharts.length}\r\n          onBulkDelete={() => setShowDeleteConfirm(true)}\r\n          onClearSelection={() => {\r\n            setSelectedCharts(new Set());\r\n            setSelectAll(false);\r\n          }}\r\n          itemType=\"rate chart\"\r\n          showStatusUpdate={true}\r\n          currentBulkStatus={bulkStatus}\r\n          onBulkStatusChange={(status) => {\r\n            setBulkStatus(status);\r\n            handleBulkStatusUpdate(status);\r\n          }}\r\n          statusOptions={[\r\n            { status: 'active', label: t.ratechartManagement.active, color: 'bg-green-500', bgColor: 'hover:bg-green-50 dark:hover:bg-green-900/30' },\r\n            { status: 'inactive', label: t.ratechartManagement.inactive, color: 'bg-red-500', bgColor: 'hover:bg-red-50 dark:hover:bg-red-900/30' }\r\n          ]}\r\n        />\r\n      )}\r\n\r\n      {/* Rate Charts Display */}\r\n      <div className=\"space-y-6\">\r\n        {societyFilteredGroupedCharts.length === 0 ? (\r\n          <EmptyState\r\n            icon={<Receipt className=\"w-12 h-12\" />}\r\n            title={t.ratechartManagement.noRateChartsFound}\r\n            message={t.ratechartManagement.uploadFirstChart}\r\n            actionText={t.ratechartManagement.uploadRateChart}\r\n            onAction={() => setShowUploadModal(true)}\r\n            showAction={true}\r\n          />\r\n        ) : (\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-4\">\r\n            {societyFilteredGroupedCharts.map(group => {\r\n              // Check if all chart records in this group are selected\r\n              const isGroupSelected = group.chartRecordIds.every(id => selectedCharts.has(id));\r\n              \r\n              return (\r\n                <RateChartMinimalCard\r\n                  key={group.chartId}\r\n                  chartId={group.chartId}\r\n                  fileName={group.fileName}\r\n                  channel={group.channel}\r\n                  uploadedBy={group.uploadedBy}\r\n                  createdAt={group.createdAt}\r\n                  societies={group.societies}\r\n                  status={group.status}\r\n                  isSelected={isGroupSelected}\r\n                  searchQuery={searchQuery}\r\n                  onToggleSelection={() => {\r\n                    // Toggle all chart records for this group\r\n                    if (isGroupSelected) {\r\n                      // Deselect all\r\n                      group.chartRecordIds.forEach(id => {\r\n                        setSelectedCharts(prev => {\r\n                          const newSet = new Set(prev);\r\n                          newSet.delete(id);\r\n                          return newSet;\r\n                        });\r\n                      });\r\n                    } else {\r\n                      // Select all\r\n                      group.chartRecordIds.forEach(id => {\r\n                        setSelectedCharts(prev => new Set(prev).add(id));\r\n                      });\r\n                    }\r\n                  }}\r\n                  onAssignSociety={() => handleOpenAssignModal(group.chartId, group.fileName, group.societies)}\r\n                  onDelete={() => handleDelete(group.chartRecordIds[0])}\r\n                  onToggleStatus={handleToggleStatus}\r\n                  onView={() => handleViewRateChart(group.fileName, group.channel, group.societies[0]?.societyId || 0)}\r\n                  onResetDownload={() => handleOpenResetDownloadModal(group.chartId, group.fileName, group.channel, group.societies, group.chartRecordIds)}\r\n                  onRemoveSociety={handleRemoveSociety}\r\n                />\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n\r\n    {/* Upload Modal - Positioned outside main container */}\r\n    <RateChartUploadModal\r\n      isOpen={showUploadModal}\r\n      onClose={() => setShowUploadModal(false)}\r\n      societies={societies}\r\n      onUploadSuccess={handleUploadSuccess}\r\n      onUploadError={handleUploadError}\r\n      onUploadStart={() => setIsUploading(true)}\r\n      onUploadEnd={() => setIsUploading(false)}\r\n      onProgressUpdate={(progress) => setUploadProgress(progress)}\r\n    />\r\n\r\n    {/* Bulk Delete Confirmation Modal */}\r\n    <BulkDeleteConfirmModal\r\n      isOpen={showDeleteConfirm}\r\n      onClose={() => setShowDeleteConfirm(false)}\r\n      onConfirm={handleBulkDelete}\r\n      itemCount={(() => {\r\n        const selectedGroupCount = Object.values(groupedCharts).filter(group => \r\n          group.chartRecordIds.some(id => selectedCharts.has(id))\r\n        ).length;\r\n        return selectedGroupCount;\r\n      })()}\r\n      itemType=\"rate chart\"\r\n      hasFilters={societyFilter.length > 0 || channelFilter !== 'all' || searchQuery !== ''}\r\n      additionalInfo={(() => {\r\n        // Get all selected groups\r\n        const selectedGroups = Object.values(groupedCharts).filter(group => \r\n          group.chartRecordIds.some(id => selectedCharts.has(id))\r\n        );\r\n        \r\n        if (selectedGroups.length === 0) return undefined;\r\n        \r\n        // Build society info for each selected chart\r\n        const chartInfo = selectedGroups.map(group => {\r\n          const societyIds = group.societies\r\n            .map(s => s.societyIdentifier || s.societyId.toString())\r\n            .join(', ');\r\n          return `${group.fileName} (${group.channel}): ${societyIds}`;\r\n        });\r\n        \r\n        return chartInfo.join(' | ');\r\n      })()}\r\n    />\r\n\r\n    {/* Assign Society Modal */}\r\n    {selectedChartForAssign && (\r\n      <AssignSocietyModal\r\n        isOpen={showAssignModal}\r\n        onClose={() => {\r\n          setShowAssignModal(false);\r\n          setSelectedChartForAssign(null);\r\n        }}\r\n        onAssign={handleAssignSocieties}\r\n        chartId={selectedChartForAssign.chartId}\r\n        fileName={selectedChartForAssign.fileName}\r\n        currentSocieties={selectedChartForAssign.societies}\r\n        allSocieties={societies}\r\n      />\r\n    )}\r\n\r\n    {/* Total Assignments Modal */}\r\n    <TotalAssignmentsModal\r\n      isOpen={showAssignmentsModal}\r\n      onClose={() => setShowAssignmentsModal(false)}\r\n      rateCharts={rateCharts}\r\n    />\r\n\r\n    {/* Single Delete Confirmation Modal */}\r\n    <BulkDeleteConfirmModal\r\n      isOpen={showSingleDeleteConfirm}\r\n      onClose={() => {\r\n        setShowSingleDeleteConfirm(false);\r\n        setChartToDelete(null);\r\n        setChartToDeleteSocieties('');\r\n      }}\r\n      onConfirm={confirmSingleDelete}\r\n      itemCount={1}\r\n      itemType=\"rate chart\"\r\n      additionalInfo={chartToDeleteSocieties ? `Assigned to society IDs: ${chartToDeleteSocieties}` : undefined}\r\n    />\r\n\r\n    {/* Rate Chart View Modal */}\r\n    {showRateChartModal && selectedRateChart && (\r\n      <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\r\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden\">\r\n          <div className=\"p-6\">\r\n            {/* Modal Header */}\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <h2 className=\"text-xl font-semibold text-gray-900 dark:text-white\">\r\n                Rate Chart - {selectedRateChart.channel} Channel\r\n              </h2>\r\n              <button\r\n                onClick={closeRateChartModal}\r\n                className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\r\n              >\r\n                <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n                </svg>\r\n              </button>\r\n            </div>\r\n\r\n            {/* Chart Info */}\r\n            <div className=\"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg mb-4\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <h3 className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">File Name</h3>\r\n                  <p className=\"text-base font-semibold text-gray-900 dark:text-white\">{selectedRateChart.fileName}</p>\r\n                </div>\r\n                <span className=\"px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200\">\r\n                  {selectedRateChart.channel}\r\n                </span>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Search Inputs */}\r\n            <div className=\"grid grid-cols-3 gap-3 mb-4\">\r\n              <div>\r\n                <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">Search FAT</label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={searchFat}\r\n                  onChange={(e) => setSearchFat(e.target.value)}\r\n                  placeholder=\"e.g., 3.5\"\r\n                  className=\"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">Search SNF</label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={searchSnf}\r\n                  onChange={(e) => setSearchSnf(e.target.value)}\r\n                  placeholder=\"e.g., 8.5\"\r\n                  className=\"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">Search CLR</label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={searchClr}\r\n                  onChange={(e) => setSearchClr(e.target.value)}\r\n                  placeholder=\"e.g., 25.0\"\r\n                  className=\"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Chart Data Table */}\r\n            <div className=\"overflow-auto max-h-[60vh]\">\r\n              {loadingChartData ? (\r\n                <div className=\"flex justify-center items-center py-8\">\r\n                  <FlowerSpinner />\r\n                </div>\r\n              ) : (() => {\r\n                // Filter data based on search inputs\r\n                const filteredData = rateChartData.filter(row => {\r\n                  const matchFat = !searchFat || row.fat.toLowerCase().includes(searchFat.toLowerCase());\r\n                  const matchSnf = !searchSnf || row.snf.toLowerCase().includes(searchSnf.toLowerCase());\r\n                  const matchClr = !searchClr || row.clr.toLowerCase().includes(searchClr.toLowerCase());\r\n                  return matchFat && matchSnf && matchClr;\r\n                });\r\n                \r\n                return filteredData.length > 0 ? (\r\n                <div>\r\n                  <table className=\"w-full border-collapse\">\r\n                    <thead className=\"sticky top-0 bg-gray-100 dark:bg-gray-700\">\r\n                      <tr>\r\n                        <th className=\"px-4 py-3 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider border border-gray-300 dark:border-gray-600\">\r\n                          FAT\r\n                        </th>\r\n                        <th className=\"px-4 py-3 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider border border-gray-300 dark:border-gray-600\">\r\n                          SNF\r\n                        </th>\r\n                        <th className=\"px-4 py-3 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider border border-gray-300 dark:border-gray-600\">\r\n                          CLR\r\n                        </th>\r\n                        <th className=\"px-4 py-3 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider border border-gray-300 dark:border-gray-600\">\r\n                          Rate\r\n                        </th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\r\n                      {filteredData.map((row, index) => (\r\n                        <tr key={index} className=\"hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors\">\r\n                          <td className=\"px-4 py-3 text-sm text-gray-900 dark:text-gray-100 border border-gray-300 dark:border-gray-600\">\r\n                            {row.fat}\r\n                          </td>\r\n                          <td className=\"px-4 py-3 text-sm text-gray-900 dark:text-gray-100 border border-gray-300 dark:border-gray-600\">\r\n                            {row.snf}\r\n                          </td>\r\n                          <td className=\"px-4 py-3 text-sm text-gray-900 dark:text-gray-100 border border-gray-300 dark:border-gray-600\">\r\n                            {row.clr}\r\n                          </td>\r\n                          <td className=\"px-4 py-3 text-sm font-semibold text-gray-900 dark:text-gray-100 border border-gray-300 dark:border-gray-600\">\r\n                            ₹{row.rate}\r\n                          </td>\r\n                        </tr>\r\n                      ))}\r\n                    </tbody>\r\n                  </table>\r\n                  <div className=\"mt-2 text-xs text-gray-500 dark:text-gray-400 text-right\">\r\n                    Showing {filteredData.length} of {rateChartData.length} records\r\n                  </div>\r\n                </div>\r\n              ) : (\r\n                <div className=\"text-center py-8\">\r\n                  <FileText className=\"w-12 h-12 text-gray-400 mx-auto mb-3\" />\r\n                  <p className=\"text-gray-500 dark:text-gray-400\">{searchFat || searchSnf || searchClr ? 'No matching records found' : 'No data available for this rate chart'}</p>\r\n                </div>\r\n              );\r\n              })()}\r\n            </div>\r\n\r\n            {/* Close Button */}\r\n            <div className=\"flex justify-end pt-4 border-t border-gray-200 dark:border-gray-700 mt-4\">\r\n              <button\r\n                onClick={closeRateChartModal}\r\n                className=\"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors\"\r\n              >\r\n                Close\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )}\r\n\r\n    {/* Reset Download Modal */}\r\n    {selectedChartForReset && (\r\n      <ResetDownloadModal\r\n        show={showResetDownloadModal}\r\n        onClose={() => {\r\n          setShowResetDownloadModal(false);\r\n          setSelectedChartForReset(null);\r\n        }}\r\n        onConfirm={handleResetDownload}\r\n        chartId={selectedChartForReset.chartId}\r\n        fileName={selectedChartForReset.fileName}\r\n        channel={selectedChartForReset.channel}\r\n        societies={selectedChartForReset.societies}\r\n      />\r\n    )}\r\n\r\n    {/* Floating Action Button */}\r\n    <FloatingActionButton\r\n      actions={[\r\n        {\r\n          icon: <Upload className=\"w-6 h-6 text-white\" />,\r\n          label: t.ratechartManagement.uploadRateChart,\r\n          onClick: () => setShowUploadModal(true),\r\n          color: 'bg-gradient-to-br from-green-500 to-green-600'\r\n        }\r\n      ]}\r\n      directClick={true}\r\n    />\r\n  </>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}