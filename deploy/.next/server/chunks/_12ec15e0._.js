module.exports=[960597,e=>{"use strict";var t,a=e.i(747909),r=e.i(174017),s=e.i(996250),n=e.i(759756),i=e.i(561916),o=e.i(114444),l=e.i(837092),d=e.i(869741),u=e.i(316795),c=e.i(487718),p=e.i(995169),R=e.i(47587),h=e.i(666012),m=e.i(570101),f=e.i(626937),E=e.i(10372),v=e.i(193695);e.i(52474);var _=e.i(600220),N=e.i(89171),A=e.i(79832),y=e.i(84168),C=((t={}).SUPER_ADMIN="super_admin",t.ADMIN="admin",t.DAIRY="dairy",t.BMC="bmc",t.SOCIETY="society",t.FARMER="farmer",t);async function w(t){try{let a=t.headers.get("authorization")?.replace("Bearer ","");if(!a)return N.NextResponse.json({error:"Authentication required"},{status:401});let r=(0,A.verifyToken)(a);if(!r)return N.NextResponse.json({error:"Invalid token"},{status:401});if(r.role!==C.ADMIN&&r.role!==C.SUPER_ADMIN)return N.NextResponse.json({error:"Forbidden: Insufficient permissions"},{status:403});await (0,y.connectDB)();let{getModels:s}=await e.A(121985),{sequelize:n,User:i}=s(),o=await i.findByPk(r.id);if(!o||!o.dbKey)return N.NextResponse.json({error:"Admin schema not found"},{status:404});let l=o.fullName.replace(/[^a-zA-Z0-9]/g,"").toLowerCase(),d=`${l}_${o.dbKey.toLowerCase()}`,[u]=await n.query(`
      SELECT 
        sp.id as sectionPulseId,
        sp.society_id as societyId,
        s.name as societyName,
        s.society_id as societyCode,
        s.bmc_id as bmcId,
        b.name as bmcName,
        b.dairy_farm_id as dairyFarmId,
        df.name as dairyName,
        DATE_FORMAT(sp.pulse_date, '%Y-%m-%d') as pulseDate,
        DATE_FORMAT(sp.last_collection_time, '%Y-%m-%d %H:%i:%s') as pausedSince,
        DATE_FORMAT(sp.last_checked, '%Y-%m-%d %H:%i:%s') as lastChecked,
        sp.inactive_days as inactiveDays,
        sp.total_collections as totalCollections
      FROM \`${d}\`.\`section_pulse\` sp
      INNER JOIN \`${d}\`.\`societies\` s ON sp.society_id = s.id
      INNER JOIN \`${d}\`.\`bmcs\` b ON s.bmc_id = b.id
      INNER JOIN \`${d}\`.\`dairy_farms\` df ON b.dairy_farm_id = df.id
      WHERE sp.pulse_status = 'paused'
        AND sp.pulse_date >= CURDATE() - INTERVAL 7 DAY
      ORDER BY sp.last_checked DESC
      LIMIT 50
    `);return N.NextResponse.json({success:!0,data:u,count:u.length})}catch(e){return console.error("Error fetching paused sections:",e),N.NextResponse.json({error:"Failed to fetch notifications",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}e.s(["GET",()=>w],830551);var g=e.i(830551);let x=new a.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/admin/notifications/paused-sections/route",pathname:"/api/admin/notifications/paused-sections",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/admin/notifications/paused-sections/route.ts",nextConfigOutput:"",userland:g}),{workAsyncStorage:T,workUnitAsyncStorage:I,serverHooks:b}=x;function O(){return(0,s.patchFetch)({workAsyncStorage:T,workUnitAsyncStorage:I})}async function D(e,t,a){x.isDev&&(0,n.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let s="/api/admin/notifications/paused-sections/route";s=s.replace(/\/index$/,"")||"/";let N=await x.prepare(e,t,{srcPage:s,multiZoneDraftMode:!1});if(!N)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:A,params:y,nextConfig:C,parsedUrl:w,isDraftMode:g,prerenderManifest:T,routerServerContext:I,isOnDemandRevalidate:b,revalidateOnlyGenerated:O,resolvedPathname:D,clientReferenceManifest:P,serverActionsManifest:M}=N,S=(0,d.normalizeAppPath)(s),k=!!(T.dynamicRoutes[S]||T.routes[D]),H=async()=>((null==I?void 0:I.render404)?await I.render404(e,t,w,!1):t.end("This page could not be found"),null);if(k&&!g){let e=!!T.routes[D],t=T.dynamicRoutes[S];if(t&&!1===t.fallback&&!e){if(C.experimental.adapterPath)return await H();throw new v.NoFallbackError}}let U=null;!k||x.isDev||g||(U="/index"===(U=D)?"/":U);let q=!0===x.isDev||!k,F=k&&!q;M&&P&&(0,o.setReferenceManifestsSingleton)({page:s,clientReferenceManifest:P,serverActionsManifest:M,serverModuleMap:(0,l.createServerModuleMap)({serverActionsManifest:M})});let j=e.method||"GET",$=(0,i.getTracer)(),B=$.getActiveScopeSpan(),K={params:y,prerenderManifest:T,renderOpts:{experimental:{authInterrupts:!!C.experimental.authInterrupts},cacheComponents:!!C.cacheComponents,supportsDynamicResponse:q,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:C.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,a,r)=>x.onRequestError(e,t,r,I)},sharedContext:{buildId:A}},L=new u.NodeNextRequest(e),Y=new u.NodeNextResponse(t),G=c.NextRequestAdapter.fromNodeNextRequest(L,(0,c.signalFromNodeResponse)(t));try{let o=async e=>x.handle(G,K).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let a=$.getRootSpanAttributes();if(!a)return;if(a.get("next.span_type")!==p.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${a.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let r=a.get("next.route");if(r){let t=`${j} ${r}`;e.setAttributes({"next.route":r,"http.route":r,"next.span_name":t}),e.updateName(t)}else e.updateName(`${j} ${s}`)}),l=!!(0,n.getRequestMeta)(e,"minimalMode"),d=async n=>{var i,d;let u=async({previousCacheEntry:r})=>{try{if(!l&&b&&O&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let s=await o(n);e.fetchMetrics=K.renderOpts.fetchMetrics;let i=K.renderOpts.pendingWaitUntil;i&&a.waitUntil&&(a.waitUntil(i),i=void 0);let d=K.renderOpts.collectedTags;if(!k)return await (0,h.sendResponse)(L,Y,s,K.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(s.headers);d&&(t[E.NEXT_CACHE_TAGS_HEADER]=d),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let a=void 0!==K.renderOpts.collectedRevalidate&&!(K.renderOpts.collectedRevalidate>=E.INFINITE_CACHE)&&K.renderOpts.collectedRevalidate,r=void 0===K.renderOpts.collectedExpire||K.renderOpts.collectedExpire>=E.INFINITE_CACHE?void 0:K.renderOpts.collectedExpire;return{value:{kind:_.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:a,expire:r}}}}catch(t){throw(null==r?void 0:r.isStale)&&await x.onRequestError(e,t,{routerKind:"App Router",routePath:s,routeType:"route",revalidateReason:(0,R.getRevalidateReason)({isStaticGeneration:F,isOnDemandRevalidate:b})},I),t}},c=await x.handleResponse({req:e,nextConfig:C,cacheKey:U,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:T,isRoutePPREnabled:!1,isOnDemandRevalidate:b,revalidateOnlyGenerated:O,responseGenerator:u,waitUntil:a.waitUntil,isMinimalMode:l});if(!k)return null;if((null==c||null==(i=c.value)?void 0:i.kind)!==_.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(d=c.value)?void 0:d.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});l||t.setHeader("x-nextjs-cache",b?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),g&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let p=(0,m.fromNodeOutgoingHttpHeaders)(c.value.headers);return l&&k||p.delete(E.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||p.get("Cache-Control")||p.set("Cache-Control",(0,f.getCacheControlHeader)(c.cacheControl)),await (0,h.sendResponse)(L,Y,new Response(c.value.body,{headers:p,status:c.value.status||200})),null};B?await d(B):await $.withPropagatedContext(e.headers,()=>$.trace(p.BaseServerSpan.handleRequest,{spanName:`${j} ${s}`,kind:i.SpanKind.SERVER,attributes:{"http.method":j,"http.target":e.url}},d))}catch(t){if(t instanceof v.NoFallbackError||await x.onRequestError(e,t,{routerKind:"App Router",routePath:S,routeType:"route",revalidateReason:(0,R.getRevalidateReason)({isStaticGeneration:F,isOnDemandRevalidate:b})}),k)throw t;return await (0,h.sendResponse)(L,Y,new Response(null,{status:500})),null}}e.s(["handler",()=>D,"patchFetch",()=>O,"routeModule",()=>x,"serverHooks",()=>b,"workAsyncStorage",()=>T,"workUnitAsyncStorage",()=>I],960597)},453753,e=>{e.v(t=>Promise.all(["server/chunks/[root-of-the-server]__86f7d54e._.js"].map(t=>e.l(t))).then(()=>t(736987)))},121985,e=>{e.v(t=>Promise.all(["server/chunks/src_models_index_ts_328304ec._.js"].map(t=>e.l(t))).then(()=>t(540590)))}];

//# sourceMappingURL=_12ec15e0._.js.map