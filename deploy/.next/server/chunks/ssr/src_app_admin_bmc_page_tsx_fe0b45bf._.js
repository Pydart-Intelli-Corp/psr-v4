module.exports=[589308,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(346158),e=a.i(50944),f=a.i(835475),g=a.i(550194),h=a.i(457431),i=a.i(677924),j=a.i(758042),k=a.i(994222),l=a.i(54419),m=a.i(659854),n=a.i(48662),o=a.i(439760),p=a.i(124987),q=a.i(963519),r=a.i(546842),s=a.i(941675),t=a.i(267900),u=a.i(313949),v=a.i(114548),w=a.i(468976),x=a.i(781560),y=a.i(660246),z=a.i(724669),A=a.i(93518),B=a.i(923821),C=a.i(177156),D=a.i(141379),E=a.i(915618),F=a.i(839761),G=a.i(633508);a.i(16707);var H=a.i(529784),I=a.i(883733),J=a.i(981189),K=a.i(651963),L=a.i(851068),M=a.i(796182),N=a.i(110724),O=a.i(199313),P=a.i(195279),Q=a.i(333436),R=a.i(960020),S=a.i(688902),T=a.i(559314),U=a.i(551551),V=a.i(841846),W=a.i(992477);let X={name:"",bmcId:"",password:"",dairyFarmId:"",location:"",contactPerson:"",phone:"",email:"",capacity:"",status:"active",monthlyTarget:""},Y=(a,c)=>{if(!a&&0!==a)return a||"";if(!c)return a;let d=a.toString(),e=RegExp(`(${c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return d.split(e).map((a,c)=>e.test(a)?(0,b.jsx)("span",{className:"bg-yellow-200 dark:bg-yellow-800 px-0.5 rounded",children:a},c):a)};function Z(){let a,Z,$=(0,e.useRouter)(),_=(0,e.useSearchParams)(),{user:aa}=(0,f.useUser)(),{t:ab}=(0,g.useLanguage)(),[ac,ad]=(0,c.useState)([]),[ae,af]=(0,c.useState)([]),[ag,ah]=(0,c.useState)(!0),[ai,aj]=(0,c.useState)(!0),[ak,al]=(0,c.useState)(!1),[am,an]=(0,c.useState)(!1),[ao,ap]=(0,c.useState)(!1),[aq,ar]=(0,c.useState)(!1),[as,at]=(0,c.useState)(!1),[au,av]=(0,c.useState)([]),[aw,ax]=(0,c.useState)([]),[ay,az]=(0,c.useState)(null),[aA,aB]=(0,c.useState)(X),[aC,aD]=(0,c.useState)(!1),[aE,aF]=(0,c.useState)(""),[aG,aH]=(0,c.useState)("all"),[aI,aJ]=(0,c.useState)([]),[aK,aL]=(0,c.useState)(""),[aM,aN]=(0,c.useState)(""),[aO,aP]=(0,c.useState)(!1),[aQ,aR]=(0,c.useState)(""),[aS,aT]=(0,c.useState)(!1),[aU,aV]=(0,c.useState)({}),[aW,aX]=(0,c.useState)(!1),[aY,aZ]=(0,c.useState)("quantity"),[a$,a_]=(0,c.useState)(!1),[a0,a1]=(0,c.useState)(null),a2=(0,c.useCallback)(async()=>{try{aj(!0);let a=localStorage.getItem("authToken");if(!a)return;let b=await fetch("/api/user/dairy",{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(b.ok){let a=await b.json();af(a.data||[])}}catch(a){console.error("Error fetching dairies:",a)}finally{aj(!1)}},[]),a3=(0,c.useCallback)(async()=>{try{ah(!0);let a=localStorage.getItem("authToken");if(!a)return void $.push("/login");let b=await fetch("/api/user/bmc",{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(!b.ok){if(401===b.status||403===b.status){localStorage.removeItem("authToken"),$.push("/login");return}throw Error("Failed to fetch BMCs")}let c=await b.json();ad(c.data||[])}catch(a){console.error("Error fetching BMCs:",a),aL("Failed to load BMC data")}finally{ah(!1)}},[$]),a4=async a=>{if(a.preventDefault(),aD(!0),aL(""),!aA.dairyFarmId){aL("Please select a dairy farm"),aD(!1);return}try{let a=localStorage.getItem("authToken"),b=await fetch("/api/user/bmc",{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({...aA,dairyFarmId:parseInt(aA.dairyFarmId),capacity:aA.capacity?parseInt(aA.capacity):void 0,monthlyTarget:aA.monthlyTarget?parseInt(aA.monthlyTarget):void 0})});if(b.ok)aN("BMC added successfully!"),al(!1),aB(X),await a3(),setTimeout(()=>aN(""),3e3);else{let a=(await b.json()).error||"Failed to add BMC";aV({}),a.toLowerCase().includes("bmc id")&&a.toLowerCase().includes("already exists")?aV({bmcId:"This BMC ID already exists"}):a.toLowerCase().includes("bmc name")&&a.toLowerCase().includes("already exists")?aV({name:"This BMC name already exists"}):aL(a)}}catch(a){console.error("Error adding BMC:",a),aL("Failed to add BMC")}finally{aD(!1)}},a5=async a=>{az(a),aP(!1),aR("");try{let b=localStorage.getItem("authToken"),c=await fetch(`/api/user/bmc/password?id=${a.id}`,{headers:{Authorization:`Bearer ${b}`}});if(c.ok){let b=await c.json(),d=b.data?.password||b.password||"";aR(d),aB({name:a.name,bmcId:a.bmcId,password:d,dairyFarmId:a.dairyFarmId?.toString()||"",location:a.location||"",contactPerson:a.contactPerson||"",phone:a.phone||"",email:a.email||"",capacity:a.capacity?.toString()||"",status:a.status||"active",monthlyTarget:a.monthlyTarget?.toString()||""})}else aB({name:a.name,bmcId:a.bmcId,password:"",dairyFarmId:a.dairyFarmId?.toString()||"",location:a.location||"",contactPerson:a.contactPerson||"",phone:a.phone||"",email:a.email||"",capacity:a.capacity?.toString()||"",status:a.status||"active",monthlyTarget:a.monthlyTarget?.toString()||""})}catch(b){console.error("Error fetching password:",b),aB({name:a.name,bmcId:a.bmcId,password:"",dairyFarmId:a.dairyFarmId?.toString()||"",location:a.location||"",contactPerson:a.contactPerson||"",phone:a.phone||"",email:a.email||"",capacity:a.capacity?.toString()||"",status:a.status||"active",monthlyTarget:a.monthlyTarget?.toString()||""})}an(!0)},a6=async a=>{if(a.preventDefault(),ay){if(aD(!0),aL(""),!aA.dairyFarmId){aL("Please select a dairy farm"),aD(!1);return}try{let a=localStorage.getItem("authToken"),b={id:ay.id,name:aA.name,dairyFarmId:parseInt(aA.dairyFarmId),location:aA.location,contactPerson:aA.contactPerson,phone:aA.phone,email:aA.email,capacity:aA.capacity?parseInt(aA.capacity):void 0,status:aA.status,monthlyTarget:aA.monthlyTarget?parseInt(aA.monthlyTarget):void 0};aA.password&&aA.password!==aQ&&(b.password=aA.password);let c=await fetch("/api/user/bmc",{method:"PUT",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(b)});if(c.ok)aN("BMC updated successfully!"),an(!1),az(null),aB(X),await a3(),setTimeout(()=>aN(""),3e3);else{let a=(await c.json()).error||"Failed to update BMC";aV({}),a.toLowerCase().includes("bmc name")&&a.toLowerCase().includes("already exists")?aV({name:"This BMC name already exists"}):aL(a)}}catch(a){console.error("Error updating BMC:",a),aL("Failed to update BMC")}finally{aD(!1)}}},a7=async(a,b)=>{try{let c=localStorage.getItem("authToken"),d=await fetch("/api/user/bmc",{method:"PUT",headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/json"},body:JSON.stringify({id:a.id,status:b})});if(d.ok)aN(`Status updated to ${b}!`),await a3(),setTimeout(()=>aN(""),3e3);else{let a=await d.json();aL(a.error||"Failed to update status")}}catch(a){console.error("Error updating status:",a),aL("Failed to update status")}},a8=async a=>{az(a);let b=await a9(a.id);b.length>0?(av(b),ax(ac.filter(b=>b.id!==a.id)),at(!0)):(window.selectedBmcIdForDelete=a.id,ap(!0))},a9=async a=>{try{let b=localStorage.getItem("authToken"),c=await fetch("/api/user/society",{headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"}});if(c.ok){let b=await c.json();return b.data?.filter(b=>b.bmc_id===a)||[]}}catch(a){console.error("Error fetching societies:",a)}return[]},ba=async a=>{if(ay)try{ar(!0);let b=localStorage.getItem("authToken"),c=await fetch("/api/user/bmc",{method:"DELETE",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"},body:JSON.stringify({id:ay.id,otp:a})});if(c.ok)aN("BMC deleted successfully!"),ap(!1),az(null),await a3(),setTimeout(()=>aN(""),3e3);else{let a=await c.json();throw Error(a.error||"Failed to delete BMC")}}catch(a){throw console.error("Error deleting BMC:",a),a}finally{ar(!1)}},bb=async(a,b,c)=>{if(ay)try{let d=localStorage.getItem("authToken"),e=await fetch("/api/user/bmc",{method:"DELETE",headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json"},body:JSON.stringify({id:ay.id,newBmcId:a,deleteAll:b,otp:c})}),f=await e.json();e.ok?(at(!1),az(null),b?aN("All data deleted successfully!"):aN(`Transferred ${f.data?.transferredSocieties||0} societies and deleted BMC successfully!`),await a3(),setTimeout(()=>aN(""),3e3)):aL(f.error||"Failed to delete BMC")}catch(a){console.error("Error deleting BMC:",a),aL("Failed to delete BMC")}},bc=(a,b)=>{if("bmcId"===a&&!am){let a=b.replace(/^B-/i,"");b=`B-${a}`}aB(c=>({...c,[a]:b})),aU[a]&&aV(b=>({...b,[a]:""}))},bd=ac.filter(a=>{let b=""===aE||a.name.toLowerCase().includes(aE.toLowerCase())||a.bmcId.toLowerCase().includes(aE.toLowerCase())||a.location?.toLowerCase().includes(aE.toLowerCase())||a.contactPerson?.toLowerCase().includes(aE.toLowerCase())||a.phone?.toLowerCase().includes(aE.toLowerCase())||a.email?.toLowerCase().includes(aE.toLowerCase())||a.dairyFarmName?.toLowerCase().includes(aE.toLowerCase()),c="all"===aG||a.status===aG,d=0===aI.length||aI.includes(a.dairyFarmId?.toString()||"");return b&&c&&d});return((0,c.useEffect)(()=>{a3(),a2()},[a3,a2]),(0,c.useEffect)(()=>{let a=a=>{aF(a.detail?.query||"")};return window.addEventListener("globalSearch",a),()=>window.removeEventListener("globalSearch",a)},[]),(0,c.useEffect)(()=>{let a=_.get("dairyFilter");a&&ae.length>0&&aJ([a])},[_,ae]),aa)?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8 space-y-4 sm:space-y-6 lg:pb-8",children:[(0,b.jsx)(O.PageHeader,{title:"BMC Management",subtitle:"Manage your Bulk Milk Cooling Centers",icon:(0,b.jsx)(o.Factory,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"}),onRefresh:a3}),(0,b.jsx)(P.StatusMessage,{success:aM,error:aK&&!aK.includes("dairy farm first")?aK:void 0}),aK&&aK.includes("dairy farm first")&&(0,b.jsx)(P.StatusMessage,{error:aK}),ac.length>0&&(()=>{let a=ac.filter(a=>a.totalQuantity30d&&Number(a.totalQuantity30d)>0);if(0===a.length)return null;let c=[...a].sort((a,b)=>Number(b.totalQuantity30d||0)-Number(a.totalQuantity30d||0))[0],d=[...a].sort((a,b)=>Number(b.totalAmount30d||0)-Number(a.totalAmount30d||0))[0],e=[...a].sort((a,b)=>Number(b.weightedFat30d||0)-Number(a.weightedFat30d||0))[0],f=[...a].sort((a,b)=>Number(b.weightedSnf30d||0)-Number(a.weightedSnf30d||0))[0],g=[...a].sort((a,b)=>Number(b.totalCollections30d||0)-Number(a.totalCollections30d||0))[0],h=[...a].sort((a,b)=>Number(a.weightedWater30d||100)-Number(b.weightedWater30d||100))[0];return(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-3 sm:gap-4",children:[c&&(0,b.jsxs)("div",{className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 p-4 rounded-lg border border-green-200 dark:border-green-700 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>{aZ("quantity"),aX(!0)},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-green-900 dark:text-green-100",children:"Top Collection (30d)"}),(0,b.jsx)(y.Users,{className:"w-5 h-5 text-green-600 dark:text-green-400"})]}),(0,b.jsx)("p",{className:"text-lg font-bold text-green-800 dark:text-green-200",children:c.name}),(0,b.jsxs)("p",{className:"text-sm text-green-600 dark:text-green-400",children:[Number(c.totalQuantity30d||0).toFixed(2)," L"]})]}),d&&(0,b.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 p-4 rounded-lg border border-blue-200 dark:border-blue-700 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>{aZ("revenue"),aX(!0)},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100",children:"Top Revenue (30d)"}),(0,b.jsx)(t.Building2,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})]}),(0,b.jsx)("p",{className:"text-lg font-bold text-blue-800 dark:text-blue-200",children:d.name}),(0,b.jsxs)("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:["₹",Number(d.totalAmount30d||0).toFixed(2)]})]}),e&&(0,b.jsxs)("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-800/20 p-4 rounded-lg border border-purple-200 dark:border-purple-700 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>{aZ("fat"),aX(!0)},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-purple-900 dark:text-purple-100",children:"Best Quality (30d)"}),(0,b.jsx)(C.Eye,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})]}),(0,b.jsx)("p",{className:"text-lg font-bold text-purple-800 dark:text-purple-200",children:e.name}),(0,b.jsxs)("p",{className:"text-sm text-purple-600 dark:text-purple-400",children:[Number(e.weightedFat30d||0).toFixed(2),"% Fat"]})]}),f&&(0,b.jsxs)("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-800/20 p-4 rounded-lg border border-orange-200 dark:border-orange-700 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>{aZ("snf"),aX(!0)},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-orange-900 dark:text-orange-100",children:"Best SNF (30d)"}),(0,b.jsx)(z.TrendingUp,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"})]}),(0,b.jsx)("p",{className:"text-lg font-bold text-orange-800 dark:text-orange-200",children:f.name}),(0,b.jsxs)("p",{className:"text-sm text-orange-600 dark:text-orange-400",children:[Number(f.weightedSnf30d||0).toFixed(2),"% SNF"]})]}),g&&(0,b.jsxs)("div",{className:"bg-gradient-to-br from-pink-50 to-pink-100 dark:from-pink-900/20 dark:to-pink-800/20 p-4 rounded-lg border border-pink-200 dark:border-pink-700 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>{aZ("collections"),aX(!0)},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-pink-900 dark:text-pink-100",children:"Most Active (30d)"}),(0,b.jsx)(A.Award,{className:"w-5 h-5 text-pink-600 dark:text-pink-400"})]}),(0,b.jsx)("p",{className:"text-lg font-bold text-pink-800 dark:text-pink-200",children:g.name}),(0,b.jsxs)("p",{className:"text-sm text-pink-600 dark:text-pink-400",children:[Number(g.totalCollections30d||0)," Collections"]})]}),h&&(0,b.jsxs)("div",{className:"bg-gradient-to-br from-red-50 to-red-100 dark:from-red-900/20 dark:to-red-800/20 p-4 rounded-lg border border-red-200 dark:border-red-700 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>{aZ("water"),aX(!0)},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-red-900 dark:text-red-100",children:"Most Water (30d)"}),(0,b.jsx)(B.Droplets,{className:"w-5 h-5 text-red-600 dark:text-red-400"})]}),(0,b.jsx)("p",{className:"text-lg font-bold text-red-800 dark:text-red-200",children:h.name}),(0,b.jsxs)("p",{className:"text-sm text-red-600 dark:text-red-400",children:[Number(h.weightedWater30d||0).toFixed(2),"% Water"]})]})]})})(),(0,b.jsx)(Q.FilterControls,{icon:(0,b.jsx)(t.Building2,{className:"w-4 h-4 flex-shrink-0"}),showingText:`Showing ${bd.length} of ${ac.length} BMCs`,filterLabel:"Filter:",filterValue:aG,filterOptions:[{value:"all",label:"All Status"},{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"maintenance",label:"Maintenance"}],onFilterChange:a=>aH(a)}),ag?(0,b.jsx)(I.LoadingSpinner,{}):bd.length>0?(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-6",children:bd.map(a=>(0,b.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-lg transition-all duration-200 overflow-visible border border-gray-200 dark:border-gray-700 hover:border-green-200 dark:hover:border-green-700 relative z-10 hover:z-20",children:[(0,b.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 p-4 border-b border-gray-200 dark:border-gray-700 rounded-t-lg",children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,b.jsx)("div",{className:"p-2 bg-gradient-to-r from-green-100 to-emerald-100 dark:from-green-900/30 dark:to-emerald-900/30 rounded-lg flex-shrink-0",children:(0,b.jsx)(o.Factory,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white truncate",children:Y(a.name,aE)}),(0,b.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:Y(a.bmcId,aE)})]})]}),(0,b.jsx)(S.StatusDropdown,{currentStatus:a.status,onStatusChange:b=>a7(a,b),options:[{status:"active",label:"Active",color:"bg-green-500",bgColor:"hover:bg-green-50 dark:hover:bg-green-900/30"},{status:"inactive",label:"Inactive",color:"bg-red-500",bgColor:"hover:bg-red-50 dark:hover:bg-red-900/30"},{status:"maintenance",label:"Maintenance",color:"bg-yellow-500",bgColor:"hover:bg-yellow-50 dark:hover:bg-yellow-900/30"}],compact:!0})]})}),(0,b.jsxs)("div",{className:"p-4 space-y-3",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(r.User,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),(0,b.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300 truncate",children:Y(a.contactPerson||"No Contact",aE)})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(q.Phone,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),(0,b.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300 truncate",children:Y(a.phone||"No Phone",aE)})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(p.MapPin,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),(0,b.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300 truncate",children:Y(a.location||"No Location",aE)})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(u.Milk,{className:"w-4 h-4 text-blue-500 flex-shrink-0"}),(0,b.jsx)("span",{className:"text-sm text-blue-600 dark:text-blue-400 font-medium truncate",children:Y(a.dairyFarmName||"No Dairy",aE)})]})]}),(0,b.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700 my-3"}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:"Last 30 Days"}),(0,b.jsx)(s.Calendar,{className:"w-4 h-4 text-gray-400"})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Collections"})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:Number(a.totalCollections30d||0)}),(0,b.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:[Number(a.totalQuantity30d||0).toFixed(2)," Liters"]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,b.jsxs)("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 rounded-lg p-2 text-center",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Fat"}),(0,b.jsxs)("div",{className:"text-sm font-bold text-indigo-600 dark:text-indigo-400",children:[Number(a.weightedFat30d||0).toFixed(2),"%"]})]}),(0,b.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-2 text-center",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"SNF"}),(0,b.jsxs)("div",{className:"text-sm font-bold text-purple-600 dark:text-purple-400",children:[Number(a.weightedSnf30d||0).toFixed(2),"%"]})]}),(0,b.jsxs)("div",{className:"bg-pink-50 dark:bg-pink-900/20 rounded-lg p-2 text-center",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"CLR"}),(0,b.jsx)("div",{className:"text-sm font-bold text-pink-600 dark:text-pink-400",children:Number(a.weightedClr30d||0).toFixed(1)})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between bg-emerald-50 dark:bg-emerald-900/20 rounded-lg p-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-2 h-2 rounded-full bg-emerald-500"}),(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Total Revenue"})]}),(0,b.jsxs)("div",{className:"text-lg font-bold text-emerald-600 dark:text-emerald-400",children:["₹",Number(a.totalAmount30d||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),(0,b.jsxs)("div",{className:"bg-white dark:bg-gray-800 px-4 py-3 border-t border-gray-100 dark:border-gray-700 flex items-center justify-between gap-2 rounded-b-lg",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>a5(a),className:"p-2 text-gray-400 dark:text-gray-500 hover:text-green-600 dark:hover:text-green-400 transition-colors rounded-lg hover:bg-green-50 dark:hover:bg-green-900/30",title:"Edit",children:(0,b.jsx)(w.Edit3,{className:"w-4 h-4"})}),(0,b.jsx)("button",{onClick:()=>a8(a),className:"p-2 text-gray-400 dark:text-gray-500 hover:text-red-600 dark:hover:text-red-400 transition-colors rounded-lg hover:bg-red-50 dark:hover:bg-red-900/30",title:"Delete",children:(0,b.jsx)(x.Trash2,{className:"w-4 h-4"})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("button",{onClick:()=>{a1(a),a_(!0)},className:"flex items-center gap-2 px-3 py-1.5 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors group",title:`View ${a.societyCount||0} societies under ${a.name}`,children:[(0,b.jsx)(t.Building2,{className:"w-4 h-4 text-gray-400 group-hover:text-blue-500 transition-colors"}),(0,b.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-400 group-hover:text-blue-600 dark:group-hover:text-blue-400 font-medium transition-colors",children:[a.societyCount||0," Societies"]})]}),(0,b.jsxs)("button",{onClick:()=>$.push(`/admin/bmc/${a.id}`),className:"flex items-center px-3 py-1.5 text-sm text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/30 rounded-lg transition-colors",title:"View Details",children:[(0,b.jsx)(C.Eye,{className:"w-4 h-4 mr-1"}),(0,b.jsx)("span",{children:"View"})]})]})]})]},a.id))}):(0,b.jsx)(R.EmptyState,{icon:(0,b.jsx)(o.Factory,{className:"w-12 h-12 sm:w-16 sm:h-16 text-gray-400"}),title:"No BMCs found",message:"all"===aG?"Get started by adding your first BMC":"Try changing the filter to see more results",actionText:"all"===aG?"Add Your First BMC":void 0,onAction:"all"===aG?()=>{if(0===ae.length){aL("Please add a dairy farm first before adding BMC"),setTimeout(()=>aL(""),5e3);return}aL(""),al(!0)}:void 0,showAction:"all"===aG})]}),(0,b.jsx)(T.default,{actions:[{icon:(0,b.jsx)(E.Plus,{className:"w-6 h-6 text-white"}),label:"Add BMC",onClick:()=>{aV({}),aL(""),al(!0),a2()},color:"bg-gradient-to-br from-green-500 to-green-600"}],directClick:!0}),(0,b.jsx)(J.FormModal,{isOpen:ak,onClose:()=>{al(!1),aB(X)},title:ab.bmcManagement.addBMC,maxWidth:"lg",children:(0,b.jsxs)("form",{onSubmit:a4,className:"space-y-4 sm:space-y-6",children:[(0,b.jsxs)(N.FormGrid,{children:[(0,b.jsx)(K.FormInput,{label:"BMC Name",value:aA.name,onChange:a=>bc("name",a),placeholder:"Enter BMC name",required:!0,error:aU.name,colSpan:1}),(0,b.jsx)(K.FormInput,{label:"BMC ID",value:aA.bmcId,onChange:a=>bc("bmcId",a),placeholder:"B-001",required:!0,disabled:am,error:aU.bmcId,colSpan:1}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Password ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{type:aS?"text":"password",value:aA.password,onChange:a=>bc("password",a.target.value),placeholder:"Enter password",required:!am,className:"form-input-custom w-full px-3 sm:px-4 py-2 sm:py-2.5 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-blue-500 dark:focus:border-blue-400 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-all duration-200 focus:outline-none"}),(0,b.jsx)("button",{type:"button",onClick:()=>aT(!aS),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-colors",title:aS?"Hide password":"Show password",children:aS?(0,b.jsx)(D.EyeOff,{className:"w-5 h-5"}):(0,b.jsx)(C.Eye,{className:"w-5 h-5"})})]})]}),(0,b.jsx)(L.FormSelect,{label:"Dairy Farm",value:aA.dairyFarmId,onChange:a=>bc("dairyFarmId",a),options:ae.map(a=>({value:a.id,label:`${a.name} (${a.dairyId})`})),placeholder:"Select dairy farm",required:!0,disabled:ai,colSpan:1}),(0,b.jsx)(K.FormInput,{label:"Capacity (Liters)",type:"number",value:aA.capacity,onChange:a=>bc("capacity",a),placeholder:"2000",colSpan:1}),(0,b.jsx)(K.FormInput,{label:"Monthly Target (Liters)",type:"number",value:aA.monthlyTarget,onChange:a=>bc("monthlyTarget",a),placeholder:"2000",colSpan:1}),(0,b.jsx)(K.FormInput,{label:"Contact Person",value:aA.contactPerson,onChange:a=>bc("contactPerson",a),placeholder:"Enter contact person",colSpan:1}),(0,b.jsx)(K.FormInput,{label:"Phone Number",type:"tel",value:aA.phone,onChange:a=>{bc("phone",(0,d.formatPhoneInput)(a))},onBlur:()=>{let a=(0,d.validatePhoneOnBlur)(aA.phone);a?aV(b=>({...b,phone:a})):aV(a=>({...a,phone:void 0}))},placeholder:"Enter 10-digit phone number",error:aU.phone,colSpan:1}),(0,b.jsx)(K.FormInput,{label:"Email",type:"email",value:aA.email,onChange:a=>bc("email",a),placeholder:"bmc@example.com",colSpan:1}),(0,b.jsx)(L.FormSelect,{label:"Status",value:aA.status,onChange:a=>bc("status",a),options:[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"maintenance",label:"Maintenance"}],colSpan:1}),(0,b.jsx)(K.FormInput,{label:"Location",value:aA.location,onChange:a=>bc("location",a),placeholder:"Enter location",colSpan:2})]}),(0,b.jsx)(M.FormActions,{onCancel:()=>{al(!1),aB(X)},submitText:ab.bmcManagement.addBMC,isLoading:aC,cancelText:ab.common.cancel})]})}),(0,b.jsx)(J.FormModal,{isOpen:am&&!!ay,onClose:()=>{an(!1),az(null),aB(X)},title:ay?`${ab.common.edit} ${ay.name}`:ab.common.edit,maxWidth:"lg",children:(0,b.jsxs)("form",{onSubmit:a6,className:"space-y-4 sm:space-y-6",children:[(0,b.jsxs)(N.FormGrid,{children:[(0,b.jsx)(K.FormInput,{label:`${ab.bmcManagement.bmcName}`,value:aA.name,onChange:a=>bc("name",a),placeholder:ab.bmcManagement.enterBMCName,required:!0,error:aU.name,colSpan:1}),(0,b.jsx)(K.FormInput,{label:`${ab.bmcManagement.bmcId} (Read-only)`,value:aA.bmcId,onChange:()=>{},readOnly:!0,disabled:!0,colSpan:1}),(0,b.jsx)(L.FormSelect,{label:`${ab.bmcManagement.dairyFarm}`,value:aA.dairyFarmId,onChange:a=>bc("dairyFarmId",a),options:ae.map(a=>({value:a.id,label:`${a.name} (${a.dairyId})`})),placeholder:"Select dairy farm",required:!0,disabled:ai,colSpan:2}),(0,b.jsxs)("div",{className:"sm:col-span-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Password"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{type:aO?"text":"password",value:aA.password,onChange:a=>bc("password",a.target.value),placeholder:"Enter password",className:"form-input-custom w-full px-3 sm:px-4 py-2 sm:py-2.5 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-emerald-500 dark:focus:ring-emerald-400 focus:border-emerald-500 dark:focus:border-emerald-400 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-all duration-200 focus:outline-none"}),(0,b.jsx)("button",{type:"button",onClick:()=>aP(!aO),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-colors",title:aO?"Hide password":"Show password",children:aO?(0,b.jsx)(D.EyeOff,{className:"w-5 h-5"}):(0,b.jsx)(C.Eye,{className:"w-5 h-5"})})]}),(0,b.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Current password is pre-filled. Click eye icon to view or edit to change."})]}),(0,b.jsx)(K.FormInput,{label:ab.bmcManagement.capacity,type:"number",value:aA.capacity,onChange:a=>bc("capacity",a),placeholder:ab.bmcManagement.enterCapacity,colSpan:1}),(0,b.jsx)(K.FormInput,{label:ab.bmcManagement.monthlyTarget,type:"number",value:aA.monthlyTarget,onChange:a=>bc("monthlyTarget",a),placeholder:ab.bmcManagement.enterMonthlyTarget,colSpan:1}),(0,b.jsx)(K.FormInput,{label:ab.bmcManagement.contactPerson,value:aA.contactPerson,onChange:a=>bc("contactPerson",a),placeholder:ab.bmcManagement.enterContactPerson,colSpan:1}),(0,b.jsx)(K.FormInput,{label:ab.bmcManagement.phone,type:"tel",value:aA.phone,onChange:a=>{bc("phone",(0,d.formatPhoneInput)(a))},onBlur:()=>{let a=(0,d.validatePhoneOnBlur)(aA.phone);a?aV(b=>({...b,phone:a})):aV(a=>({...a,phone:void 0}))},placeholder:ab.bmcManagement.enterPhoneNumber,error:aU.phone,colSpan:1}),(0,b.jsx)(K.FormInput,{label:ab.bmcManagement.email,type:"email",value:aA.email,onChange:a=>bc("email",a),placeholder:ab.bmcManagement.enterEmail,colSpan:1}),(0,b.jsx)(L.FormSelect,{label:ab.bmcManagement.status,value:aA.status,onChange:a=>bc("status",a),options:[{value:"active",label:ab.bmcManagement.active},{value:"inactive",label:ab.bmcManagement.inactive},{value:"maintenance",label:ab.bmcManagement.maintenance}],colSpan:1}),(0,b.jsx)(K.FormInput,{label:ab.bmcManagement.location,value:aA.location,onChange:a=>bc("location",a),placeholder:ab.bmcManagement.enterLocation,colSpan:2})]}),(0,b.jsx)(M.FormActions,{onCancel:()=>{an(!1),az(null),aB(X)},submitText:ab.bmcManagement.updateBMC,isLoading:aC,cancelText:ab.common.cancel,loadingText:ab.bmcManagement.updatingBMC,submitIcon:(0,b.jsx)(v.Save,{className:"w-4 h-4"})})]})}),(0,b.jsx)(W.default,{isOpen:ao&&!!ay,onClose:()=>{ap(!1),az(null)},onConfirm:ba,bmcName:ay?.name||"",loading:aq,societyCount:ay?.societyCount||0}),(0,b.jsx)(V.default,{isOpen:as,onClose:()=>{at(!1),az(null)},onConfirm:bb,bmcName:ay?.name||"",bmcId:ay?.id||0,societies:au,availableBMCs:aw}),(0,b.jsx)(U.default,{isOpen:a$&&!!a0,onClose:()=>{a_(!1),a1(null)},onConfirm:()=>{a_(!1),$.push(`/admin/society?bmcFilter=${a0?.id}`),a1(null)},title:"Navigate to Society Management",message:`View all societies from ${a0?.name} in the Society Management page with filters applied.`,confirmText:"Go to Society Management",cancelText:"Cancel"}),aW&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,b.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(F.BarChart3,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"}),(0,b.jsxs)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:["quantity"===aY&&"Collection Volume - Last 30 Days","revenue"===aY&&"Revenue - Last 30 Days","fat"===aY&&"Average Fat % - Last 30 Days","snf"===aY&&"Average SNF % - Last 30 Days","collections"===aY&&"Number of Collections - Last 30 Days","water"===aY&&"Average Water % - Last 30 Days"]})]}),(0,b.jsx)("button",{onClick:()=>aX(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:(0,b.jsx)(G.X,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(a=ac.filter(a=>a.totalQuantity30d&&a.totalQuantity30d>0).map(a=>({name:a.name,bmcId:a.bmcId,value:"quantity"===aY?a.totalQuantity30d||0:"revenue"===aY?a.totalAmount30d||0:"fat"===aY?a.weightedFat30d||0:"snf"===aY?a.weightedSnf30d||0:"collections"===aY?a.totalCollections30d||0:a.weightedWater30d||0})).sort((a,b)=>b.value-a.value),Z=()=>{switch(aY){case"quantity":return"#10b981";case"revenue":return"#3b82f6";case"fat":return"#8b5cf6";case"snf":return"#f97316";case"collections":return"#ec4899";case"water":return"#ef4444";default:return"#6b7280"}},a.length>0?(0,b.jsx)("div",{className:"w-full h-[500px]",children:(0,b.jsx)(n.ResponsiveContainer,{width:"100%",height:"100%",children:(0,b.jsxs)(h.LineChart,{data:a,margin:{top:5,right:30,left:20,bottom:80},children:[(0,b.jsx)(l.CartesianGrid,{strokeDasharray:"3 3",stroke:"#e5e7eb",className:"dark:stroke-gray-700"}),(0,b.jsx)(j.XAxis,{dataKey:"name",angle:-45,textAnchor:"end",height:100,interval:0,tick:{fontSize:11},stroke:"#6b7280",label:{value:"BMC Name",position:"insideBottom",offset:-5,style:{fontSize:13,fontWeight:500,fill:"#9ca3af"}}}),(0,b.jsx)(k.YAxis,{label:{value:"revenue"===aY?"Revenue (₹)":"fat"===aY||"snf"===aY||"water"===aY?"Percentage (%)":"quantity"===aY?"Volume (L)":"Count",angle:-90,position:"insideLeft",style:{fontSize:13,fontWeight:500,fill:"#9ca3af"}},stroke:"#6b7280"}),(0,b.jsx)(m.Tooltip,{contentStyle:{backgroundColor:"#1f2937",border:"none",borderRadius:"0.5rem",color:"#fff",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1)"},formatter:a=>"revenue"===aY?["₹"+Number(a).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]:"fat"===aY||"snf"===aY||"water"===aY?[Number(a).toFixed(2)+"%"]:"quantity"===aY?[Number(a).toFixed(2)+" L"]:[Number(a)],labelFormatter:a=>`BMC: ${a}`,cursor:{stroke:"#9ca3af",strokeWidth:1}}),(0,b.jsx)(i.Line,{type:"monotone",dataKey:"value",stroke:Z(),strokeWidth:2,dot:{fill:Z(),r:4},activeDot:{r:6},isAnimationActive:!0,name:"Value"})]})})}):(0,b.jsx)("div",{className:"flex items-center justify-center h-[500px]",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(F.BarChart3,{className:"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),(0,b.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-lg",children:"No data available for this metric"})]})}))}),(0,b.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700 p-4 bg-gray-50 dark:bg-gray-700/50",children:(0,b.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Showing performance metrics for all BMCs over the last 30 days. Click the X to close this view."})})]})})]}):(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:(0,b.jsx)(H.FlowerSpinner,{})})}a.s(["default",()=>Z])}];

//# sourceMappingURL=src_app_admin_bmc_page_tsx_fe0b45bf._.js.map