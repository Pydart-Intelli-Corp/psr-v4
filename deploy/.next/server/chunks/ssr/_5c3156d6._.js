module.exports=[481402,a=>{"use strict";let b=(0,a.i(170106).default)("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);a.s(["Key",()=>b],481402)},540222,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(346271),e=a.i(835475);a.i(16707);var f=a.i(529784),g=a.i(546842),h=a.i(992258),i=a.i(963519),j=a.i(124987),k=a.i(267900),l=a.i(941675),m=a.i(481402),n=a.i(603314),o=a.i(114548),p=a.i(468976),q=a.i(400210);function r(){let{user:a}=(0,e.useUser)(),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)(!0),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)({firstName:"",lastName:"",companyName:"",companyAddress:"",companyPhone:""}),B=async()=>{let a=localStorage.getItem("authToken");if(!a){console.log("No auth token found, redirecting to login"),window.location.href="/login";return}try{console.log("ðŸ”„ Fetching user profile...");let b=await fetch("/api/user/profile",{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(!b.ok){if(401===b.status||403===b.status){console.log("Authentication failed, redirecting to login"),localStorage.removeItem("authToken"),localStorage.removeItem("userData"),window.location.href="/login";return}throw Error(`Profile API failed: ${b.status}`)}let c=await b.json();if(console.log("âœ… User profile fetched:",c),c.success&&c.data){let a="string"==typeof c.data?JSON.parse(c.data):c.data;if("admin"===a.role){let b={id:a.id,fullName:a.fullName||`${a.firstName||""} ${a.lastName||""}`.trim(),firstName:a.firstName||a.fullName?.split(" ")[0]||"",lastName:a.lastName||a.fullName?.split(" ").slice(1).join(" ")||"",email:a.email,role:a.role,status:a.status,companyName:a.companyName,phone:a.companyPhone||a.phone,address:a.companyAddress||a.address,dbKey:a.dbKey,joinedDate:a.created_at||a.createdAt||new Date().toISOString()};s(b),A({firstName:b.firstName,lastName:b.lastName,companyName:b.companyName||"",companyAddress:b.address||"",companyPhone:b.phone||""}),console.log("Admin profile loaded:",b.fullName)}else console.log("User is not admin, redirecting to login"),window.location.href="/login"}else console.log("Invalid response format, redirecting to login"),window.location.href="/login"}catch(a){console.error("âŒ Error fetching user profile:",a),window.location.href="/login"}finally{u(!1)}},C=async()=>{let a=localStorage.getItem("authToken");if(a)try{w(!0),console.log("ðŸ’¾ Updating profile...",z);let b=await fetch("/api/user/profile",{method:"PUT",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(z)});if(!b.ok)throw Error(`Update failed: ${b.status}`);let c=await b.json();if(console.log("âœ… Profile updated:",c),c.success)await B(),y(!1),alert("Profile updated successfully!");else throw Error("Update failed")}catch(a){console.error("âŒ Error updating profile:",a),alert("Failed to update profile. Please try again.")}finally{w(!1)}};(0,c.useEffect)(()=>{B()},[]);let D=(a,b)=>{A(c=>({...c,[a]:b}))};return a?t?(0,b.jsxs)("div",{className:"flex items-center justify-center min-h-[400px]",children:[(0,b.jsx)(f.FlowerSpinner,{size:32}),(0,b.jsx)("span",{className:"ml-4 text-gray-600 dark:text-gray-400",children:"Loading profile..."})]}):r?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsx)("button",{onClick:()=>window.history.back(),className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:(0,b.jsx)(q.ArrowLeft,{className:"w-5 h-5"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Profile"}),(0,b.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage your account information"})]})]}),(0,b.jsx)("div",{className:"flex items-center space-x-3",children:x?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:()=>{y(!1),A({firstName:r.firstName,lastName:r.lastName,companyName:r.companyName||"",companyAddress:r.address||"",companyPhone:r.phone||""})},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,b.jsxs)("button",{onClick:C,disabled:v,className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors",children:[v?(0,b.jsx)(f.FlowerSpinner,{size:16,className:"mr-2"}):(0,b.jsx)(o.Save,{className:"w-4 h-4 mr-2"}),v?"Saving...":"Save Changes"]})]}):(0,b.jsxs)("button",{onClick:()=>y(!0),className:"flex items-center px-4 py-2 text-green-600 border border-green-600 rounded-lg hover:bg-green-50 transition-colors",children:[(0,b.jsx)(p.Edit3,{className:"w-4 h-4 mr-2"}),"Edit Profile"]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsx)(d.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"lg:col-span-1",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"w-20 h-20 bg-gradient-to-br from-green-500 to-emerald-600 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,b.jsxs)("span",{className:"text-2xl font-bold text-white",children:[r.firstName.charAt(0).toUpperCase(),r.lastName.charAt(0).toUpperCase()]})}),(0,b.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:r.fullName}),(0,b.jsx)("p",{className:"text-gray-600 mt-1",children:r.email}),(0,b.jsxs)("div",{className:"flex items-center justify-center mt-2",children:[(0,b.jsx)(n.Shield,{className:"w-4 h-4 text-purple-600 mr-1"}),(0,b.jsx)("span",{className:"text-purple-600 font-medium capitalize",children:r.role})]})]}),(0,b.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,b.jsx)(l.Calendar,{className:"w-4 h-4 mr-2"}),"Joined ",new Date(r.joinedDate).toLocaleDateString()]}),(0,b.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,b.jsx)(m.Key,{className:"w-4 h-4 mr-2"}),"DB Key: ",r.dbKey||"Not assigned"]}),(0,b.jsxs)("div",{className:"flex items-center text-sm",children:[(0,b.jsx)("div",{className:`w-2 h-2 rounded-full mr-2 ${"active"===r.status?"bg-green-500":"bg-yellow-500"}`}),(0,b.jsx)("span",{className:`capitalize font-medium ${"active"===r.status?"text-green-600":"text-yellow-600"}`,children:r.status})]})]})]})}),(0,b.jsx)(d.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"lg:col-span-2",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,b.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Profile Information"}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h5",{className:"text-md font-medium text-gray-700 mb-4 flex items-center",children:[(0,b.jsx)(g.User,{className:"w-4 h-4 mr-2"}),"Personal Information"]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name"}),x?(0,b.jsx)("input",{type:"text",value:z.firstName,onChange:a=>D("firstName",a.target.value),className:"psr-input"}):(0,b.jsx)("p",{className:"text-gray-900 py-2",children:r.firstName})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name"}),x?(0,b.jsx)("input",{type:"text",value:z.lastName,onChange:a=>D("lastName",a.target.value),className:"psr-input"}):(0,b.jsx)("p",{className:"text-gray-900 py-2",children:r.lastName})]})]}),(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(h.Mail,{className:"w-4 h-4 text-gray-400 mr-2"}),(0,b.jsx)("p",{className:"text-gray-900",children:r.email}),(0,b.jsx)("span",{className:"ml-2 text-xs text-gray-500",children:"(Cannot be changed)"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h5",{className:"text-md font-medium text-gray-700 mb-4 flex items-center",children:[(0,b.jsx)(k.Building2,{className:"w-4 h-4 mr-2"}),"Company Information"]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Name"}),x?(0,b.jsx)("input",{type:"text",value:z.companyName,onChange:a=>D("companyName",a.target.value),className:"psr-input",placeholder:"Enter your company name"}):(0,b.jsx)("p",{className:"text-gray-900 py-2",children:r.companyName||"Not provided"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),x?(0,b.jsx)("input",{type:"tel",value:z.companyPhone,onChange:a=>D("companyPhone",a.target.value),className:"psr-input",placeholder:"Enter phone number"}):(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(i.Phone,{className:"w-4 h-4 text-gray-400 mr-2"}),(0,b.jsx)("p",{className:"text-gray-900",children:r.phone||"Not provided"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),x?(0,b.jsx)("textarea",{value:z.companyAddress,onChange:a=>D("companyAddress",a.target.value),rows:3,className:"psr-textarea",placeholder:"Enter company address"}):(0,b.jsxs)("div",{className:"flex items-start",children:[(0,b.jsx)(j.MapPin,{className:"w-4 h-4 text-gray-400 mr-2 mt-1 flex-shrink-0"}),(0,b.jsx)("p",{className:"text-gray-900",children:r.address||"Not provided"})]})]})]})]})]})]})})]})]}):(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Unable to load profile"}),(0,b.jsx)("button",{onClick:()=>window.location.href="/admin/dashboard",className:"mt-4 text-green-600 hover:text-green-700 dark:text-green-400 dark:hover:text-green-300",children:"Return to Dashboard"})]})}):(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:(0,b.jsx)(f.FlowerSpinner,{})})}a.s(["default",()=>r])}];

//# sourceMappingURL=_5c3156d6._.js.map