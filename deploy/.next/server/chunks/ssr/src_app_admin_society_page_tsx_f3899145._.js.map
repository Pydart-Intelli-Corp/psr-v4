{"version":3,"sources":["turbopack:///[project]/src/app/admin/society/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport { formatPhoneInput, validatePhoneOnBlur } from '@/lib/validation/phoneValidation';\r\nimport { validateEmailOnBlur, formatEmailInput } from '@/lib/validation/emailValidation';\r\nimport { useRouter, useSearchParams } from 'next/navigation';\r\nimport { useUser } from '@/contexts/UserContext';\r\nimport { useLanguage } from '@/contexts/LanguageContext';\r\nimport {\r\n  LineChart,\r\n  Line,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip,\r\n  ResponsiveContainer\r\n} from 'recharts';\r\nimport { \r\n  Users, \r\n  Edit3, \r\n  MapPin,\r\n  Phone,\r\n  User,\r\n  Calendar,\r\n  Building2,\r\n  Eye,\r\n  EyeOff,\r\n  Trash2,\r\n  TrendingUp,\r\n  Award,\r\n  Droplets,\r\n  Plus,\r\n  BarChart3,\r\n  X\r\n} from 'lucide-react';\r\nimport { \r\n  FlowerSpinner, \r\n  LoadingSpinner,\r\n  FormModal, \r\n  FormInput, \r\n  FormSelect, \r\n  FormActions, \r\n  FormGrid,\r\n  PageHeader,\r\n  StatusMessage,\r\n  FilterControls,\r\n  FilterDropdown,\r\n  EmptyState,\r\n  StatusDropdown,\r\n  LoadingSnackbar\r\n} from '@/components';\r\nimport { PulseStatus } from '@/components/SectionPulseIndicator';\r\nimport BulkActionsToolbar from '@/components/management/BulkActionsToolbar';\r\nimport FloatingActionButton from '@/components/management/FloatingActionButton';\r\nimport PasswordConfirmDialog from '@/components/dialogs/PasswordConfirmDialog';\r\nimport DeleteSocietyModal from '@/components/modals/DeleteSocietyModal';\r\n\r\ninterface Society {\r\n  id: number;\r\n  name: string;\r\n  societyId: string;\r\n  location?: string;\r\n  presidentName?: string;\r\n  contactPhone?: string;\r\n  email: string;\r\n  bmcId: number;\r\n  bmcName?: string;\r\n  status: 'active' | 'inactive' | 'maintenance' | 'suspended';\r\n  createdAt: string;\r\n  lastActivity?: string;\r\n  memberCount?: number;\r\n  totalCollections30d?: number;\r\n  totalQuantity30d?: number;\r\n  totalAmount30d?: number;\r\n  weightedFat30d?: number;\r\n  weightedSnf30d?: number;\r\n  weightedClr30d?: number;\r\n  weightedWater30d?: number;\r\n}\r\n\r\ninterface SocietyFormData {\r\n  name: string;\r\n  societyId: string;\r\n  password: string;\r\n  location: string;\r\n  presidentName: string;\r\n  contactPhone: string;\r\n  email: string;\r\n  bmcId: string;\r\n  status: 'active' | 'inactive' | 'maintenance' | 'suspended';\r\n}\r\n\r\nconst initialFormData: SocietyFormData = {\r\n  name: '',\r\n  societyId: '',\r\n  password: '',\r\n  location: '',\r\n  presidentName: '',\r\n  contactPhone: '',\r\n  email: '',\r\n  bmcId: '',\r\n  status: 'active'\r\n};\r\n\r\n// Helper function to highlight matching text in search results\r\nconst highlightText = (text: string | number | null | undefined, searchQuery: string) => {\r\n  if (!text && text !== 0) return text || '';\r\n  if (!searchQuery) return text;\r\n  \r\n  const textStr = text.toString();\r\n  const regex = new RegExp(`(${searchQuery.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')})`, 'gi');\r\n  const parts = textStr.split(regex);\r\n  \r\n  return parts.map((part, index) => \r\n    regex.test(part) ? (\r\n      <span key={index} className=\"bg-yellow-200 dark:bg-yellow-800 px-0.5 rounded\">\r\n        {part}\r\n      </span>\r\n    ) : (\r\n      part\r\n    )\r\n  );\r\n};\r\n\r\nexport default function SocietyManagement() {\r\n  const router = useRouter();\r\n  const searchParams = useSearchParams();\r\n  const { user } = useUser();\r\n  const { t } = useLanguage();\r\n  \r\n  // State management\r\n  const [societies, setSocieties] = useState<Society[]>([]);\r\n  const [bmcs, setBmcs] = useState<Array<{ id: number; name: string; bmcId: string; dairyFarmId?: number }>>([]);\r\n  const [dairies, setDairies] = useState<Array<{ id: number; name: string; dairyId: string }>>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [bmcsLoading, setBmcsLoading] = useState(false);\r\n  const [showAddForm, setShowAddForm] = useState(false);\r\n  const [showEditForm, setShowEditForm] = useState(false);\r\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n  const [selectedSociety, setSelectedSociety] = useState<Society | null>(null);\r\n  const [isDeleting, setIsDeleting] = useState(false);\r\n  const [formData, setFormData] = useState<SocietyFormData>(initialFormData);\r\n  const [formLoading, setFormLoading] = useState(false);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [statusFilter, setStatusFilter] = useState<'all' | 'active' | 'inactive' | 'maintenance' | 'suspended'>('all');\r\n  const [dairyFilter, setDairyFilter] = useState<string[]>([]);\r\n  const [bmcFilter, setBmcFilter] = useState<string[]>([]);\r\n  const [error, setError] = useState('');\r\n  const [success, setSuccess] = useState('');\r\n  const [fieldErrors, setFieldErrors] = useState<{\r\n    societyId?: string;\r\n    name?: string;\r\n    bmcId?: string;\r\n    contactPhone?: string;\r\n    email?: string;\r\n  }>({});\r\n  const [openMenuId, setOpenMenuId] = useState<number | null>(null);\r\n  const [selectedSocieties, setSelectedSocieties] = useState<Set<number>>(new Set());\r\n  const [bulkStatus, setBulkStatus] = useState<'active' | 'inactive' | 'maintenance' | 'suspended'>('active');\r\n  const [showBulkDeleteConfirm, setShowBulkDeleteConfirm] = useState(false);\r\n  const [showGraphModal, setShowGraphModal] = useState(false);\r\n  const [graphMetric, setGraphMetric] = useState<'quantity' | 'revenue' | 'fat' | 'snf' | 'collections' | 'water'>('quantity');\r\n  const [isDeletingBulk, setIsDeletingBulk] = useState(false);\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const [currentPassword, setCurrentPassword] = useState('');\r\n  const [showAddPassword, setShowAddPassword] = useState(false);\r\n  \r\n  // Pulse tracking state\r\n  const [pulseData, setPulseData] = useState<{\r\n    totalSocieties: number;\r\n    active: number;\r\n    ended: number;\r\n    notStarted: number;\r\n    inactive: number;\r\n    pulses: (PulseStatus & { societyName?: string })[];\r\n  } | null>(null);\r\n\r\n  // Fetch societies\r\n  const fetchSocieties = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n      const token = localStorage.getItem('authToken');\r\n      if (!token) {\r\n        router.push('/login');\r\n        return;\r\n      }\r\n\r\n      const response = await fetch('/api/user/society', {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        }\r\n      });\r\n\r\n      if (!response.ok) {\r\n        if (response.status === 401 || response.status === 403) {\r\n          localStorage.removeItem('authToken');\r\n          router.push('/login');\r\n          return;\r\n        }\r\n        throw new Error('Failed to fetch societies');\r\n      }\r\n\r\n      const result = await response.json();\r\n      // Transform snake_case to camelCase for consistent frontend usage\r\n      const transformedSocieties = (result.data || []).map((society: {\r\n        id: number;\r\n        name: string;\r\n        society_id: string;\r\n        location?: string;\r\n        president_name?: string;\r\n        contact_phone?: string;\r\n        email?: string;\r\n        bmc_id: number;\r\n        bmc_name?: string;\r\n        status: string;\r\n        created_at: string;\r\n        updated_at: string;\r\n        total_collections_30d?: number;\r\n        total_quantity_30d?: number;\r\n        total_amount_30d?: number;\r\n        weighted_fat_30d?: number;\r\n        weighted_snf_30d?: number;\r\n        weighted_clr_30d?: number;\r\n        weighted_water_30d?: number;\r\n      }) => ({\r\n        id: society.id,\r\n        name: society.name,\r\n        societyId: society.society_id,\r\n        location: society.location,\r\n        presidentName: society.president_name,\r\n        contactPhone: society.contact_phone,\r\n        email: society.email || '',\r\n        bmcId: society.bmc_id,\r\n        bmcName: society.bmc_name,\r\n        status: society.status as 'active' | 'inactive' | 'maintenance',\r\n        createdAt: society.created_at,\r\n        updatedAt: society.updated_at,\r\n        totalCollections30d: Number(society.total_collections_30d) || 0,\r\n        totalQuantity30d: Number(society.total_quantity_30d) || 0,\r\n        totalAmount30d: Number(society.total_amount_30d) || 0,\r\n        weightedFat30d: Number(society.weighted_fat_30d) || 0,\r\n        weightedSnf30d: Number(society.weighted_snf_30d) || 0,\r\n        weightedClr30d: Number(society.weighted_clr_30d) || 0,\r\n        weightedWater30d: Number(society.weighted_water_30d) || 0\r\n      }));\r\n      setSocieties(transformedSocieties);\r\n    } catch (error) {\r\n      console.error('Error fetching societies:', error);\r\n      setError('Failed to load society data');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [router]);\r\n\r\n  // Fetch dairies for filtering\r\n  const fetchDairies = useCallback(async () => {\r\n    try {\r\n      const token = localStorage.getItem('authToken');\r\n      if (!token) return;\r\n\r\n      const response = await fetch('/api/user/dairy', {\r\n        headers: { 'Authorization': `Bearer ${token}` }\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setDairies(data.data || []);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching dairies:', error);\r\n    }\r\n  }, []);\r\n\r\n  // Fetch BMCs for the dropdown\r\n  const fetchBmcs = useCallback(async () => {\r\n    try {\r\n      setBmcsLoading(true);\r\n      const token = localStorage.getItem('authToken');\r\n      if (!token) return;\r\n\r\n      const response = await fetch('/api/user/bmc', {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        }\r\n      });\r\n\r\n      if (response.ok) {\r\n        const result = await response.json();\r\n        setBmcs(result.data || []);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching BMCs:', error);\r\n    } finally {\r\n      setBmcsLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  // Fetch pulse data for ECG indicators\r\n  const fetchPulseData = useCallback(async () => {\r\n    try {\r\n      const token = localStorage.getItem('authToken');\r\n      if (!token) {\r\n        return;\r\n      }\r\n\r\n      const response = await fetch('/api/user/pulse', {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json',\r\n          'x-user-id': user?.id?.toString() || ''\r\n        }\r\n      });\r\n\r\n      if (response.ok) {\r\n        const result = await response.json();\r\n        setPulseData(result.data || null);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching pulse data:', error);\r\n    }\r\n  }, [user?.id]);\r\n\r\n  // Close menu when clicking outside\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (openMenuId !== null) {\r\n        const target = event.target as HTMLElement;\r\n        if (!target.closest('.relative')) {\r\n          setOpenMenuId(null);\r\n        }\r\n      }\r\n    };\r\n\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside);\r\n    };\r\n  }, [openMenuId]);\r\n\r\n  // Handle society selection\r\n  const handleSelectSociety = (societyId: number) => {\r\n    setSelectedSocieties(prev => {\r\n      const newSelected = new Set(prev);\r\n      if (newSelected.has(societyId)) {\r\n        newSelected.delete(societyId);\r\n      } else {\r\n        newSelected.add(societyId);\r\n      }\r\n      return newSelected;\r\n    });\r\n  };\r\n\r\n  // Handle bulk status update\r\n  const handleBulkStatusUpdate = async (newStatus?: string) => {\r\n    if (selectedSocieties.size === 0) return;\r\n\r\n    const statusToUpdate = newStatus || bulkStatus;\r\n\r\n    try {\r\n      setLoading(true);\r\n      const token = localStorage.getItem('authToken');\r\n      const societyIds = Array.from(selectedSocieties);\r\n\r\n      console.log(`ðŸ”„ Bulk updating ${societyIds.length} societies to status: ${statusToUpdate}`);\r\n\r\n      const updatePromises = societyIds.map(id => {\r\n        const society = societies.find(s => s.id === id);\r\n        if (!society) return Promise.resolve();\r\n\r\n        return fetch('/api/user/society', {\r\n          method: 'PUT',\r\n          headers: {\r\n            'Authorization': `Bearer ${token}`,\r\n            'Content-Type': 'application/json'\r\n          },\r\n          body: JSON.stringify({\r\n            id: society.id,\r\n            name: society.name,\r\n            societyId: society.societyId,\r\n            location: society.location || '',\r\n            presidentName: society.presidentName || '',\r\n            contactPhone: society.contactPhone || '',\r\n            bmcId: society.bmcId,\r\n            status: statusToUpdate\r\n          })\r\n        });\r\n      });\r\n\r\n      await Promise.all(updatePromises);\r\n      \r\n      console.log(`âœ… Successfully updated ${societyIds.length} societies to ${statusToUpdate}`);\r\n      \r\n      setSuccess(`Updated ${societyIds.length} ${societyIds.length === 1 ? 'society' : 'societies'} to ${statusToUpdate}!`);\r\n      await fetchSocieties();\r\n      setSelectedSocieties(new Set());\r\n      setTimeout(() => setSuccess(''), 3000);\r\n    } catch (error) {\r\n      console.error('Bulk update error:', error);\r\n      setError('Failed to update societies');\r\n      setTimeout(() => setError(''), 5000);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Handle bulk delete - show confirmation dialog\r\n  const handleBulkDeleteClick = () => {\r\n    if (selectedSocieties.size === 0) return;\r\n    setShowBulkDeleteConfirm(true);\r\n  };\r\n\r\n  // Handle select all societies\r\n  const handleSelectAll = () => {\r\n    const allSocietyIds = new Set(filteredSocieties.map(society => society.id));\r\n    setSelectedSocieties(allSocietyIds);\r\n  };\r\n\r\n  // Handle bulk delete with password confirmation\r\n  const handleBulkDeleteConfirm = async (password: string) => {\r\n    setShowBulkDeleteConfirm(false);\r\n    setIsDeletingBulk(true);\r\n\r\n    try {\r\n      const token = localStorage.getItem('authToken');\r\n      const societyIds = Array.from(selectedSocieties);\r\n\r\n      console.log(`ðŸ—‘ï¸ Bulk deleting ${societyIds.length} societies with password verification:`, societyIds);\r\n\r\n      // Delete societies in parallel with password verification\r\n      const deletePromises = societyIds.map(id => \r\n        fetch('/api/user/society/delete', {\r\n          method: 'DELETE',\r\n          headers: {\r\n            'Authorization': `Bearer ${token}`,\r\n            'Content-Type': 'application/json'\r\n          },\r\n          body: JSON.stringify({ id, password })\r\n        }).then(async (res) => {\r\n          if (!res.ok) {\r\n            const error = await res.json();\r\n            throw new Error(error.error || 'Delete failed');\r\n          }\r\n          return res.json();\r\n        })\r\n      );\r\n\r\n      const results = await Promise.allSettled(deletePromises);\r\n      const successful = results.filter(r => r.status === 'fulfilled').length;\r\n      const failed = results.filter(r => r.status === 'rejected').length;\r\n      \r\n      if (successful > 0) {\r\n        console.log(`âœ… Successfully deleted ${successful} societies`);\r\n        setSuccess(`Successfully deleted ${successful} ${successful === 1 ? 'society' : 'societies'}${failed > 0 ? `. ${failed} failed.` : ''}`);\r\n        await fetchSocieties();\r\n        setSelectedSocieties(new Set());\r\n        setTimeout(() => setSuccess(''), 5000);\r\n      } else {\r\n        console.error(`âŒ Failed to delete all ${societyIds.length} societies`);\r\n        setError('Failed to delete societies. Please check your password and try again.');\r\n        setTimeout(() => setError(''), 5000);\r\n      }\r\n    } catch (error) {\r\n      console.error('Bulk delete error:', error);\r\n      setError(error instanceof Error ? error.message : 'Failed to delete societies');\r\n      setTimeout(() => setError(''), 5000);\r\n    } finally {\r\n      setIsDeletingBulk(false);\r\n    }\r\n  };\r\n\r\n  // Add new society\r\n  const handleAddSociety = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setFormLoading(true);\r\n    setError('');\r\n\r\n    // Validate required fields\r\n    if (!formData.bmcId) {\r\n      setError('Please select a BMC');\r\n      setFormLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const token = localStorage.getItem('authToken');\r\n      const response = await fetch('/api/user/society', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({\r\n          ...formData,\r\n          bmcId: parseInt(formData.bmcId)\r\n        })\r\n      });\r\n\r\n      if (response.ok) {\r\n        setSuccess('Society added successfully!');\r\n        setShowAddForm(false);\r\n        setFormData(initialFormData);\r\n        await fetchSocieties();\r\n        \r\n        setTimeout(() => setSuccess(''), 3000);\r\n      } else {\r\n        const errorResponse = await response.json();\r\n        const errorMessage = errorResponse.error || 'Failed to add society';\r\n        \r\n        // Clear previous field errors\r\n        setFieldErrors({});\r\n        \r\n        // Check for specific field errors\r\n        if (errorMessage.toLowerCase().includes('society id') && errorMessage.toLowerCase().includes('already exists')) {\r\n          setFieldErrors({ societyId: 'This Society ID already exists' });\r\n        } else if (errorMessage.toLowerCase().includes('society name') && errorMessage.toLowerCase().includes('already exists')) {\r\n          setFieldErrors({ name: 'This Society name already exists' });\r\n        } else {\r\n          setError(errorMessage);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error adding society:', error);\r\n      setError('Failed to add society');\r\n    } finally {\r\n      setFormLoading(false);\r\n    }\r\n  };\r\n\r\n  // Edit society\r\n  const handleEditSociety = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!selectedSociety) return;\r\n\r\n    setFormLoading(true);\r\n    setError('');\r\n\r\n    // Validate required fields\r\n    if (!formData.bmcId) {\r\n      setError('Please select a BMC');\r\n      setFormLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const token = localStorage.getItem('authToken');\r\n      const updateData: {\r\n        id: number;\r\n        name: string;\r\n        location: string;\r\n        presidentName: string;\r\n        contactPhone: string;\r\n        email: string;\r\n        bmcId?: number;\r\n        status?: 'active' | 'inactive' | 'maintenance' | 'suspended';\r\n        password?: string;\r\n      } = {\r\n        id: selectedSociety.id,\r\n        name: formData.name,\r\n        location: formData.location,\r\n        presidentName: formData.presidentName,\r\n        contactPhone: formData.contactPhone,\r\n        email: formData.email,\r\n        bmcId: parseInt(formData.bmcId),\r\n        status: formData.status\r\n      };\r\n\r\n      // Only include password if it was changed from the original\r\n      if (formData.password && formData.password !== currentPassword) {\r\n        updateData.password = formData.password;\r\n      }\r\n\r\n      const response = await fetch('/api/user/society', {\r\n        method: 'PUT',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify(updateData)\r\n      });\r\n\r\n      if (response.ok) {\r\n        setSuccess('Society updated successfully!');\r\n        setShowEditForm(false);\r\n        setSelectedSociety(null);\r\n        setFormData(initialFormData);\r\n        await fetchSocieties();\r\n        \r\n        setTimeout(() => setSuccess(''), 3000);\r\n      } else {\r\n        const errorResponse = await response.json();\r\n        const errorMessage = errorResponse.error || 'Failed to update society';\r\n        \r\n        // Clear previous field errors\r\n        setFieldErrors({});\r\n        \r\n        // Check for specific field errors\r\n        if (errorMessage.toLowerCase().includes('society id') && errorMessage.toLowerCase().includes('already exists')) {\r\n          setFieldErrors({ societyId: 'This Society ID already exists' });\r\n        } else if (errorMessage.toLowerCase().includes('society name') && errorMessage.toLowerCase().includes('already exists')) {\r\n          setFieldErrors({ name: 'This Society name already exists' });\r\n        } else {\r\n          setError(errorMessage);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error updating society:', error);\r\n      setError('Failed to update society');\r\n    } finally {\r\n      setFormLoading(false);\r\n    }\r\n  };\r\n\r\n\r\n\r\n  // Delete society with OTP confirmation\r\n  const handleConfirmDelete = async (otp: string) => {\r\n    if (!selectedSociety) return;\r\n\r\n    setIsDeleting(true);\r\n    try {\r\n      const token = localStorage.getItem('authToken');\r\n      const response = await fetch(`/api/user/society/delete?id=${selectedSociety.id}&otp=${otp}`, {\r\n        method: 'DELETE',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        }\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (!response.ok) {\r\n        throw new Error(data.error || 'Failed to delete society');\r\n      }\r\n\r\n      setSuccess('Society and all related data deleted successfully!');\r\n      setShowDeleteModal(false);\r\n      setSelectedSociety(null);\r\n      await fetchSocieties();\r\n      setTimeout(() => setSuccess(''), 3000);\r\n    } catch (error) {\r\n      console.error('Error deleting society:', error);\r\n      setError(error instanceof Error ? error.message : 'Failed to delete society');\r\n      setTimeout(() => setError(''), 5000);\r\n    } finally {\r\n      setIsDeleting(false);\r\n    }\r\n  };\r\n\r\n  // Handle form input changes\r\n  const handleInputChange = (field: keyof SocietyFormData, value: string) => {\r\n    // Auto-prefix society ID with \"S-\" only for new societies (add form)\r\n    if (field === 'societyId' && showAddForm && !value.startsWith('S-') && value.length > 0) {\r\n      value = `S-${value.replace(/^S-/, '')}`;\r\n    }\r\n    \r\n    setFormData(prev => ({ ...prev, [field]: value }));\r\n    \r\n    // Clear field-specific errors when user types\r\n    if (fieldErrors[field as keyof typeof fieldErrors]) {\r\n      setFieldErrors(prev => ({\r\n        ...prev,\r\n        [field]: undefined\r\n      }));\r\n    }\r\n  };\r\n\r\n  // Open edit modal\r\n  const handleEditClick = async (society: Society) => {\r\n    setSelectedSociety(society);\r\n    setFieldErrors({}); // Clear field errors\r\n    setError(''); // Clear general errors\r\n    setShowPassword(false); // Reset password visibility\r\n    fetchBmcs(); // Load BMCs when opening edit form\r\n    \r\n    // Fetch current password from database\r\n    try {\r\n      const token = localStorage.getItem('authToken');\r\n      const response = await fetch(`/api/user/society/password?id=${society.id}`, {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`\r\n        }\r\n      });\r\n      \r\n      console.log('Password fetch response status:', response.status);\r\n      \r\n      if (response.ok) {\r\n        const result = await response.json();\r\n        console.log('Password fetch result:', result);\r\n        // Handle both wrapped (result.data.password) and direct (result.password) responses\r\n        const fetchedPassword = result.data?.password || result.password || '';\r\n        console.log('Fetched password:', fetchedPassword);\r\n        setCurrentPassword(fetchedPassword);\r\n        \r\n        // Set form data with fetched password\r\n        setFormData({\r\n          name: society.name,\r\n          societyId: society.societyId,\r\n          password: fetchedPassword,\r\n          location: society.location || '',\r\n          presidentName: society.presidentName || '',\r\n          contactPhone: society.contactPhone || '',\r\n          email: society.email || '',\r\n          bmcId: society.bmcId?.toString() || '',\r\n          status: society.status\r\n        });\r\n      } else {\r\n        const errorData = await response.json();\r\n        console.error('Password fetch failed:', errorData);\r\n        // Fallback if password fetch fails\r\n        setCurrentPassword('');\r\n        setFormData({\r\n          name: society.name,\r\n          societyId: society.societyId,\r\n          password: '',\r\n          location: society.location || '',\r\n          presidentName: society.presidentName || '',\r\n          contactPhone: society.contactPhone || '',\r\n          email: society.email || '',\r\n          bmcId: society.bmcId?.toString() || '',\r\n          status: society.status\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching password:', error);\r\n      setCurrentPassword('');\r\n      setFormData({\r\n        name: society.name,\r\n        societyId: society.societyId,\r\n        password: '',\r\n        location: society.location || '',\r\n        presidentName: society.presidentName || '',\r\n        contactPhone: society.contactPhone || '',\r\n        email: society.email || '',\r\n        bmcId: society.bmcId?.toString() || '',\r\n        status: society.status\r\n      });\r\n    }\r\n    \r\n    setShowEditForm(true);\r\n  };\r\n\r\n  // Open delete modal\r\n  const handleDeleteClick = (society: Society) => {\r\n    setSelectedSociety(society);\r\n    // Store society ID for OTP modal\r\n    (window as { selectedSocietyId?: number }).selectedSocietyId = society.id;\r\n    setShowDeleteModal(true);\r\n  };\r\n\r\n  // Handle status change\r\n  const handleStatusChange = async (society: Society, newStatus: 'active' | 'inactive' | 'maintenance' | 'suspended') => {\r\n    console.log('Status change triggered:', { societyId: society.id, currentStatus: society.status, newStatus });\r\n    \r\n    try {\r\n      setLoading(true);\r\n      const token = localStorage.getItem('authToken');\r\n      \r\n      const payload = {\r\n        id: society.id,\r\n        name: society.name,\r\n        societyId: society.societyId,\r\n        location: society.location || '',\r\n        presidentName: society.presidentName || '',\r\n        contactPhone: society.contactPhone || '',\r\n        bmcId: society.bmcId,\r\n        status: newStatus\r\n      };\r\n      \r\n      console.log('Sending update request:', payload);\r\n      \r\n      const response = await fetch('/api/user/society', {\r\n        method: 'PUT',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify(payload)\r\n      });\r\n\r\n      const result = await response.json();\r\n      console.log('API response:', { status: response.status, data: result });\r\n\r\n      if (response.ok) {\r\n        setSuccess(`Status updated to ${newStatus}!`);\r\n        await fetchSocieties();\r\n        setTimeout(() => setSuccess(''), 3000);\r\n      } else {\r\n        const errorMessage = result.error || 'Failed to update status';\r\n        console.error('Update failed:', errorMessage);\r\n        setError(errorMessage);\r\n        setTimeout(() => setError(''), 5000);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error updating status:', error);\r\n      setError('Failed to update status');\r\n      setTimeout(() => setError(''), 5000);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Filter societies based on search term and status\r\n  const filteredSocieties = societies.filter(society => {\r\n    const matchesSearch = searchQuery === '' ||\r\n                         society.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n                         society.societyId.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n                         society.presidentName?.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n                         society.location?.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n                         society.contactPhone?.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n                         society.bmcName?.toLowerCase().includes(searchQuery.toLowerCase());\r\n    \r\n    const matchesStatus = statusFilter === 'all' || society.status === statusFilter;\r\n    \r\n    // Find the BMC for this society\r\n    const societyBmc = bmcs.find(b => b.id === society.bmcId);\r\n    \r\n    // Filter by BMC if bmcFilter is set\r\n    const matchesBmc = bmcFilter.length === 0 || bmcFilter.includes(societyBmc?.id.toString() || '');\r\n    \r\n    // Filter by Dairy - if dairy is selected, check if the society's BMC belongs to that dairy\r\n    const matchesDairy = dairyFilter.length === 0 || \r\n                        (societyBmc?.dairyFarmId ? dairyFilter.includes(societyBmc.dairyFarmId.toString()) : false);\r\n    \r\n    return matchesSearch && matchesStatus && matchesBmc && matchesDairy;\r\n  });\r\n\r\n  useEffect(() => {\r\n    fetchSocieties();\r\n    fetchDairies();\r\n    fetchBmcs();\r\n    fetchPulseData();\r\n    \r\n    // Apply BMC filter from URL if present\r\n    const bmcFilterParam = searchParams.get('bmcFilter');\r\n    if (bmcFilterParam) {\r\n      setBmcFilter([bmcFilterParam]);\r\n    }\r\n    \r\n    // Apply Dairy filter from URL if present\r\n    const dairyFilterParam = searchParams.get('dairyFilter');\r\n    if (dairyFilterParam) {\r\n      setDairyFilter([dairyFilterParam]);\r\n    }\r\n    \r\n    // Poll pulse data every 30 seconds for live updates\r\n    const pulseInterval = setInterval(() => {\r\n      fetchPulseData();\r\n    }, 30000); // 30 seconds\r\n    \r\n    return () => clearInterval(pulseInterval);\r\n  }, [fetchSocieties, fetchDairies, fetchBmcs, fetchPulseData, searchParams]);\r\n\r\n  // Listen for global search events from header\r\n  useEffect(() => {\r\n    const handleGlobalSearch = (event: Event) => {\r\n      const customEvent = event as CustomEvent;\r\n      const query = customEvent.detail?.query || '';\r\n      setSearchQuery(query);\r\n    };\r\n    window.addEventListener('globalSearch', handleGlobalSearch);\r\n    return () => window.removeEventListener('globalSearch', handleGlobalSearch);\r\n  }, []);\r\n\r\n  // Don't render until user is loaded from context\r\n  if (!user) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900\">\r\n        <FlowerSpinner size={48} />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n    <div className=\"p-4 sm:p-6 lg:p-8 space-y-4 sm:space-y-6 lg:pb-8\">\r\n      {/* Page Header */}\r\n      <PageHeader\r\n        title=\"Society Management\"\r\n        subtitle=\"Manage societies and their operations\"\r\n        icon={<Users className=\"w-5 h-5 sm:w-6 sm:h-6\" />}\r\n        onRefresh={fetchSocieties}\r\n      />\r\n\r\n      {/* Success/Error Messages */}\r\n      <StatusMessage \r\n        success={success} \r\n        error={error}\r\n      />\r\n\r\n      {/* Top Performers Section */}\r\n      {societies.length > 0 && (() => {\r\n        const societiesWithStats = societies.filter(s => s.totalQuantity30d && s.totalQuantity30d > 0);\r\n        \r\n        const topCollection = [...societiesWithStats].sort((a, b) => \r\n          (b.totalQuantity30d || 0) - (a.totalQuantity30d || 0)\r\n        )[0];\r\n        \r\n        const topRevenue = [...societiesWithStats].sort((a, b) => \r\n          (b.totalAmount30d || 0) - (a.totalAmount30d || 0)\r\n        )[0];\r\n        \r\n        const topFat = [...societiesWithStats].sort((a, b) => \r\n          (b.weightedFat30d || 0) - (a.weightedFat30d || 0)\r\n        )[0];\r\n        \r\n        const topSnf = [...societiesWithStats].sort((a, b) => \r\n          (b.weightedSnf30d || 0) - (a.weightedSnf30d || 0)\r\n        )[0];\r\n        \r\n        const mostCollections = [...societiesWithStats].sort((a, b) => \r\n          (b.totalCollections30d || 0) - (a.totalCollections30d || 0)\r\n        )[0];\r\n        \r\n        const mostWater = [...societiesWithStats].sort((a, b) => \r\n          (b.weightedWater30d || 0) - (a.weightedWater30d || 0)\r\n        )[0];\r\n\r\n        return (\r\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-3 sm:gap-4\">\r\n            {topCollection && (\r\n              <div \r\n                className=\"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 p-4 rounded-lg border border-green-200 dark:border-green-700 cursor-pointer hover:shadow-lg transition-shadow\"\r\n                onClick={() => {\r\n                  setGraphMetric('quantity');\r\n                  setShowGraphModal(true);\r\n                }}\r\n              >\r\n                <div className=\"flex items-center justify-between mb-2\">\r\n                  <h3 className=\"text-sm font-semibold text-green-900 dark:text-green-100\">Top Collection (30d)</h3>\r\n                  <Users className=\"w-5 h-5 text-green-600 dark:text-green-400\" />\r\n                </div>\r\n                <p className=\"text-lg font-bold text-green-800 dark:text-green-200\">{topCollection.name}</p>\r\n                <p className=\"text-sm text-green-600 dark:text-green-400\">{topCollection.totalQuantity30d?.toFixed(2)} L</p>\r\n              </div>\r\n            )}\r\n            \r\n            {topRevenue && (\r\n              <div \r\n                className=\"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 p-4 rounded-lg border border-blue-200 dark:border-blue-700 cursor-pointer hover:shadow-lg transition-shadow\"\r\n                onClick={() => {\r\n                  setGraphMetric('revenue');\r\n                  setShowGraphModal(true);\r\n                }}\r\n              >\r\n                <div className=\"flex items-center justify-between mb-2\">\r\n                  <h3 className=\"text-sm font-semibold text-blue-900 dark:text-blue-100\">Top Revenue (30d)</h3>\r\n                  <Building2 className=\"w-5 h-5 text-blue-600 dark:text-blue-400\" />\r\n                </div>\r\n                <p className=\"text-lg font-bold text-blue-800 dark:text-blue-200\">{topRevenue.name}</p>\r\n                <p className=\"text-sm text-blue-600 dark:text-blue-400\">â‚¹{topRevenue.totalAmount30d?.toFixed(2)}</p>\r\n              </div>\r\n            )}\r\n            \r\n            {topFat && (\r\n              <div \r\n                className=\"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-800/20 p-4 rounded-lg border border-purple-200 dark:border-purple-700 cursor-pointer hover:shadow-lg transition-shadow\"\r\n                onClick={() => {\r\n                  setGraphMetric('fat');\r\n                  setShowGraphModal(true);\r\n                }}\r\n              >\r\n                <div className=\"flex items-center justify-between mb-2\">\r\n                  <h3 className=\"text-sm font-semibold text-purple-900 dark:text-purple-100\">Best Quality (30d)</h3>\r\n                  <Eye className=\"w-5 h-5 text-purple-600 dark:text-purple-400\" />\r\n                </div>\r\n                <p className=\"text-lg font-bold text-purple-800 dark:text-purple-200\">{topFat.name}</p>\r\n                <p className=\"text-sm text-purple-600 dark:text-purple-400\">{topFat.weightedFat30d?.toFixed(2)}% Fat</p>\r\n              </div>\r\n            )}\r\n            \r\n            {topSnf && (\r\n              <div \r\n                className=\"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-800/20 p-4 rounded-lg border border-orange-200 dark:border-orange-700 cursor-pointer hover:shadow-lg transition-shadow\"\r\n                onClick={() => {\r\n                  setGraphMetric('snf');\r\n                  setShowGraphModal(true);\r\n                }}\r\n              >\r\n                <div className=\"flex items-center justify-between mb-2\">\r\n                  <h3 className=\"text-sm font-semibold text-orange-900 dark:text-orange-100\">Best SNF (30d)</h3>\r\n                  <TrendingUp className=\"w-5 h-5 text-orange-600 dark:text-orange-400\" />\r\n                </div>\r\n                <p className=\"text-lg font-bold text-orange-800 dark:text-orange-200\">{topSnf.name}</p>\r\n                <p className=\"text-sm text-orange-600 dark:text-orange-400\">{topSnf.weightedSnf30d?.toFixed(2)}% SNF</p>\r\n              </div>\r\n            )}\r\n            \r\n            {mostCollections && (\r\n              <div \r\n                className=\"bg-gradient-to-br from-pink-50 to-pink-100 dark:from-pink-900/20 dark:to-pink-800/20 p-4 rounded-lg border border-pink-200 dark:border-pink-700 cursor-pointer hover:shadow-lg transition-shadow\"\r\n                onClick={() => {\r\n                  setGraphMetric('collections');\r\n                  setShowGraphModal(true);\r\n                }}\r\n              >\r\n                <div className=\"flex items-center justify-between mb-2\">\r\n                  <h3 className=\"text-sm font-semibold text-pink-900 dark:text-pink-100\">Most Active (30d)</h3>\r\n                  <Award className=\"w-5 h-5 text-pink-600 dark:text-pink-400\" />\r\n                </div>\r\n                <p className=\"text-lg font-bold text-pink-800 dark:text-pink-200\">{mostCollections.name}</p>\r\n                <p className=\"text-sm text-pink-600 dark:text-pink-400\">{mostCollections.totalCollections30d} Collections</p>\r\n              </div>\r\n            )}\r\n            \r\n            {mostWater && (\r\n              <div \r\n                className=\"bg-gradient-to-br from-red-50 to-red-100 dark:from-red-900/20 dark:to-red-800/20 p-4 rounded-lg border border-red-200 dark:border-red-700 cursor-pointer hover:shadow-lg transition-shadow\"\r\n                onClick={() => {\r\n                  setGraphMetric('water');\r\n                  setShowGraphModal(true);\r\n                }}\r\n              >\r\n                <div className=\"flex items-center justify-between mb-2\">\r\n                  <h3 className=\"text-sm font-semibold text-red-900 dark:text-red-100\">Most Water (30d)</h3>\r\n                  <Droplets className=\"w-5 h-5 text-red-600 dark:text-red-400\" />\r\n                </div>\r\n                <p className=\"text-lg font-bold text-red-800 dark:text-red-200\">{mostWater.name}</p>\r\n                <p className=\"text-sm text-red-600 dark:text-red-400\">{mostWater.weightedWater30d?.toFixed(2)}% Water</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        );\r\n      })()}\r\n\r\n      {/* Filter Controls */}\r\n      {/* FilterDropdown for Dairy and BMC */}\r\n      <FilterDropdown\r\n        statusFilter={statusFilter}\r\n        onStatusChange={(value) => setStatusFilter(value as typeof statusFilter)}\r\n        dairyFilter={dairyFilter}\r\n        onDairyChange={(value) => setDairyFilter(Array.isArray(value) ? value : [value])}\r\n        bmcFilter={bmcFilter}\r\n        onBmcChange={(value) => setBmcFilter(Array.isArray(value) ? value : [value])}\r\n        societyFilter={[]}\r\n        onSocietyChange={() => {}}\r\n        machineFilter={[]}\r\n        onMachineChange={() => {}}\r\n        dairies={dairies}\r\n        bmcs={bmcs}\r\n        societies={societies.map(s => ({ ...s, bmc_id: s.bmcId, society_id: s.societyId }))}\r\n        machines={[]}\r\n        filteredCount={filteredSocieties.length}\r\n        totalCount={societies.length}\r\n        searchQuery={searchQuery}\r\n        hideMainFilterButton={true}\r\n        hideSocietyFilter={true}\r\n      />\r\n\r\n      <FilterControls\r\n        icon={<Users className=\"w-4 h-4\" />}\r\n        showingText={`Showing ${filteredSocieties.length} of ${societies.length} societies`}\r\n        filterValue={statusFilter}\r\n        filterOptions={[\r\n          { value: 'all', label: 'All Status' },\r\n          { value: 'active', label: 'Active' },\r\n          { value: 'inactive', label: 'Inactive' },\r\n          { value: 'maintenance', label: 'Maintenance' },\r\n          { value: 'suspended', label: 'Suspended' }\r\n        ]}\r\n        onFilterChange={(value) => setStatusFilter(value as typeof statusFilter)}\r\n      />\r\n\r\n      {/* Main Content */}\r\n      {loading ? (\r\n        <LoadingSpinner />\r\n      ) : filteredSocieties.length > 0 ? (\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-6\">\r\n          {filteredSocieties.map((society) => (\r\n            <div key={society.id} className=\"bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-lg transition-all duration-200 overflow-visible border border-gray-200 dark:border-gray-700 hover:border-green-200 dark:hover:border-green-700 relative z-10 hover:z-20\">\r\n              {/* Header */}\r\n              <div className=\"bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 p-4 border-b border-gray-200 dark:border-gray-700 rounded-t-lg\">\r\n                <div className=\"flex items-start justify-between gap-3\">\r\n                  <div className=\"flex items-center gap-3 flex-1 min-w-0\">\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={selectedSocieties.has(society.id)}\r\n                      onChange={() => handleSelectSociety(society.id)}\r\n                      onClick={(e) => e.stopPropagation()}\r\n                      className=\"w-4 h-4 text-green-600 bg-gray-100 border-gray-300 rounded focus:ring-green-500 dark:focus:ring-green-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600 flex-shrink-0\"\r\n                    />\r\n                    <div className=\"p-2 bg-gradient-to-r from-green-100 to-emerald-100 dark:from-green-900/30 dark:to-emerald-900/30 rounded-lg flex-shrink-0\">\r\n                      <Building2 className=\"w-5 h-5 text-green-600 dark:text-green-400\" />\r\n                    </div>\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white truncate\">{highlightText(society.name, searchQuery)}</h3>\r\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400\">{highlightText(society.societyId, searchQuery)}</p>\r\n                    </div>\r\n                  </div>\r\n                  <StatusDropdown\r\n                    currentStatus={society.status}\r\n                    onStatusChange={(status) => handleStatusChange(society, status as 'active' | 'inactive' | 'maintenance' | 'suspended')}\r\n                    options={[\r\n                      {\r\n                        status: 'active',\r\n                        label: 'Active',\r\n                        color: 'bg-green-500',\r\n                        bgColor: 'hover:bg-green-50 dark:hover:bg-green-900/30'\r\n                      },\r\n                      {\r\n                        status: 'inactive',\r\n                        label: 'Inactive',\r\n                        color: 'bg-red-500',\r\n                        bgColor: 'hover:bg-red-50 dark:hover:bg-red-900/30'\r\n                      },\r\n                      {\r\n                        status: 'maintenance',\r\n                        label: 'Maintenance',\r\n                        color: 'bg-yellow-500',\r\n                        bgColor: 'hover:bg-yellow-50 dark:hover:bg-yellow-900/30'\r\n                      },\r\n                      {\r\n                        status: 'suspended',\r\n                        label: 'Suspended',\r\n                        color: 'bg-orange-500',\r\n                        bgColor: 'hover:bg-orange-50 dark:hover:bg-orange-900/30'\r\n                      }\r\n                    ]}\r\n                    compact={true}\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              {/* Content */}\r\n              <div className=\"p-4 space-y-3\">\r\n                {/* Basic Info - Two Columns */}\r\n                <div className=\"grid grid-cols-2 gap-3\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <User className=\"w-4 h-4 text-gray-500 flex-shrink-0\" />\r\n                    <span className=\"text-sm text-gray-700 dark:text-gray-300 truncate\">{highlightText(society.presidentName || 'No President', searchQuery)}</span>\r\n                  </div>\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <Phone className=\"w-4 h-4 text-gray-500 flex-shrink-0\" />\r\n                    <span className=\"text-sm text-gray-700 dark:text-gray-300 truncate\">{highlightText(society.contactPhone || 'No Phone', searchQuery)}</span>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Location & BMC - Two Columns */}\r\n                <div className=\"grid grid-cols-2 gap-3\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <MapPin className=\"w-4 h-4 text-gray-500 flex-shrink-0\" />\r\n                    <span className=\"text-sm text-gray-700 dark:text-gray-300 truncate\">{highlightText(society.location || 'No Location', searchQuery)}</span>\r\n                  </div>\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <Building2 className=\"w-4 h-4 text-blue-500 flex-shrink-0\" />\r\n                    <span className=\"text-sm text-blue-600 dark:text-blue-400 font-medium truncate\">{highlightText(society.bmcName || 'No BMC', searchQuery)}</span>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Divider */}\r\n                <div className=\"border-t border-gray-200 dark:border-gray-700 my-3\"></div>\r\n\r\n                {/* 30-Day Statistics Header */}\r\n                <div className=\"flex items-center justify-between\">\r\n                  <span className=\"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide\">Last 30 Days</span>\r\n                  <Calendar className=\"w-4 h-4 text-gray-400\" />\r\n                </div>\r\n\r\n                {/* Collections & Quantity */}\r\n                <div className=\"flex items-center justify-between bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <div className=\"w-2 h-2 rounded-full bg-blue-500\"></div>\r\n                    <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">Collections</span>\r\n                  </div>\r\n                  <div className=\"text-right\">\r\n                    <div className=\"text-lg font-bold text-blue-600 dark:text-blue-400\">{society.totalCollections30d || 0}</div>\r\n                    <div className=\"text-xs text-gray-600 dark:text-gray-400\">{(society.totalQuantity30d || 0).toFixed(2)} Liters</div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Quality Metrics - Three Columns */}\r\n                <div className=\"grid grid-cols-3 gap-2\">\r\n                  <div className=\"bg-indigo-50 dark:bg-indigo-900/20 rounded-lg p-2 text-center\">\r\n                    <div className=\"text-xs text-gray-600 dark:text-gray-400 mb-1\">Fat</div>\r\n                    <div className=\"text-sm font-bold text-indigo-600 dark:text-indigo-400\">{(society.weightedFat30d || 0).toFixed(2)}%</div>\r\n                  </div>\r\n                  <div className=\"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-2 text-center\">\r\n                    <div className=\"text-xs text-gray-600 dark:text-gray-400 mb-1\">SNF</div>\r\n                    <div className=\"text-sm font-bold text-purple-600 dark:text-purple-400\">{(society.weightedSnf30d || 0).toFixed(2)}%</div>\r\n                  </div>\r\n                  <div className=\"bg-pink-50 dark:bg-pink-900/20 rounded-lg p-2 text-center\">\r\n                    <div className=\"text-xs text-gray-600 dark:text-gray-400 mb-1\">CLR</div>\r\n                    <div className=\"text-sm font-bold text-pink-600 dark:text-pink-400\">{(society.weightedClr30d || 0).toFixed(1)}</div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Revenue */}\r\n                <div className=\"flex items-center justify-between bg-emerald-50 dark:bg-emerald-900/20 rounded-lg p-3\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <div className=\"w-2 h-2 rounded-full bg-emerald-500\"></div>\r\n                    <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">Total Revenue</span>\r\n                  </div>\r\n                  <div className=\"text-lg font-bold text-emerald-600 dark:text-emerald-400\">\r\n                    â‚¹{(society.totalAmount30d || 0).toLocaleString('en-IN', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Footer Actions */}\r\n              <div className=\"bg-white dark:bg-gray-800 px-4 py-3 border-t border-gray-100 dark:border-gray-700 flex items-center justify-between gap-2 rounded-b-lg\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <button\r\n                    onClick={() => handleEditClick(society)}\r\n                    className=\"p-2 text-gray-400 dark:text-gray-500 hover:text-green-600 dark:hover:text-green-400 transition-colors rounded-lg hover:bg-green-50 dark:hover:bg-green-900/30\"\r\n                    title=\"Edit\"\r\n                  >\r\n                    <Edit3 className=\"w-4 h-4\" />\r\n                  </button>\r\n                  <button\r\n                    onClick={() => handleDeleteClick(society)}\r\n                    className=\"p-2 text-gray-400 dark:text-gray-500 hover:text-red-600 dark:hover:text-red-400 transition-colors rounded-lg hover:bg-red-50 dark:hover:bg-red-900/30\"\r\n                    title=\"Delete\"\r\n                  >\r\n                    <Trash2 className=\"w-4 h-4\" />\r\n                  </button>\r\n                  \r\n                  {/* Pulse Indicator - ECG Style */}\r\n                  {(() => {\r\n                    const societyPulse = pulseData?.pulses?.find(p => p.societyId === society.id);\r\n                    const hasActivePulse = societyPulse?.pulseStatus === 'active';\r\n                    const hasPausedPulse = societyPulse?.pulseStatus === 'paused';\r\n                    const hasEndedPulse = societyPulse?.pulseStatus === 'ended';\r\n                    const isInactive = societyPulse?.pulseStatus === 'inactive';\r\n                    \r\n                    // Determine color based on status\r\n                    const getColor = () => {\r\n                      if (hasActivePulse) return 'text-green-500';\r\n                      if (hasPausedPulse) return 'text-orange-500';\r\n                      if (hasEndedPulse) return 'text-red-500';\r\n                      if (isInactive) return 'text-gray-400';\r\n                      return 'text-gray-300';\r\n                    };\r\n                    \r\n                    // Determine status text\r\n                    const getStatusText = () => {\r\n                      if (hasActivePulse) return 'Active';\r\n                      if (hasPausedPulse) return 'Paused';\r\n                      if (hasEndedPulse) return 'Ended';\r\n                      if (isInactive) return `${societyPulse.inactiveDays}d`;\r\n                      return 'No Pulse';\r\n                    };\r\n                    \r\n                    // Generate tooltip with section start time from database\r\n                    const getTooltip = () => {\r\n                      if (!societyPulse) return 'No Pulse';\r\n                      \r\n                      const formatDateTime = (dateTime: Date | string | null | undefined, addOffset = false) => {\r\n                        if (!dateTime) return 'N/A';\r\n                        const str = dateTime.toString();\r\n                        const dateMatch = str.match(/(\\d{4})-(\\d{2})-(\\d{2})/);\r\n                        const timeMatch = str.match(/(\\d{2}):(\\d{2}):(\\d{2})/);\r\n                        if (dateMatch && timeMatch) {\r\n                          let hours = parseInt(timeMatch[1]);\r\n                          let minutes = parseInt(timeMatch[2]);\r\n                          const seconds = timeMatch[3];\r\n\r\n                          if (addOffset) {\r\n                            // Add 5 hours 30 minutes\r\n                            minutes += 30;\r\n                            hours += 5;\r\n                            if (minutes >= 60) {\r\n                              hours += 1;\r\n                              minutes -= 60;\r\n                            }\r\n                            if (hours >= 24) {\r\n                              hours -= 24;\r\n                            }\r\n                          }\r\n\r\n                          const formattedHours = hours.toString().padStart(2, '0');\r\n                          const formattedMinutes = minutes.toString().padStart(2, '0');\r\n                          return `${dateMatch[1]}-${dateMatch[2]}-${dateMatch[3]} ${formattedHours}:${formattedMinutes}:${seconds}`;\r\n                        }\r\n                        return 'N/A';\r\n                      };\r\n\r\n                      const startTime = formatDateTime(societyPulse.createdAt);\r\n                      const lastCollection = formatDateTime(societyPulse.lastCollectionTime, true); // Add +5:30 for pause time\r\n                      const endTime = formatDateTime(societyPulse.sectionEndTime);\r\n\r\n                      // Active: Show only start time\r\n                      if (societyPulse.pulseStatus === 'active') {\r\n                        return `Section Start: ${startTime}`;\r\n                      }\r\n\r\n                      // Paused: Show start time and paused time (last collection time + 5:30)\r\n                      if (societyPulse.pulseStatus === 'paused') {\r\n                        return `Start: ${startTime}\\nPaused: ${lastCollection}`;\r\n                      }\r\n\r\n                      // Ended: Show start time and end time\r\n                      if (societyPulse.pulseStatus === 'ended') {\r\n                        return `Start: ${startTime}\\nEnd: ${endTime}`;\r\n                      }\r\n\r\n                      // Inactive or other statuses\r\n                      if (societyPulse.createdAt) {\r\n                        return `Section Start: ${startTime}`;\r\n                      }\r\n                      \r\n                      return societyPulse.statusMessage || getStatusText();\r\n                    };\r\n                    \r\n                    return (\r\n                      <div \r\n                        className=\"flex items-center gap-1.5 ml-2 pl-2 border-l border-gray-200 dark:border-gray-700\" \r\n                        title={getTooltip()}\r\n                      >\r\n                        {/* ECG Wave or Flatline */}\r\n                        <svg \r\n                          className={`w-6 h-4 ${getColor()}`} \r\n                          viewBox=\"0 0 24 16\" \r\n                          fill=\"none\" \r\n                          xmlns=\"http://www.w3.org/2000/svg\"\r\n                        >\r\n                          {hasActivePulse ? (\r\n                            // ECG waveform for active pulse\r\n                            <path\r\n                              d=\"M0 8 L5 8 L6 3 L7 13 L8 8 L10 8 L11 5 L12 11 L13 8 L24 8\"\r\n                              stroke=\"currentColor\"\r\n                              strokeWidth=\"1.5\"\r\n                              strokeLinecap=\"round\"\r\n                              strokeLinejoin=\"round\"\r\n                              className=\"animate-pulse\"\r\n                            />\r\n                          ) : (\r\n                            // Flatline for no pulse/ended/inactive\r\n                            <path\r\n                              d=\"M0 8 L24 8\"\r\n                              stroke=\"currentColor\"\r\n                              strokeWidth=\"1.5\"\r\n                              strokeLinecap=\"round\"\r\n                            />\r\n                          )}\r\n                        </svg>\r\n                        <span className={`text-xs ${getColor()}`}>\r\n                          {getStatusText()}\r\n                        </span>\r\n                      </div>\r\n                    );\r\n                  })()}\r\n                </div>\r\n                <button\r\n                  onClick={() => router.push(`/admin/society/${society.id}`)}\r\n                  className=\"flex items-center px-3 py-1.5 text-sm text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/30 rounded-lg transition-colors\"\r\n                >\r\n                  <Eye className=\"w-4 h-4 mr-1\" />\r\n                  <span>View</span>\r\n                </button>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      ) : (\r\n        <EmptyState\r\n          icon={<Users className=\"w-12 h-12 sm:w-16 sm:h-16 text-gray-400\" />}\r\n          title={societies.length === 0 ? 'No societies found' : 'No matching societies'}\r\n          message={societies.length === 0 \r\n            ? 'Get started by adding your first society to the system.'\r\n            : 'Try changing your search or filter criteria.'\r\n          }\r\n          actionText={societies.length === 0 ? 'Add First Society' : undefined}\r\n          onAction={societies.length === 0 ? () => {\r\n            setFieldErrors({}); // Clear field errors\r\n            setError(''); // Clear general errors\r\n            setShowAddForm(true);\r\n            fetchBmcs();\r\n          } : undefined}\r\n          showAction={societies.length === 0}\r\n        />\r\n      )}\r\n      </div>\r\n\r\n      {/* Bulk Actions Toolbar */}\r\n      <BulkActionsToolbar\r\n        selectedCount={selectedSocieties.size}\r\n        totalCount={filteredSocieties.length}\r\n        onBulkDelete={handleBulkDeleteClick}\r\n        onBulkStatusUpdate={handleBulkStatusUpdate}\r\n        onSelectAll={handleSelectAll}\r\n        onClearSelection={() => {\r\n          setSelectedSocieties(new Set());\r\n        }}\r\n        itemType=\"society\"\r\n        showStatusUpdate={true}\r\n        currentBulkStatus={bulkStatus}\r\n        onBulkStatusChange={(status) => setBulkStatus(status as typeof bulkStatus)}\r\n      />\r\n\r\n      {/* Floating Action Button */}\r\n      <FloatingActionButton\r\n        actions={[\r\n          {\r\n            icon: <Plus className=\"w-6 h-6 text-white\" />,\r\n            label: 'Add Society',\r\n            onClick: () => {\r\n              setFieldErrors({});\r\n              setError('');\r\n              setShowAddForm(true);\r\n              fetchBmcs();\r\n            },\r\n            color: 'bg-gradient-to-br from-blue-500 to-blue-600'\r\n          }\r\n        ]}\r\n        directClick={true}\r\n      />\r\n\r\n      {/* Add Society Modal - Positioned outside main container */}\r\n      <FormModal\r\n        isOpen={showAddForm}\r\n        onClose={() => setShowAddForm(false)}\r\n        title=\"Add New Society\"\r\n        maxWidth=\"lg\"\r\n      >\r\n        <form onSubmit={handleAddSociety} className=\"space-y-4 sm:space-y-6\">\r\n          <FormGrid>\r\n            {/* Mandatory Fields First */}\r\n            <FormInput\r\n              label=\"Society Name\"\r\n              value={formData.name}\r\n              onChange={(value) => handleInputChange('name', value)}\r\n              placeholder=\"Enter society name\"\r\n              required\r\n              error={fieldErrors.name}\r\n              colSpan={1}\r\n            />\r\n\r\n            <FormInput\r\n              label=\"Society ID\"\r\n              value={formData.societyId}\r\n              onChange={(value) => handleInputChange('societyId', value)}\r\n              placeholder=\"S-001\"\r\n              required\r\n              error={fieldErrors.societyId}\r\n              colSpan={1}\r\n            />\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                Password <span className=\"text-red-500\">*</span>\r\n              </label>\r\n              <div className=\"relative\">\r\n                <input\r\n                  type={showAddPassword ? 'text' : 'password'}\r\n                  value={formData.password}\r\n                  onChange={(e) => handleInputChange('password', e.target.value)}\r\n                  placeholder=\"Enter password\"\r\n                  required\r\n                  className=\"form-input-custom w-full px-3 sm:px-4 py-2 sm:py-2.5 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-blue-500 dark:focus:border-blue-400 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-all duration-200 focus:outline-none\"\r\n                />\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setShowAddPassword(!showAddPassword)}\r\n                  className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-colors\"\r\n                  title={showAddPassword ? 'Hide password' : 'Show password'}\r\n                >\r\n                  {showAddPassword ? <EyeOff className=\"w-5 h-5\" /> : <Eye className=\"w-5 h-5\" />}\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            <FormSelect\r\n              label=\"Associated BMC\"\r\n              value={formData.bmcId}\r\n              onChange={(value) => handleInputChange('bmcId', value)}\r\n              options={bmcs.map(bmc => ({ \r\n                value: bmc.id, \r\n                label: `${bmc.name} (${bmc.bmcId})` \r\n              }))}\r\n              placeholder=\"Select BMC\"\r\n              required\r\n              disabled={bmcsLoading}\r\n              colSpan={1}\r\n            />\r\n\r\n            {/* Optional Fields */}\r\n            <FormInput\r\n              label=\"President Name\"\r\n              value={formData.presidentName}\r\n              onChange={(value) => handleInputChange('presidentName', value)}\r\n              placeholder=\"Enter president name\"\r\n              colSpan={1}\r\n            />\r\n\r\n            <FormInput\r\n              label=\"Location\"\r\n              value={formData.location}\r\n              onChange={(value) => handleInputChange('location', value)}\r\n              placeholder=\"Enter location\"\r\n              colSpan={1}\r\n            />\r\n\r\n            <FormInput\r\n              label=\"Contact Phone\"\r\n              type=\"tel\"\r\n              value={formData.contactPhone}\r\n              onChange={(value) => {\r\n                const formatted = formatPhoneInput(value);\r\n                handleInputChange('contactPhone', formatted);\r\n              }}\r\n              onBlur={() => {\r\n                const error = validatePhoneOnBlur(formData.contactPhone);\r\n                if (error) {\r\n                  setFieldErrors(prev => ({ ...prev, contactPhone: error }));\r\n                } else {\r\n                  setFieldErrors(prev => ({ ...prev, contactPhone: undefined }));\r\n                }\r\n              }}\r\n              placeholder=\"Enter phone number\"\r\n              error={fieldErrors.contactPhone}\r\n              colSpan={1}\r\n            />\r\n\r\n            <FormInput\r\n              label=\"Email Address\"\r\n              type=\"email\"\r\n              value={formData.email}\r\n              onChange={(value) => {\r\n                const formatted = formatEmailInput(value);\r\n                handleInputChange('email', formatted);\r\n              }}\r\n              onBlur={() => {\r\n                const error = validateEmailOnBlur(formData.email);\r\n                if (error) {\r\n                  setFieldErrors(prev => ({ ...prev, email: error }));\r\n                } else {\r\n                  setFieldErrors(prev => ({ ...prev, email: undefined }));\r\n                }\r\n              }}\r\n              placeholder=\"Enter email address\"\r\n              error={fieldErrors.email}\r\n              required\r\n              colSpan={1}\r\n            />\r\n\r\n            <FormSelect\r\n              label=\"Status\"\r\n              value={formData.status}\r\n              onChange={(value) => handleInputChange('status', value)}\r\n              options={[\r\n                { value: 'active', label: 'Active' },\r\n                { value: 'inactive', label: 'Inactive' },\r\n                { value: 'maintenance', label: 'Maintenance' },\r\n                { value: 'suspended', label: 'Suspended' }\r\n              ]}\r\n              colSpan={1}\r\n            />\r\n          </FormGrid>\r\n\r\n          <FormActions\r\n            onCancel={() => setShowAddForm(false)}\r\n            submitText=\"Add Society\"\r\n            isLoading={formLoading}\r\n          />\r\n        </form>\r\n      </FormModal>\r\n\r\n      {/* Edit Society Modal */}\r\n      <FormModal\r\n        isOpen={showEditForm && !!selectedSociety}\r\n        onClose={() => {\r\n          setShowEditForm(false);\r\n          setSelectedSociety(null);\r\n          setFormData(initialFormData);\r\n        }}\r\n        title={selectedSociety ? `${t.common?.edit || 'Edit'} ${selectedSociety.name}` : (t.common?.edit || 'Edit')}\r\n        maxWidth=\"lg\"\r\n      >\r\n        <form onSubmit={handleEditSociety} className=\"space-y-4 sm:space-y-6\">\r\n          <FormGrid>\r\n            {/* Mandatory Fields First */}\r\n            <FormInput\r\n              label=\"Society Name\"\r\n              value={formData.name}\r\n              onChange={(value) => handleInputChange('name', value)}\r\n              placeholder=\"Enter society name\"\r\n              required\r\n              error={fieldErrors.name}\r\n              colSpan={1}\r\n            />\r\n\r\n            <FormInput\r\n              label=\"Society ID\"\r\n              value={formData.societyId}\r\n              onChange={() => {}}\r\n              readOnly\r\n              disabled\r\n              colSpan={1}\r\n            />\r\n\r\n            <FormSelect\r\n              label=\"Associated BMC\"\r\n              value={formData.bmcId}\r\n              onChange={(value) => handleInputChange('bmcId', value)}\r\n              options={bmcs.map(bmc => ({ \r\n                value: bmc.id, \r\n                label: `${bmc.name} (${bmc.bmcId})` \r\n              }))}\r\n              placeholder=\"Select BMC\"\r\n              required\r\n              disabled={true}\r\n              colSpan={2}\r\n            />\r\n\r\n            {/* Optional Fields */}\r\n            <div className=\"sm:col-span-2\">\r\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                Password\r\n              </label>\r\n              <div className=\"relative\">\r\n                <input\r\n                  type={showPassword ? 'text' : 'password'}\r\n                  value={formData.password}\r\n                  onChange={(e) => handleInputChange('password', e.target.value)}\r\n                  placeholder=\"Enter password\"\r\n                  className=\"form-input-custom w-full px-3 sm:px-4 py-2 sm:py-2.5 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-emerald-500 dark:focus:ring-emerald-400 focus:border-emerald-500 dark:focus:border-emerald-400 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-all duration-200 focus:outline-none\"\r\n                />\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setShowPassword(!showPassword)}\r\n                  className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-colors\"\r\n                  title={showPassword ? 'Hide password' : 'Show password'}\r\n                >\r\n                  {showPassword ? <EyeOff className=\"w-5 h-5\" /> : <Eye className=\"w-5 h-5\" />}\r\n                </button>\r\n              </div>\r\n              <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n                Current password is pre-filled. Click eye icon to view or edit to change.\r\n              </p>\r\n            </div>\r\n\r\n            <FormInput\r\n              label=\"President Name\"\r\n              value={formData.presidentName}\r\n              onChange={(value) => handleInputChange('presidentName', value)}\r\n              placeholder=\"Enter president name\"\r\n              colSpan={1}\r\n            />\r\n\r\n            <FormInput\r\n              label=\"Location\"\r\n              value={formData.location}\r\n              onChange={(value) => handleInputChange('location', value)}\r\n              placeholder=\"Enter location\"\r\n              colSpan={1}\r\n            />\r\n\r\n            <FormInput\r\n              label=\"Contact Phone\"\r\n              type=\"tel\"\r\n              value={formData.contactPhone}\r\n              onChange={(value) => {\r\n                const formatted = formatPhoneInput(value);\r\n                handleInputChange('contactPhone', formatted);\r\n              }}\r\n              onBlur={() => {\r\n                const error = validatePhoneOnBlur(formData.contactPhone);\r\n                if (error) {\r\n                  setFieldErrors(prev => ({ ...prev, contactPhone: error }));\r\n                } else {\r\n                  setFieldErrors(prev => ({ ...prev, contactPhone: undefined }));\r\n                }\r\n              }}\r\n              placeholder=\"Enter contact phone\"\r\n              error={fieldErrors.contactPhone}\r\n              colSpan={1}\r\n            />\r\n\r\n            <FormInput\r\n              label=\"Email Address\"\r\n              type=\"email\"\r\n              value={formData.email}\r\n              onChange={(value) => {\r\n                const formatted = formatEmailInput(value);\r\n                handleInputChange('email', formatted);\r\n              }}\r\n              onBlur={() => {\r\n                const error = validateEmailOnBlur(formData.email);\r\n                if (error) {\r\n                  setFieldErrors(prev => ({ ...prev, email: error }));\r\n                } else {\r\n                  setFieldErrors(prev => ({ ...prev, email: undefined }));\r\n                }\r\n              }}\r\n              placeholder={selectedSociety?.email ? `Current: ${selectedSociety.email}` : \"Enter email address\"}\r\n              error={fieldErrors.email}\r\n              required\r\n              colSpan={1}\r\n              helperText=\"Current email address is pre-filled. Edit to change.\"\r\n            />\r\n\r\n            <FormSelect\r\n              label=\"Status\"\r\n              value={formData.status}\r\n              onChange={(value) => handleInputChange('status', value)}\r\n              options={[\r\n                { value: 'active', label: 'Active' },\r\n                { value: 'inactive', label: 'Inactive' },\r\n                { value: 'maintenance', label: 'Maintenance' },\r\n                { value: 'suspended', label: 'Suspended' }\r\n              ]}\r\n              colSpan={1}\r\n            />\r\n          </FormGrid>\r\n\r\n          <FormActions\r\n            onCancel={() => {\r\n              setShowEditForm(false);\r\n              setSelectedSociety(null);\r\n              setFormData(initialFormData);\r\n            }}\r\n            submitText=\"Update Society\"\r\n            isLoading={formLoading}\r\n            cancelText=\"Cancel\"\r\n            loadingText=\"Updating...\"\r\n            submitIcon={<Edit3 className=\"w-4 h-4\" />}\r\n          />\r\n        </form>\r\n      </FormModal>\r\n\r\n      {/* Delete Confirmation Modal - Individual Delete with OTP */}\r\n      <DeleteSocietyModal\r\n        isOpen={showDeleteModal && !!selectedSociety}\r\n        onClose={() => {\r\n          setShowDeleteModal(false);\r\n          setSelectedSociety(null);\r\n        }}\r\n        onConfirm={handleConfirmDelete}\r\n        societyName={selectedSociety?.name || ''}\r\n        loading={isDeleting}\r\n      />\r\n\r\n      {/* Bulk Delete Password Confirmation Dialog */}\r\n      <PasswordConfirmDialog\r\n        isOpen={showBulkDeleteConfirm}\r\n        onClose={() => setShowBulkDeleteConfirm(false)}\r\n        onConfirm={handleBulkDeleteConfirm}\r\n        title={`Delete ${selectedSocieties.size} ${selectedSocieties.size === 1 ? 'Society' : 'Societies'}`}\r\n        message={`Enter your admin password to confirm deletion of ${selectedSocieties.size} selected ${selectedSocieties.size === 1 ? 'society' : 'societies'}. This action cannot be undone and will be logged for security purposes.`}\r\n      />\r\n\r\n      {/* Loading Snackbar */}\r\n      <LoadingSnackbar\r\n        isVisible={loading || isDeletingBulk || isDeleting}\r\n        message={\r\n          isDeletingBulk \r\n            ? `Deleting ${selectedSocieties.size} ${selectedSocieties.size === 1 ? 'Society' : 'Societies'}` \r\n            : isDeleting \r\n            ? \"Deleting Society\" \r\n            : \"Processing\"\r\n        }\r\n        submessage={\r\n          isDeletingBulk || isDeleting \r\n            ? \"Verifying credentials and removing data...\" \r\n            : \"Please wait...\"\r\n        }\r\n        showProgress={false}\r\n      />\r\n\r\n      {/* Graph Modal */}\r\n      {showGraphModal && (\r\n        <div className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\r\n          <div className=\"bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-hidden flex flex-col\">\r\n            {/* Header */}\r\n            <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <BarChart3 className=\"w-6 h-6 text-blue-600 dark:text-blue-400\" />\r\n                <h2 className=\"text-xl font-bold text-gray-900 dark:text-white\">\r\n                  {graphMetric === 'quantity' && 'Collection Volume - Last 30 Days'}\r\n                  {graphMetric === 'revenue' && 'Revenue - Last 30 Days'}\r\n                  {graphMetric === 'fat' && 'Average Fat % - Last 30 Days'}\r\n                  {graphMetric === 'snf' && 'Average SNF % - Last 30 Days'}\r\n                  {graphMetric === 'collections' && 'Number of Collections - Last 30 Days'}\r\n                  {graphMetric === 'water' && 'Average Water % - Last 30 Days'}\r\n                </h2>\r\n              </div>\r\n              <button\r\n                onClick={() => setShowGraphModal(false)}\r\n                className=\"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors\"\r\n              >\r\n                <X className=\"w-5 h-5 text-gray-500 dark:text-gray-400\" />\r\n              </button>\r\n            </div>\r\n\r\n            {/* Graph Content */}\r\n            <div className=\"flex-1 overflow-y-auto p-6\">\r\n              {(() => {\r\n                const societiesWithStats = societies.filter(s => s.totalQuantity30d && s.totalQuantity30d > 0);\r\n                \r\n                // Prepare data for line chart (all societies)\r\n                const chartData = societiesWithStats.map(society => ({\r\n                  name: society.name,\r\n                  societyId: society.societyId,\r\n                  value: graphMetric === 'quantity' ? (society.totalQuantity30d || 0) :\r\n                         graphMetric === 'revenue' ? (society.totalAmount30d || 0) :\r\n                         graphMetric === 'fat' ? (society.weightedFat30d || 0) :\r\n                         graphMetric === 'snf' ? (society.weightedSnf30d || 0) :\r\n                         graphMetric === 'collections' ? (society.totalCollections30d || 0) :\r\n                         (society.weightedWater30d || 0)\r\n                })).sort((a, b) => b.value - a.value);\r\n\r\n                // Get color and settings\r\n                const getLineColor = () => {\r\n                  switch (graphMetric) {\r\n                    case 'quantity': return '#10b981';\r\n                    case 'revenue': return '#3b82f6';\r\n                    case 'fat': return '#8b5cf6';\r\n                    case 'snf': return '#f59e0b';\r\n                    case 'collections': return '#ec4899';\r\n                    case 'water': return '#ef4444';\r\n                    default: return '#6b7280';\r\n                  }\r\n                };\r\n\r\n                const getYAxisLabel = () => {\r\n                  switch (graphMetric) {\r\n                    case 'quantity': return 'Quantity (L)';\r\n                    case 'revenue': return 'Revenue (â‚¹)';\r\n                    case 'fat': return 'Fat %';\r\n                    case 'snf': return 'SNF %';\r\n                    case 'collections': return 'Collections';\r\n                    case 'water': return 'Water %';\r\n                    default: return 'Value';\r\n                  }\r\n                };\r\n\r\n                const CustomTooltip = ({ active, payload }: {\r\n                  active?: boolean;\r\n                  payload?: Array<{\r\n                    payload: { name: string; societyId: string; value: number };\r\n                  }>;\r\n                }) => {\r\n                  if (active && payload && payload.length) {\r\n                    const data = payload[0].payload;\r\n                    return (\r\n                      <div className=\"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700\">\r\n                        <p className=\"font-bold text-gray-900 dark:text-white mb-1\">{data.name}</p>\r\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-2\">({data.societyId})</p>\r\n                        <p className=\"font-semibold\" style={{ color: getLineColor() }}>\r\n                          {graphMetric === 'revenue' && 'â‚¹'}\r\n                          {data.value.toFixed(2)}\r\n                          {graphMetric === 'fat' || graphMetric === 'snf' || graphMetric === 'water' ? '%' : ''}\r\n                          {graphMetric === 'quantity' ? ' L' : ''}\r\n                        </p>\r\n                      </div>\r\n                    );\r\n                  }\r\n                  return null;\r\n                };\r\n\r\n                return chartData.length > 0 ? (\r\n                  <div className=\"w-full h-[500px]\">\r\n                    <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                      <LineChart data={chartData} margin={{ top: 5, right: 30, left: 20, bottom: 80 }}>\r\n                        <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#e5e7eb\" className=\"dark:stroke-gray-700\" />\r\n                        <XAxis \r\n                          dataKey=\"name\" \r\n                          angle={-45}\r\n                          textAnchor=\"end\"\r\n                          height={100}\r\n                          interval={0}\r\n                          tick={{ fontSize: 11 }}\r\n                          stroke=\"#6b7280\"\r\n                          label={{ \r\n                            value: 'Society Name', \r\n                            position: 'insideBottom', \r\n                            offset: -5,\r\n                            style: { fontSize: 13, fontWeight: 500, fill: '#9ca3af' }\r\n                          }}\r\n                        />\r\n                        <YAxis \r\n                          label={{ \r\n                            value: getYAxisLabel(), \r\n                            angle: -90, \r\n                            position: 'insideLeft',\r\n                            style: { fontSize: 14, fontWeight: 600 }\r\n                          }}\r\n                          tick={{ fontSize: 12 }}\r\n                          stroke=\"#6b7280\"\r\n                        />\r\n                        <Tooltip content={<CustomTooltip />} />\r\n                        <Line \r\n                          type=\"monotone\" \r\n                          dataKey=\"value\" \r\n                          stroke={getLineColor()} \r\n                          strokeWidth={3}\r\n                          dot={{ fill: getLineColor(), r: 5 }}\r\n                          activeDot={{ r: 7 }}\r\n                          name={getYAxisLabel()}\r\n                        />\r\n                      </LineChart>\r\n                    </ResponsiveContainer>\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"text-center py-12\">\r\n                    <BarChart3 className=\"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-4\" />\r\n                    <p className=\"text-gray-500 dark:text-gray-400\">No data available for the last 30 days</p>\r\n                  </div>\r\n                );\r\n              })()}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n}"],"names":[],"mappings":"yDAEA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,OASA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAkBA,EAAA,CAAA,CAAA,OAAA,IAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAiBA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAqCA,IAAM,EAAmC,CACvC,KAAM,GACN,UAAW,GACX,SAAU,GACV,SAAU,GACV,cAAe,GACf,aAAc,GACd,MAAO,GACP,MAAO,GACP,OAAQ,QACV,EAGM,EAAgB,CAAC,EAA0C,KAC/D,GAAI,CAAC,GAAQ,AAAS,MAAG,OAAO,GAAQ,GACxC,GAAI,CAAC,EAAa,OAAO,EAEzB,IAAM,EAAU,EAAK,QAAQ,GACvB,EAAQ,AAAI,OAAO,CAAC,CAAC,EAAE,EAAY,OAAO,CAAC,sBAAuB,QAAQ,CAAC,CAAC,CAAE,MAGpF,OAFc,AAEP,EAFe,KAAK,CAAC,GAEf,GAAG,CAAC,CAAC,EAAM,IACtB,EAAM,IAAI,CAAC,GACT,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAiB,UAAU,2DACzB,GADQ,GAIX,EAGN,EAEe,SAAS,IACtB,MAmwBY,YAoBA,GA42BQ,SAnoDd,GAAS,CAAA,EAAA,EAAA,SAAA,AAAS,IAClB,GAAe,CAAA,EAAA,EAAA,eAAe,AAAf,IACf,MAAE,EAAI,CAAE,CAAG,CAAA,EAAA,EAAA,OAAA,AAAO,IAClB,CAAE,IAAC,CAAE,CAAG,CAAA,EAAA,EAAA,WAAA,AAAW,IAGnB,CAAC,GAAW,GAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAY,EAAE,EAClD,CAAC,GAAM,GAAQ,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAA2E,EAAE,EACvG,CAAC,GAAS,GAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAuD,EAAE,EACzF,CAAC,GAAS,GAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACjC,CAAC,GAAa,GAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACzC,CAAC,GAAa,GAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACzC,CAAC,GAAc,GAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC3C,CAAC,GAAiB,GAAmB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACjD,CAAC,GAAiB,GAAmB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAiB,MACjE,CAAC,GAAY,GAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACvC,CAAC,GAAU,GAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAkB,GACpD,CAAC,GAAa,GAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACzC,CAAC,GAAa,GAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACzC,CAAC,GAAc,GAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAA8D,OACxG,CAAC,GAAa,GAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAW,EAAE,EACrD,CAAC,GAAW,GAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAW,EAAE,EACjD,CAAC,GAAO,GAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC7B,CAAC,GAAS,GAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACjC,CAAC,GAAa,GAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAM3C,CAAC,GACE,CAAC,GAAY,GAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MACtD,CAAC,GAAmB,GAAqB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAc,IAAI,KACtE,CAAC,GAAY,GAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAsD,UAC5F,CAAC,GAAuB,GAAyB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC7D,CAAC,GAAgB,GAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC/C,CAAC,GAAa,GAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAmE,YAC3G,CAAC,GAAgB,GAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC/C,CAAC,GAAc,GAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC3C,CAAC,GAAiB,GAAmB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACjD,CAAC,GAAiB,GAAmB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAGjD,CAAC,GAAW,GAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAOhC,MAGJ,GAAiB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,UACjC,GAAI,CACF,IAAW,GACX,IAAM,EAAQ,aAAa,OAAO,CAAC,aACnC,GAAI,CAAC,EAAO,YACV,GAAO,IAAI,CAAC,UAId,IAAM,EAAW,MAAM,MAAM,oBAAqB,CAChD,QAAS,CACP,cAAiB,CAAC,OAAO,EAAE,EAAA,CAAO,CAClC,eAAgB,kBAClB,CACF,GAEA,GAAI,CAAC,EAAS,EAAE,CAAE,CAChB,GAAwB,MAApB,EAAS,MAAM,EAAgC,MAApB,EAAS,MAAM,CAAU,CACtD,aAAa,UAAU,CAAC,aACxB,GAAO,IAAI,CAAC,UACZ,MACF,CACA,MAAU,AAAJ,MAAU,4BAClB,CAIA,IAAM,EAAuB,CAAC,CAFf,MAAM,EAAS,IAAI,EAAA,EAEG,IAAI,EAAI,EAAA,AAAE,EAAE,GAAG,CAAC,AAAC,IAoB/C,CACL,GAAI,EAAQ,AADR,EACU,CACd,KAAM,EAAQ,IAAI,CAClB,UAAW,EAAQ,UAAU,CAC7B,SAAU,EAAQ,QAAQ,CAC1B,cAAe,EAAQ,cAAc,CACrC,aAAc,EAAQ,aAAa,CACnC,MAAO,EAAQ,KAAK,EAAI,GACxB,MAAO,EAAQ,MAAM,CACrB,QAAS,EAAQ,QAAQ,CACzB,OAAQ,EAAQ,MAAM,CACtB,UAAW,EAAQ,UAAU,CAC7B,UAAW,EAAQ,UAAU,CAC7B,oBAAqB,OAAO,EAAQ,qBAAqB,GAAK,EAC9D,iBAAkB,OAAO,EAAQ,kBAAkB,GAAK,EACxD,eAAgB,OAAO,EAAQ,gBAAgB,GAAK,EACpD,eAAgB,OAAO,EAAQ,gBAAgB,GAAK,EACpD,eAAgB,OAAO,EAAQ,gBAAgB,GAAK,EACpD,eAAgB,OAAO,EAAQ,gBAAgB,GAAK,EACpD,iBAAkB,OAAO,EAAQ,kBAAkB,GAAK,EAC1D,CAAC,EACD,GAAa,EACf,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,4BAA6B,GAC3C,GAAS,8BACX,QAAU,CACR,IAAW,EACb,CACF,EAAG,CAAC,GAAO,EAGL,GAAe,CAAA,EAAA,EAAA,WAAW,AAAX,EAAY,UAC/B,GAAI,CACF,IAAM,EAAQ,aAAa,OAAO,CAAC,aACnC,GAAI,CAAC,EAAO,OAEZ,IAAM,EAAW,MAAM,MAAM,kBAAmB,CAC9C,QAAS,CAAE,cAAiB,CAAC,OAAO,EAAE,EAAA,CAAO,AAAC,CAChD,GAEA,GAAI,EAAS,EAAE,CAAE,CACf,IAAM,EAAO,MAAM,EAAS,IAAI,GAChC,GAAW,EAAK,IAAI,EAAI,EAAE,CAC5B,CACF,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,0BAA2B,EAC3C,CACF,EAAG,EAAE,EAGC,GAAY,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,UAC5B,GAAI,CACF,IAAe,GACf,IAAM,EAAQ,aAAa,OAAO,CAAC,aACnC,GAAI,CAAC,EAAO,OAEZ,IAAM,EAAW,MAAM,MAAM,gBAAiB,CAC5C,QAAS,CACP,cAAiB,CAAC,OAAO,EAAE,EAAA,CAAO,CAClC,eAAgB,kBAClB,CACF,GAEA,GAAI,EAAS,EAAE,CAAE,CACf,IAAM,EAAS,MAAM,EAAS,IAAI,GAClC,GAAQ,EAAO,IAAI,EAAI,EAAE,CAC3B,CACF,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,uBAAwB,EACxC,QAAU,CACR,IAAe,EACjB,CACF,EAAG,EAAE,EAGC,GAAiB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,UACjC,GAAI,CACF,IAAM,EAAQ,aAAa,OAAO,CAAC,aACnC,GAAI,CAAC,EACH,KADU,EAIZ,IAAM,EAAW,MAAM,MAAM,kBAAmB,CAC9C,QAAS,CACP,cAAiB,CAAC,OAAO,EAAE,EAAA,CAAO,CAClC,eAAgB,mBAChB,YAAa,IAAM,IAAI,YAAc,EACvC,CACF,GAEA,GAAI,EAAS,EAAE,CAAE,CACf,IAAM,EAAS,MAAM,EAAS,IAAI,GAClC,GAAa,EAAO,IAAI,EAAI,KAC9B,CACF,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,6BAA8B,EAC9C,CACF,EAAG,CAAC,IAAM,GAAG,EAGb,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAM,EAAqB,AAAC,IACP,MAAM,CAArB,KACa,AACX,AAAC,EADgB,MAAM,CACf,OAAO,CAAC,cAClB,GAAc,KADI,CAIxB,EAJsC,AAOtC,OADA,SAAS,gBAAgB,CAAC,YAAa,GAChC,KACL,SAAS,mBAAmB,CAAC,YAAa,EAC5C,CACF,EAAG,CAAC,GAAW,EAgBf,IAAM,GAAyB,MAAO,IACpC,GAA+B,IAA3B,GAAkB,IAAI,CAAQ,OAElC,IAAM,EAAiB,GAAa,GAEpC,GAAI,CACF,IAAW,GACX,IAAM,EAAQ,aAAa,OAAO,CAAC,aAC7B,EAAa,MAAM,IAAI,CAAC,IAE9B,QAAQ,GAAG,CAAC,CAAC,iBAAiB,EAAE,EAAW,MAAM,CAAC,sBAAsB,EAAE,EAAA,CAAgB,EAE1F,IAAM,EAAiB,EAAW,GAAG,CAAC,IACpC,IAAM,EAAU,GAAU,IAAI,CAAC,GAAK,EAAE,EAAE,GAAK,UACxC,AAAL,EAEO,EAFH,IAES,CAFC,mBAEoB,CAChC,OAAQ,MACR,QAAS,CACP,cAAiB,CAAC,OAAO,EAAE,EAAA,CAAO,CAClC,eAAgB,kBAClB,EACA,KAAM,KAAK,SAAS,CAAC,CACnB,GAAI,EAAQ,EAAE,CACd,KAAM,EAAQ,IAAI,CAClB,UAAW,EAAQ,SAAS,CAC5B,SAAU,EAAQ,QAAQ,EAAI,GAC9B,cAAe,EAAQ,aAAa,EAAI,GACxC,aAAc,EAAQ,YAAY,EAAI,GACtC,MAAO,EAAQ,KAAK,CACpB,OAAQ,CACV,EACF,GAlBqB,QAAQ,OAAO,EAmBtC,EAEA,OAAM,QAAQ,GAAG,CAAC,GAElB,QAAQ,GAAG,CAAC,CAAC,uBAAuB,EAAE,EAAW,MAAM,CAAC,cAAc,EAAE,EAAA,CAAgB,EAExF,GAAW,CAAC,QAAQ,EAAE,EAAW,MAAM,CAAC,CAAC,EAAwB,IAAtB,EAAW,MAAM,CAAS,UAAY,YAAY,IAAI,EAAE,EAAe,CAAC,CAAC,EACpH,MAAM,KACN,GAAqB,IAAI,KACzB,WAAW,IAAM,GAAW,IAAK,IACnC,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,qBAAsB,GACpC,GAAS,8BACT,WAAW,IAAM,GAAS,IAAK,IACjC,QAAU,CACR,IAAW,EACb,CACF,EAeM,GAA0B,MAAO,IACrC,IAAyB,GACzB,IAAkB,GAElB,GAAI,CACF,IAAM,EAAQ,aAAa,OAAO,CAAC,aAC7B,EAAa,MAAM,IAAI,CAAC,IAE9B,QAAQ,GAAG,CAAC,CAAC,kBAAkB,EAAE,EAAW,MAAM,CAAC,sCAAsC,CAAC,CAAE,GAG5F,IAAM,EAAiB,EAAW,GAAG,CAAC,GACpC,MAAM,2BAA4B,CAChC,OAAQ,SACR,QAAS,CACP,cAAiB,CAAC,OAAO,EAAE,EAAA,CAAO,CAClC,eAAgB,kBAClB,EACA,KAAM,KAAK,SAAS,CAAC,IAAE,WAAI,CAAS,EACtC,GAAG,IAAI,CAAC,MAAO,IACb,GAAI,CAAC,EAAI,EAAE,CAAE,CACX,IAAM,EAAQ,MAAM,EAAI,IAAI,EAC5B,OAAM,AAAI,MAAM,EAAM,KAAK,EAAI,gBACjC,CACA,OAAO,EAAI,IAAI,EACjB,IAGI,EAAU,MAAM,QAAQ,UAAU,CAAC,GACnC,EAAa,EAAQ,MAAM,CAAC,GAAkB,cAAb,EAAE,MAAM,EAAkB,MAAM,CACjE,EAAS,EAAQ,MAAM,CAAC,GAAK,AAAa,eAAX,MAAM,EAAiB,MAAM,CAE9D,EAAa,GAAG,AAClB,QAAQ,GAAG,CAAC,CAAC,uBAAuB,EAAE,EAAW,UAAU,CAAC,EAC5D,GAAW,CAAC,qBAAqB,EAAE,EAAW,CAAC,EAAiB,IAAf,EAAmB,UAAY,YAAA,EAAc,EAAS,EAAI,CAAC,EAAE,EAAE,EAAO,QAAQ,CAAC,CAAG,GAAA,CAAI,EACvI,MAAM,KACN,GAAqB,IAAI,KACzB,WAAW,IAAM,GAAW,IAAK,OAEjC,QAAQ,KAAK,CAAC,CAAC,uBAAuB,EAAE,EAAW,MAAM,CAAC,UAAU,CAAC,EACrE,GAAS,yEACT,WAAW,IAAM,GAAS,IAAK,KAEnC,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,qBAAsB,GACpC,GAAS,aAAiB,MAAQ,EAAM,OAAO,CAAG,8BAClD,WAAW,IAAM,GAAS,IAAK,IACjC,QAAU,CACR,IAAkB,EACpB,CACF,EAGM,GAAmB,MAAO,IAM9B,GALA,EAAE,cAAc,GAChB,IAAe,GACf,GAAS,IAGL,CAAC,GAAS,KAAK,CAAE,CACnB,GAAS,uBACT,IAAe,GACf,MACF,CAEA,GAAI,CACF,IAAM,EAAQ,aAAa,OAAO,CAAC,aAC7B,EAAW,MAAM,MAAM,oBAAqB,CAChD,OAAQ,OACR,QAAS,CACP,cAAiB,CAAC,OAAO,EAAE,EAAA,CAAO,CAClC,eAAgB,kBAClB,EACA,KAAM,KAAK,SAAS,CAAC,CACnB,GAAG,EAAQ,CACX,MAAO,SAAS,GAAS,KAAK,CAChC,EACF,GAEA,GAAI,EAAS,EAAE,CACb,CADe,EACJ,+BACX,IAAe,GACf,GAAY,GACZ,MAAM,KAEN,WAAW,IAAM,GAAW,IAAK,SAC5B,CAEL,IAAM,EAAe,CADC,MAAM,EAAS,IAAI,EAAA,EACN,KAAK,EAAI,wBAG5C,GAAe,CAAC,GAGZ,EAAa,WAAW,GAAG,QAAQ,CAAC,eAAiB,EAAa,WAAW,GAAG,QAAQ,CAAC,kBAC3F,CAD8G,EAC/F,CAAE,UAAW,gCAAiC,GACpD,EAAa,WAAW,GAAG,QAAQ,CAAC,iBAAmB,EAAa,WAAW,GAAG,QAAQ,CAAC,kBACpG,CADuH,EACxG,CAAE,KAAM,kCAAmC,GAE1D,GAAS,EAEb,CACF,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,wBAAyB,GACvC,GAAS,wBACX,QAAU,CACR,IAAe,EACjB,CACF,EAGM,GAAoB,MAAO,IAE/B,GADA,CACI,CADF,cAAc,GACX,IAML,GAJA,IAAe,GACf,GAHsB,AAGb,IAGL,CAAC,GAAS,KAAK,CAAE,CACnB,GAAS,uBACT,IAAe,GACf,MACF,CAEA,GAAI,CACF,IAAM,EAAQ,aAAa,OAAO,CAAC,aAC7B,EAUF,CACF,GAAI,GAAgB,EAAE,CACtB,KAAM,GAAS,IAAI,CACnB,SAAU,GAAS,QAAQ,CAC3B,cAAe,GAAS,aAAa,CACrC,aAAc,GAAS,YAAY,CACnC,MAAO,GAAS,KAAK,CACrB,MAAO,SAAS,GAAS,KAAK,EAC9B,OAAQ,GAAS,MAAM,AACzB,EAGI,GAAS,QAAQ,EAAI,GAAS,QAAQ,GAAK,KAC7C,EAAW,QAAQ,CAAG,CADwC,EAC/B,QAAA,AAAQ,EAGzC,IAAM,EAAW,MAAM,MAAM,oBAAqB,CAChD,OAAQ,MACR,QAAS,CACP,cAAiB,CAAC,OAAO,EAAE,EAAA,CAAO,CAClC,eAAgB,kBAClB,EACA,KAAM,KAAK,SAAS,CAAC,EACvB,GAEA,GAAI,EAAS,EAAE,CACb,CADe,EACJ,iCACX,GAAgB,IAChB,GAAmB,MACnB,GAAY,GACZ,MAAM,KAEN,WAAW,IAAM,GAAW,IAAK,SAC5B,CAEL,IAAM,EAAe,CADC,MAAM,EAAS,IAAI,EAAA,EACN,KAAK,EAAI,2BAG5C,GAAe,CAAC,GAGZ,EAAa,WAAW,GAAG,QAAQ,CAAC,eAAiB,EAAa,WAAW,GAAG,QAAQ,CAAC,kBAC3F,CAD8G,EAC/F,CAAE,UAAW,gCAAiC,GACpD,EAAa,WAAW,GAAG,QAAQ,CAAC,iBAAmB,EAAa,WAAW,GAAG,QAAQ,CAAC,kBACpG,CADuH,EACxG,CAAE,KAAM,kCAAmC,GAE1D,GAAS,EAEb,CACF,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,0BAA2B,GACzC,GAAS,2BACX,QAAU,CACR,IAAe,EACjB,EACF,EAKM,GAAsB,MAAO,IACjC,GAAK,CAAD,GAEJ,IAAc,GACd,GAAI,CACF,EAJoB,EAId,EAAQ,aAAa,OAAO,CAAC,aAC7B,EAAW,MAAM,MAAM,CAAC,4BAA4B,EAAE,GAAgB,EAAE,CAAC,KAAK,EAAE,EAAA,CAAK,CAAE,CAC3F,OAAQ,SACR,QAAS,CACP,cAAiB,CAAC,OAAO,EAAE,EAAA,CAAO,CAClC,eAAgB,kBAClB,CACF,GAEM,EAAO,MAAM,EAAS,IAAI,GAEhC,GAAI,CAAC,EAAS,EAAE,CACd,CADgB,KACV,AAAI,MAAM,EAAK,KAAK,EAAI,4BAGhC,GAAW,sDACX,IAAmB,GACnB,GAAmB,MACnB,MAAM,KACN,WAAW,IAAM,GAAW,IAAK,IACnC,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,0BAA2B,GACzC,GAAS,aAAiB,MAAQ,EAAM,OAAO,CAAG,4BAClD,WAAW,IAAM,GAAS,IAAK,IACjC,QAAU,CACR,IAAc,EAChB,EACF,EAGM,GAAoB,CAAC,EAA8B,KAEzC,cAAV,GAAyB,IAAe,CAAC,EAAM,UAAU,CAAC,OAAS,EAAM,MAAM,CAAG,GAAG,CACvF,EAAQ,CAAC,EAAE,EAAE,EAAM,OAAO,CAAC,MAAO,IAAA,CAAA,AAAK,EAGzC,GAAY,IAAS,CAAE,EAAH,CAAM,CAAI,CAAE,CAAC,EAAM,CAAE,CAAM,CAAC,GAG5C,EAAW,CAAC,EAAkC,EAAE,AAClD,GAAe,GAAS,EACtB,EADqB,CAClB,CAAI,CACP,CAAC,EAAM,MAAE,EACX,CAAC,CAEL,EAGM,GAAkB,MAAO,IAC7B,GAAmB,GACnB,GAAe,CAAC,GAChB,CADoB,EACX,IACT,CADc,GACE,GAChB,KADwB,AAIxB,GAAI,AANqC,CAOvC,IAJW,AAIL,EAAQ,EANqB,WAMR,KALuB,EAKhB,CAAC,YAJW,CAKxC,EAAW,MAAM,MAAM,CAAC,8BAA8B,EAAE,EAAQ,EAAE,CAAA,CAAE,CAAE,CAC1E,QAAS,CACP,cAAiB,CAAC,OAAO,EAAE,EAAA,CAAO,AACpC,CACF,GAIA,GAFA,QAAQ,GAAG,CAAC,kCAAmC,EAAS,MAAM,EAE1D,EAAS,EAAE,CAAE,CACf,IAAM,EAAS,MAAM,EAAS,IAAI,GAClC,QAAQ,GAAG,CAAC,yBAA0B,GAEtC,IAAM,EAAkB,EAAO,IAAI,EAAE,UAAY,EAAO,QAAQ,EAAI,GACpE,QAAQ,GAAG,CAAC,oBAAqB,GACjC,GAAmB,GAGnB,GAAY,CACV,KAAM,EAAQ,IAAI,CAClB,UAAW,EAAQ,SAAS,CAC5B,SAAU,EACV,SAAU,EAAQ,QAAQ,EAAI,GAC9B,cAAe,EAAQ,aAAa,EAAI,GACxC,aAAc,EAAQ,YAAY,EAAI,GACtC,MAAO,EAAQ,KAAK,EAAI,GACxB,MAAO,EAAQ,KAAK,EAAE,YAAc,GACpC,OAAQ,EAAQ,MAAM,AACxB,EACF,KAAO,CACL,IAAM,EAAY,MAAM,EAAS,IAAI,GACrC,QAAQ,KAAK,CAAC,yBAA0B,GAExC,GAAmB,IACnB,GAAY,CACV,KAAM,EAAQ,IAAI,CAClB,UAAW,EAAQ,SAAS,CAC5B,SAAU,GACV,SAAU,EAAQ,QAAQ,EAAI,GAC9B,cAAe,EAAQ,aAAa,EAAI,GACxC,aAAc,EAAQ,YAAY,EAAI,GACtC,MAAO,EAAQ,KAAK,EAAI,GACxB,MAAO,EAAQ,KAAK,EAAE,YAAc,GACpC,OAAQ,EAAQ,MAAM,AACxB,EACF,CACF,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,2BAA4B,GAC1C,GAAmB,IACnB,GAAY,CACV,KAAM,EAAQ,IAAI,CAClB,UAAW,EAAQ,SAAS,CAC5B,SAAU,GACV,SAAU,EAAQ,QAAQ,EAAI,GAC9B,cAAe,EAAQ,aAAa,EAAI,GACxC,aAAc,EAAQ,YAAY,EAAI,GACtC,MAAO,EAAQ,KAAK,EAAI,GACxB,MAAO,EAAQ,KAAK,EAAE,YAAc,GACpC,OAAQ,EAAQ,MAAM,AACxB,EACF,CAEA,IAAgB,EAClB,EAWM,GAAqB,MAAO,EAAkB,KAClD,QAAQ,GAAG,CAAC,2BAA4B,CAAE,UAAW,EAAQ,EAAE,CAAE,cAAe,EAAQ,MAAM,WAAE,CAAU,GAE1G,GAAI,CACF,IAAW,GACX,IAAM,EAAQ,aAAa,OAAO,CAAC,aAE7B,EAAU,CACd,GAAI,EAAQ,EAAE,CACd,KAAM,EAAQ,IAAI,CAClB,UAAW,EAAQ,SAAS,CAC5B,SAAU,EAAQ,QAAQ,EAAI,GAC9B,cAAe,EAAQ,aAAa,EAAI,GACxC,aAAc,EAAQ,YAAY,EAAI,GACtC,MAAO,EAAQ,KAAK,CACpB,OAAQ,CACV,EAEA,QAAQ,GAAG,CAAC,0BAA2B,GAEvC,IAAM,EAAW,MAAM,MAAM,oBAAqB,CAChD,OAAQ,MACR,QAAS,CACP,cAAiB,CAAC,OAAO,EAAE,EAAA,CAAO,CAClC,eAAgB,kBAClB,EACA,KAAM,KAAK,SAAS,CAAC,EACvB,GAEM,EAAS,MAAM,EAAS,IAAI,GAGlC,GAFA,QAAQ,GAAG,CAAC,gBAAiB,CAAE,OAAQ,EAAS,MAAM,CAAE,KAAM,CAAO,GAEjE,EAAS,EAAE,CACb,CADe,EACJ,CAAC,kBAAkB,EAAE,EAAU,CAAC,CAAC,EAC5C,MAAM,KACN,WAAW,IAAM,GAAW,IAAK,SAC5B,CACL,IAAM,EAAe,EAAO,KAAK,EAAI,0BACrC,QAAQ,KAAK,CAAC,iBAAkB,GAChC,GAAS,GACT,WAAW,IAAM,GAAS,IAAK,IACjC,CACF,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,yBAA0B,GACxC,GAAS,2BACT,WAAW,IAAM,GAAS,IAAK,IACjC,QAAU,CACR,IAAW,EACb,CACF,EAGM,GAAoB,GAAU,MAAM,CAAC,IACzC,IAAM,EAAgC,KAAhB,IACD,EAAQ,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,GAAY,WAAW,KAC3D,EAAQ,SAAS,CAAC,WAAW,GAAG,QAAQ,CAAC,GAAY,WAAW,KAChE,EAAQ,aAAa,EAAE,cAAc,SAAS,GAAY,WAAW,KACrE,EAAQ,QAAQ,EAAE,cAAc,SAAS,GAAY,WAAW,KAChE,EAAQ,YAAY,EAAE,cAAc,SAAS,GAAY,WAAW,KACpE,EAAQ,OAAO,EAAE,cAAc,SAAS,GAAY,WAAW,IAE9E,EAAiC,QAAjB,IAA0B,EAAQ,MAAM,GAAK,GAG7D,EAAa,GAAK,IAAI,CAAC,GAAK,EAAE,EAAE,GAAK,EAAQ,KAAK,EAGlD,EAAkC,IAArB,GAAU,MAAM,EAAU,GAAU,QAAQ,CAAC,GAAY,GAAG,YAAc,IAGvF,EAAsC,IAAvB,CACD,EADa,MAAM,IAClB,GAAY,aAAc,GAAY,QAAQ,CAAC,EAAW,WAAW,CAAC,QAAQ,IAEnG,EAFyG,KAAK,AAEvG,GAAiB,GAAiB,GAAc,CACzD,SAwCA,CAtCA,CAAA,EAAA,AAsCI,EAtCJ,SAAS,AAAT,EAAU,KACR,KACA,KACA,KACA,KAGA,IAAM,EAAiB,GAAa,GAAG,CAAC,aACpC,GACF,GAAa,CAAC,EAAe,EAI/B,IAAM,CALc,CAKK,GAAa,GAAG,CAAC,eACtC,GACF,GAAe,CAAC,EAAiB,EAInC,IAAM,EAAgB,CALA,WAKY,KAChC,IACF,EAAG,KAEH,GAFW,GAEJ,IAAM,MAFW,QAEG,EAC7B,EAAG,CAAC,GAAgB,GAAc,GAAW,GAAgB,GAAa,EAG1E,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAM,EAAqB,AAAC,IAG1B,GAFoB,AACN,EAAY,MAAM,EAAE,EACnB,KAD4B,GAE7C,EAEA,OADA,OAAO,gBAAgB,CAAC,eAAgB,GACjC,IAAM,OAAO,mBAAmB,CAAC,eAAgB,EAC1D,EAAG,EAAE,EAGA,IASH,CAAA,CATS,CAST,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACA,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,6DAEb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CACT,MAAM,qBACN,SAAS,wCACT,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,0BACvB,UAAW,KAIb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,aAAa,CAAA,CACZ,QAAS,GACT,MAAO,KAIR,GAAU,MAAM,CAAG,KAAK,CAAC,AAGF,IAFhB,EAAqB,GAAU,MAAM,CAAC,GAAK,EAAE,gBAAgB,EAAI,EAAE,gBAAgB,CAAG,GAE/C,CAAC,IAAI,CAAC,CAAC,EAAG,IACrD,CAAC,EAAE,gBAAgB,GAAI,CAAC,EAAK,EAAD,AAAG,gBAAgB,EAAI,CAAC,EACrD,CAAC,EAAE,CAEE,EAAa,IAAI,EAAmB,CAAC,IAAI,CAAC,CAAC,EAAG,IAClD,CAAC,EAAE,cAAc,GAAI,CAAC,EAAK,EAAD,AAAG,cAAc,GAAI,CAAC,CACjD,CAAC,EAAE,CAEE,EAAS,IAAI,EAAmB,CAAC,IAAI,CAAC,CAAC,EAAG,IAC9C,CAAC,EAAE,cAAc,GAAI,CAAC,CAAK,GAAE,AAAH,cAAiB,GAAI,CAAC,CACjD,CAAC,EAAE,CAEE,GAAS,IAAI,EAAmB,CAAC,IAAI,CAAC,CAAC,EAAG,IAC9C,CAAC,EAAE,cAAc,GAAI,CAAC,EAAK,EAAD,AAAG,cAAc,GAAI,CAAC,CACjD,CAAC,EAAE,CAEE,GAAkB,IAAI,EAAmB,CAAC,IAAI,CAAC,CAAC,EAAG,IACvD,CAAC,EAAE,mBAAmB,GAAI,CAAC,EAAK,EAAD,AAAG,mBAAmB,GAAI,CAAC,CAC3D,CAAC,EAAE,IAEc,IAAI,EAAmB,CAAC,IAAI,CAAC,CAAC,EAAG,IACjD,CAAC,EAAE,gBAAgB,GAAI,CAAC,EAAK,EAAD,AAAG,gBAAgB,GAAI,CAAC,CACrD,CAAC,EAAE,CAGF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yFACZ,GACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CACC,UAAU,yMACV,QAAS,KACP,GAAe,YACf,IAAkB,EACpB,YAEA,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,oEAA2D,yBACzE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,kDAEnB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,gEAAwD,EAAc,IAAI,GACvF,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,uDAA8C,EAAc,gBAAgB,EAAE,QAAQ,GAAG,WAIzG,GACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CACC,UAAU,mMACV,QAAS,KACP,GAAe,WACf,IAAkB,EACpB,YAEA,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,kEAAyD,sBACvE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,gDAEvB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,8DAAsD,EAAW,IAAI,GAClF,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,qDAA2C,IAAE,EAAW,cAAc,EAAE,QAAQ,SAIhG,GACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CACC,UAAU,+MACV,QAAS,KACP,GAAe,OACf,GAAkB,GACpB,YAEA,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,sEAA6D,uBAC3E,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,GAAG,CAAA,CAAC,UAAU,oDAEjB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,kEAA0D,EAAO,IAAI,GAClF,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,yDAAgD,EAAO,cAAc,EAAE,QAAQ,GAAG,cAIlG,IACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CACC,UAAU,+MACV,QAAS,KACP,GAAe,OACf,IAAkB,EACpB,YAEA,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,sEAA6D,mBAC3E,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,UAAU,oDAExB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,kEAA0D,GAAO,IAAI,GAClF,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,yDAAgD,GAAO,cAAc,EAAE,QAAQ,GAAG,cAIlG,IACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CACC,UAAU,mMACV,QAAS,KACP,GAAe,eACf,GAAkB,GACpB,YAEA,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,kEAAyD,sBACvE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,gDAEnB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,8DAAsD,GAAgB,IAAI,GACvF,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,qDAA4C,GAAgB,mBAAmB,CAAC,qBAIhG,IACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CACC,UAAU,6LACV,QAAS,KACP,GAAe,SACf,IAAkB,EACpB,YAEA,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,gEAAuD,qBACrE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,8CAEtB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,4DAAoD,GAAU,IAAI,GAC/E,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,mDAA0C,GAAU,gBAAgB,EAAE,QAAQ,GAAG,oBASxG,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,cAAc,CAAA,CACb,aAAc,GACd,eAAgB,AAAC,GAAU,GAAgB,GAC3C,YAAa,GACb,cAAe,AAAC,GAAU,GAAe,MAAM,OAAO,CAAC,GAAS,EAAQ,CAAC,EAAM,EAC/E,UAAW,GACX,YAAa,AAAC,GAAU,GAAa,MAAM,OAAO,CAAC,GAAS,EAAQ,CAAC,EAAM,EAC3E,cAAe,EAAE,CACjB,gBAAiB,KAAO,EACxB,cAAe,EAAE,CACjB,gBAAiB,KAAO,EACxB,QAAS,GACT,KAAM,GACN,UAAW,GAAU,GAAG,CAAC,GAAM,CAAD,CAAG,GAAG,CAAC,CAAE,OAAQ,EAAE,KAAK,CAAE,WAAY,EAAE,SAAS,CAAC,CAAC,EACjF,SAAU,EAAE,CACZ,cAAe,GAAkB,MAAM,CACvC,WAAY,GAAU,MAAM,CAC5B,YAAa,GACb,sBAAsB,EACtB,mBAAmB,IAGrB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,cAAc,CAAA,CACb,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,YACvB,YAAa,CAAC,QAAQ,EAAE,GAAkB,MAAM,CAAC,IAAI,EAAE,GAAU,MAAM,CAAC,UAAU,CAAC,CACnF,YAAa,GACb,cAAe,CACb,CAAE,MAAO,MAAO,MAAO,YAAa,EACpC,CAAE,MAAO,SAAU,MAAO,QAAS,EACnC,CAAE,MAAO,WAAY,MAAO,UAAW,EACvC,CAAE,MAAO,cAAe,MAAO,aAAc,EAC7C,CAAE,MAAO,YAAa,MAAO,WAAY,EAC1C,CACD,eAAgB,AAAC,GAAU,GAAgB,KAI5C,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,cAAc,CAAA,CAAA,GACb,GAAkB,MAAM,CAAG,EAC7B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yEACZ,GAAkB,GAAG,CAAC,AAAC,IAsJd,MACM,IAEA,EACA,EAGA,EASA,QArKd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAqB,UAAU,gPAE9B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qKACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,WACL,QAAS,GAAkB,GAAG,CAAC,EAAQ,EAAE,EACzC,SAAU,IAAM,cAjuBP,EAiuB2B,EAAQ,EAAE,MAhuBhE,GAAqB,IACnB,IAAM,EAAc,IAAI,IAAI,GAM5B,OALI,EAAY,GAAG,CAAC,GAClB,EAAY,MAAM,CADY,AACX,GAEnB,EAAY,GAAG,CAAC,GAEX,CACT,IAytBkB,QAAS,AAAC,GAAM,EAAE,eAAe,GACjC,UAAU,yMAEZ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qIACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,iDAEvB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,wEAAgE,EAAc,EAAQ,IAAI,CAAE,MAC1G,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,oDAA4C,EAAc,EAAQ,SAAS,CAAE,YAG9F,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,cAAc,CAAA,CACb,cAAe,EAAQ,MAAM,CAC7B,eAAgB,AAAC,GAAW,GAAmB,EAAS,GACxD,QAAS,CACP,CACE,OAAQ,SACR,MAAO,SACP,MAAO,eACP,QAAS,8CACX,EACA,CACE,OAAQ,WACR,MAAO,WACP,MAAO,aACP,QAAS,0CACX,EACA,CACE,OAAQ,cACR,MAAO,cACP,MAAO,gBACP,QAAS,gDACX,EACA,CACE,OAAQ,YACR,MAAO,YACP,MAAO,gBACP,QAAS,gDACX,EACD,CACD,SAAS,SAMf,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0BAEb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,wCAChB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,6DAAqD,EAAc,EAAQ,aAAa,EAAI,eAAgB,SAE9H,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,wCACjB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,6DAAqD,EAAc,EAAQ,YAAY,EAAI,WAAY,YAK3H,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,wCAClB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,6DAAqD,EAAc,EAAQ,QAAQ,EAAI,cAAe,SAExH,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,wCACrB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,yEAAiE,EAAc,EAAQ,OAAO,EAAI,SAAU,YAKhI,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uDAGf,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,0FAAiF,iBACjG,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,6BAItB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4FACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qCACf,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,gEAAuD,mBAEzE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uBACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,8DAAsD,EAAQ,mBAAmB,EAAI,IACpG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,qDAA6C,AAAD,GAAS,gBAAgB,GAAI,CAAC,CAAE,OAAO,CAAC,GAAG,mBAK1G,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0EACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yDAAgD,QAC/D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mEAA0D,AAAC,GAAQ,cAAc,GAAI,CAAC,CAAE,OAAO,CAAC,GAAG,UAEpH,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0EACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yDAAgD,QAC/D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mEAA0D,CAAC,EAAQ,cAAc,GAAI,CAAC,CAAE,OAAO,CAAC,GAAG,UAEpH,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sEACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yDAAgD,QAC/D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,8DAAsD,CAAC,EAAQ,cAAc,GAAI,CAAC,CAAE,OAAO,CAAC,WAK/G,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kGACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,wCACf,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,gEAAuD,qBAEzE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,qEAA2D,IACtE,CAAC,EAAQ,cAAc,GAAI,CAAC,CAAE,cAAc,CAAC,QAAS,CAAE,sBAAuB,EAAG,sBAAuB,CAAE,YAMnH,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mJACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAgB,GAC/B,UAAU,gKACV,MAAM,gBAEN,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,cAEnB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,CAjd/B,MAEC,OAA0C,MAFxB,WAEyC,CAAG,AA+cd,EA/csB,EAAE,CACzE,IAAmB,IA+cH,UAAU,wJACV,MAAM,kBAEN,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,eAKZ,EAAe,IAAW,QAAQ,KAAK,GAAK,EAAE,SAAS,GAAK,EAAQ,EAAE,IACrD,GAAc,cAAgB,SAC/C,EAAiB,GAAc,cAAgB,WAC/B,GAAc,cAAgB,UACjC,GAAc,cAAgB,aAGhC,IACf,AAAI,EAAuB,cAAP,GAChB,EAAuB,cAAP,IAChB,EAAsB,aAAP,EACf,EAAmB,UAAP,MACT,kBAIa,IACpB,AAAI,EAAuB,SACvB,EAAuB,GADP,MAEhB,EAAsB,GADN,KAEhB,EAAmB,CAAA,EAAG,AADP,EACoB,KAAvB,OAAmC,CAAC,CAAC,CAAC,CAC/C,WAiEP,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CACC,UAAU,oFACV,MAAO,CA/DQ,KACjB,GAAI,CAAC,EAAc,MAAO,WAE1B,IAAM,EAAiB,CAAC,EAA4C,GAAY,CAAK,IACnF,GAAI,CAAC,EAAU,MAAO,MACtB,IAAM,EAAM,EAAS,QAAQ,GACvB,EAAY,EAAI,KAAK,CAAC,2BACtB,EAAY,EAAI,KAAK,CAAC,2BAC5B,GAAI,GAAa,EAAW,CAC1B,IAAI,EAAQ,SAAS,CAAS,CAAC,EAAE,EAC7B,EAAU,SAAS,CAAS,CAAC,EAAE,EAC7B,EAAU,CAAS,CAAC,EAAE,CAExB,IAGF,GAAS,EADT,EAFa,EAEF,EAAA,GAEI,IAAI,CACjB,GAAS,EACT,GAAW,IAET,GAAS,IAAI,CACf,GAAS,EAAA,GAIb,IAAM,EAAiB,EAAM,QAAQ,GAAG,QAAQ,CAAC,EAAG,KAC9C,EAAmB,EAAQ,QAAQ,GAAG,QAAQ,CAAC,EAAG,KACxD,MAAO,CAAA,EAAG,CAAS,CAAC,EAAE,CAAC,CAAC,EAAE,CAAS,CAAC,EAAE,CAAC,CAAC,EAAE,CAAS,CAAC,EAAE,CAAC,CAAC,EAAE,EAAe,CAAC,EAAE,EAAiB,CAAC,EAAE,EAAA,CAAS,AAC3G,CACA,MAAO,KACT,EAEM,EAAY,EAAe,EAAa,SAAS,EACjD,EAAiB,EAAe,EAAa,kBAAkB,EAAE,GACjE,EAAU,EAD8D,AAC/C,EAAa,cAAc,QAGzB,AAAjC,GAJyG,OAI9D,CAAvC,EAAa,WAAW,CACnB,CAAC,eAAe,EAAE,EAAA,CAAW,CAIlC,AAA6B,UAAU,GAA1B,WAAW,CACnB,CAAC,OAAO,EAAE,UAAU;AAAA,QAAU,EAAE,EAAA,CAAgB,CAIxB,SAAS,CAAtC,EAAa,WAAW,CACnB,CAAC,OAAO,EAAE,UAAU;AAAA,KAAO,EAAE,EAAA,CAAS,CAI3C,EAAa,SAAS,CACjB,CADmB,AAClB,eAAe,EAAE,EAAA,CAAW,CAG/B,EAAa,aAAa,EAAI,IACvC,cAQI,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACC,UAAW,CAAC,QAAQ,EAAE,IAAA,CAAY,CAClC,QAAQ,YACR,KAAK,OACL,MAAM,sCAEL,EAEC,CAAA,EAAA,EAAA,GAAA,EAAC,KADD,EACC,CACC,EAAE,2BAF4B,gCAG9B,OAAO,eACP,YAAY,MACZ,cAAc,QACd,eAAe,QACf,UAAU,kBAIZ,CAAA,CADA,CACA,EAAA,GAAA,EAAC,OAAA,CACC,EAAE,aACF,OAAO,CAH8B,cAIrC,YAAY,MACZ,cAAc,YAIpB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,CAAC,QAAQ,EAAE,IAAA,CAAY,UACrC,aAMX,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAO,IAAI,CAAC,CAAC,eAAe,EAAE,EAAQ,EAAE,CAAA,CAAE,EACzD,UAAU,+JAEV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,GAAG,CAAA,CAAC,UAAU,iBACf,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,iBAtRF,EAAQ,EAAE,MA6RxB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CACT,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,4CACvB,MAA4B,IAArB,GAAU,MAAM,CAAS,qBAAuB,wBACvD,QAA8B,IAArB,GAAU,MAAM,CACrB,0DACA,+CAEJ,WAAiC,IAArB,GAAU,MAAM,CAAS,oBAAsB,OAC3D,SAA+B,IAArB,GAAU,MAAM,CAAS,KACjC,GAAe,CAAC,GAChB,CADoB,EACX,IACT,CADc,GACC,GACf,IACF,IAJ2C,GAIvC,EACJ,IAJuC,OAIN,IAArB,GAAU,MAAM,MAMhC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAkB,CAAA,CACjB,cAAe,GAAkB,IAAI,CACrC,WAAY,GAAkB,MAAM,CACpC,aA38BwB,CA28BV,IA18Ba,GAAG,CAA9B,GAAkB,IAAI,EAC1B,IAAyB,EAC3B,EAy8BM,mBAAoB,GACpB,YAv8BkB,CAu8BL,IAr8BjB,GADsB,IAAI,IAAI,GAAkB,GAAG,CAAC,GAC/B,AAD0C,EAAQ,EAAE,GAE3E,EAq8BM,iBAAkB,KAChB,GAAqB,IAAI,IAC3B,EACA,SAAS,UACT,kBAAkB,EAClB,kBAAmB,GACnB,mBAAoB,AAAC,GAAW,GAAc,KAIhD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAoB,CAAA,CACnB,QAAS,CACP,CACE,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,uBACtB,MAAO,cACP,QAAS,KACP,GAAe,CAAC,GAChB,GAAS,IACT,IAAe,GACf,IACF,EACA,MAAO,6CACT,EACD,CACD,YAAa,KAIf,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CACR,OAAQ,GACR,QAAS,IAAM,IAAe,GAC9B,MAAM,kBACN,SAAS,cAET,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,SAAU,GAAkB,UAAU,mCAC1C,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,QAAQ,CAAA,WAEP,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CACR,MAAM,eACN,MAAO,GAAS,IAAI,CACpB,SAAW,AAAD,GAAW,GAAkB,OAAQ,GAC/C,YAAY,qBACZ,QAAQ,CAAA,CAAA,EACR,MAAO,GAAY,IAAI,CACvB,QAAS,IAGX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CACR,MAAM,aACN,MAAO,GAAS,SAAS,CACzB,SAAU,AAAC,GAAU,GAAkB,YAAa,GACpD,YAAY,QACZ,QAAQ,CAAA,CAAA,EACR,MAAO,GAAY,SAAS,CAC5B,QAAS,IAGX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,4EAAkE,YACxE,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,wBAAe,SAE1C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,qBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAM,GAAkB,OAAS,WACjC,MAAO,GAAS,QAAQ,CACxB,SAAW,AAAD,GAAO,GAAkB,WAAY,EAAE,MAAM,CAAC,KAAK,EAC7D,YAAY,iBACZ,QAAQ,CAAA,CAAA,EACR,UAAU,2UAEZ,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,IAAM,GAAmB,CAAC,IACnC,UAAU,4IACV,MAAO,GAAkB,gBAAkB,yBAE1C,GAAkB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,YAAe,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,GAAG,CAAA,CAAC,UAAU,oBAKzE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CACT,MAAM,iBACN,MAAO,GAAS,KAAK,CACrB,SAAU,AAAC,GAAU,GAAkB,QAAS,GAChD,QAAS,GAAK,GAAG,CAAC,GAAQ,EACxB,CADuB,KAChB,EAAI,EAAE,CACb,MAAO,CAAA,EAAG,EAAI,IAAI,CAAC,EAAE,EAAE,EAAI,KAAK,CAAC,CAAC,CAAC,CACrC,CAAC,EACD,YAAY,aACZ,QAAQ,CAAA,CAAA,EACR,SAAU,GACV,QAAS,IAIX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CACR,MAAM,iBACN,MAAO,GAAS,aAAa,CAC7B,SAAU,AAAC,GAAU,GAAkB,gBAAiB,GACxD,YAAY,uBACZ,QAAS,IAGX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CACR,MAAM,WACN,MAAO,GAAS,QAAQ,CACxB,SAAU,AAAC,GAAU,GAAkB,WAAY,GACnD,YAAY,iBACZ,QAAS,IAGX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CACR,MAAM,gBACN,KAAK,MACL,MAAO,GAAS,YAAY,CAC5B,SAAU,AAAC,IAET,GAAkB,eADA,CAAA,AACgB,EADhB,EAAA,gBAAgB,AAAhB,EAAiB,GAErC,EACA,OAAQ,KACN,IAAM,EAAQ,CAAA,EAAA,EAAA,mBAAA,AAAmB,EAAC,GAAS,YAAY,EACnD,EACF,GAAe,EADN,EACe,CAAE,EAAH,CAAM,CAAI,CAAE,aAAc,EAAM,CAAC,EAExD,GAAe,IAAS,CAAE,EAAH,CAAM,CAAI,CAAE,kBAAc,EAAU,CAAC,CAEhE,EACA,YAAY,qBACZ,MAAO,GAAY,YAAY,CAC/B,QAAS,IAGX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CACR,MAAM,gBACN,KAAK,QACL,MAAO,GAAS,KAAK,CACrB,SAAU,AAAC,IAET,GAAkB,QADA,CAAA,AACS,EADT,EAAA,gBAAA,AAAgB,EAAC,GAErC,EACA,OAAQ,KACN,IAAM,EAAQ,CAAA,EAAA,EAAA,mBAAA,AAAmB,EAAC,GAAS,KAAK,EAC5C,EACF,GAAe,EADN,CACe,EAAE,EAAH,CAAM,CAAI,CAAE,MAAO,EAAM,CAAC,EAEjD,GAAe,IAAS,CAAE,EAAH,CAAM,CAAI,CAAE,WAAO,EAAU,CAAC,CAEzD,EACA,YAAY,sBACZ,MAAO,GAAY,KAAK,CACxB,QAAQ,CAAA,CAAA,EACR,QAAS,IAGX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CACT,MAAM,SACN,MAAO,GAAS,MAAM,CACtB,SAAU,AAAC,GAAU,GAAkB,SAAU,GACjD,QAAS,CACP,CAAE,MAAO,SAAU,MAAO,QAAS,EACnC,CAAE,MAAO,WAAY,MAAO,UAAW,EACvC,CAAE,MAAO,cAAe,MAAO,aAAc,EAC7C,CAAE,MAAO,YAAa,MAAO,WAAY,EAC1C,CACD,QAAS,OAIb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CACV,SAAU,IAAM,GAAe,IAC/B,WAAW,cACX,UAAW,UAMjB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CACR,OAAQ,IAAgB,CAAC,CAAC,GAC1B,QAAS,KACP,IAAgB,GAChB,GAAmB,MACnB,GAAY,EACd,EACA,MAAO,GAAkB,CAAA,EAAG,GAAE,MAAM,EAAE,MAAQ,OAAO,CAAC,EAAE,GAAgB,IAAI,CAAA,CAAE,CAAI,GAAE,MAAM,EAAE,MAAQ,OACpG,SAAS,cAET,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,SAAU,GAAmB,UAAU,mCAC3C,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,QAAQ,CAAA,WAEP,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CACR,MAAM,eACN,MAAO,GAAS,IAAI,CACpB,SAAU,AAAC,GAAU,GAAkB,OAAQ,GAC/C,YAAY,qBACZ,QAAQ,CAAA,CAAA,EACR,MAAO,GAAY,IAAI,CACvB,QAAS,IAGX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CACR,MAAM,aACN,MAAO,GAAS,SAAS,CACzB,SAAU,KAAO,EACjB,QAAQ,CAAA,CAAA,EACR,QAAQ,CAAA,CAAA,EACR,QAAS,IAGX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CACT,MAAM,iBACN,MAAO,GAAS,KAAK,CACrB,SAAU,AAAC,GAAU,GAAkB,QAAS,GAChD,QAAS,GAAK,GAAG,CAAC,IAAQ,CACxB,CADuB,KAChB,EAAI,EAAE,CACb,MAAO,CAAA,EAAG,EAAI,IAAI,CAAC,EAAE,EAAE,EAAI,KAAK,CAAC,CAAC,CAAC,AACrC,CAAC,GACD,YAAY,aACZ,QAAQ,CAAA,CAAA,EACR,UAAU,EACV,QAAS,IAIX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0BACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,2EAAkE,aAGnF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,qBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAM,GAAe,OAAS,WAC9B,MAAO,GAAS,QAAQ,CACxB,SAAU,AAAC,GAAM,GAAkB,WAAY,EAAE,MAAM,CAAC,KAAK,EAC7D,YAAY,iBACZ,UAAU,uVAEZ,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,IAAM,GAAgB,CAAC,IAChC,UAAU,4IACV,MAAO,GAAe,gBAAkB,yBAEvC,GAAe,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,YAAe,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,GAAG,CAAA,CAAC,UAAU,iBAGpE,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yDAAgD,iFAK/D,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CACR,MAAM,iBACN,MAAO,GAAS,aAAa,CAC7B,SAAU,AAAC,GAAU,GAAkB,gBAAiB,GACxD,YAAY,uBACZ,QAAS,IAGX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CACR,MAAM,WACN,MAAO,GAAS,QAAQ,CACxB,SAAU,AAAC,GAAU,GAAkB,WAAY,GACnD,YAAY,iBACZ,QAAS,IAGX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CACR,MAAM,gBACN,KAAK,MACL,MAAO,GAAS,YAAY,CAC5B,SAAU,AAAC,IAET,GAAkB,eADA,CAAA,AACgB,EADhB,EAAA,gBAAA,AAAgB,EAAC,GAErC,EACA,OAAQ,KACN,IAAM,EAAQ,CAAA,EAAA,EAAA,mBAAA,AAAmB,EAAC,GAAS,YAAY,EACnD,EACF,GAAe,EADN,EACe,CAAE,EAAH,CAAM,CAAI,CAAE,aAAc,EAAM,CAAC,EAExD,GAAe,IAAS,CAAE,EAAH,CAAM,CAAI,CAAE,kBAAc,EAAU,CAAC,CAEhE,EACA,YAAY,sBACZ,MAAO,GAAY,YAAY,CAC/B,QAAS,IAGX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CACR,MAAM,gBACN,KAAK,QACL,MAAO,GAAS,KAAK,CACrB,SAAU,AAAC,IAET,GAAkB,QADA,CACS,AADT,EAAA,EAAA,gBAAA,AAAgB,EAAC,GAErC,EACA,OAAQ,KACN,IAAM,EAAQ,CAAA,EAAA,EAAA,mBAAA,AAAmB,EAAC,GAAS,KAAK,EAC5C,EACF,GAAe,EADN,EACe,CAAE,EAAH,CAAM,CAAI,CAAE,MAAO,EAAM,CAAC,EAEjD,GAAe,IAAS,CAAE,EAAH,CAAM,CAAI,CAAE,WAAO,EAAU,CAAC,CAEzD,EACA,YAAa,IAAiB,MAAQ,CAAC,SAAS,EAAE,GAAgB,KAAK,CAAA,CAAE,CAAG,sBAC5E,MAAO,GAAY,KAAK,CACxB,QAAQ,CAAA,CAAA,EACR,QAAS,EACT,WAAW,yDAGb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CACT,MAAM,SACN,MAAO,GAAS,MAAM,CACtB,SAAU,AAAC,GAAU,GAAkB,SAAU,GACjD,QAAS,CACP,CAAE,MAAO,SAAU,MAAO,QAAS,EACnC,CAAE,MAAO,WAAY,MAAO,UAAW,EACvC,CAAE,MAAO,cAAe,MAAO,aAAc,EAC7C,CAAE,MAAO,YAAa,MAAO,WAAY,EAC1C,CACD,QAAS,OAIb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CACV,SAAU,KACR,IAAgB,GAChB,GAAmB,MACnB,GAAY,EACd,EACA,WAAW,iBACX,UAAW,GACX,WAAW,SACX,YAAY,cACZ,WAAY,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,mBAMnC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAkB,CAAA,CACjB,OAAQ,IAAmB,CAAC,CAAC,GAC7B,QAAS,KACP,IAAmB,GACnB,GAAmB,KACrB,EACA,UAAW,GACX,YAAa,IAAiB,MAAQ,GACtC,QAAS,KAIX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAqB,CAAA,CACpB,OAAQ,GACR,QAAS,IAAM,GAAyB,IACxC,UAAW,GACX,MAAO,CAAC,OAAO,EAAE,GAAkB,IAAI,CAAC,CAAC,EAA6B,IAA3B,GAAkB,IAAI,CAAS,UAAY,YAAA,CAAa,CACnG,QAAS,CAAC,iDAAiD,EAAE,GAAkB,IAAI,CAAC,UAAU,EAA6B,AAA3B,OAAkB,IAAI,CAAS,UAAY,YAAY,wEAAwE,CAAC,GAIlO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,CACd,UAAW,IAAW,IAAkB,GACxC,QACE,GACI,CAAC,SAAS,EAAE,GAAkB,IAAI,CAAC,CAAC,EAAE,AAA2B,OAAT,IAAI,CAAS,UAAY,YAAA,CAAa,CAC9F,GACA,mBACA,aAEN,WACE,IAAkB,GACd,6CACA,iBAEN,cAAc,IAIf,IACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gGACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wHAEb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gGACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,6CACrB,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,CAAG,UAAU,4DACK,aAAhB,IAA8B,mCACd,YAAhB,IAA6B,yBACb,QAAhB,IAAyB,+BACT,QAAhB,IAAyB,+BACT,AAAhB,oBAAiC,uCACjB,UAAhB,IAA2B,uCAGhC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,IAAkB,GACjC,UAAU,qFAEV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAC,CAAA,CAAC,UAAU,kDAKjB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uCACZ,CAAC,EAC2B,AAGT,GAHmB,MAAM,CAAC,GAAK,EAAE,gBAAgB,EAAI,EAAE,gBAAgB,CAAG,GAGvD,GAAG,CAAC,IAAY,CACnD,KADkD,AAC5C,EAAQ,IAAI,CAClB,UAAW,EAAQ,SAAS,CAC5B,MAAO,AAAgB,gBAAc,EAAQ,gBAAgB,EAAI,EAC1D,AAAgB,eAAa,EAAQ,cAAc,EAAI,EACvC,QAAhB,GAAyB,EAAQ,cAAc,EAAI,EACnC,QAAhB,GAAyB,EAAQ,cAAc,EAAI,EACnD,AAAgB,mBAAiB,EAAQ,mBAAmB,EAAI,EAC/D,EAAQ,gBAAgB,EAAI,EACtC,CAAC,EAAG,IAAI,CAAC,CAAC,EAAG,IAAM,EAAE,KAAK,CAAG,EAAE,KAAK,EAG9B,GAAe,KACnB,OAAQ,IACN,IAAK,WAAY,MAAO,SACxB,KAAK,UAAW,MAAO,SACvB,KAAK,MAAO,MAAO,SACnB,KAAK,MAAO,MAAO,SACnB,KAAK,cAAe,MAAO,SAC3B,KAAK,QAAS,MAAO,SACrB,SAAS,MAAO,SAClB,CACF,EAEM,GAAgB,KACpB,OAAQ,IACN,IAAK,WAAY,MAAO,cACxB,KAAK,UAAW,MAAO,aACvB,KAAK,MAAO,MAAO,OACnB,KAAK,MAAO,MAAO,OACnB,KAAK,cAAe,MAAO,aAC3B,KAAK,QAAS,MAAO,SACrB,SAAS,MAAO,OAClB,CACF,EA0BO,GAAU,MAAM,CAAG,EACxB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,4BACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,mBAAmB,CAAA,CAAC,MAAM,OAAO,OAAO,gBACvC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,SAAS,CAAA,CAAC,KAAM,GAAW,OAAQ,CAAE,IAAK,EAAG,MAAO,GAAI,KAAM,GAAI,OAAQ,EAAG,YAC5E,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,aAAa,CAAA,CAAC,gBAAgB,MAAM,OAAO,UAAU,UAAU,yBAChE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,QAAQ,OACR,MAAO,CAAC,GACR,WAAW,MACX,OAAQ,IACR,SAAU,EACV,KAAM,CAAE,SAAU,EAAG,EACrB,OAAO,UACP,MAAO,CACL,MAAO,eACP,SAAU,eACV,OAAQ,CAAC,EACT,MAAO,CAAE,SAAU,GAAI,WAAY,IAAK,KAAM,SAAU,CAC1D,IAEF,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,MAAO,CACL,MAAO,KACP,MAAO,CAAC,GACR,SAAU,aACV,MAAO,CAAE,SAAU,GAAI,WAAY,GAAI,CACzC,EACA,KAAM,CAAE,SAAU,EAAG,EACrB,OAAO,YAET,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,QAAS,CAAA,EAAA,EAAA,GAAA,EAAC,AAtDL,CAAC,QAAE,CAAM,SAAE,CAAO,CAKvC,IACC,GAAI,GAAU,GAAW,EAAQ,MAAM,CAAE,CACvC,IAAM,EAAO,CAAO,CAAC,EAAE,CAAC,OAAO,CAC/B,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2GACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,wDAAgD,EAAK,IAAI,GACtE,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,0DAAgD,IAAE,EAAK,SAAS,CAAC,OAC9E,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,gBAAgB,MAAO,CAAE,MAAO,IAAe,YACzC,YAAhB,IAA6B,IAC7B,EAAK,KAAK,CAAC,OAAO,CAAC,GACH,QAAhB,IAAyC,QAAhB,IAAyC,UAAhB,GAA0B,IAAM,GAClF,AAAgB,gBAAa,KAAO,QAI7C,CACA,OAAO,IACT,EAgC2B,CAAA,KACnB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CACH,KAAK,WACL,QAAQ,QACR,OAAQ,KACR,YAAa,EACb,IAAK,CAAE,KAAM,KAAgB,EAAG,CAAE,EAClC,UAAW,CAAE,EAAG,CAAE,EAClB,KAAM,cAMd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8BACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,4DACrB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,4CAAmC,yDArgC9D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qFACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,aAAa,CAAA,CAAC,KAAM,MA8gC7B"}