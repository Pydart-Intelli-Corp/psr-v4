{"version":3,"sources":["turbopack:///[project]/src/app/diagnostic/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\n\r\ninterface TokenData {\r\n  exists: boolean;\r\n  preview?: string;\r\n  length: number;\r\n}\r\n\r\ninterface UserData {\r\n  exists?: boolean;\r\n  error?: string;\r\n  raw?: string;\r\n  [key: string]: unknown;\r\n}\r\n\r\nexport default function DiagnosticPage() {\r\n  const [tokenData, setTokenData] = useState<TokenData | null>(null);\r\n  const [userData, setUserData] = useState<UserData | null>(null);\r\n\r\n  useEffect(() => {\r\n    const checkStorage = () => {\r\n      const token = localStorage.getItem('authToken');\r\n      const userDataStr = localStorage.getItem('userData');\r\n      \r\n      const tokenInfo: TokenData = {\r\n        exists: !!token,\r\n        preview: token ? token.substring(0, 50) + '...' : undefined,\r\n        length: token ? token.length : 0\r\n      };\r\n      setTokenData(tokenInfo);\r\n\r\n      if (userDataStr) {\r\n        try {\r\n          const user = JSON.parse(userDataStr);\r\n          setUserData(user);\r\n        } catch {\r\n          setUserData({ error: 'Failed to parse user data', raw: userDataStr });\r\n        }\r\n      } else {\r\n        setUserData({ exists: false });\r\n      }\r\n    };\r\n\r\n    checkStorage();\r\n  }, []);\r\n\r\n  const testProfileAPI = async () => {\r\n    const token = localStorage.getItem('authToken');\r\n    if (!token) {\r\n      alert('No token found');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await fetch('/api/user/profile', {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        }\r\n      });\r\n\r\n      const result = await response.json();\r\n      console.log('Profile API Test:', result);\r\n      alert(`Profile API Response: ${JSON.stringify(result, null, 2)}`);\r\n    } catch (error) {\r\n      console.error('Profile API Error:', error);\r\n      alert(`Error: ${error}`);\r\n    }\r\n  };\r\n\r\n  const clearStorage = () => {\r\n    localStorage.removeItem('authToken');\r\n    localStorage.removeItem('userData');\r\n    window.location.reload();\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-100 p-8\">\r\n      <div className=\"max-w-4xl mx-auto bg-white rounded-lg shadow-lg p-6\">\r\n        <h1 className=\"text-2xl font-bold mb-6\">Authentication Diagnostic</h1>\r\n        \r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n          <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n            <h2 className=\"text-lg font-semibold mb-4\">Token Information</h2>\r\n            <pre className=\"text-sm overflow-auto\">\r\n              {JSON.stringify(tokenData, null, 2)}\r\n            </pre>\r\n          </div>\r\n          \r\n          <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n            <h2 className=\"text-lg font-semibold mb-4\">User Data</h2>\r\n            <pre className=\"text-sm overflow-auto\">\r\n              {JSON.stringify(userData, null, 2)}\r\n            </pre>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"mt-6 space-x-4\">\r\n          <button\r\n            onClick={testProfileAPI}\r\n            className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700\"\r\n          >\r\n            Test Profile API\r\n          </button>\r\n          <button\r\n            onClick={clearStorage}\r\n            className=\"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700\"\r\n          >\r\n            Clear Storage & Reload\r\n          </button>\r\n          <a\r\n            href=\"/login\"\r\n            className=\"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 inline-block\"\r\n          >\r\n            Go to Login\r\n          </a>\r\n          <a\r\n            href=\"/admin/dashboard\"\r\n            className=\"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 inline-block\"\r\n          >\r\n            Go to Dashboard\r\n          </a>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"yDAEA,EAAA,EAAA,CAAA,CAAA,QAee,SAAS,IACtB,GAAM,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAmB,MACvD,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAkB,MAE1D,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KAEN,IAAM,EAAQ,aAAa,OAAO,CAAC,aAC7B,EAAc,aAAa,OAAO,CAAC,YASzC,GAFA,EAL6B,CAC3B,OAAQ,CAAC,CAAC,CAIC,CAHX,QAAS,EAAQ,EAAM,SAAS,CAAC,EAAG,IAAM,WAAQ,EAClD,OAAQ,EAAQ,EAAM,MAAM,CAAG,CACjC,GAGI,EACF,GAAI,CACF,IAAM,EAAO,CAFA,IAEK,KAAK,CAAC,GACxB,EAAY,EACd,CAAE,KAAM,CACN,EAAY,CAAE,MAAO,4BAA6B,IAAK,CAAY,EACrE,MAEA,EAAY,CAAE,QAAQ,CAAM,EAKlC,EAAG,EAAE,EAEL,IAAM,EAAiB,UACrB,IAAM,EAAQ,aAAa,OAAO,CAAC,aACnC,GAAI,CAAC,EAAO,YACV,MAAM,kBAIR,GAAI,CACF,IAAM,EAAW,MAAM,MAAM,oBAAqB,CAChD,QAAS,CACP,cAAiB,CAAC,OAAO,EAAE,EAAA,CAAO,CAClC,eAAgB,kBAClB,CACF,GAEM,EAAS,MAAM,EAAS,IAAI,GAClC,QAAQ,GAAG,CAAC,oBAAqB,GACjC,MAAM,CAAC,sBAAsB,EAAE,KAAK,SAAS,CAAC,EAAQ,KAAM,GAAA,CAAI,CAClE,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,qBAAsB,GACpC,MAAM,CAAC,OAAO,EAAE,EAAA,CAAO,CACzB,CACF,EAQA,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,wCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gEACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,mCAA0B,8BAExC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sCACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,sCAA6B,sBAC3C,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCACZ,KAAK,SAAS,CAAC,EAAW,KAAM,QAIrC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sCACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,sCAA6B,cAC3C,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCACZ,KAAK,SAAS,CAAC,EAAU,KAAM,WAKtC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACb,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,EACT,UAAU,yEACX,qBAGD,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAnCW,CAmCF,IAlCjB,aAAa,UAAU,CAAC,aACxB,aAAa,UAAU,CAAC,YACxB,OAAO,QAAQ,CAAC,MAAM,EACxB,EAgCU,UAAU,uEACX,2BAGD,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CACC,KAAK,SACL,UAAU,wFACX,gBAGD,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CACC,KAAK,mBACL,UAAU,0FACX,2BAOX"}