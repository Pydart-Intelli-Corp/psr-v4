module.exports=[130630,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(50944),e=a.i(835475),f=a.i(550194),g=a.i(346158),h=a.i(367044),i=a.i(457431),j=a.i(677924),k=a.i(758042),l=a.i(994222),m=a.i(54419),n=a.i(659854),o=a.i(48662),p=a.i(313949),q=a.i(915618),r=a.i(468976),s=a.i(124987),t=a.i(963519),u=a.i(992258),v=a.i(546842),w=a.i(941675),x=a.i(267900),y=a.i(781560),z=a.i(439760),A=a.i(660246),B=a.i(724669),C=a.i(93518),D=a.i(923821),E=a.i(177156),F=a.i(141379),G=a.i(839761),H=a.i(633508);a.i(16707);var I=a.i(529784),J=a.i(883733),K=a.i(981189),L=a.i(651963),M=a.i(851068),N=a.i(796182),O=a.i(110724),P=a.i(199313),Q=a.i(195279),R=a.i(333436),S=a.i(960020),T=a.i(688902),U=a.i(274643),V=a.i(559314),W=a.i(551551),X=a.i(46532);let Y={name:"",dairyId:"",password:"",location:"",contactPerson:"",phone:"",email:"",capacity:"",status:"active",monthlyTarget:""},Z=(a,c)=>{if(!a&&0!==a)return a||"";if(!c)return a;let d=a.toString(),e=RegExp(`(${c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return d.split(e).map((a,c)=>e.test(a)?(0,b.jsx)("span",{className:"bg-yellow-200 dark:bg-yellow-800 px-0.5 rounded",children:a},c):a)};function $(){let a,$,_=(0,d.useRouter)(),{user:aa}=(0,e.useUser)(),{t:ab}=(0,f.useLanguage)(),[ac,ad]=(0,c.useState)([]),[ae,af]=(0,c.useState)(!0),[ag,ah]=(0,c.useState)(!1),[ai,aj]=(0,c.useState)(!1),[ak,al]=(0,c.useState)(!1),[am,an]=(0,c.useState)(!1),[ao,ap]=(0,c.useState)(null),[aq,ar]=(0,c.useState)(Y),[as,at]=(0,c.useState)(!1),[au,av]=(0,c.useState)("all"),[aw,ax]=(0,c.useState)(""),[ay,az]=(0,c.useState)(""),[aA,aB]=(0,c.useState)(""),[aC,aD]=(0,c.useState)({}),[aE,aF]=(0,c.useState)(!1),[aG,aH]=(0,c.useState)("quantity"),[aI,aJ]=(0,c.useState)(!1),[aK,aL]=(0,c.useState)(!1),[aM,aN]=(0,c.useState)(null),[aO,aP]=(0,c.useState)(!1),[aQ,aR]=(0,c.useState)([]),[aS,aT]=(0,c.useState)(!1),[aU,aV]=(0,c.useState)(""),aW=(0,c.useCallback)(async()=>{try{af(!0);let a=localStorage.getItem("authToken");if(!a)return void _.push("/login");let b=await fetch("/api/user/dairy",{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(!b.ok){if(401===b.status||403===b.status){localStorage.removeItem("authToken"),_.push("/login");return}throw Error("Failed to fetch dairies")}let c=await b.json();ad(c.data||[])}catch(a){console.error("Error fetching dairies:",a),az("Failed to load dairy data")}finally{af(!1)}},[_]),aX=async a=>{a.preventDefault(),at(!0),az("");try{let a=localStorage.getItem("authToken"),b=await fetch("/api/user/dairy",{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({...aq,capacity:aq.capacity?parseInt(aq.capacity):void 0,monthlyTarget:aq.monthlyTarget?parseInt(aq.monthlyTarget):void 0})});if(b.ok)aB("Dairy added successfully!"),ah(!1),ar(Y),await aW(),setTimeout(()=>aB(""),3e3);else{let a=(await b.json()).error||"Failed to add dairy";aD({}),a.toLowerCase().includes("dairy id")&&a.toLowerCase().includes("already exists")?aD({dairyId:"This Dairy ID already exists"}):a.toLowerCase().includes("dairy name")&&a.toLowerCase().includes("already exists")?aD({name:"This Dairy name already exists"}):a.toLowerCase().includes("already exists")?aD({dairyId:"This Dairy ID already exists"}):az(a)}}catch(a){console.error("Error adding dairy:",a),az("Failed to add dairy")}finally{at(!1)}},aY=async a=>{ap(a),aT(!1),aV("");try{let b=localStorage.getItem("authToken"),c=await fetch(`/api/user/dairy/password?id=${a.id}`,{headers:{Authorization:`Bearer ${b}`}});if(c.ok){let b=await c.json(),d="";b.data?"string"==typeof b.data?d=b.data:"object"==typeof b.data&&b.data.password&&(d=String(b.data.password)):b.password&&(d=String(b.password)),aV(d),ar({name:a.name,dairyId:a.dairyId,password:d,location:a.location||"",contactPerson:a.contactPerson||"",phone:a.phone||"",email:a.email||"",capacity:a.capacity?.toString()||"",status:a.status||"active",monthlyTarget:a.monthlyTarget?.toString()||""})}}catch(a){console.error("Error fetching password:",a)}aj(!0)},aZ=async a=>{if(a.preventDefault(),ao){at(!0),az("");try{let a=localStorage.getItem("authToken"),b={id:ao.id,name:aq.name,location:aq.location,contactPerson:aq.contactPerson,phone:aq.phone,email:aq.email,capacity:aq.capacity?parseInt(aq.capacity):void 0,status:aq.status,monthlyTarget:aq.monthlyTarget?parseInt(aq.monthlyTarget):void 0};aq.password&&aq.password!==aU&&(b.password=aq.password);let c=await fetch("/api/user/dairy",{method:"PUT",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(b)});if(c.ok)aB("Dairy updated successfully!"),aj(!1),ap(null),ar(Y),await aW(),setTimeout(()=>aB(""),3e3);else{let a=(await c.json()).error||"Failed to update dairy";aD({}),a.toLowerCase().includes("dairy name")&&a.toLowerCase().includes("already exists")||a.toLowerCase().includes("already exists")?aD({name:"This Dairy name already exists"}):az(a)}}catch(a){console.error("Error updating dairy:",a),az("Failed to update dairy")}finally{at(!1)}}},a$=async(a,b)=>{try{let c=localStorage.getItem("authToken"),d=await fetch("/api/user/dairy",{method:"PUT",headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/json"},body:JSON.stringify({id:a.id,status:b})});if(d.ok)aB(`Status updated to ${b}!`),await aW(),setTimeout(()=>aB(""),3e3);else{let a=await d.json();az(a.error||"Failed to update status")}}catch(a){console.error("Error updating status:",a),az("Failed to update status")}},a_=async a=>{try{let b=localStorage.getItem("authToken"),c=await fetch("/api/user/bmc",{headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"}});if(c.ok)return((await c.json()).data||[]).filter(b=>b.dairyFarmId===a).map(a=>({id:a.id,name:a.name,bmcId:a.bmcId}));return[]}catch(a){return console.error("Error fetching BMCs:",a),[]}},a0=async a=>{ap(a);let b=await a_(a.id);aR(b),b.length>0?aP(!0):(window.selectedDairyIdForDelete=a.id,al(!0))},a1=async(a,b,c)=>{if(ao)try{let d=localStorage.getItem("authToken"),e=await fetch("/api/user/dairy",{method:"DELETE",headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json"},body:JSON.stringify({id:ao.id,newDairyId:a,deleteAll:b,otp:c})}),f=await e.json();e.ok?(b?aB("Dairy and all related data deleted successfully!"):aB(`${f.data.transferredBMCs} BMC(s) transferred and dairy deleted successfully!`),aP(!1),ap(null),aR([]),await aW(),setTimeout(()=>aB(""),3e3)):az(f.message||"Failed to delete dairy")}catch(a){console.error("Error deleting dairy:",a),az("Failed to delete dairy")}},a2=async a=>{if(ao)try{an(!0);let b=localStorage.getItem("authToken"),c=await fetch("/api/user/dairy",{method:"DELETE",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"},body:JSON.stringify({id:ao.id,otp:a})});if(c.ok)aB("Dairy deleted successfully!"),al(!1),ap(null),await aW(),setTimeout(()=>aB(""),3e3);else{let a=await c.json();throw Error(a.error||"Failed to delete dairy")}}catch(a){throw console.error("Error deleting dairy:",a),a}finally{an(!1)}},a3=(a,b)=>{if("dairyId"===a&&!ai){let a=b.replace(/^D-/i,"");b=`D-${a}`}ar(c=>({...c,[a]:b})),aC[a]&&aD(b=>({...b,[a]:""}))},a4=ac.filter(a=>{let b="all"===au||a.status===au,c=""===aw||a.name.toLowerCase().includes(aw.toLowerCase())||a.dairyId.toLowerCase().includes(aw.toLowerCase())||a.location?.toLowerCase().includes(aw.toLowerCase())||a.contactPerson?.toLowerCase().includes(aw.toLowerCase())||a.phone?.toLowerCase().includes(aw.toLowerCase())||a.email?.toLowerCase().includes(aw.toLowerCase());return b&&c});return((0,c.useEffect)(()=>{aW()},[aW]),(0,c.useEffect)(()=>{let a=a=>{ax(a.detail?.query||"")};return window.addEventListener("globalSearch",a),()=>window.removeEventListener("globalSearch",a)},[]),aa)?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8 space-y-4 sm:space-y-6 lg:pb-8",children:[(0,b.jsx)(P.PageHeader,{title:ab.dairyManagement.title,subtitle:ab.dairyManagement.subtitle,icon:(0,b.jsx)(p.Milk,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"}),onRefresh:aW}),(0,b.jsx)(Q.StatusMessage,{success:aA,error:ay}),ac.length>0&&(()=>{let a=ac.filter(a=>a.totalQuantity30d&&Number(a.totalQuantity30d)>0);if(0===a.length)return null;let c=[...a].sort((a,b)=>Number(b.totalQuantity30d||0)-Number(a.totalQuantity30d||0))[0],d=[...a].sort((a,b)=>Number(b.totalAmount30d||0)-Number(a.totalAmount30d||0))[0],e=[...a].sort((a,b)=>Number(b.weightedFat30d||0)-Number(a.weightedFat30d||0))[0],f=[...a].sort((a,b)=>Number(b.weightedSnf30d||0)-Number(a.weightedSnf30d||0))[0],g=[...a].sort((a,b)=>Number(b.totalCollections30d||0)-Number(a.totalCollections30d||0))[0],h=[...a].sort((a,b)=>Number(a.weightedWater30d||100)-Number(b.weightedWater30d||100))[0];return(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-3 sm:gap-4",children:[c&&(0,b.jsxs)("div",{className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 p-4 rounded-lg border border-green-200 dark:border-green-700 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>{aH("quantity"),aF(!0)},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-green-900 dark:text-green-100",children:"Top Collection (30d)"}),(0,b.jsx)(A.Users,{className:"w-5 h-5 text-green-600 dark:text-green-400"})]}),(0,b.jsx)("p",{className:"text-lg font-bold text-green-800 dark:text-green-200",children:c.name}),(0,b.jsxs)("p",{className:"text-sm text-green-600 dark:text-green-400",children:[Number(c.totalQuantity30d||0).toFixed(2)," L"]})]}),d&&(0,b.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 p-4 rounded-lg border border-blue-200 dark:border-blue-700 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>{aH("revenue"),aF(!0)},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100",children:"Top Revenue (30d)"}),(0,b.jsx)(x.Building2,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})]}),(0,b.jsx)("p",{className:"text-lg font-bold text-blue-800 dark:text-blue-200",children:d.name}),(0,b.jsxs)("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:["₹",Number(d.totalAmount30d||0).toFixed(2)]})]}),e&&(0,b.jsxs)("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-800/20 p-4 rounded-lg border border-purple-200 dark:border-purple-700 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>{aH("fat"),aF(!0)},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-purple-900 dark:text-purple-100",children:"Best Quality (30d)"}),(0,b.jsx)(E.Eye,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})]}),(0,b.jsx)("p",{className:"text-lg font-bold text-purple-800 dark:text-purple-200",children:e.name}),(0,b.jsxs)("p",{className:"text-sm text-purple-600 dark:text-purple-400",children:[Number(e.weightedFat30d||0).toFixed(2),"% Fat"]})]}),f&&(0,b.jsxs)("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-800/20 p-4 rounded-lg border border-orange-200 dark:border-orange-700 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>{aH("snf"),aF(!0)},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-orange-900 dark:text-orange-100",children:"Best SNF (30d)"}),(0,b.jsx)(B.TrendingUp,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"})]}),(0,b.jsx)("p",{className:"text-lg font-bold text-orange-800 dark:text-orange-200",children:f.name}),(0,b.jsxs)("p",{className:"text-sm text-orange-600 dark:text-orange-400",children:[Number(f.weightedSnf30d||0).toFixed(2),"% SNF"]})]}),g&&(0,b.jsxs)("div",{className:"bg-gradient-to-br from-pink-50 to-pink-100 dark:from-pink-900/20 dark:to-pink-800/20 p-4 rounded-lg border border-pink-200 dark:border-pink-700 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>{aH("collections"),aF(!0)},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-pink-900 dark:text-pink-100",children:"Most Active (30d)"}),(0,b.jsx)(C.Award,{className:"w-5 h-5 text-pink-600 dark:text-pink-400"})]}),(0,b.jsx)("p",{className:"text-lg font-bold text-pink-800 dark:text-pink-200",children:g.name}),(0,b.jsxs)("p",{className:"text-sm text-pink-600 dark:text-pink-400",children:[Number(g.totalCollections30d||0)," Collections"]})]}),h&&(0,b.jsxs)("div",{className:"bg-gradient-to-br from-red-50 to-red-100 dark:from-red-900/20 dark:to-red-800/20 p-4 rounded-lg border border-red-200 dark:border-red-700 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>{aH("water"),aF(!0)},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-red-900 dark:text-red-100",children:"Most Water (30d)"}),(0,b.jsx)(D.Droplets,{className:"w-5 h-5 text-red-600 dark:text-red-400"})]}),(0,b.jsx)("p",{className:"text-lg font-bold text-red-800 dark:text-red-200",children:h.name}),(0,b.jsxs)("p",{className:"text-sm text-red-600 dark:text-red-400",children:[Number(h.weightedWater30d||0).toFixed(2),"% Water"]})]})]})})(),(0,b.jsx)(R.FilterControls,{icon:(0,b.jsx)(p.Milk,{className:"w-4 h-4 flex-shrink-0"}),showingText:`Showing ${a4.length} of ${ac.length} Dairies`,filterLabel:"Filter:",filterValue:au,filterOptions:[{value:"all",label:"All Status"},{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"maintenance",label:"Maintenance"}],onFilterChange:a=>av(a)}),ae?(0,b.jsx)(J.LoadingSpinner,{}):a4.length>0?(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-6",children:a4.map(a=>(0,b.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-lg transition-all duration-200 overflow-visible border border-gray-200 dark:border-gray-700 hover:border-blue-200 dark:hover:border-blue-700 relative z-10 hover:z-20",children:[(0,b.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-4 border-b border-gray-200 dark:border-gray-700 rounded-t-lg",children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,b.jsx)("div",{className:"p-2 bg-gradient-to-r from-blue-100 to-indigo-100 dark:from-blue-900/30 dark:to-indigo-900/30 rounded-lg flex-shrink-0",children:(0,b.jsx)(p.Milk,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white truncate",children:Z(a.name,aw)}),(0,b.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:Z(a.dairyId,aw)})]})]}),(0,b.jsx)(T.StatusDropdown,{currentStatus:a.status,onStatusChange:b=>a$(a,b),options:[{status:"active",label:"Active",color:"bg-green-500",bgColor:"hover:bg-green-50 dark:hover:bg-green-900/30"},{status:"inactive",label:"Inactive",color:"bg-red-500",bgColor:"hover:bg-red-50 dark:hover:bg-red-900/30"},{status:"maintenance",label:"Maintenance",color:"bg-yellow-500",bgColor:"hover:bg-yellow-50 dark:hover:bg-yellow-900/30"}],compact:!0})]})}),(0,b.jsxs)("div",{className:"p-4 space-y-3",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(v.User,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),(0,b.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300 truncate",children:Z(a.contactPerson||"No Contact",aw)})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(t.Phone,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),(0,b.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300 truncate",children:Z(a.phone||"No Phone",aw)})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(s.MapPin,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),(0,b.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300 truncate",children:Z(a.location||"No Location",aw)})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(u.Mail,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),(0,b.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300 truncate",children:Z(a.email||"No Email",aw)})]})]}),(0,b.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700 my-3"}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:"Last 30 Days"}),(0,b.jsx)(w.Calendar,{className:"w-4 h-4 text-gray-400"})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Collections"})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:Number(a.totalCollections30d||0)}),(0,b.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:[Number(a.totalQuantity30d||0).toFixed(2)," Liters"]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,b.jsxs)("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 rounded-lg p-2 text-center",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Fat"}),(0,b.jsxs)("div",{className:"text-sm font-bold text-indigo-600 dark:text-indigo-400",children:[Number(a.weightedFat30d||0).toFixed(2),"%"]})]}),(0,b.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-2 text-center",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"SNF"}),(0,b.jsxs)("div",{className:"text-sm font-bold text-purple-600 dark:text-purple-400",children:[Number(a.weightedSnf30d||0).toFixed(2),"%"]})]}),(0,b.jsxs)("div",{className:"bg-pink-50 dark:bg-pink-900/20 rounded-lg p-2 text-center",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"CLR"}),(0,b.jsx)("div",{className:"text-sm font-bold text-pink-600 dark:text-pink-400",children:Number(a.weightedClr30d||0).toFixed(1)})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between bg-emerald-50 dark:bg-emerald-900/20 rounded-lg p-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-2 h-2 rounded-full bg-emerald-500"}),(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Total Revenue"})]}),(0,b.jsxs)("div",{className:"text-lg font-bold text-emerald-600 dark:text-emerald-400",children:["₹",Number(a.totalAmount30d||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),(0,b.jsxs)("div",{className:"bg-white dark:bg-gray-800 px-4 py-3 border-t border-gray-100 dark:border-gray-700 flex items-center justify-between gap-2 rounded-b-lg",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>aY(a),className:"p-2 text-gray-400 dark:text-gray-500 hover:text-green-600 dark:hover:text-green-400 transition-colors rounded-lg hover:bg-green-50 dark:hover:bg-green-900/30",title:"Edit",children:(0,b.jsx)(r.Edit3,{className:"w-4 h-4"})}),(0,b.jsx)("button",{onClick:()=>a0(a),className:"p-2 text-gray-400 dark:text-gray-500 hover:text-red-600 dark:hover:text-red-400 transition-colors rounded-lg hover:bg-red-50 dark:hover:bg-red-900/30",title:"Delete",children:(0,b.jsx)(y.Trash2,{className:"w-4 h-4"})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("button",{onClick:()=>{aN(a),aJ(!0)},className:"flex items-center gap-1.5 px-2 py-1 rounded hover:bg-orange-50 dark:hover:bg-orange-900/20 transition-colors group",title:`View ${a.bmcCount||0} BMCs under ${a.name}`,children:[(0,b.jsx)(z.Factory,{className:"w-3.5 h-3.5 text-gray-400 group-hover:text-orange-500 transition-colors"}),(0,b.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 group-hover:text-orange-600 dark:group-hover:text-orange-400 font-medium",children:a.bmcCount||0})]}),(0,b.jsxs)("button",{onClick:()=>{aN(a),aL(!0)},className:"flex items-center gap-1.5 px-2 py-1 rounded hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors group",title:`View ${a.societyCount||0} societies under ${a.name}`,children:[(0,b.jsx)(x.Building2,{className:"w-3.5 h-3.5 text-gray-400 group-hover:text-blue-500 transition-colors"}),(0,b.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 group-hover:text-blue-600 dark:group-hover:text-blue-400 font-medium",children:a.societyCount||0})]}),(0,b.jsxs)("button",{onClick:()=>_.push(`/admin/dairy/${a.id}`),className:"flex items-center px-3 py-1.5 text-sm text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/30 rounded-lg transition-colors",title:"View Details",children:[(0,b.jsx)(E.Eye,{className:"w-4 h-4 mr-1"}),(0,b.jsx)("span",{children:"View"})]})]})]})]},a.id))}):(0,b.jsx)(S.EmptyState,{icon:(0,b.jsx)(p.Milk,{className:"w-12 h-12 sm:w-16 sm:h-16 text-gray-400"}),title:"No Dairies found",message:"all"===au?"Get started by adding your first Dairy":"Try changing the filter to see more results",actionText:"all"===au?"Add Your First Dairy":void 0,onAction:"all"===au?()=>ah(!0):void 0,showAction:"all"===au})]}),(0,b.jsx)(V.default,{actions:[{icon:(0,b.jsx)(q.Plus,{className:"w-6 h-6 text-white"}),label:"Add Dairy",onClick:()=>{aD({}),az(""),ah(!0)},color:"bg-gradient-to-br from-blue-500 to-blue-600"}],directClick:!0}),(0,b.jsx)(K.FormModal,{isOpen:ag,onClose:()=>ah(!1),title:ab.dairyManagement.addNewDairy,maxWidth:"lg",children:(0,b.jsxs)("form",{onSubmit:aX,className:"space-y-4 sm:space-y-6",children:[(0,b.jsxs)(O.FormGrid,{children:[(0,b.jsx)(L.FormInput,{label:ab.dairyManagement.dairyName,value:aq.name,onChange:a=>a3("name",a),placeholder:ab.dairyManagement.enterDairyName,required:!0,error:aC.name}),(0,b.jsx)(L.FormInput,{label:ab.dairyManagement.dairyId,value:aq.dairyId,onChange:a=>a3("dairyId",a),placeholder:"D-001",required:!0,error:aC.dairyId}),(0,b.jsxs)("div",{className:"sm:col-span-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:ab.dairyManagement.password}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{type:aS?"text":"password",value:aq.password,onChange:a=>a3("password",a.target.value),placeholder:ab.dairyManagement.enterSecurePassword,className:"form-input-custom w-full px-3 sm:px-4 py-2 sm:py-2.5 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-emerald-500 dark:focus:ring-emerald-400 focus:border-emerald-500 dark:focus:border-emerald-400 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-all duration-200 focus:outline-none"}),(0,b.jsx)("button",{type:"button",onClick:()=>aT(!aS),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-colors",title:aS?"Hide password":"Show password",children:aS?(0,b.jsx)(F.EyeOff,{className:"w-5 h-5"}):(0,b.jsx)(E.Eye,{className:"w-5 h-5"})})]}),(0,b.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Current password is pre-filled. Click eye icon to view or edit to change."})]}),(0,b.jsx)(L.FormInput,{label:ab.dairyManagement.capacity,type:"number",value:aq.capacity,onChange:a=>a3("capacity",a),placeholder:ab.dairyManagement.enterCapacity}),(0,b.jsx)(L.FormInput,{label:ab.dairyManagement.contactPerson,value:aq.contactPerson,onChange:a=>a3("contactPerson",a),placeholder:ab.dairyManagement.enterContactPerson}),(0,b.jsx)(L.FormInput,{label:ab.dairyManagement.phone,type:"tel",value:aq.phone,onChange:a=>{a3("phone",(0,g.formatPhoneInput)(a))},onBlur:()=>{let a=(0,g.validatePhoneOnBlur)(aq.phone);a?aD(b=>({...b,phone:a})):aD(a=>({...a,phone:void 0}))},placeholder:ab.dairyManagement.enterPhoneNumber,error:aC.phone}),(0,b.jsx)(L.FormInput,{label:ab.dairyManagement.email,type:"email",value:aq.email,onChange:a=>a3("email",a),onBlur:()=>{let a=(0,h.validateEmailQuick)(aq.email);a?aD(b=>({...b,email:a})):aD(a=>({...a,email:void 0}))},placeholder:ab.dairyManagement.enterEmail,error:aC.email}),(0,b.jsx)(L.FormInput,{label:ab.dairyManagement.location,value:aq.location,onChange:a=>a3("location",a),placeholder:ab.dairyManagement.enterLocation}),(0,b.jsx)(M.FormSelect,{label:"Status",value:aq.status,onChange:a=>a3("status",a),options:[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"maintenance",label:"Maintenance"}]}),(0,b.jsx)(L.FormInput,{label:"Monthly Target (Liters)",type:"number",value:aq.monthlyTarget,onChange:a=>a3("monthlyTarget",a),placeholder:"Enter monthly target"})]}),(0,b.jsx)(N.FormActions,{onCancel:()=>ah(!1),submitText:ab.dairyManagement.addDairy,isLoading:as,cancelText:ab.common.cancel,loadingText:ab.dairyManagement.addingDairy,submitIcon:(0,b.jsx)(q.Plus,{className:"w-4 h-4"})})]})}),(0,b.jsx)(K.FormModal,{isOpen:ai&&!!ao,onClose:()=>{aj(!1),ap(null),ar(Y)},title:ao?`${ab.common.edit} ${ao.name}`:ab.common.edit,maxWidth:"lg",children:(0,b.jsxs)("form",{onSubmit:aZ,className:"space-y-4 sm:space-y-6",children:[(0,b.jsxs)(O.FormGrid,{children:[(0,b.jsx)(L.FormInput,{label:ab.dairyManagement.dairyName,value:aq.name,onChange:a=>a3("name",a),placeholder:ab.dairyManagement.enterDairyName,required:!0,error:aC.name}),(0,b.jsx)(L.FormInput,{label:`${ab.dairyManagement.dairyId} (Read-only)`,value:aq.dairyId,onChange:()=>{},readOnly:!0,disabled:!0}),(0,b.jsxs)("div",{className:"sm:col-span-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:ab.dairyManagement.password}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{type:aS?"text":"password",value:aq.password,onChange:a=>a3("password",a.target.value),placeholder:"Enter password",className:"form-input-custom w-full px-3 sm:px-4 py-2 sm:py-2.5 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-emerald-500 dark:focus:ring-emerald-400 focus:border-emerald-500 dark:focus:border-emerald-400 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-all duration-200 focus:outline-none"}),(0,b.jsx)("button",{type:"button",onClick:()=>aT(!aS),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-colors",title:aS?"Hide password":"Show password",children:aS?(0,b.jsx)(F.EyeOff,{className:"w-5 h-5"}):(0,b.jsx)(E.Eye,{className:"w-5 h-5"})})]}),(0,b.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Current password is pre-filled. Click eye icon to view or edit to change."})]}),(0,b.jsx)(L.FormInput,{label:ab.dairyManagement.capacity,type:"number",value:aq.capacity,onChange:a=>a3("capacity",a),placeholder:ab.dairyManagement.enterCapacity}),(0,b.jsx)(L.FormInput,{label:ab.dairyManagement.contactPerson,value:aq.contactPerson,onChange:a=>a3("contactPerson",a),placeholder:ab.dairyManagement.enterContactPerson}),(0,b.jsx)(L.FormInput,{label:ab.dairyManagement.phone,type:"tel",value:aq.phone,onChange:a=>{a3("phone",(0,g.formatPhoneInput)(a))},onBlur:()=>{let a=(0,g.validatePhoneOnBlur)(aq.phone);a?aD(b=>({...b,phone:a})):aD(a=>({...a,phone:void 0}))},placeholder:ab.dairyManagement.enterPhoneNumber,error:aC.phone}),(0,b.jsx)(L.FormInput,{label:ab.dairyManagement.email,type:"email",value:aq.email,onChange:a=>a3("email",a),onBlur:()=>{let a=(0,h.validateEmailQuick)(aq.email);a?aD(b=>({...b,email:a})):aD(a=>({...a,email:void 0}))},placeholder:ab.dairyManagement.enterEmail,error:aC.email}),(0,b.jsx)(L.FormInput,{label:ab.dairyManagement.location,value:aq.location,onChange:a=>a3("location",a),placeholder:ab.dairyManagement.enterLocation}),(0,b.jsx)(M.FormSelect,{label:"Status",value:aq.status,onChange:a=>a3("status",a),options:[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"maintenance",label:"Maintenance"}]}),(0,b.jsx)(L.FormInput,{label:"Monthly Target (Liters)",type:"number",value:aq.monthlyTarget,onChange:a=>a3("monthlyTarget",a),placeholder:"Enter monthly target"})]}),(0,b.jsx)(N.FormActions,{onCancel:()=>{aj(!1),ap(null),ar(Y)},submitText:"Update Dairy",isLoading:as,cancelText:ab.common.cancel,loadingText:"Updating...",submitIcon:(0,b.jsx)(r.Edit3,{className:"w-4 h-4"})})]})}),(0,b.jsx)(U.default,{isOpen:ak&&!!ao,onClose:()=>{al(!1),ap(null)},onConfirm:a2,dairyName:ao?.name||"",loading:am,bmcCount:ao?.bmcCount||0,societyCount:ao?.societyCount||0}),(0,b.jsx)(W.default,{isOpen:aI&&!!aM,onClose:()=>{aJ(!1),aN(null)},onConfirm:()=>{aJ(!1),_.push(`/admin/bmc?dairyFilter=${aM?.id}`),aN(null)},title:"Navigate to BMC Management",message:`View all BMCs from ${aM?.name} in the BMC Management page with filters applied.`,confirmText:"Go to BMC Management",cancelText:"Cancel"}),(0,b.jsx)(W.default,{isOpen:aK&&!!aM,onClose:()=>{aL(!1),aN(null)},onConfirm:()=>{aL(!1),_.push(`/admin/society?dairyFilter=${aM?.id}`),aN(null)},title:"Navigate to Society Management",message:`View all societies from ${aM?.name} in the Society Management page with filters applied.`,confirmText:"Go to Society Management",cancelText:"Cancel"}),(0,b.jsx)(X.default,{isOpen:aO,onClose:()=>{aP(!1),ap(null),aR([])},onConfirm:a1,bmcs:aQ,dairies:ac,dairyName:ao?.name||"",currentDairyId:ao?.id||0,adminEmail:aa?.email||""}),aE&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,b.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(G.BarChart3,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"}),(0,b.jsxs)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:["quantity"===aG&&"Collection Volume - Last 30 Days","revenue"===aG&&"Revenue - Last 30 Days","fat"===aG&&"Average Fat % - Last 30 Days","snf"===aG&&"Average SNF % - Last 30 Days","collections"===aG&&"Number of Collections - Last 30 Days","water"===aG&&"Average Water % - Last 30 Days"]})]}),(0,b.jsx)("button",{onClick:()=>aF(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:(0,b.jsx)(H.X,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(a=ac.filter(a=>a.totalQuantity30d&&Number(a.totalQuantity30d)>0).map(a=>({name:a.name,dairyId:a.dairyId,value:"quantity"===aG?Number(a.totalQuantity30d||0):"revenue"===aG?Number(a.totalAmount30d||0):"fat"===aG?Number(a.weightedFat30d||0):"snf"===aG?Number(a.weightedSnf30d||0):"collections"===aG?Number(a.totalCollections30d||0):Number(a.weightedWater30d||0)})).sort((a,b)=>b.value-a.value),$=()=>{switch(aG){case"quantity":return"#10b981";case"revenue":return"#3b82f6";case"fat":return"#8b5cf6";case"snf":return"#f97316";case"collections":return"#ec4899";case"water":return"#ef4444";default:return"#6b7280"}},a.length>0?(0,b.jsx)("div",{className:"w-full h-[500px]",children:(0,b.jsx)(o.ResponsiveContainer,{width:"100%",height:"100%",children:(0,b.jsxs)(i.LineChart,{data:a,margin:{top:5,right:30,left:20,bottom:80},children:[(0,b.jsx)(m.CartesianGrid,{strokeDasharray:"3 3",stroke:"#e5e7eb",className:"dark:stroke-gray-700"}),(0,b.jsx)(k.XAxis,{dataKey:"name",angle:-45,textAnchor:"end",height:100,interval:0,tick:{fontSize:11},stroke:"#6b7280",label:{value:"Dairy Name",position:"insideBottom",offset:-5,style:{fontSize:13,fontWeight:500,fill:"#9ca3af"}}}),(0,b.jsx)(l.YAxis,{label:{value:"revenue"===aG?"Revenue (₹)":"fat"===aG||"snf"===aG||"water"===aG?"Percentage (%)":"quantity"===aG?"Volume (L)":"Count",angle:-90,position:"insideLeft",style:{fontSize:13,fontWeight:500,fill:"#9ca3af"}},stroke:"#6b7280"}),(0,b.jsx)(n.Tooltip,{contentStyle:{backgroundColor:"#1f2937",border:"none",borderRadius:"0.5rem",color:"#fff",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1)"},formatter:a=>"revenue"===aG?["₹"+Number(a).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]:"fat"===aG||"snf"===aG||"water"===aG?[Number(a).toFixed(2)+"%"]:"quantity"===aG?[Number(a).toFixed(2)+" L"]:[Number(a)],labelFormatter:a=>`Dairy: ${a}`,cursor:{stroke:"#9ca3af",strokeWidth:1}}),(0,b.jsx)(j.Line,{type:"monotone",dataKey:"value",stroke:$(),strokeWidth:2,dot:{fill:$(),r:4},activeDot:{r:6},isAnimationActive:!0,name:"Value"})]})})}):(0,b.jsx)("div",{className:"flex items-center justify-center h-[500px]",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(G.BarChart3,{className:"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),(0,b.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-lg",children:"No data available for this metric"})]})}))}),(0,b.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700 p-4 bg-gray-50 dark:bg-gray-700/50",children:(0,b.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Showing performance metrics for all dairies over the last 30 days. Click the X to close this view."})})]})})]}):(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:(0,b.jsx)(I.FlowerSpinner,{})})}a.s(["default",()=>$])}];

//# sourceMappingURL=src_app_admin_dairy_page_tsx_8a6932d2._.js.map