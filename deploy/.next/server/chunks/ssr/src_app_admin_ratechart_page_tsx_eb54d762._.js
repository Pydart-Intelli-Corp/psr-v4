module.exports=[966674,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(50944),e=a.i(835475),f=a.i(550194),g=a.i(501199),h=a.i(104720),i=a.i(773320);a.i(16707);var j=a.i(529784),k=a.i(195279),l=a.i(857032),m=a.i(960020),n=a.i(603430);a.i(152824);var o=a.i(436355),p=a.i(715867),q=a.i(986687),r=a.i(284505),s=a.i(981189),t=a.i(851068),u=a.i(796182);let v=({isOpen:a,onClose:d,societies:e,onUploadSuccess:g,onUploadError:h,onUploadStart:j,onUploadEnd:k,onProgressUpdate:l})=>{let{t:m}=(0,f.useLanguage)(),[n,o]=(0,c.useState)(null),[p,q]=(0,c.useState)([]),[v,w]=(0,c.useState)(""),[x,y]=(0,c.useState)(!1),z=a=>{l?.(a)},A=async a=>{if(a.preventDefault(),0===p.length||!v||!n)return void h("Please select at least one society, channel, and CSV file");y(!0),z(0),j?.();try{let a=localStorage.getItem("authToken");z(10);let b=new FormData;b.append("file",n),b.append("societyIds",p.join(",")),b.append("channel",v),z(30);let c=await fetch("/api/user/ratechart/upload",{method:"POST",headers:{Authorization:`Bearer ${a}`},body:b});z(70);let d=await c.json();if(z(90),d.success){z(100);let a=`Rate chart uploaded to ${p.length} ${1===p.length?"society":"societies"}! Total ${d.data.recordCount} records imported.`;g(a),B()}else h(d.message||"Failed to upload rate chart")}catch(a){console.error("Error uploading rate chart:",a),h("Error uploading rate chart. Please try again.")}finally{y(!1),z(0),k?.()}},B=()=>{o(null),q([]),w(""),d()};return(0,b.jsx)(s.FormModal,{isOpen:a,onClose:B,title:m.ratechartManagement.uploadRateChart,maxWidth:"lg",children:(0,b.jsxs)("form",{onSubmit:A,className:"space-y-4 sm:space-y-6",children:[(0,b.jsxs)("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[(0,b.jsxs)("h3",{className:"font-medium text-blue-900 dark:text-blue-100 mb-2 text-sm",children:[m.ratechartManagement.csvFormatRequirements,":"]}),(0,b.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-xs text-blue-800 dark:text-blue-200",children:[(0,b.jsxs)("li",{children:[m.ratechartManagement.headersRequired,": CLR, FAT, SNF, RATE"]}),(0,b.jsxs)("li",{children:[m.ratechartManagement.clrDescription,": ",m.ratechartManagement.colorDegreeNumeric]}),(0,b.jsxs)("li",{children:[m.ratechartManagement.fatDescription,": ",m.ratechartManagement.fatPercentageNumeric]}),(0,b.jsxs)("li",{children:[m.ratechartManagement.snfDescription,": ",m.ratechartManagement.snfPercentageNumeric]}),(0,b.jsxs)("li",{children:[m.ratechartManagement.rateDescription,": ",m.ratechartManagement.ratePerLiterNumeric]}),(0,b.jsx)("li",{children:m.ratechartManagement.fileEncodingUTF8})]}),(0,b.jsxs)("button",{type:"button",onClick:()=>{let a=new Blob([`CLR,FAT,SNF,RATE
7,3,3,15
8,3,3.1,15.25
8,3,3.2,15.5
8,3,3.3,15.75
9,3,3.4,16
9,3,3.5,16.25
10,3,3.6,16.5`],{type:"text/csv;charset=utf-8;"}),b=document.createElement("a"),c=URL.createObjectURL(a);b.setAttribute("href",c),b.setAttribute("download","ratechart_sample.csv"),b.style.visibility="hidden",document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL(c)},className:"mt-3 flex items-center text-xs text-blue-600 dark:text-blue-400 hover:underline",children:[(0,b.jsx)(r.Download,{className:"w-4 h-4 mr-1"}),m.ratechartManagement.downloadSampleCSV]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[m.ratechartManagement.selectSociety," ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("button",{type:"button",onClick:()=>{p.length===e.length?q([]):q(e.map(a=>a.id))},className:"text-sm text-green-600 dark:text-green-400 hover:underline",children:p.length===e.length?m.common.clearAll:m.common.selectAll})]}),(0,b.jsx)("div",{className:"border border-gray-300 dark:border-gray-600 rounded-lg p-3 max-h-48 overflow-y-auto space-y-2",children:0===e.length?(0,b.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-2",children:m.ratechartManagement.noSocietiesAvailable}):e.map(a=>(0,b.jsxs)("label",{className:"flex items-center space-x-3 p-2 hover:bg-gray-50 dark:hover:bg-gray-700 rounded cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",checked:p.includes(a.id),onChange:()=>{var b;return b=a.id,void q(a=>a.includes(b)?a.filter(a=>a!==b):[...a,b])},className:"w-4 h-4 text-green-600 border-gray-300 dark:border-gray-600 rounded focus:ring-green-500"}),(0,b.jsxs)("span",{className:"text-sm text-gray-900 dark:text-white",children:[a.name," (",a.society_id,")"]})]},a.id))}),p.length>0&&(0,b.jsxs)("p",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400",children:[p.length," ",1===p.length?m.ratechartManagement.society:m.ratechartManagement.societies," ",m.common.selected]})]}),(0,b.jsx)(t.FormSelect,{label:m.ratechartManagement.milkChannel,value:v,onChange:a=>w(a),options:[{value:"COW",label:m.ratechartManagement.cow},{value:"BUF",label:m.ratechartManagement.buffalo},{value:"MIX",label:m.ratechartManagement.mixed}],placeholder:m.ratechartManagement.selectChannel,required:!0}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[m.ratechartManagement.csvFile," ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsxs)("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center hover:border-green-400 dark:hover:border-green-500 transition-colors",children:[(0,b.jsx)("input",{type:"file",accept:".csv",onChange:a=>{let b=a.target.files?.[0];if(b){if(!b.name.toLowerCase().endsWith(".csv"))return void h("Please select a CSV file");o(b)}},className:"hidden",id:"csv-upload"}),(0,b.jsxs)("label",{htmlFor:"csv-upload",className:"cursor-pointer flex flex-col items-center",children:[(0,b.jsx)(i.Upload,{className:"w-12 h-12 text-gray-400 mb-3"}),n?(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:n.name}),(0,b.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[(n.size/1024).toFixed(2)," KB"]})]}):(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:m.ratechartManagement.clickToUploadCSV}),(0,b.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:m.ratechartManagement.orDragAndDrop})]})]})]})]}),(0,b.jsx)(u.FormActions,{onCancel:B,submitText:`${m.common.upload} to ${p.length} ${1===p.length?m.ratechartManagement.society:m.ratechartManagement.societies}`,isLoading:x,isSubmitDisabled:0===p.length||!v||!n,submitType:"submit"})]})})};var w=a.i(781560),x=a.i(170106);let y=(0,x.default)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),z=(0,x.default)("power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]),A=(0,x.default)("power-off",[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var B=a.i(177156),C=a.i(669520),D=a.i(633508),E=a.i(879360),F=a.i(405784);let G=(0,x.default)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);var H=a.i(267900),I=a.i(816201),J=a.i(641710),K=a.i(604126);let L=(a,c)=>{if(!c)return a;let d=RegExp(`(${c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return a.split(d).map((a,c)=>d.test(a)?(0,b.jsx)("span",{className:"bg-yellow-200 dark:bg-yellow-800 px-0.5 rounded",children:a},c):a)};function M({chartId:a,fileName:d,channel:e,uploadedBy:i,createdAt:j,societies:k,status:l,isSelected:m,onToggleSelection:n,onDelete:o,onAssignSociety:p,onToggleStatus:q,onView:r,onResetDownload:s,onRemoveSociety:t,searchQuery:u=""}){let{t:v}=(0,f.useLanguage)(),[x,M]=c.default.useState(!1),[N,O]=c.default.useState(!1),[P,Q]=c.default.useState(!1),[R,S]=c.default.useState(null),[T,U]=c.default.useState(null),[V,W]=c.default.useState(!1),X=c.default.useRef(null);return c.default.useEffect(()=>{(async()=>{if(0!==l){W(!0);try{let b=localStorage.getItem("authToken");if(!b)return;let c=await fetch(`/api/user/ratechart/download-status?chartId=${a}`,{headers:{Authorization:`Bearer ${b}`}}),d=await c.json();d.success&&U(d.data)}catch(a){console.error("Error fetching download status:",a)}finally{W(!1)}}})()},[a,l]),c.default.useEffect(()=>{let a=a=>{X.current&&!X.current.contains(a.target)&&M(!1)};return x&&document.addEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)}},[x]),(0,b.jsxs)("div",{className:`relative border rounded-xl p-5 transition-all duration-300 hover:shadow-lg ${m?"border-green-500 dark:border-green-400 bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/30 dark:to-emerald-900/30 shadow-md ring-2 ring-green-200 dark:ring-green-700":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 hover:border-green-300 dark:hover:border-green-600"}`,children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("input",{type:"checkbox",checked:m,onChange:n,className:"mt-1 w-4 h-4 text-green-600 dark:text-green-500 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded focus:ring-green-500 dark:focus:ring-green-400 focus:ring-2 cursor-pointer transition-transform hover:scale-110"}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)(g.Receipt,{className:"w-4 h-4 text-gray-400 dark:text-gray-500 flex-shrink-0"}),(0,b.jsx)("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 truncate",title:d,children:L(d,u)})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-md text-xs font-semibold ${"COW"===e?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"BUF"===e?"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300":"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300"}`,children:L({COW:"COW",BUF:"BUFFALO",MIX:"MIXED",BUFFALO:"BUFFALO",MIXED:"MIXED"}[e]||e,u)}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:`inline-flex items-center px-2.5 py-0.5 rounded-md ${0===l?"bg-gray-50 dark:bg-gray-900/20 border border-gray-200 dark:border-gray-800":T?.allDownloaded?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":T?.totalMachines===0?"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800":"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800"}`,children:((a,c,d,e,f)=>{if(d)return(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("div",{className:"w-2 h-2 rounded-full bg-gray-400 dark:bg-gray-500 animate-pulse"}),(0,b.jsx)("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Loading..."})]});if(0===a)return(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("div",{className:"w-2 h-2 rounded-full bg-gray-500 dark:bg-gray-400"}),(0,b.jsx)("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Inactive"})]});if(c){let{allDownloaded:a,totalDownloaded:d,totalMachines:g}=c;if(0===g)return(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("div",{className:"w-2 h-2 rounded-full bg-amber-500 dark:bg-amber-400 animate-pulse"}),(0,b.jsx)("span",{className:"text-xs font-medium text-amber-600 dark:text-amber-400",children:"Ready"})]});let h="flex items-center gap-1.5",i=e?"cursor-pointer hover:opacity-80 transition-opacity":"";return a?(0,b.jsxs)("div",{className:`${h} ${i}`,onClick:e,children:[(0,b.jsx)(I.CheckCircle,{className:"w-3.5 h-3.5 text-green-600 dark:text-green-400"}),(0,b.jsxs)("span",{className:"text-xs font-medium text-green-600 dark:text-green-400",children:["Downloaded (",d,"/",g,")"]}),f&&(0,b.jsx)(F.ChevronDown,{className:"w-3 h-3 text-green-600 dark:text-green-400"})]}):(0,b.jsxs)("div",{className:`${h} ${i}`,onClick:e,children:[(0,b.jsx)(J.Clock,{className:"w-3.5 h-3.5 text-blue-600 dark:text-blue-400"}),(0,b.jsxs)("span",{className:"text-xs font-medium text-blue-600 dark:text-blue-400",children:["Pending (",d,"/",g,")"]}),f&&(0,b.jsx)(F.ChevronDown,{className:"w-3 h-3 text-blue-600 dark:text-blue-400"})]})}return(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("div",{className:"w-2 h-2 rounded-full bg-amber-500 dark:bg-amber-400 animate-pulse"}),(0,b.jsx)("span",{className:"text-xs font-medium text-amber-600 dark:text-amber-400",children:"Ready"})]})})(l,T,V,T&&T.totalMachines>0?()=>Q(!P):void 0,!!(T&&T.totalMachines>0))}),P&&T&&T.totalMachines>0&&(0,b.jsxs)("div",{className:"absolute top-full left-0 mt-1 w-64 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 z-10 max-h-80 overflow-y-auto",children:[(0,b.jsxs)("div",{className:"px-3 py-2 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700 rounded-t-lg flex items-center justify-between",children:[(0,b.jsx)("div",{className:"flex-1 min-w-0",children:(0,b.jsxs)("h4",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 truncate",children:[T.totalDownloaded,"/",T.totalMachines," Downloaded"]})}),(0,b.jsx)("button",{onClick:a=>{a.stopPropagation(),Q(!1)},className:"ml-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:(0,b.jsx)(D.X,{className:"w-3.5 h-3.5"})})]}),(0,b.jsx)("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:Object.entries(T.societies).map(([a,c])=>(0,b.jsxs)("div",{className:"p-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-1.5",children:[(0,b.jsx)("h5",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 truncate",children:a}),(0,b.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:[c.downloadedMachines,"/",c.totalMachines]})]}),c.machines.filter(a=>a.downloaded).length>0&&(0,b.jsxs)("div",{className:"mb-1.5",children:[(0,b.jsxs)("div",{className:"text-xs font-medium text-green-600 dark:text-green-400 mb-1 flex items-center gap-1",children:[(0,b.jsx)(I.CheckCircle,{className:"w-2.5 h-2.5"}),(0,b.jsx)("span",{children:"Done"})]}),(0,b.jsx)("div",{className:"space-y-0.5",children:c.machines.filter(a=>a.downloaded).map(a=>(0,b.jsxs)("div",{className:"text-xs bg-green-50 dark:bg-green-900/20 rounded px-1.5 py-1",children:[(0,b.jsx)("div",{className:"font-medium text-green-700 dark:text-green-300 truncate",children:a.machineId}),(0,b.jsxs)("div",{className:"text-[10px] text-green-600 dark:text-green-400 truncate",children:[a.machineType," • ",a.location]})]},a.id))})]}),c.machines.filter(a=>!a.downloaded).length>0&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"text-xs font-medium text-amber-600 dark:text-amber-400 mb-1 flex items-center gap-1",children:[(0,b.jsx)(J.Clock,{className:"w-2.5 h-2.5"}),(0,b.jsx)("span",{children:"Pending"})]}),(0,b.jsx)("div",{className:"space-y-0.5",children:c.machines.filter(a=>!a.downloaded).map(a=>(0,b.jsxs)("div",{className:"text-xs bg-amber-50 dark:bg-amber-900/20 rounded px-1.5 py-1",children:[(0,b.jsx)("div",{className:"font-medium text-amber-700 dark:text-amber-300 truncate",children:a.machineId}),(0,b.jsxs)("div",{className:"text-[10px] text-amber-600 dark:text-amber-400 truncate",children:[a.machineType," • ",a.location]})]},a.id))})]})]},a))})]})]})]})]})]}),(0,b.jsxs)("div",{className:"relative",ref:X,children:[(0,b.jsx)("button",{onClick:()=>M(!x),className:"p-1.5 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",title:"Actions",children:(0,b.jsx)(E.MoreVertical,{className:"w-5 h-5"})}),x&&(0,b.jsxs)("div",{className:"absolute right-0 mt-2 w-56 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 z-50 py-1",children:[(0,b.jsxs)("button",{onClick:()=>{r(),M(!1)},className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[(0,b.jsx)(B.Eye,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"}),(0,b.jsxs)("span",{children:[v.common.view||"View"," ",v.ratechartManagement.rateChart]})]}),(0,b.jsxs)("button",{onClick:()=>{p(),M(!1)},className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[(0,b.jsx)(y,{className:"w-4 h-4 text-green-600 dark:text-green-400"}),(0,b.jsxs)("span",{children:[v.common.add," ",v.ratechartManagement.societies]})]}),(0,b.jsxs)("button",{onClick:()=>{s(),M(!1)},className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[(0,b.jsx)(C.RefreshCw,{className:"w-4 h-4 text-purple-600 dark:text-purple-400"}),(0,b.jsx)("span",{children:v.ratechartManagement.resetDownload})]}),(0,b.jsx)("button",{onClick:()=>{q(a,l),M(!1)},className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:1===l?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(A,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"}),(0,b.jsx)("span",{children:v.ratechartManagement.inactive})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(z,{className:"w-4 h-4 text-green-600 dark:text-green-400"}),(0,b.jsx)("span",{children:v.ratechartManagement.active})]})}),(0,b.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700 my-1"}),(0,b.jsxs)("button",{onClick:()=>{o(),M(!1)},className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:[(0,b.jsx)(w.Trash2,{className:"w-4 h-4"}),(0,b.jsx)("span",{children:v.common.delete})]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4 mb-4 text-xs text-gray-500 dark:text-gray-400",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)(h.FileText,{className:"w-3.5 h-3.5"}),(0,b.jsx)("span",{children:i})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("span",{children:"•"}),(0,b.jsx)("span",{children:new Date(j).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]})]}),(0,b.jsxs)("div",{className:"relative bg-gray-50 dark:bg-gray-900/50 rounded-lg p-3 border border-gray-200 dark:border-gray-700 mb-3",children:[(0,b.jsxs)("button",{onClick:()=>O(!N),className:"w-full flex items-center justify-between text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(H.Building2,{className:"w-4 h-4 text-green-600 dark:text-green-400"}),(0,b.jsxs)("span",{children:[v.ratechartManagement.societies," (",k.length,")"]})]}),N?(0,b.jsx)(G,{className:"w-4 h-4"}):(0,b.jsx)(F.ChevronDown,{className:"w-4 h-4"})]}),N&&(0,b.jsx)("div",{className:"absolute left-0 right-0 top-full mt-2 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 z-50 overflow-hidden max-h-64 overflow-y-auto",children:k.map(a=>(0,b.jsxs)("div",{className:"group flex items-center justify-between p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors border-b border-gray-100 dark:border-gray-700 last:border-b-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0",children:(0,b.jsx)("span",{className:"text-xs font-bold text-green-700 dark:text-green-300",children:a.societyName.charAt(0).toUpperCase()})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",title:a.societyName,children:L(a.societyName,u)}),a.societyIdentifier&&(0,b.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:L(a.societyIdentifier,u)})]})]}),t&&k.length>1&&(0,b.jsx)("button",{onClick:()=>{S({chartRecordId:a.chartRecordId,societyId:a.societyId,societyName:a.societyName})},className:"ml-2 p-1.5 text-red-500 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-all opacity-0 group-hover:opacity-100",title:`Remove ${a.societyName}`,children:(0,b.jsx)(D.X,{className:"w-4 h-4"})})]},a.societyId))})]}),(0,b.jsx)(K.ConfirmDeleteModal,{isOpen:!!R,onClose:()=>S(null),onConfirm:()=>{R&&t&&(t(R.chartRecordId,R.societyId,R.societyName),2===k.length&&O(!1)),S(null)},itemName:R?.societyName||"",itemType:v.ratechartManagement.society,title:`${v.common.delete} ${v.ratechartManagement.society}`,message:v.common.confirm,confirmText:`${v.common.delete} ${v.ratechartManagement.society}`})]})}var N=a.i(660246),O=a.i(915618),P=a.i(73570);a.i(833828);var Q=a.i(346271),R=a.i(262036);function S({isOpen:a,onClose:d,onAssign:e,fileName:g,currentSocieties:h,allSocieties:i}){let{t:j}=(0,f.useLanguage)(),[k,l]=(0,c.useState)(new Set),[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)(!1);if((0,c.useEffect)(()=>{a&&(l(new Set),p(null),r(!1))},[a]),!a)return null;let t=new Set(h.map(a=>a.societyId)),v=i.filter(a=>!t.has(a.id)),w=async(a=!1)=>{if(0!==k.size){n(!0);try{let b=await e(Array.from(k),a);if(b&&b.requiresConfirmation&&b.conflicts){p(b.conflicts),r(!0),n(!1);return}d()}catch(a){a&&"object"==typeof a&&"requiresConfirmation"in a&&"conflicts"in a?(p(a.conflicts),r(!0)):console.error("Error assigning societies:",a)}finally{n(!1)}}},x=()=>{r(!1),p(null)};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(s.FormModal,{isOpen:a,onClose:d,title:j.ratechartManagement.chartAssignedSuccessfully.split(" ")[0]+" "+j.ratechartManagement.societies,maxWidth:"2xl",children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 rounded-xl p-4 border border-green-200 dark:border-green-800",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-green-500 dark:bg-green-600 rounded-lg",children:(0,b.jsx)(N.Users,{className:"w-5 h-5 text-white"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-xs font-medium text-green-700 dark:text-green-300 mb-0.5",children:"Rate Chart File"}),(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 truncate",title:g,children:g})]})]})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3 flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-green-500"}),"Currently Assigned (",h.length,")"]}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:h.map(a=>(0,b.jsx)("span",{className:"inline-flex items-center px-3 py-1.5 rounded-lg text-sm font-medium bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600",children:a.societyName},a.societyId))})]}),(0,b.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700"}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsxs)("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"}),"Available Societies (",v.length,")"]}),v.length>0&&(0,b.jsx)("button",{onClick:()=>{k.size===v.length?l(new Set):l(new Set(v.map(a=>a.id)))},className:"text-xs text-green-600 dark:text-green-400 hover:text-green-700 dark:hover:text-green-300 font-semibold transition-colors",children:k.size===v.length?"Deselect All":"Select All"})]}),0===v.length?(0,b.jsxs)("div",{className:"text-center py-12 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl",children:[(0,b.jsx)(N.Users,{className:"w-12 h-12 mx-auto mb-3 text-gray-400 dark:text-gray-500"}),(0,b.jsx)("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"All societies assigned"}),(0,b.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"All available societies already have this chart"})]}):(0,b.jsx)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-xl overflow-hidden max-h-80 overflow-y-auto bg-gray-50 dark:bg-gray-900/50",children:(0,b.jsx)("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:v.map(a=>(0,b.jsxs)("label",{className:"flex items-center gap-3 p-4 hover:bg-white dark:hover:bg-gray-800 cursor-pointer transition-colors group",children:[(0,b.jsx)("input",{type:"checkbox",checked:k.has(a.id),onChange:()=>{var b;let c;return b=a.id,void((c=new Set(k)).has(b)?c.delete(b):c.add(b),l(c))},className:"w-4 h-4 text-green-600 dark:text-green-500 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded focus:ring-green-500 dark:focus:ring-green-400 focus:ring-2 cursor-pointer transition-all"}),(0,b.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-green-100 to-emerald-100 dark:from-green-900/50 dark:to-emerald-900/50 flex items-center justify-center flex-shrink-0 group-hover:scale-110 transition-transform",children:(0,b.jsx)("span",{className:"text-xs font-bold text-green-700 dark:text-green-300",children:a.name.charAt(0).toUpperCase()})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 truncate",children:a.name}),(0,b.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:a.society_id})]})]},a.id))})}),k.size>0&&(0,b.jsxs)("div",{className:"mt-3 flex items-center gap-2 text-sm",children:[(0,b.jsx)("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-green-100 dark:bg-green-900/30",children:(0,b.jsx)("span",{className:"text-xs font-bold text-green-600 dark:text-green-400",children:k.size})}),(0,b.jsxs)("span",{className:"text-gray-700 dark:text-gray-300 font-medium",children:[k.size," ",1===k.size?"society":"societies"," selected"]})]})]}),(0,b.jsx)(u.FormActions,{onCancel:d,onSubmit:()=>w(!1),submitText:k.size>0?`Assign to ${k.size} ${1===k.size?"Society":"Societies"}`:"Select Societies",isLoading:m,isSubmitDisabled:0===k.size,loadingText:"Assigning...",submitIcon:(0,b.jsx)(O.Plus,{className:"w-4 h-4"}),submitType:"button"})]})}),(0,b.jsx)(R.AnimatePresence,{children:q&&o&&o.length>0&&(0,b.jsx)(Q.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 dark:bg-black/80 flex items-center justify-center z-[10000] p-4",onClick:x,children:(0,b.jsx)(Q.motion.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-md",onClick:a=>a.stopPropagation(),children:(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("div",{className:"flex items-start gap-4 mb-4",children:[(0,b.jsx)("div",{className:"flex-shrink-0 w-12 h-12 rounded-full bg-yellow-100 dark:bg-yellow-900/30 flex items-center justify-center",children:(0,b.jsx)(P.AlertTriangle,{className:"w-6 h-6 text-yellow-600 dark:text-yellow-400"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-gray-100 mb-1",children:"Replace Existing Charts?"}),(0,b.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["The following ",1===o.length?"society already has":"societies already have"," a rate chart assigned:"]})]})]}),(0,b.jsx)("div",{className:"space-y-2 mb-5 max-h-48 overflow-y-auto",children:o.map(a=>(0,b.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-3",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:a.societyName}),(0,b.jsxs)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-0.5",children:["Current: ",(0,b.jsx)("span",{className:"font-medium",children:a.currentFileName})]})]},a.societyId))}),(0,b.jsxs)("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-6",children:["Do you want to replace ",1===o.length?"this chart":"these charts"," with the new one?"]}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)("button",{onClick:x,disabled:m,className:"flex-1 px-4 py-2.5 text-sm font-semibold text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-xl transition-colors disabled:opacity-50",children:"Cancel"}),(0,b.jsx)("button",{onClick:()=>{r(!1),w(!0)},disabled:m,className:"flex-1 px-4 py-2.5 text-sm font-semibold text-white bg-yellow-600 dark:bg-yellow-600 hover:bg-yellow-700 dark:hover:bg-yellow-500 rounded-xl transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:m?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Replacing..."]}):"Yes, Replace"})]})]})})})})]})}function T({isOpen:a,onClose:d,rateCharts:e}){let{t:h}=(0,f.useLanguage)(),[i,j]=(0,c.useState)("all");if(!a)return null;let k=e.filter(a=>"all"===i||a.channel===i),l=k.filter(a=>"COW"===a.channel),m=k.filter(a=>"BUF"===a.channel),n=k.filter(a=>"MIX"===a.channel);return(0,b.jsx)(s.FormModal,{isOpen:a,onClose:d,title:`${h.ratechartManagement.totalAssignments} (${e.length})`,maxWidth:"2xl",children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:h.ratechartManagement.allRateChartAssignments}),(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,b.jsxs)("button",{onClick:()=>j("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${"all"===i?"bg-blue-600 dark:bg-blue-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:[h.dashboard.all," (",e.length,")"]}),(0,b.jsxs)("button",{onClick:()=>j("COW"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${"COW"===i?"bg-green-600 dark:bg-green-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:[h.ratechartManagement.cow," (",e.filter(a=>"COW"===a.channel).length,")"]}),(0,b.jsxs)("button",{onClick:()=>j("BUF"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${"BUF"===i?"bg-blue-600 dark:bg-blue-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:[h.ratechartManagement.buf," (",e.filter(a=>"BUF"===a.channel).length,")"]}),(0,b.jsxs)("button",{onClick:()=>j("MIX"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${"MIX"===i?"bg-purple-600 dark:bg-purple-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:[h.ratechartManagement.mix," (",e.filter(a=>"MIX"===a.channel).length,")"]})]}),(0,b.jsx)("div",{className:"max-h-96 overflow-y-auto space-y-2 border border-gray-200 dark:border-gray-700 rounded-xl p-3 bg-gray-50 dark:bg-gray-900/50",children:0===k.length?(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)(g.Receipt,{className:"w-12 h-12 mx-auto mb-3 text-gray-400 dark:text-gray-500"}),(0,b.jsx)("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:h.ratechartManagement.noAssignmentsFound}),(0,b.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:h.ratechartManagement.tryChangingFilter})]}):(0,b.jsxs)("div",{className:"space-y-4",children:[("all"===i||"COW"===i)&&l.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2",children:[(0,b.jsx)("span",{className:"inline-block w-2 h-2 rounded-full bg-green-500"}),h.ratechartManagement.cow," ",h.ratechartManagement.channel," (",l.length,")"]}),(0,b.jsx)("div",{className:"space-y-2",children:l.map(a=>(0,b.jsx)(U,{chart:a},a.id))})]}),("all"===i||"BUF"===i)&&m.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2",children:[(0,b.jsx)("span",{className:"inline-block w-2 h-2 rounded-full bg-blue-500"}),h.ratechartManagement.buffalo," ",h.ratechartManagement.channel," (",m.length,")"]}),(0,b.jsx)("div",{className:"space-y-2",children:m.map(a=>(0,b.jsx)(U,{chart:a},a.id))})]}),("all"===i||"MIX"===i)&&n.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2",children:[(0,b.jsx)("span",{className:"inline-block w-2 h-2 rounded-full bg-purple-500"}),h.ratechartManagement.mixed," ",h.ratechartManagement.channel," (",n.length,")"]}),(0,b.jsx)("div",{className:"space-y-2",children:n.map(a=>(0,b.jsx)(U,{chart:a},a.id))})]})]})}),(0,b.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t border-gray-200 dark:border-gray-700",children:[(0,b.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[h.ratechartManagement.showing," ",k.length," ",h.ratechartManagement.of," ",e.length," ",h.ratechartManagement.assignments]}),(0,b.jsx)("button",{onClick:d,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 dark:bg-blue-500 rounded-lg hover:bg-blue-700 dark:hover:bg-blue-600 transition-colors",children:h.common.close})]})]})})}function U({chart:a}){var c;return(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-700 transition-colors",children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:a.societyName}),(0,b.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",a.societyIdentifier,")"]}),(0,b.jsx)("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium border ${(a=>{switch(a){case"COW":return"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 border-green-200 dark:border-green-800";case"BUF":return"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400 border-blue-200 dark:border-blue-800";case"MIX":return"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400 border-yellow-200 dark:border-yellow-800";default:return"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-200 dark:border-gray-700"}})(a.channel)}`,children:{COW:"COW",BUF:"BUFFALO",MIX:"MIXED",BUFFALO:"BUFFALO",MIXED:"MIXED"}[c=a.channel]||c}),a.shared_chart_id&&(0,b.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400 border border-purple-200 dark:border-purple-800",children:"Shared"})]}),(0,b.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 truncate",children:a.fileName})]}),(0,b.jsxs)("div",{className:"text-right ml-4 flex-shrink-0",children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(a.uploadedAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),(0,b.jsxs)("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:[a.recordCount," records"]})]})]})}function V({show:a,onClose:d,onConfirm:e,chartId:g,fileName:h,channel:i,societies:k}){let{t:l}=(0,f.useLanguage)(),[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)(new Set),[q,r]=(0,c.useState)(!1),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)("all");(0,c.useEffect)(()=>{let b=async()=>{if(a){r(!0);try{let a=localStorage.getItem("authToken");if(!a)return;let b=await fetch(`/api/user/ratechart/data?chartId=${g}`,{headers:{Authorization:`Bearer ${a}`}});if(b.ok){let a=await b.json();n(a.data?.machines||[])}}catch(a){console.error("Error fetching machines:",a)}finally{r(!1)}}};a&&(b(),p(new Set),y("all"))},[a,g]);let z=async()=>{if(0!==o.size){w(!0);try{await e(Array.from(o)),d()}catch(a){console.error("Error resetting download:",a)}finally{w(!1)}}},A=m.filter(a=>"all"===x||k.find(b=>b.societyId===x&&b.societyName===a.societyName));return a?(0,b.jsx)(s.FormModal,{isOpen:a,onClose:d,title:`${l.common.reset} ${l.ratechartManagement.channelDownloadStatus}`,maxWidth:"2xl",children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsxs)("span",{className:`px-2.5 py-1 rounded-lg text-xs font-semibold ${"COW"===i?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"BUF"===i?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300"}`,children:[i," ",l.ratechartManagement.channel]})}),(0,b.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-xl p-4 border border-blue-200 dark:border-blue-800",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-blue-500 dark:bg-blue-600 rounded-lg",children:(0,b.jsx)(C.RefreshCw,{className:"w-5 h-5 text-white"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-xs font-medium text-blue-700 dark:text-blue-300 mb-0.5",children:l.ratechartManagement.rateChartFile}),(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 truncate",title:h,children:h})]})]})}),(0,b.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[l.ratechartManagement.selectMachinesToReset," ",(0,b.jsxs)("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:[i," ",l.ratechartManagement.channel]})," ",l.ratechartManagement.downloadStatusAllowRedownload," ",i," ",l.ratechartManagement.milkType,"."]}),(0,b.jsx)(t.FormSelect,{label:l.ratechartManagement.filterBySociety,value:x.toString(),onChange:a=>y("all"===a?"all":parseInt(a)),options:[{value:"all",label:l.ratechartManagement.allSocieties},...k.map(a=>({value:a.societyId.toString(),label:a.societyName}))]}),A.length>0&&(0,b.jsxs)("div",{className:"flex items-center justify-between pb-3 border-b border-gray-200 dark:border-gray-700",children:[(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer group",children:[(0,b.jsx)("input",{type:"checkbox",checked:o.size===A.length&&A.length>0,onChange:()=>{o.size===A.length?p(new Set):p(new Set(A.map(a=>a.id)))},className:"w-4 h-4 text-blue-600 dark:text-blue-500 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded focus:ring-blue-500 dark:focus:ring-blue-400 focus:ring-2 cursor-pointer transition-all"}),(0,b.jsxs)("span",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",children:[l.common.selectAll," (",A.length,")"]})]}),o.size>0&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 dark:bg-blue-900/30",children:(0,b.jsx)("span",{className:"text-xs font-bold text-blue-600 dark:text-blue-400",children:o.size})}),(0,b.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300 font-medium",children:"selected"})]})]}),(0,b.jsx)("div",{className:"max-h-80 overflow-y-auto space-y-2 border border-gray-200 dark:border-gray-700 rounded-xl p-3 bg-gray-50 dark:bg-gray-900/50",children:q?(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,b.jsx)(j.FlowerSpinner,{size:32}),(0,b.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-3",children:l.ratechartManagement.loadingMachines})]}):0===A.length?(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)(C.RefreshCw,{className:"w-12 h-12 mx-auto mb-3 text-gray-400 dark:text-gray-500"}),(0,b.jsx)("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:l.ratechartManagement.noMachinesFound}),(0,b.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:l.ratechartManagement.tryChangingSocietyFilter})]}):A.map(a=>(0,b.jsxs)("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-all group ${o.has(a.id)?"border-blue-500 dark:border-blue-400 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 hover:border-blue-300 dark:hover:border-blue-600 hover:bg-blue-50/50 dark:hover:bg-blue-900/10"}`,children:[(0,b.jsx)("input",{type:"checkbox",checked:o.has(a.id),onChange:()=>{var b;return b=a.id,void p(a=>{let c=new Set(a);return c.has(b)?c.delete(b):c.add(b),c})},className:"w-4 h-4 text-blue-600 dark:text-blue-500 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded focus:ring-blue-500 dark:focus:ring-blue-400 focus:ring-2 cursor-pointer transition-all"}),(0,b.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-blue-100 to-indigo-100 dark:from-blue-900/50 dark:to-indigo-900/50 flex items-center justify-center flex-shrink-0 group-hover:scale-110 transition-transform",children:(0,b.jsx)("span",{className:"text-xs font-bold text-blue-700 dark:text-blue-300",children:a.machineId.charAt(0).toUpperCase()})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:a.machineId}),(0,b.jsx)("span",{className:"text-xs px-2 py-0.5 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded font-medium",children:a.machineType})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-1 text-xs",children:[(0,b.jsx)("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:a.societyName}),(0,b.jsx)("span",{className:"text-gray-400 dark:text-gray-500",children:"•"}),(0,b.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:a.societyIdentifier||`ID: ${a.societyId}`}),a.location&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:"text-gray-400 dark:text-gray-500",children:"•"}),(0,b.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:a.location})]})]})]})]},a.id))}),(0,b.jsx)(u.FormActions,{onCancel:d,onSubmit:z,submitText:o.size>0?`${l.common.reset} ${i} ${l.ratechartManagement.download} (${o.size})`:l.ratechartManagement.selectMachines,isLoading:v,isSubmitDisabled:0===o.size,loadingText:`${l.ratechartManagement.resetting} ${i}...`,submitIcon:(0,b.jsx)(C.RefreshCw,{className:"w-4 h-4"}),submitType:"button"})]})}):null}var W=a.i(756357),X=a.i(494443);function Y(){let a,r=(0,d.useRouter)(),{user:s}=(0,e.useUser)(),{t}=(0,f.useLanguage)(),[u,w]=(0,c.useState)([]),[x,y]=(0,c.useState)([]),[z,A]=(0,c.useState)([]),[B,C]=(0,c.useState)([]),[D,E]=(0,c.useState)([]),[F,G]=(0,c.useState)(!0),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)(""),[L,N]=(0,c.useState)(""),[O,P]=(0,c.useState)(!1),[Q,R]=(0,c.useState)(0),[U,Y]=(0,c.useState)([]),[Z,$]=(0,c.useState)([]),[_,aa]=(0,c.useState)([]),[ab,ac]=(0,c.useState)([]),[ad,ae]=(0,c.useState)("all"),[af,ag]=(0,c.useState)(""),[ah,ai]=(0,c.useState)(new Set),[aj,ak]=(0,c.useState)(!1),[al,am]=(0,c.useState)(!1),[an,ao]=(0,c.useState)(!1),[ap,aq]=(0,c.useState)(!1),[ar,as]=(0,c.useState)(null),[at,au]=(0,c.useState)(""),[av,aw]=(0,c.useState)(!1),[ax,ay]=(0,c.useState)(null),[az,aA]=(0,c.useState)("active"),[aB,aC]=(0,c.useState)(!1),[aD,aE]=(0,c.useState)(!1),[aF,aG]=(0,c.useState)(null),[aH,aI]=(0,c.useState)([]),[aJ,aK]=(0,c.useState)(!1),[aL,aM]=(0,c.useState)(""),[aN,aO]=(0,c.useState)(""),[aP,aQ]=(0,c.useState)(""),[aR,aS]=(0,c.useState)(!1),[aT,aU]=(0,c.useState)(null);(0,c.useEffect)(()=>{s&&"admin"!==s.role&&"super_admin"!==s.role&&r.push("/dashboard")},[s,r]);let aV=(0,c.useCallback)(async()=>{try{G(!0);let a=localStorage.getItem("authToken");if(!a)return;let b=await fetch("/api/user/ratechart",{headers:{Authorization:`Bearer ${a}`}}),c=await b.json();c.success&&w(c.data||[])}catch(a){console.error("Error fetching rate charts:",a),N(t.ratechartManagement.failedToLoadCharts)}finally{G(!1)}},[]),aW=(0,c.useCallback)(async()=>{try{let a=localStorage.getItem("authToken");if(!a)return;let b=await fetch("/api/user/society",{headers:{Authorization:`Bearer ${a}`}}),c=await b.json();if(console.log("Societies API response:",c),c.success){let a=c.data||[];console.log("Societies list:",a),y(a)}}catch(a){console.error("Error fetching societies:",a)}},[]),aX=(0,c.useCallback)(async()=>{try{let a=localStorage.getItem("authToken");if(!a)return;let b=await fetch("/api/user/dairy",{headers:{Authorization:`Bearer ${a}`}});if(b.ok){let a=await b.json();A(a.data||[])}}catch(a){console.error("Error fetching dairies:",a)}},[]),aY=(0,c.useCallback)(async()=>{try{let a=localStorage.getItem("authToken");if(!a)return;let b=await fetch("/api/user/bmc",{headers:{Authorization:`Bearer ${a}`}});if(b.ok){let a=await b.json();C(a.data||[])}}catch(a){console.error("Error fetching BMCs:",a)}},[]),aZ=(0,c.useCallback)(async()=>{try{let a=localStorage.getItem("authToken");if(!a)return;let b=await fetch("/api/user/machine",{headers:{Authorization:`Bearer ${a}`}});if(b.ok){let a=await b.json();E(a.data||[])}}catch(a){console.error("Error fetching machines:",a)}},[]);(0,c.useEffect)(()=>{s&&(aV(),aW(),aX(),aY(),aZ())},[s,aV,aW,aX,aY,aZ]),(0,c.useEffect)(()=>{let a=a=>{ag(a.detail?.query||"")};return window.addEventListener("globalSearch",a),()=>{window.removeEventListener("globalSearch",a)}},[]);let a$=async(a,b,c)=>{try{aK(!0);let d=localStorage.getItem("authToken");if(!d)return;let e=await fetch(`/api/user/ratechart/data?fileName=${encodeURIComponent(a)}&channel=${b}&societyId=${c}`,{headers:{Authorization:`Bearer ${d}`}}),f=await e.json();f.success?aI(f.data||[]):N("string"==typeof f.error?f.error:f.error?.message||t.ratechartManagement.failedToFetchData)}catch(a){console.error("Error fetching rate chart data:",a),N(t.ratechartManagement.failedToFetchData)}finally{aK(!1)}},a_=()=>{aE(!1),aG(null),aI([]),aM(""),aO(""),aQ("")},a0=async a=>{as(a);let b=Object.values(a5).find(b=>b.chartRecordIds.includes(a)||b.chartId===a);b&&b.societies.length>0?au(b.societies.map(a=>a.societyIdentifier||a.societyId.toString()).join(", ")):au(""),aq(!0)},a1=async()=>{if(ar)try{let a=localStorage.getItem("authToken"),b=await fetch(`/api/user/ratechart/${ar}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}}),c=await b.json();c.success?(K("Rate chart deleted successfully"),aV(),setTimeout(()=>{K("")},5e3)):(N(c.message||"Failed to delete rate chart"),setTimeout(()=>{N("")},5e3))}catch(a){console.error("Error deleting rate chart:",a),N("Error deleting rate chart"),setTimeout(()=>{N("")},5e3)}finally{aq(!1),as(null),au("")}},a2=async(a,b)=>{try{let c=localStorage.getItem("authToken");if(!c)return;let d=+(1!==b),e=Object.values(a5).find(b=>b.chartId===a),f=e?.chartRecordIds||[a],g=await fetch("/api/user/ratechart/status",{method:"PATCH",headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/json"},body:JSON.stringify({chartIds:f,status:d})}),h=await g.json();h.success?(K(`${t.ratechartManagement.statusUpdatedSuccessfully} ${1===d?t.ratechartManagement.active.toLowerCase():t.ratechartManagement.inactive.toLowerCase()}`),aV(),setTimeout(()=>{K("")},5e3)):(N(h.message||t.ratechartManagement.failedToUpdateStatus),setTimeout(()=>{N("")},5e3))}catch(a){console.error("Error updating status:",a),N(t.ratechartManagement.errorUpdatingStatus),setTimeout(()=>{N("")},5e3)}},a3=async a=>{try{let b=localStorage.getItem("authToken");if(!b)return;let c=Object.values(a5).filter(a=>a.chartRecordIds.some(a=>ah.has(a))),d=c.flatMap(a=>a.chartRecordIds),e=await fetch("/api/user/ratechart/status",{method:"PATCH",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"},body:JSON.stringify({chartIds:d,status:+("active"===a)})}),f=await e.json();f.success?(K(`✅ ${c.length} ${t.ratechartManagement.bulkStatusUpdated} ${"active"===a?t.ratechartManagement.active.toLowerCase():t.ratechartManagement.inactive.toLowerCase()}`),setTimeout(()=>K(""),5e3),ai(new Set),ak(!1),await aV()):(N(f.message||t.ratechartManagement.failedToUpdateStatus),setTimeout(()=>N(""),5e3))}catch(a){console.error("Error updating bulk status:",a),N(t.ratechartManagement.errorUpdatingStatus),setTimeout(()=>N(""),5e3)}},a4=u.filter(a=>{if("all"!==ad)if("unique"===ad){let b=u.some(b=>b.shared_chart_id===a.id);if(null!==a.shared_chart_id||b)return!1}else{var b;if((({COW:"COW",BUF:"BUFFALO",MIX:"MIXED",BUFFALO:"BUFFALO",MIXED:"MIXED"})[b=a.channel]||b)!==ad)return!1}if(""!==af){let b=af.toLowerCase();if(!(a.societyName.toLowerCase().includes(b)||a.societyIdentifier.toLowerCase().includes(b)||a.channel.toLowerCase().includes(b)||a.fileName.toLowerCase().includes(b)||a.uploadedBy.toLowerCase().includes(b)))return!1}return!0}),a5=a4.filter(a=>null===a.shared_chart_id).reduce((a,b)=>(a[b.id]={chartId:b.id,fileName:b.fileName,channel:b.channel,uploadedBy:b.uploadedBy,createdAt:b.uploadedAt,recordCount:b.recordCount,status:b.status,societies:[],chartRecordIds:[b.id]},a[b.id].societies.push({societyId:b.societyId,societyName:b.societyName,societyIdentifier:b.societyIdentifier,chartRecordId:b.id}),a4.forEach(c=>{c.shared_chart_id===b.id&&(a[b.id].societies.push({societyId:c.societyId,societyName:c.societyName,societyIdentifier:c.societyIdentifier,chartRecordId:c.id}),a[b.id].chartRecordIds.push(c.id))}),a),{}),a6=Object.values(a5).filter(a=>a.societies.some(a=>{let b=x.find(b=>b.id===a.societyId);if(!b)return!1;let c=b.bmc_id?B.find(a=>a.id===b.bmc_id):null,d=c?.dairyFarmId?z.find(a=>a.id===c.dairyFarmId):null;return!!(0===U.length||U.includes(d?.id.toString()||""))&&!!(0===Z.length||Z.includes(c?.id.toString()||""))&&!!(0===_.length||_.includes(a.societyId.toString()))&&(!(ab.length>0)||!!D.filter(b=>b.societyId===a.societyId).some(a=>ab.includes(a.id.toString())))&&!0}));(0,c.useEffect)(()=>{if(ah.size>0){let a=new Set(a4.map(a=>a.id)),b=new Set(Array.from(ah).filter(b=>a.has(b)));b.size!==ah.size&&(ai(b),ak(!1))}},[_,ad,af,u]);let a7=async()=>{if(0!==ah.size){am(!1),ao(!0),R(0);try{let a=localStorage.getItem("authToken");R(10);let b=Array.from(ah),c=b.map(b=>fetch(`/api/user/ratechart/${b}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}}));R(30),await Promise.all(c),R(70),await aV(),R(95),ai(new Set),ak(!1),K(`Successfully deleted ${b.length} rate chart(s)`),N(""),R(100),setTimeout(()=>{K("")},5e3)}catch(a){console.error("Error deleting rate charts:",a),N("Error deleting selected rate charts"),setTimeout(()=>{N("")},5e3)}finally{ao(!1),R(0)}}},a8=async(a,b)=>{if(ax)try{let c=localStorage.getItem("authToken");if(!c)return;let d=await fetch("/api/user/ratechart/assign",{method:"POST",headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/json"},body:JSON.stringify({masterChartId:ax.chartId,societyIds:a,replaceExisting:b})}),e=await d.json();if(409===d.status&&e.requiresConfirmation)return{requiresConfirmation:!0,conflicts:e.conflicts};if(e.success){K(`Successfully assigned chart to ${e.data.assignedCount} ${1===e.data.assignedCount?"society":"societies"}`),setTimeout(()=>K(""),5e3),await aV(),aw(!1),ay(null);return}N(e.message||"Failed to assign chart to societies"),setTimeout(()=>N(""),5e3)}catch(a){console.error("Error assigning chart to societies:",a),N("Error assigning chart to societies"),setTimeout(()=>N(""),5e3)}},a9=async a=>{if(aT)try{let b=localStorage.getItem("authToken");if(!b)return;let c=await fetch("/api/user/ratechart/reset-download",{method:"POST",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"},body:JSON.stringify({chartIds:aT.chartRecordIds||[aT.chartId],machineIds:a,channel:aT.channel})}),d=await c.json();if(d.success){let b=a.length,c=aT.fileName,d=aT.channel;K(`✅ Successfully reset ${d} channel download status for ${b} machine${b>1?"s":""}. Chart "${c}" can now be re-downloaded by selected machines.`),setTimeout(()=>K(""),6e3),aS(!1),aU(null)}else N(d.message||"Failed to reset download history"),setTimeout(()=>N(""),5e3)}catch(a){console.error("Error resetting download history:",a),N("❌ Error resetting download history. Please try again."),setTimeout(()=>N(""),5e3)}},ba=async(a,b,c)=>{try{let d=localStorage.getItem("authToken");if(!d)return;let e=await fetch("/api/user/ratechart/remove-society",{method:"POST",headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json"},body:JSON.stringify({chartId:a,societyId:b})}),f=await e.json();f.success?(K(`✅ Successfully removed ${c} from rate chart`),setTimeout(()=>K(""),5e3),w([]),await aV()):(N(f.message||"Failed to remove society"),setTimeout(()=>N(""),5e3))}catch(a){console.error("Error removing society:",a),N("❌ Error removing society. Please try again."),setTimeout(()=>N(""),5e3)}},bb=u.filter(a=>null===a.shared_chart_id),bc=bb.filter(a=>!u.some(b=>b.shared_chart_id===a.id)).length,bd=u.length,be=bb.filter(a=>"COW"===a.channel).length,bf=bb.filter(a=>"BUF"===a.channel).length,bg=bb.filter(a=>"MIX"===a.channel).length;return F?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsx)(j.FlowerSpinner,{size:48,isLoading:!0})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n.LoadingSnackbar,{isVisible:O||an,message:an?t.ratechartManagement.deletingRateCharts:t.ratechartManagement.uploadingRateChart,submessage:an?t.ratechartManagement.pleaseWaitDeleting:t.ratechartManagement.pleaseWaitUploading,progress:Q,showProgress:!0}),(0,b.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8 space-y-4 sm:space-y-6 lg:pb-8",children:[(0,b.jsx)(W.default,{title:t.ratechartManagement.title,subtitle:t.ratechartManagement.subtitle,icon:(0,b.jsx)(g.Receipt,{className:"w-5 h-5 sm:w-6 sm:h-6"}),onRefresh:aV}),(0,b.jsx)(k.StatusMessage,{success:J,error:L,onClose:()=>{K(""),N("")}}),(0,b.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-2 sm:gap-3",children:[(0,b.jsx)(l.StatsCard,{title:t.ratechartManagement.uniqueCharts,value:bc,icon:(0,b.jsx)(g.Receipt,{className:"w-4 h-4"}),color:"blue",onClick:()=>ae("unique"),clickable:!0,isActive:"unique"===ad}),(0,b.jsx)(l.StatsCard,{title:t.ratechartManagement.totalAssignments,value:bd,icon:(0,b.jsx)(g.Receipt,{className:"w-4 h-4"}),color:"gray",onClick:()=>{ae("all"),aC(!0)},clickable:!0,isActive:"all"===ad}),(0,b.jsx)(l.StatsCard,{title:t.ratechartManagement.cowCharts,value:be,icon:(0,b.jsx)(g.Receipt,{className:"w-4 h-4"}),color:"green",onClick:()=>ae("COW"),clickable:!0,isActive:"COW"===ad}),(0,b.jsx)(l.StatsCard,{title:t.ratechartManagement.buffaloCharts,value:bf,icon:(0,b.jsx)(g.Receipt,{className:"w-4 h-4"}),color:"blue",onClick:()=>ae("BUFFALO"),clickable:!0,isActive:"BUFFALO"===ad}),(0,b.jsx)(l.StatsCard,{title:t.ratechartManagement.mixedCharts,value:bg,icon:(0,b.jsx)(g.Receipt,{className:"w-4 h-4"}),color:"yellow",onClick:()=>ae("MIXED"),clickable:!0,isActive:"MIXED"===ad})]}),(0,b.jsx)(X.default,{statusFilter:"all",onStatusChange:()=>{},dairyFilter:U,onDairyChange:a=>Y(Array.isArray(a)?a:[a]),bmcFilter:Z,onBmcChange:a=>$(Array.isArray(a)?a:[a]),societyFilter:_,onSocietyChange:a=>aa(Array.isArray(a)?a:[a]),machineFilter:ab,onMachineChange:a=>ac(Array.isArray(a)?a:[a]),channelFilter:ad,onChannelChange:ae,dairies:z,bmcs:B,societies:x,machines:D,filteredCount:a6.length,totalCount:u.length,searchQuery:af,onSearchChange:ag,icon:(0,b.jsx)(g.Receipt,{className:"w-5 h-5"}),showChannelFilter:!0,hideMainFilterButton:!0}),ah.size>0&&(0,b.jsx)(o.BulkActionsToolbar,{selectedCount:a6.filter(a=>a.chartRecordIds.some(a=>ah.has(a))).length,totalCount:a6.length,onBulkDelete:()=>am(!0),onClearSelection:()=>{ai(new Set),ak(!1)},itemType:"rate chart",showStatusUpdate:!0,currentBulkStatus:az,onBulkStatusChange:a=>{aA(a),a3(a)},statusOptions:[{status:"active",label:t.ratechartManagement.active,color:"bg-green-500",bgColor:"hover:bg-green-50 dark:hover:bg-green-900/30"},{status:"inactive",label:t.ratechartManagement.inactive,color:"bg-red-500",bgColor:"hover:bg-red-50 dark:hover:bg-red-900/30"}]}),(0,b.jsx)("div",{className:"space-y-6",children:0===a6.length?(0,b.jsx)(m.EmptyState,{icon:(0,b.jsx)(g.Receipt,{className:"w-12 h-12"}),title:t.ratechartManagement.noRateChartsFound,message:t.ratechartManagement.uploadFirstChart,actionText:t.ratechartManagement.uploadRateChart,onAction:()=>I(!0),showAction:!0}):(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-4",children:a6.map(a=>{let c=a.chartRecordIds.every(a=>ah.has(a));return(0,b.jsx)(M,{chartId:a.chartId,fileName:a.fileName,channel:a.channel,uploadedBy:a.uploadedBy,createdAt:a.createdAt,societies:a.societies,status:a.status,isSelected:c,searchQuery:af,onToggleSelection:()=>{c?a.chartRecordIds.forEach(a=>{ai(b=>{let c=new Set(b);return c.delete(a),c})}):a.chartRecordIds.forEach(a=>{ai(b=>new Set(b).add(a))})},onAssignSociety:()=>{var b;return b=a.chartId,void(ay({chartId:b,fileName:a.fileName,societies:a.societies}),aw(!0))},onDelete:()=>a0(a.chartRecordIds[0]),onToggleStatus:a2,onView:()=>{var b,c,d;return b=a.fileName,void(aG({fileName:b,channel:c=a.channel,societyId:d=a.societies[0]?.societyId||0}),aE(!0),a$(b,c,d))},onResetDownload:()=>{var b,c,d,e,f;return b=a.chartId,c=a.fileName,d=a.channel,e=a.societies,f=a.chartRecordIds,void(aU({chartId:b,fileName:c,channel:d,societies:e.map(a=>({societyId:a.societyId,societyName:a.societyName})),chartRecordIds:f}),aS(!0))},onRemoveSociety:ba},a.chartId)})})})]}),(0,b.jsx)(v,{isOpen:H,onClose:()=>I(!1),societies:x,onUploadSuccess:a=>{K(a),aV(),setTimeout(()=>{K("")},5e3)},onUploadError:a=>{N(a),setTimeout(()=>{N("")},5e3)},onUploadStart:()=>P(!0),onUploadEnd:()=>P(!1),onProgressUpdate:a=>R(a)}),(0,b.jsx)(q.default,{isOpen:al,onClose:()=>am(!1),onConfirm:a7,itemCount:Object.values(a5).filter(a=>a.chartRecordIds.some(a=>ah.has(a))).length,itemType:"rate chart",hasFilters:_.length>0||"all"!==ad||""!==af,additionalInfo:(()=>{let a=Object.values(a5).filter(a=>a.chartRecordIds.some(a=>ah.has(a)));if(0!==a.length)return a.map(a=>{let b=a.societies.map(a=>a.societyIdentifier||a.societyId.toString()).join(", ");return`${a.fileName} (${a.channel}): ${b}`}).join(" | ")})()}),ax&&(0,b.jsx)(S,{isOpen:av,onClose:()=>{aw(!1),ay(null)},onAssign:a8,chartId:ax.chartId,fileName:ax.fileName,currentSocieties:ax.societies,allSocieties:x}),(0,b.jsx)(T,{isOpen:aB,onClose:()=>aC(!1),rateCharts:u}),(0,b.jsx)(q.default,{isOpen:ap,onClose:()=>{aq(!1),as(null),au("")},onConfirm:a1,itemCount:1,itemType:"rate chart",additionalInfo:at?`Assigned to society IDs: ${at}`:void 0}),aD&&aF&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,b.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Rate Chart - ",aF.channel," Channel"]}),(0,b.jsx)("button",{onClick:a_,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,b.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,b.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg mb-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"File Name"}),(0,b.jsx)("p",{className:"text-base font-semibold text-gray-900 dark:text-white",children:aF.fileName})]}),(0,b.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:aF.channel})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Search FAT"}),(0,b.jsx)("input",{type:"text",value:aL,onChange:a=>aM(a.target.value),placeholder:"e.g., 3.5",className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Search SNF"}),(0,b.jsx)("input",{type:"text",value:aN,onChange:a=>aO(a.target.value),placeholder:"e.g., 8.5",className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Search CLR"}),(0,b.jsx)("input",{type:"text",value:aP,onChange:a=>aQ(a.target.value),placeholder:"e.g., 25.0",className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})]}),(0,b.jsx)("div",{className:"overflow-auto max-h-[60vh]",children:aJ?(0,b.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,b.jsx)(j.FlowerSpinner,{})}):(a=aH.filter(a=>{let b=!aL||a.fat.toLowerCase().includes(aL.toLowerCase()),c=!aN||a.snf.toLowerCase().includes(aN.toLowerCase()),d=!aP||a.clr.toLowerCase().includes(aP.toLowerCase());return b&&c&&d})).length>0?(0,b.jsxs)("div",{children:[(0,b.jsxs)("table",{className:"w-full border-collapse",children:[(0,b.jsx)("thead",{className:"sticky top-0 bg-gray-100 dark:bg-gray-700",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider border border-gray-300 dark:border-gray-600",children:"FAT"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider border border-gray-300 dark:border-gray-600",children:"SNF"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider border border-gray-300 dark:border-gray-600",children:"CLR"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider border border-gray-300 dark:border-gray-600",children:"Rate"})]})}),(0,b.jsx)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:a.map((a,c)=>(0,b.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900 dark:text-gray-100 border border-gray-300 dark:border-gray-600",children:a.fat}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900 dark:text-gray-100 border border-gray-300 dark:border-gray-600",children:a.snf}),(0,b.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900 dark:text-gray-100 border border-gray-300 dark:border-gray-600",children:a.clr}),(0,b.jsxs)("td",{className:"px-4 py-3 text-sm font-semibold text-gray-900 dark:text-gray-100 border border-gray-300 dark:border-gray-600",children:["₹",a.rate]})]},c))})]}),(0,b.jsxs)("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400 text-right",children:["Showing ",a.length," of ",aH.length," records"]})]}):(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(h.FileText,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),(0,b.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:aL||aN||aP?"No matching records found":"No data available for this rate chart"})]})}),(0,b.jsx)("div",{className:"flex justify-end pt-4 border-t border-gray-200 dark:border-gray-700 mt-4",children:(0,b.jsx)("button",{onClick:a_,className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Close"})})]})})}),aT&&(0,b.jsx)(V,{show:aR,onClose:()=>{aS(!1),aU(null)},onConfirm:a9,chartId:aT.chartId,fileName:aT.fileName,channel:aT.channel,societies:aT.societies}),(0,b.jsx)(p.FloatingActionButton,{actions:[{icon:(0,b.jsx)(i.Upload,{className:"w-6 h-6 text-white"}),label:t.ratechartManagement.uploadRateChart,onClick:()=>I(!0),color:"bg-gradient-to-br from-green-500 to-green-600"}],directClick:!0})]})}a.s(["default",()=>Y],966674)}];

//# sourceMappingURL=src_app_admin_ratechart_page_tsx_eb54d762._.js.map