{"version":3,"sources":["turbopack:///[project]/src/components/modals/TransferSocietiesModal.tsx","turbopack:///[project]/src/components/modals/DeleteBMCModal.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect, useRef } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { X, AlertTriangle, Building2, ArrowRight, Users, CheckCircle, Mail, RefreshCw } from 'lucide-react';\r\n\r\ninterface Society {\r\n  id: number;\r\n  name: string;\r\n  society_id: string;\r\n}\r\n\r\ninterface BMC {\r\n  id: number;\r\n  name: string;\r\n  bmcId: string;\r\n}\r\n\r\ninterface TransferSocietiesModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onConfirm: (newBmcId: number | null, deleteAll: boolean, otp?: string) => void;\r\n  bmcName: string;\r\n  bmcId: number;\r\n  societies: Society[];\r\n  availableBMCs: BMC[];\r\n}\r\n\r\nexport default function TransferSocietiesModal({\r\n  isOpen,\r\n  onClose,\r\n  onConfirm,\r\n  bmcName,\r\n  bmcId,\r\n  societies,\r\n  availableBMCs\r\n}: TransferSocietiesModalProps) {\r\n  const [selectedBmcId, setSelectedBmcId] = useState<number | null>(null);\r\n  const [isTransferring, setIsTransferring] = useState(false);\r\n  const [deleteAll, setDeleteAll] = useState(false);\r\n  const [showOtpInput, setShowOtpInput] = useState(false);\r\n  const [otp, setOtp] = useState(['', '', '', '', '', '']);\r\n  const [otpSent, setOtpSent] = useState(false);\r\n  const [otpError, setOtpError] = useState('');\r\n  const [isSendingOtp, setIsSendingOtp] = useState(false);\r\n  const inputRefs = useRef<(HTMLInputElement | null)[]>([]);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      setSelectedBmcId(null);\r\n      setDeleteAll(false);\r\n      setShowOtpInput(false);\r\n      setOtp(['', '', '', '', '', '']);\r\n      setOtpSent(false);\r\n      setOtpError('');\r\n    }\r\n  }, [isOpen]);\r\n\r\n  const sendOTP = async () => {\r\n    setIsSendingOtp(true);\r\n    setOtpError('');\r\n    \r\n    try {\r\n      const token = localStorage.getItem('authToken');\r\n      const response = await fetch('/api/user/bmc/send-delete-otp', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({ bmcId, bmcName })\r\n      });\r\n\r\n      const result = await response.json();\r\n\r\n      if (response.ok) {\r\n        setOtpSent(true);\r\n        setShowOtpInput(true);\r\n        setTimeout(() => inputRefs.current[0]?.focus(), 100);\r\n      } else {\r\n        setOtpError(result.error || 'Failed to send OTP');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error sending OTP:', error);\r\n      setOtpError('Failed to send OTP. Please try again.');\r\n    } finally {\r\n      setIsSendingOtp(false);\r\n    }\r\n  };\r\n\r\n  const handleOtpChange = (index: number, value: string) => {\r\n    if (value.length > 1) return;\r\n    if (!/^\\d*$/.test(value)) return;\r\n\r\n    const newOtp = [...otp];\r\n    newOtp[index] = value;\r\n    setOtp(newOtp);\r\n\r\n    if (value && index < 5) {\r\n      inputRefs.current[index + 1]?.focus();\r\n    }\r\n  };\r\n\r\n  const handleOtpKeyDown = (index: number, e: React.KeyboardEvent) => {\r\n    if (e.key === 'Backspace' && !otp[index] && index > 0) {\r\n      inputRefs.current[index - 1]?.focus();\r\n    }\r\n  };\r\n\r\n  const handleOtpPaste = (e: React.ClipboardEvent) => {\r\n    e.preventDefault();\r\n    const pastedData = e.clipboardData.getData('text').replace(/\\D/g, '').slice(0, 6);\r\n    \r\n    if (pastedData.length === 6) {\r\n      const newOtp = pastedData.split('');\r\n      setOtp(newOtp);\r\n    }\r\n  };\r\n\r\n  const handleTransfer = async () => {\r\n    if (!deleteAll && !selectedBmcId) return;\r\n    \r\n    // Always require OTP for both transfer and delete-all\r\n    if (!otpSent) {\r\n      await sendOTP();\r\n      return;\r\n    }\r\n    \r\n    const otpCode = otp.join('');\r\n    if (otpCode.length !== 6) {\r\n      setOtpError('Please enter the 6-digit OTP');\r\n      return;\r\n    }\r\n\r\n    setIsTransferring(true);\r\n    try {\r\n      await onConfirm(selectedBmcId, deleteAll, otpCode);\r\n    } catch {\r\n      setOtpError('Invalid OTP. Please try again.');\r\n      setOtp(['', '', '', '', '', '']);\r\n      inputRefs.current[0]?.focus();\r\n    } finally {\r\n      setIsTransferring(false);\r\n    }\r\n  };\r\n\r\n  const selectedBmc = availableBMCs.find(bmc => bmc.id === selectedBmcId);\r\n\r\n  return (\r\n    <AnimatePresence>\r\n      {isOpen && (\r\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\r\n          {/* Backdrop */}\r\n          <motion.div\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            onClick={onClose}\r\n            className=\"absolute inset-0 bg-black/50 backdrop-blur-sm\"\r\n          />\r\n\r\n          {/* Modal */}\r\n          <motion.div\r\n            initial={{ opacity: 0, scale: 0.95, y: 20 }}\r\n            animate={{ opacity: 1, scale: 1, y: 0 }}\r\n            exit={{ opacity: 0, scale: 0.95, y: 20 }}\r\n            className=\"relative bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden\"\r\n          >\r\n            {/* Header */}\r\n            <div className=\"sticky top-0 bg-gradient-to-r from-orange-500 to-red-500 px-6 py-4\">\r\n              <div className=\"flex items-start justify-between\">\r\n                <div className=\"flex items-start gap-3\">\r\n                  <div className=\"p-2 bg-white/20 rounded-lg\">\r\n                    <AlertTriangle className=\"w-6 h-6 text-white\" />\r\n                  </div>\r\n                  <div>\r\n                    <h3 className=\"text-xl font-bold text-white\">Transfer Societies Required</h3>\r\n                    <p className=\"text-sm text-white/90 mt-1\">Cannot delete BMC with active societies</p>\r\n                  </div>\r\n                </div>\r\n                <button\r\n                  onClick={onClose}\r\n                  className=\"p-2 hover:bg-white/20 rounded-lg transition-colors\"\r\n                >\r\n                  <X className=\"w-5 h-5 text-white\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Content */}\r\n            <div className=\"p-6 overflow-y-auto max-h-[calc(90vh-200px)]\">\r\n              {/* Warning Message */}\r\n              <div className=\"mb-6 p-4 bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg\">\r\n                <div className=\"flex gap-3\">\r\n                  <AlertTriangle className=\"w-5 h-5 text-orange-600 dark:text-orange-400 flex-shrink-0 mt-0.5\" />\r\n                  <div>\r\n                    <h4 className=\"font-semibold text-orange-900 dark:text-orange-100\">\r\n                      {societies.length} {societies.length === 1 ? 'Society' : 'Societies'} Under This BMC\r\n                    </h4>\r\n                    <p className=\"text-sm text-orange-800 dark:text-orange-200 mt-1\">\r\n                      Before deleting <strong>{bmcName}</strong>, you must either transfer all societies to another BMC or delete everything.\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Delete All Option */}\r\n              <div className=\"mb-6\">\r\n                <label className=\"flex items-start gap-3 p-4 bg-red-50 dark:bg-red-900/20 border-2 border-red-200 dark:border-red-800 rounded-lg cursor-pointer hover:bg-red-100 dark:hover:bg-red-900/30 transition-colors\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={deleteAll}\r\n                    onChange={(e) => {\r\n                      setDeleteAll(e.target.checked);\r\n                      if (e.target.checked) {\r\n                        setSelectedBmcId(null);\r\n                      }\r\n                    }}\r\n                    className=\"mt-0.5 w-5 h-5 text-red-600 bg-white dark:bg-gray-700 border-red-300 dark:border-red-700 rounded focus:ring-2 focus:ring-red-500 cursor-pointer\"\r\n                  />\r\n                  <div className=\"flex-1\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <AlertTriangle className=\"w-5 h-5 text-red-600 dark:text-red-400\" />\r\n                      <span className=\"font-semibold text-red-900 dark:text-red-100\">\r\n                        Delete All Data (Permanent)\r\n                      </span>\r\n                    </div>\r\n                    <p className=\"text-sm text-red-800 dark:text-red-200 mt-1\">\r\n                      Delete all societies, farmers, machines, machine statistics, machine corrections, rate charts, collections, sales, dispatches, and section pulse data under this BMC. \r\n                      <strong className=\"block mt-1\">This action cannot be undone!</strong>\r\n                    </p>\r\n                  </div>\r\n                </label>\r\n              </div>\r\n\r\n              {/* Societies List */}\r\n              <div className=\"mb-6\">\r\n                <h4 className=\"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 flex items-center gap-2\">\r\n                  <Users className=\"w-4 h-4\" />\r\n                  Societies to Transfer ({societies.length})\r\n                </h4>\r\n                <div className=\"space-y-2 max-h-40 overflow-y-auto p-3 bg-gray-50 dark:bg-gray-900/50 rounded-lg border border-gray-200 dark:border-gray-700\">\r\n                  {societies.map((society) => (\r\n                    <div\r\n                      key={society.id}\r\n                      className=\"flex items-center justify-between p-2 bg-white dark:bg-gray-800 rounded border border-gray-200 dark:border-gray-700\"\r\n                    >\r\n                      <div>\r\n                        <p className=\"text-sm font-medium text-gray-900 dark:text-gray-100\">{society.name}</p>\r\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400\">ID: {society.society_id}</p>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n\r\n              {/* BMC Selection */}\r\n              <div>\r\n                <label className=\"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3\">\r\n                  Select Target BMC {!deleteAll && <span className=\"text-red-500\">*</span>}\r\n                </label>\r\n                {deleteAll && (\r\n                  <div className=\"mb-3 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg\">\r\n                    <p className=\"text-sm text-yellow-800 dark:text-yellow-200\">\r\n                      <strong>Delete All</strong> is enabled. BMC selection is disabled.\r\n                    </p>\r\n                  </div>\r\n                )}\r\n                <div className={`space-y-2 ${deleteAll ? 'opacity-50 pointer-events-none' : ''}`}>\r\n                  {availableBMCs.length === 0 ? (\r\n                    <div className=\"p-4 text-center bg-gray-50 dark:bg-gray-900/50 rounded-lg border border-gray-200 dark:border-gray-700\">\r\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n                        No other BMCs available. {!deleteAll && 'Please create a new BMC first or use Delete All option.'}\r\n                      </p>\r\n                    </div>\r\n                  ) : (\r\n                    availableBMCs.map((bmc) => (\r\n                      <button\r\n                        key={bmc.id}\r\n                        onClick={() => setSelectedBmcId(bmc.id)}\r\n                        disabled={deleteAll}\r\n                        className={`w-full p-4 rounded-lg border-2 transition-all text-left ${\r\n                          selectedBmcId === bmc.id\r\n                            ? 'border-green-500 bg-green-50 dark:bg-green-900/20'\r\n                            : 'border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 bg-white dark:bg-gray-800'\r\n                        }`}\r\n                      >\r\n                        <div className=\"flex items-center justify-between\">\r\n                          <div className=\"flex items-center gap-3\">\r\n                            <div className={`p-2 rounded-lg ${\r\n                              selectedBmcId === bmc.id\r\n                                ? 'bg-green-500'\r\n                                : 'bg-gray-100 dark:bg-gray-700'\r\n                            }`}>\r\n                              <Building2 className={`w-5 h-5 ${\r\n                                selectedBmcId === bmc.id\r\n                                  ? 'text-white'\r\n                                  : 'text-gray-600 dark:text-gray-400'\r\n                              }`} />\r\n                            </div>\r\n                            <div>\r\n                              <p className=\"font-medium text-gray-900 dark:text-gray-100\">{bmc.name}</p>\r\n                              <p className=\"text-sm text-gray-500 dark:text-gray-400\">ID: {bmc.bmcId}</p>\r\n                            </div>\r\n                          </div>\r\n                          {selectedBmcId === bmc.id && (\r\n                            <CheckCircle className=\"w-5 h-5 text-green-500\" />\r\n                          )}\r\n                        </div>\r\n                      </button>\r\n                    ))\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Transfer Preview */}\r\n              {selectedBmc && !deleteAll && (\r\n                <motion.div\r\n                  initial={{ opacity: 0, y: 10 }}\r\n                  animate={{ opacity: 1, y: 0 }}\r\n                  className=\"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg\"\r\n                >\r\n                  <div className=\"flex items-center justify-center gap-3 text-sm\">\r\n                    <div className=\"text-center\">\r\n                      <p className=\"font-medium text-gray-900 dark:text-gray-100\">{bmcName}</p>\r\n                      <p className=\"text-xs text-gray-500 dark:text-gray-400\">Current BMC</p>\r\n                    </div>\r\n                    <ArrowRight className=\"w-5 h-5 text-blue-600 dark:text-blue-400\" />\r\n                    <div className=\"text-center\">\r\n                      <p className=\"font-medium text-gray-900 dark:text-gray-100\">{selectedBmc.name}</p>\r\n                      <p className=\"text-xs text-gray-500 dark:text-gray-400\">New BMC</p>\r\n                    </div>\r\n                  </div>\r\n                  <p className=\"text-xs text-center text-blue-800 dark:text-blue-200 mt-2\">\r\n                    All {societies.length} {societies.length === 1 ? 'society' : 'societies'} will be transferred\r\n                  </p>\r\n                </motion.div>\r\n              )}\r\n\r\n              {/* Delete All Preview */}\r\n              {deleteAll && (\r\n                <motion.div\r\n                  initial={{ opacity: 0, y: 10 }}\r\n                  animate={{ opacity: 1, y: 0 }}\r\n                  className=\"mt-6 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg\"\r\n                >\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <AlertTriangle className=\"w-8 h-8 text-red-600 dark:text-red-400 flex-shrink-0\" />\r\n                    <div className=\"flex-1\">\r\n                      <h5 className=\"font-semibold text-red-900 dark:text-red-100 mb-1\">\r\n                        Complete Data Deletion\r\n                      </h5>\r\n                      <p className=\"text-sm text-red-800 dark:text-red-200\">\r\n                        The following will be permanently deleted:\r\n                      </p>\r\n                      <ul className=\"text-sm text-red-800 dark:text-red-200 mt-2 space-y-1 list-disc list-inside\">\r\n                        <li>{societies.length} {societies.length === 1 ? 'Society' : 'Societies'}</li>\r\n                        <li>All farmers under these societies</li>\r\n                        <li>All machines linked to these societies</li>\r\n                        <li>All machine statistics</li>\r\n                        <li>All machine corrections (admin & device saved)</li>\r\n                        <li>All rate charts and rate chart data</li>\r\n                        <li>All milk collection records</li>\r\n                        <li>All milk sales records</li>\r\n                        <li>All milk dispatch records</li>\r\n                        <li>All section pulse tracking data</li>\r\n                        <li>BMC: <strong>{bmcName}</strong></li>\r\n                      </ul>\r\n                    </div>\r\n                  </div>\r\n                </motion.div>\r\n              )}\r\n\r\n              {/* OTP Input Section */}\r\n              {otpSent && showOtpInput && (\r\n                <motion.div\r\n                  initial={{ opacity: 0, y: 10 }}\r\n                  animate={{ opacity: 1, y: 0 }}\r\n                  className=\"mt-6 p-4 bg-orange-50 dark:bg-orange-900/20 border-2 border-orange-300 dark:border-orange-700 rounded-lg\"\r\n                >\r\n                  <div className=\"text-center\">\r\n                    <h4 className=\"font-semibold text-orange-900 dark:text-orange-100 mb-2 flex items-center justify-center gap-2\">\r\n                      <Mail className=\"w-5 h-5\" />\r\n                      OTP Verification Required\r\n                    </h4>\r\n                    <p className=\"text-sm text-orange-800 dark:text-orange-200 mb-4\">\r\n                      We&apos;ve sent a 6-digit OTP to your registered email. Please enter it below to confirm {deleteAll ? 'deletion' : 'transfer'}.\r\n                    </p>\r\n                    \r\n                    {/* OTP Input Boxes */}\r\n                    <div className=\"flex justify-center gap-2 mb-4\">\r\n                      {otp.map((digit, index) => (\r\n                        <input\r\n                          key={index}\r\n                          ref={el => { inputRefs.current[index] = el; }}\r\n                          type=\"text\"\r\n                          inputMode=\"numeric\"\r\n                          maxLength={1}\r\n                          value={digit}\r\n                          onChange={(e) => handleOtpChange(index, e.target.value)}\r\n                          onKeyDown={(e) => handleOtpKeyDown(index, e)}\r\n                          onPaste={handleOtpPaste}\r\n                          className=\"w-12 h-14 text-center text-2xl font-bold border-2 border-orange-300 dark:border-orange-700 rounded-lg focus:border-orange-500 focus:ring-2 focus:ring-orange-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100\"\r\n                          disabled={isTransferring}\r\n                        />\r\n                      ))}\r\n                    </div>\r\n\r\n                    {otpError && (\r\n                      <p className=\"text-sm text-red-600 dark:text-red-400 mb-2\">{otpError}</p>\r\n                    )}\r\n\r\n                    <button\r\n                      onClick={sendOTP}\r\n                      disabled={isSendingOtp}\r\n                      className=\"text-sm text-orange-700 dark:text-orange-300 hover:text-orange-900 dark:hover:text-orange-100 flex items-center justify-center gap-1 mx-auto transition-colors disabled:opacity-50\"\r\n                    >\r\n                      <RefreshCw className=\"w-4 h-4\" />\r\n                      Resend OTP\r\n                    </button>\r\n                  </div>\r\n                </motion.div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Footer */}\r\n            <div className=\"sticky bottom-0 bg-gray-50 dark:bg-gray-900/50 px-6 py-4 border-t border-gray-200 dark:border-gray-700\">\r\n              <div className=\"flex gap-3\">\r\n                <button\r\n                  onClick={onClose}\r\n                  disabled={isTransferring}\r\n                  className=\"flex-1 px-4 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  onClick={handleTransfer}\r\n                  disabled={(!selectedBmcId && !deleteAll) || isTransferring || (otpSent && otp.join('').length !== 6)}\r\n                  className={`flex-1 px-4 py-2.5 text-sm font-medium text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 ${\r\n                    deleteAll \r\n                      ? 'bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700' \r\n                      : 'bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600'\r\n                  }`}\r\n                >\r\n                  {isTransferring ? (\r\n                    <>\r\n                      <div className=\"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin\" />\r\n                      {deleteAll ? 'Deleting All...' : 'Transferring...'}\r\n                    </>\r\n                  ) : !otpSent ? (\r\n                    <>\r\n                      <Mail className=\"w-4 h-4\" />\r\n                      Send OTP to Confirm\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      {deleteAll ? <AlertTriangle className=\"w-4 h-4\" /> : <ArrowRight className=\"w-4 h-4\" />}\r\n                      Verify OTP & {deleteAll ? 'Delete All' : 'Transfer'}\r\n                    </>\r\n                  )}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </motion.div>\r\n        </div>\r\n      )}\r\n    </AnimatePresence>\r\n  );\r\n}\r\n","'use client';\r\n\r\nimport { useState, useRef, KeyboardEvent, ClipboardEvent } from 'react';\r\nimport { X, AlertTriangle, Trash2, Send, ShieldCheck } from 'lucide-react';\r\n\r\ninterface DeleteBMCModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onConfirm: (otp: string) => Promise<void>;\r\n  bmcName: string;\r\n  loading?: boolean;\r\n  societyCount?: number;\r\n  farmerCount?: number;\r\n  collectionCount?: number;\r\n  machineCount?: number;\r\n}\r\n\r\nexport default function DeleteBMCModal({\r\n  isOpen,\r\n  onClose,\r\n  onConfirm,\r\n  bmcName,\r\n  loading = false,\r\n  societyCount = 0,\r\n  farmerCount = 0,\r\n  collectionCount = 0,\r\n  machineCount = 0\r\n}: DeleteBMCModalProps) {\r\n  const [step, setStep] = useState<'confirm' | 'otp'>('confirm');\r\n  const [otp, setOtp] = useState(['', '', '', '', '', '']);\r\n  const [otpLoading, setOtpLoading] = useState(false);\r\n  const [otpError, setOtpError] = useState('');\r\n  const inputRefs = useRef<(HTMLInputElement | null)[]>([]);\r\n\r\n  const handleSendOTP = async () => {\r\n    try {\r\n      setOtpLoading(true);\r\n      setOtpError('');\r\n\r\n      // Get BMC ID from window (stored by parent component)\r\n      const bmcId = (window as Window & { selectedBmcIdForDelete?: number }).selectedBmcIdForDelete;\r\n      if (!bmcId) {\r\n        setOtpError('BMC ID not found. Please try again.');\r\n        return;\r\n      }\r\n\r\n      const response = await fetch('/api/user/bmc/send-delete-otp', {\r\n        method: 'POST',\r\n        headers: { \r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${localStorage.getItem('authToken')}`\r\n        },\r\n        body: JSON.stringify({ bmcId }),\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (!response.ok) {\r\n        throw new Error(data.error || 'Failed to send OTP');\r\n      }\r\n\r\n      setStep('otp');\r\n      // Auto-focus first input\r\n      setTimeout(() => inputRefs.current[0]?.focus(), 100);\r\n    } catch (error: unknown) {\r\n      setOtpError(error instanceof Error ? error.message : 'Failed to send OTP');\r\n    } finally {\r\n      setOtpLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleOtpChange = (index: number, value: string) => {\r\n    if (value.length > 1) {\r\n      value = value[0];\r\n    }\r\n\r\n    if (!/^\\d*$/.test(value)) return;\r\n\r\n    const newOtp = [...otp];\r\n    newOtp[index] = value;\r\n    setOtp(newOtp);\r\n\r\n    // Auto-focus next input\r\n    if (value && index < 5) {\r\n      inputRefs.current[index + 1]?.focus();\r\n    }\r\n  };\r\n\r\n  const handleKeyDown = (index: number, e: KeyboardEvent<HTMLInputElement>) => {\r\n    if (e.key === 'Backspace' && !otp[index] && index > 0) {\r\n      inputRefs.current[index - 1]?.focus();\r\n    }\r\n  };\r\n\r\n  const handlePaste = (e: ClipboardEvent<HTMLInputElement>) => {\r\n    e.preventDefault();\r\n    const pastedData = e.clipboardData.getData('text').slice(0, 6);\r\n    if (!/^\\d+$/.test(pastedData)) return;\r\n\r\n    const newOtp = [...otp];\r\n    pastedData.split('').forEach((char, index) => {\r\n      if (index < 6) newOtp[index] = char;\r\n    });\r\n    setOtp(newOtp);\r\n\r\n    const nextEmptyIndex = newOtp.findIndex(val => !val);\r\n    if (nextEmptyIndex !== -1) {\r\n      inputRefs.current[nextEmptyIndex]?.focus();\r\n    } else {\r\n      inputRefs.current[5]?.focus();\r\n    }\r\n  };\r\n\r\n  const handleVerifyOtp = async () => {\r\n    const otpString = otp.join('');\r\n    if (otpString.length !== 6) {\r\n      setOtpError('Please enter the complete 6-digit OTP');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await onConfirm(otpString);\r\n      handleClose();\r\n    } catch (error: unknown) {\r\n      setOtpError(error instanceof Error ? error.message : 'Invalid or expired OTP');\r\n      setOtp(['', '', '', '', '', '']);\r\n      inputRefs.current[0]?.focus();\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setStep('confirm');\r\n    setOtp(['', '', '', '', '', '']);\r\n    setOtpError('');\r\n    onClose();\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm\">\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full overflow-hidden\">\r\n        {/* Header */}\r\n        <div className=\"bg-gradient-to-r from-red-500 to-red-600 px-6 py-4 flex items-center justify-between\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <div className=\"p-2 bg-white/20 rounded-lg\">\r\n              <Trash2 className=\"w-5 h-5 text-white\" />\r\n            </div>\r\n            <h3 className=\"text-lg font-semibold text-white\">\r\n              {step === 'confirm' ? 'Delete BMC' : 'Verify OTP'}\r\n            </h3>\r\n          </div>\r\n          <button\r\n            onClick={handleClose}\r\n            disabled={loading || otpLoading}\r\n            className=\"text-white/80 hover:text-white transition-colors disabled:opacity-50\"\r\n          >\r\n            <X className=\"w-5 h-5\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"p-6\">\r\n          {step === 'confirm' ? (\r\n            <>\r\n              {/* Warning Message */}\r\n              <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 mb-4\">\r\n                <div className=\"flex gap-3\">\r\n                  <AlertTriangle className=\"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5\" />\r\n                  <div>\r\n                    <p className=\"font-medium text-red-900 dark:text-red-100 mb-1\">\r\n                      Warning: This action cannot be undone\r\n                    </p>\r\n                    <p className=\"text-sm text-red-700 dark:text-red-300\">\r\n                      Deleting this BMC will permanently remove:\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Deletion Details */}\r\n              <div className=\"space-y-3 mb-6\">\r\n                <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4\">\r\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-1\">BMC Name</p>\r\n                  <p className=\"font-semibold text-gray-900 dark:text-gray-100\">{bmcName}</p>\r\n                </div>\r\n\r\n                <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4\">\r\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-2\">The following data will be deleted:</p>\r\n                  <ul className=\"space-y-1 text-sm text-gray-700 dark:text-gray-300\">\r\n                    {societyCount > 0 && (\r\n                      <li className=\"flex items-center gap-2\">\r\n                        <div className=\"w-1.5 h-1.5 bg-red-500 rounded-full\"></div>\r\n                        {societyCount} societ{societyCount > 1 ? 'ies' : 'y'}\r\n                      </li>\r\n                    )}\r\n                    {farmerCount > 0 && (\r\n                      <li className=\"flex items-center gap-2\">\r\n                        <div className=\"w-1.5 h-1.5 bg-red-500 rounded-full\"></div>\r\n                        {farmerCount} farmer{farmerCount > 1 ? 's' : ''} and their data\r\n                      </li>\r\n                    )}\r\n                    {collectionCount > 0 && (\r\n                      <li className=\"flex items-center gap-2\">\r\n                        <div className=\"w-1.5 h-1.5 bg-red-500 rounded-full\"></div>\r\n                        {collectionCount} collection record{collectionCount > 1 ? 's' : ''}\r\n                      </li>\r\n                    )}\r\n                    {machineCount > 0 && (\r\n                      <li className=\"flex items-center gap-2\">\r\n                        <div className=\"w-1.5 h-1.5 bg-red-500 rounded-full\"></div>\r\n                        {machineCount} machine{machineCount > 1 ? 's' : ''} and settings\r\n                      </li>\r\n                    )}\r\n                    {societyCount === 0 && farmerCount === 0 && collectionCount === 0 && machineCount === 0 && (\r\n                      <li className=\"flex items-center gap-2\">\r\n                        <div className=\"w-1.5 h-1.5 bg-red-500 rounded-full\"></div>\r\n                        The BMC details only\r\n                      </li>\r\n                    )}\r\n                  </ul>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Actions */}\r\n              <div className=\"flex gap-3\">\r\n                <button\r\n                  onClick={handleClose}\r\n                  disabled={loading || otpLoading}\r\n                  className=\"flex-1 px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors disabled:opacity-50\"\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  onClick={handleSendOTP}\r\n                  disabled={loading || otpLoading}\r\n                  className=\"flex-1 px-4 py-2.5 bg-gradient-to-r from-red-500 to-red-600 rounded-lg font-medium text-white hover:from-red-600 hover:to-red-700 transition-all disabled:opacity-50 flex items-center justify-center gap-2\"\r\n                >\r\n                  {otpLoading ? (\r\n                    <>\r\n                      <div className=\"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin\"></div>\r\n                      Sending OTP...\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      <Send className=\"w-4 h-4\" />\r\n                      Send OTP\r\n                    </>\r\n                  )}\r\n                </button>\r\n              </div>\r\n            </>\r\n          ) : (\r\n            <>\r\n              {/* OTP Instructions */}\r\n              <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4 mb-6\">\r\n                <div className=\"flex gap-3\">\r\n                  <ShieldCheck className=\"w-5 h-5 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5\" />\r\n                  <div>\r\n                    <p className=\"font-medium text-blue-900 dark:text-blue-100 mb-1\">\r\n                      OTP Sent to Your Email\r\n                    </p>\r\n                    <p className=\"text-sm text-blue-700 dark:text-blue-300\">\r\n                      Please enter the 6-digit OTP to confirm deletion. The code will expire in 10 minutes.\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* OTP Input */}\r\n              <div className=\"mb-6\">\r\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3\">\r\n                  Enter OTP Code\r\n                </label>\r\n                <div className=\"flex gap-2 justify-center\">\r\n                  {otp.map((digit, index) => (\r\n                    <input\r\n                      key={index}\r\n                      ref={el => { inputRefs.current[index] = el; }}\r\n                      type=\"text\"\r\n                      inputMode=\"numeric\"\r\n                      maxLength={1}\r\n                      value={digit}\r\n                      onChange={(e) => handleOtpChange(index, e.target.value)}\r\n                      onKeyDown={(e) => handleKeyDown(index, e)}\r\n                      onPaste={index === 0 ? handlePaste : undefined}\r\n                      className=\"w-12 h-14 text-center text-xl font-bold border-2 border-gray-300 dark:border-gray-600 rounded-lg focus:border-red-500 focus:ring-2 focus:ring-red-500/20 bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\r\n                      disabled={loading}\r\n                    />\r\n                  ))}\r\n                </div>\r\n                {otpError && (\r\n                  <p className=\"text-sm text-red-600 dark:text-red-400 mt-2 text-center\">{otpError}</p>\r\n                )}\r\n              </div>\r\n\r\n              {/* Actions */}\r\n              <div className=\"flex gap-3\">\r\n                <button\r\n                  onClick={() => {\r\n                    setStep('confirm');\r\n                    setOtp(['', '', '', '', '', '']);\r\n                    setOtpError('');\r\n                  }}\r\n                  disabled={loading}\r\n                  className=\"flex-1 px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors disabled:opacity-50\"\r\n                >\r\n                  Back\r\n                </button>\r\n                <button\r\n                  onClick={handleVerifyOtp}\r\n                  disabled={loading || otp.some(d => !d)}\r\n                  className=\"flex-1 px-4 py-2.5 bg-gradient-to-r from-red-500 to-red-600 rounded-lg font-medium text-white hover:from-red-600 hover:to-red-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\r\n                >\r\n                  {loading ? (\r\n                    <>\r\n                      <div className=\"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin\"></div>\r\n                      Deleting...\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      <Trash2 className=\"w-4 h-4\" />\r\n                      Delete BMC\r\n                    </>\r\n                  )}\r\n                </button>\r\n              </div>\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}