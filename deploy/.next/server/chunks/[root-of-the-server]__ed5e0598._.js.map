{"version":3,"sources":["turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/module.compiled.js","turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/rsc/react.ts","turbopack:///[project]/node_modules/next/dist/compiled/@edge-runtime/cookies/index.js","turbopack:///[project]/node_modules/ms/index.js","turbopack:///[project]/src/models/User.ts","turbopack:///[project]/src/lib/auth.ts"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-rsc']!.React\n","\"use strict\";\nvar __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __getOwnPropNames = Object.getOwnPropertyNames;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __export = (target, all) => {\n  for (var name in all)\n    __defProp(target, name, { get: all[name], enumerable: true });\n};\nvar __copyProps = (to, from, except, desc) => {\n  if (from && typeof from === \"object\" || typeof from === \"function\") {\n    for (let key of __getOwnPropNames(from))\n      if (!__hasOwnProp.call(to, key) && key !== except)\n        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });\n  }\n  return to;\n};\nvar __toCommonJS = (mod) => __copyProps(__defProp({}, \"__esModule\", { value: true }), mod);\n\n// src/index.ts\nvar src_exports = {};\n__export(src_exports, {\n  RequestCookies: () => RequestCookies,\n  ResponseCookies: () => ResponseCookies,\n  parseCookie: () => parseCookie,\n  parseSetCookie: () => parseSetCookie,\n  stringifyCookie: () => stringifyCookie\n});\nmodule.exports = __toCommonJS(src_exports);\n\n// src/serialize.ts\nfunction stringifyCookie(c) {\n  var _a;\n  const attrs = [\n    \"path\" in c && c.path && `Path=${c.path}`,\n    \"expires\" in c && (c.expires || c.expires === 0) && `Expires=${(typeof c.expires === \"number\" ? new Date(c.expires) : c.expires).toUTCString()}`,\n    \"maxAge\" in c && typeof c.maxAge === \"number\" && `Max-Age=${c.maxAge}`,\n    \"domain\" in c && c.domain && `Domain=${c.domain}`,\n    \"secure\" in c && c.secure && \"Secure\",\n    \"httpOnly\" in c && c.httpOnly && \"HttpOnly\",\n    \"sameSite\" in c && c.sameSite && `SameSite=${c.sameSite}`,\n    \"partitioned\" in c && c.partitioned && \"Partitioned\",\n    \"priority\" in c && c.priority && `Priority=${c.priority}`\n  ].filter(Boolean);\n  const stringified = `${c.name}=${encodeURIComponent((_a = c.value) != null ? _a : \"\")}`;\n  return attrs.length === 0 ? stringified : `${stringified}; ${attrs.join(\"; \")}`;\n}\nfunction parseCookie(cookie) {\n  const map = /* @__PURE__ */ new Map();\n  for (const pair of cookie.split(/; */)) {\n    if (!pair)\n      continue;\n    const splitAt = pair.indexOf(\"=\");\n    if (splitAt === -1) {\n      map.set(pair, \"true\");\n      continue;\n    }\n    const [key, value] = [pair.slice(0, splitAt), pair.slice(splitAt + 1)];\n    try {\n      map.set(key, decodeURIComponent(value != null ? value : \"true\"));\n    } catch {\n    }\n  }\n  return map;\n}\nfunction parseSetCookie(setCookie) {\n  if (!setCookie) {\n    return void 0;\n  }\n  const [[name, value], ...attributes] = parseCookie(setCookie);\n  const {\n    domain,\n    expires,\n    httponly,\n    maxage,\n    path,\n    samesite,\n    secure,\n    partitioned,\n    priority\n  } = Object.fromEntries(\n    attributes.map(([key, value2]) => [\n      key.toLowerCase().replace(/-/g, \"\"),\n      value2\n    ])\n  );\n  const cookie = {\n    name,\n    value: decodeURIComponent(value),\n    domain,\n    ...expires && { expires: new Date(expires) },\n    ...httponly && { httpOnly: true },\n    ...typeof maxage === \"string\" && { maxAge: Number(maxage) },\n    path,\n    ...samesite && { sameSite: parseSameSite(samesite) },\n    ...secure && { secure: true },\n    ...priority && { priority: parsePriority(priority) },\n    ...partitioned && { partitioned: true }\n  };\n  return compact(cookie);\n}\nfunction compact(t) {\n  const newT = {};\n  for (const key in t) {\n    if (t[key]) {\n      newT[key] = t[key];\n    }\n  }\n  return newT;\n}\nvar SAME_SITE = [\"strict\", \"lax\", \"none\"];\nfunction parseSameSite(string) {\n  string = string.toLowerCase();\n  return SAME_SITE.includes(string) ? string : void 0;\n}\nvar PRIORITY = [\"low\", \"medium\", \"high\"];\nfunction parsePriority(string) {\n  string = string.toLowerCase();\n  return PRIORITY.includes(string) ? string : void 0;\n}\nfunction splitCookiesString(cookiesString) {\n  if (!cookiesString)\n    return [];\n  var cookiesStrings = [];\n  var pos = 0;\n  var start;\n  var ch;\n  var lastComma;\n  var nextStart;\n  var cookiesSeparatorFound;\n  function skipWhitespace() {\n    while (pos < cookiesString.length && /\\s/.test(cookiesString.charAt(pos))) {\n      pos += 1;\n    }\n    return pos < cookiesString.length;\n  }\n  function notSpecialChar() {\n    ch = cookiesString.charAt(pos);\n    return ch !== \"=\" && ch !== \";\" && ch !== \",\";\n  }\n  while (pos < cookiesString.length) {\n    start = pos;\n    cookiesSeparatorFound = false;\n    while (skipWhitespace()) {\n      ch = cookiesString.charAt(pos);\n      if (ch === \",\") {\n        lastComma = pos;\n        pos += 1;\n        skipWhitespace();\n        nextStart = pos;\n        while (pos < cookiesString.length && notSpecialChar()) {\n          pos += 1;\n        }\n        if (pos < cookiesString.length && cookiesString.charAt(pos) === \"=\") {\n          cookiesSeparatorFound = true;\n          pos = nextStart;\n          cookiesStrings.push(cookiesString.substring(start, lastComma));\n          start = pos;\n        } else {\n          pos = lastComma + 1;\n        }\n      } else {\n        pos += 1;\n      }\n    }\n    if (!cookiesSeparatorFound || pos >= cookiesString.length) {\n      cookiesStrings.push(cookiesString.substring(start, cookiesString.length));\n    }\n  }\n  return cookiesStrings;\n}\n\n// src/request-cookies.ts\nvar RequestCookies = class {\n  constructor(requestHeaders) {\n    /** @internal */\n    this._parsed = /* @__PURE__ */ new Map();\n    this._headers = requestHeaders;\n    const header = requestHeaders.get(\"cookie\");\n    if (header) {\n      const parsed = parseCookie(header);\n      for (const [name, value] of parsed) {\n        this._parsed.set(name, { name, value });\n      }\n    }\n  }\n  [Symbol.iterator]() {\n    return this._parsed[Symbol.iterator]();\n  }\n  /**\n   * The amount of cookies received from the client\n   */\n  get size() {\n    return this._parsed.size;\n  }\n  get(...args) {\n    const name = typeof args[0] === \"string\" ? args[0] : args[0].name;\n    return this._parsed.get(name);\n  }\n  getAll(...args) {\n    var _a;\n    const all = Array.from(this._parsed);\n    if (!args.length) {\n      return all.map(([_, value]) => value);\n    }\n    const name = typeof args[0] === \"string\" ? args[0] : (_a = args[0]) == null ? void 0 : _a.name;\n    return all.filter(([n]) => n === name).map(([_, value]) => value);\n  }\n  has(name) {\n    return this._parsed.has(name);\n  }\n  set(...args) {\n    const [name, value] = args.length === 1 ? [args[0].name, args[0].value] : args;\n    const map = this._parsed;\n    map.set(name, { name, value });\n    this._headers.set(\n      \"cookie\",\n      Array.from(map).map(([_, value2]) => stringifyCookie(value2)).join(\"; \")\n    );\n    return this;\n  }\n  /**\n   * Delete the cookies matching the passed name or names in the request.\n   */\n  delete(names) {\n    const map = this._parsed;\n    const result = !Array.isArray(names) ? map.delete(names) : names.map((name) => map.delete(name));\n    this._headers.set(\n      \"cookie\",\n      Array.from(map).map(([_, value]) => stringifyCookie(value)).join(\"; \")\n    );\n    return result;\n  }\n  /**\n   * Delete all the cookies in the cookies in the request.\n   */\n  clear() {\n    this.delete(Array.from(this._parsed.keys()));\n    return this;\n  }\n  /**\n   * Format the cookies in the request as a string for logging\n   */\n  [Symbol.for(\"edge-runtime.inspect.custom\")]() {\n    return `RequestCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`;\n  }\n  toString() {\n    return [...this._parsed.values()].map((v) => `${v.name}=${encodeURIComponent(v.value)}`).join(\"; \");\n  }\n};\n\n// src/response-cookies.ts\nvar ResponseCookies = class {\n  constructor(responseHeaders) {\n    /** @internal */\n    this._parsed = /* @__PURE__ */ new Map();\n    var _a, _b, _c;\n    this._headers = responseHeaders;\n    const setCookie = (_c = (_b = (_a = responseHeaders.getSetCookie) == null ? void 0 : _a.call(responseHeaders)) != null ? _b : responseHeaders.get(\"set-cookie\")) != null ? _c : [];\n    const cookieStrings = Array.isArray(setCookie) ? setCookie : splitCookiesString(setCookie);\n    for (const cookieString of cookieStrings) {\n      const parsed = parseSetCookie(cookieString);\n      if (parsed)\n        this._parsed.set(parsed.name, parsed);\n    }\n  }\n  /**\n   * {@link https://wicg.github.io/cookie-store/#CookieStore-get CookieStore#get} without the Promise.\n   */\n  get(...args) {\n    const key = typeof args[0] === \"string\" ? args[0] : args[0].name;\n    return this._parsed.get(key);\n  }\n  /**\n   * {@link https://wicg.github.io/cookie-store/#CookieStore-getAll CookieStore#getAll} without the Promise.\n   */\n  getAll(...args) {\n    var _a;\n    const all = Array.from(this._parsed.values());\n    if (!args.length) {\n      return all;\n    }\n    const key = typeof args[0] === \"string\" ? args[0] : (_a = args[0]) == null ? void 0 : _a.name;\n    return all.filter((c) => c.name === key);\n  }\n  has(name) {\n    return this._parsed.has(name);\n  }\n  /**\n   * {@link https://wicg.github.io/cookie-store/#CookieStore-set CookieStore#set} without the Promise.\n   */\n  set(...args) {\n    const [name, value, cookie] = args.length === 1 ? [args[0].name, args[0].value, args[0]] : args;\n    const map = this._parsed;\n    map.set(name, normalizeCookie({ name, value, ...cookie }));\n    replace(map, this._headers);\n    return this;\n  }\n  /**\n   * {@link https://wicg.github.io/cookie-store/#CookieStore-delete CookieStore#delete} without the Promise.\n   */\n  delete(...args) {\n    const [name, options] = typeof args[0] === \"string\" ? [args[0]] : [args[0].name, args[0]];\n    return this.set({ ...options, name, value: \"\", expires: /* @__PURE__ */ new Date(0) });\n  }\n  [Symbol.for(\"edge-runtime.inspect.custom\")]() {\n    return `ResponseCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`;\n  }\n  toString() {\n    return [...this._parsed.values()].map(stringifyCookie).join(\"; \");\n  }\n};\nfunction replace(bag, headers) {\n  headers.delete(\"set-cookie\");\n  for (const [, value] of bag) {\n    const serialized = stringifyCookie(value);\n    headers.append(\"set-cookie\", serialized);\n  }\n}\nfunction normalizeCookie(cookie = { name: \"\", value: \"\" }) {\n  if (typeof cookie.expires === \"number\") {\n    cookie.expires = new Date(cookie.expires);\n  }\n  if (cookie.maxAge) {\n    cookie.expires = new Date(Date.now() + cookie.maxAge * 1e3);\n  }\n  if (cookie.path === null || cookie.path === void 0) {\n    cookie.path = \"/\";\n  }\n  return cookie;\n}\n// Annotate the CommonJS export names for ESM import in node:\n0 && (module.exports = {\n  RequestCookies,\n  ResponseCookies,\n  parseCookie,\n  parseSetCookie,\n  stringifyCookie\n});\n","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar w = d * 7;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function (val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isFinite(val)) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^(-?(?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'weeks':\n    case 'week':\n    case 'w':\n      return n * w;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (msAbs >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (msAbs >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (msAbs >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return plural(ms, msAbs, d, 'day');\n  }\n  if (msAbs >= h) {\n    return plural(ms, msAbs, h, 'hour');\n  }\n  if (msAbs >= m) {\n    return plural(ms, msAbs, m, 'minute');\n  }\n  if (msAbs >= s) {\n    return plural(ms, msAbs, s, 'second');\n  }\n  return ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, msAbs, n, name) {\n  var isPlural = msAbs >= n * 1.5;\n  return Math.round(ms / n) + ' ' + name + (isPlural ? 's' : '');\n}\n","import { DataTypes, Model, Sequelize } from 'sequelize';\r\nimport bcrypt from 'bcryptjs';\r\n\r\n// User roles in hierarchical order\r\nexport enum UserRole {\r\n  SUPER_ADMIN = 'super_admin',\r\n  ADMIN = 'admin',\r\n  DAIRY = 'dairy',\r\n  BMC = 'bmc',\r\n  SOCIETY = 'society',\r\n  FARMER = 'farmer'\r\n}\r\n\r\n// User status\r\nexport enum UserStatus {\r\n  PENDING = 'pending',\r\n  PENDING_APPROVAL = 'pending_approval', // Email verified, waiting for super admin approval\r\n  ACTIVE = 'active',\r\n  INACTIVE = 'inactive',\r\n  SUSPENDED = 'suspended'\r\n}\r\n\r\n// User attributes interface\r\nexport interface UserAttributes {\r\n  id?: number;\r\n  uid: string;\r\n  email: string;\r\n  password: string;\r\n  fullName: string;\r\n  role: UserRole;\r\n  status: UserStatus;\r\n  dbKey?: string; // For admins - their dedicated schema key\r\n  companyName?: string;\r\n  companyPincode?: string;\r\n  companyCity?: string;\r\n  companyState?: string;\r\n  parentId?: number; // Reference to parent user in hierarchy\r\n  isEmailVerified: boolean;\r\n  emailVerificationToken?: string;\r\n  emailVerificationExpires?: Date;\r\n  passwordResetToken?: string;\r\n  passwordResetExpires?: Date;\r\n  otpCode?: string;\r\n  otpExpires?: Date;\r\n  lastLogin?: Date;\r\n  loginAttempts: number;\r\n  lockUntil?: Date;\r\n  createdAt?: Date;\r\n  updatedAt?: Date;\r\n}\r\n\r\n// User model class\r\nclass User extends Model<UserAttributes> implements UserAttributes {\r\n  // Remove public class fields to avoid shadowing Sequelize getters/setters\r\n  declare id: number;\r\n  declare uid: string;\r\n  declare email: string;\r\n  declare password: string;\r\n  declare fullName: string;\r\n  declare role: UserRole;\r\n  declare status: UserStatus;\r\n  declare dbKey?: string;\r\n  declare companyName?: string;\r\n  declare companyPincode?: string;\r\n  declare companyCity?: string;\r\n  declare companyState?: string;\r\n  declare parentId?: number;\r\n  declare isEmailVerified: boolean;\r\n  declare emailVerificationToken?: string;\r\n  declare emailVerificationExpires?: Date;\r\n  declare passwordResetToken?: string;\r\n  declare passwordResetExpires?: Date;\r\n  declare otpCode?: string;\r\n  declare otpExpires?: Date;\r\n  declare lastLogin?: Date;\r\n  declare loginAttempts: number;\r\n  declare lockUntil?: Date;\r\n\r\n  // Timestamps\r\n  declare readonly createdAt: Date;\r\n  declare readonly updatedAt: Date;\r\n\r\n  // Instance methods\r\n  public async comparePassword(candidatePassword: string): Promise<boolean> {\r\n    return bcrypt.compare(candidatePassword, this.password);\r\n  }\r\n\r\n  public async incLoginAttempts(): Promise<void> {\r\n    // If we have a previous lock that has expired, restart at 1\r\n    if (this.lockUntil && this.lockUntil < new Date()) {\r\n      await this.update({\r\n        loginAttempts: 1,\r\n        lockUntil: undefined\r\n      });\r\n      return;\r\n    }\r\n\r\n    const updates: Partial<UserAttributes> = { loginAttempts: this.loginAttempts + 1 };\r\n\r\n    // Lock account after 5 failed attempts for 2 hours\r\n    if (this.loginAttempts + 1 >= 5 && !this.isLocked) {\r\n      updates.lockUntil = new Date(Date.now() + 2 * 60 * 60 * 1000); // 2 hours\r\n    }\r\n\r\n    await this.update(updates);\r\n  }\r\n\r\n  public async resetLoginAttempts(): Promise<void> {\r\n    await this.update({\r\n      loginAttempts: 0,\r\n      lockUntil: undefined\r\n    });\r\n  }\r\n\r\n  public get isLocked(): boolean {\r\n    return !!(this.lockUntil && this.lockUntil > new Date());\r\n  }\r\n\r\n\r\n\r\n  public canManageRole(targetRole: UserRole): boolean {\r\n    const roleHierarchy = [\r\n      UserRole.SUPER_ADMIN,\r\n      UserRole.ADMIN,\r\n      UserRole.DAIRY,\r\n      UserRole.BMC,\r\n      UserRole.SOCIETY,\r\n      UserRole.FARMER\r\n    ];\r\n\r\n    const currentRoleIndex = roleHierarchy.indexOf(this.role);\r\n    const targetRoleIndex = roleHierarchy.indexOf(targetRole);\r\n\r\n    return currentRoleIndex < targetRoleIndex;\r\n  }\r\n}\r\n\r\n// Initialize User model\r\nexport const initUserModel = (sequelize: Sequelize): typeof User => {\r\n  User.init(\r\n    {\r\n      id: {\r\n        type: DataTypes.INTEGER,\r\n        primaryKey: true,\r\n        autoIncrement: true,\r\n      },\r\n      uid: {\r\n        type: DataTypes.STRING(50),\r\n        allowNull: false,\r\n        unique: true,\r\n        validate: {\r\n          notEmpty: true,\r\n          len: [3, 50]\r\n        }\r\n      },\r\n      email: {\r\n        type: DataTypes.STRING(255),\r\n        allowNull: false,\r\n        unique: true,\r\n        validate: {\r\n          isEmail: true,\r\n          notEmpty: true\r\n        }\r\n      },\r\n      password: {\r\n        type: DataTypes.STRING(255),\r\n        allowNull: false,\r\n        validate: {\r\n          notEmpty: true,\r\n          len: [6, 255]\r\n        }\r\n      },\r\n      fullName: {\r\n        type: DataTypes.STRING(200),\r\n        allowNull: false,\r\n        validate: {\r\n          notEmpty: true,\r\n          len: [2, 200]\r\n        }\r\n      },\r\n      role: {\r\n        type: DataTypes.ENUM(...Object.values(UserRole)),\r\n        allowNull: false,\r\n        defaultValue: UserRole.FARMER\r\n      },\r\n      status: {\r\n        type: DataTypes.ENUM(...Object.values(UserStatus)),\r\n        allowNull: false,\r\n        defaultValue: UserStatus.PENDING\r\n      },\r\n      dbKey: {\r\n        type: DataTypes.STRING(50),\r\n        allowNull: true,\r\n        unique: true,\r\n        comment: 'Dedicated database schema key for admins'\r\n      },\r\n      companyName: {\r\n        type: DataTypes.STRING(255),\r\n        allowNull: true\r\n      },\r\n      companyPincode: {\r\n        type: DataTypes.STRING(10),\r\n        allowNull: true,\r\n        validate: {\r\n          len: [5, 10]\r\n        }\r\n      },\r\n      companyCity: {\r\n        type: DataTypes.STRING(100),\r\n        allowNull: true,\r\n        validate: {\r\n          len: [2, 100]\r\n        }\r\n      },\r\n      companyState: {\r\n        type: DataTypes.STRING(100),\r\n        allowNull: true,\r\n        validate: {\r\n          len: [2, 100]\r\n        }\r\n      },\r\n      parentId: {\r\n        type: DataTypes.INTEGER,\r\n        allowNull: true,\r\n        references: {\r\n          model: 'users',\r\n          key: 'id'\r\n        }\r\n      },\r\n      isEmailVerified: {\r\n        type: DataTypes.BOOLEAN,\r\n        allowNull: false,\r\n        defaultValue: false\r\n      },\r\n      emailVerificationToken: {\r\n        type: DataTypes.STRING(255),\r\n        allowNull: true\r\n      },\r\n      emailVerificationExpires: {\r\n        type: DataTypes.DATE,\r\n        allowNull: true\r\n      },\r\n      passwordResetToken: {\r\n        type: DataTypes.STRING(255),\r\n        allowNull: true\r\n      },\r\n      passwordResetExpires: {\r\n        type: DataTypes.DATE,\r\n        allowNull: true\r\n      },\r\n      otpCode: {\r\n        type: DataTypes.STRING(10),\r\n        allowNull: true\r\n      },\r\n      otpExpires: {\r\n        type: DataTypes.DATE,\r\n        allowNull: true\r\n      },\r\n      lastLogin: {\r\n        type: DataTypes.DATE,\r\n        allowNull: true\r\n      },\r\n      loginAttempts: {\r\n        type: DataTypes.INTEGER,\r\n        allowNull: false,\r\n        defaultValue: 0\r\n      },\r\n      lockUntil: {\r\n        type: DataTypes.DATE,\r\n        allowNull: true\r\n      }\r\n    },\r\n    {\r\n      sequelize,\r\n      modelName: 'User',\r\n      tableName: 'users',\r\n      timestamps: true,\r\n      hooks: {\r\n        beforeSave: async (user: User) => {\r\n          // Hash password if it's being modified\r\n          if (user.changed('password') && user.password) {\r\n            const salt = await bcrypt.genSalt(12);\r\n            user.password = await bcrypt.hash(user.password, salt);\r\n          }\r\n\r\n          // Generate UID if not provided\r\n          if (!user.uid && user.email) {\r\n            const timestamp = Date.now().toString().slice(-6);\r\n            const emailPrefix = user.email.substring(0, 3).toUpperCase();\r\n            user.uid = `${emailPrefix}${timestamp}`;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  );\r\n\r\n  // Define associations\r\n  User.hasMany(User, { \r\n    as: 'Children', \r\n    foreignKey: 'parentId',\r\n    onDelete: 'SET NULL'\r\n  });\r\n  \r\n  User.belongsTo(User, { \r\n    as: 'Parent', \r\n    foreignKey: 'parentId',\r\n    onDelete: 'SET NULL'\r\n  });\r\n\r\n  return User;\r\n};\r\n\r\nexport default User;","import jwt from 'jsonwebtoken';\r\nimport crypto from 'crypto';\r\nimport { UserRole } from '@/models/User';\r\n\r\n// JWT configuration\r\nconst JWT_SECRET = process.env.JWT_SECRET || 'your-super-secret-jwt-key';\r\nconst JWT_REFRESH_SECRET = process.env.JWT_REFRESH_SECRET || 'your-super-secret-refresh-jwt-key';\r\n\r\n// JWT payload interface\r\nexport interface JWTPayload {\r\n  id: number;\r\n  uid: string;\r\n  email: string;\r\n  role: UserRole | string; // Allow string for external auth entity types\r\n  dbKey?: string;\r\n  entityType?: 'society' | 'farmer' | 'dairy' | 'bmc'; // For external auth\r\n  schemaName?: string; // For external auth\r\n}\r\n\r\n// Generate JWT tokens\r\nexport const generateTokens = (user: JWTPayload) => {\r\n  const payload = {\r\n    id: user.id,\r\n    uid: user.uid,\r\n    email: user.email,\r\n    role: user.role,\r\n    dbKey: user.dbKey,\r\n    entityType: user.entityType,\r\n    schemaName: user.schemaName\r\n  };\r\n\r\n  const token = jwt.sign(payload, JWT_SECRET as string, {\r\n    expiresIn: '7d',\r\n    issuer: 'poornasree-equipments-cloud',\r\n    audience: 'psr-client'\r\n  });\r\n\r\n  const refreshToken = jwt.sign(payload, JWT_REFRESH_SECRET as string, {\r\n    expiresIn: '30d',\r\n    issuer: 'poornasree-equipments-cloud',\r\n    audience: 'psr-client'\r\n  });\r\n\r\n  return { token, refreshToken };\r\n};\r\n\r\n// Verify JWT token\r\nexport const verifyToken = (token: string): JWTPayload | null => {\r\n  try {\r\n    const decoded = jwt.verify(token, JWT_SECRET as string, {\r\n      issuer: 'poornasree-equipments-cloud',\r\n      audience: 'psr-client'\r\n    }) as JWTPayload;\r\n    return decoded;\r\n  } catch (error) {\r\n    console.error('JWT verification failed:', error);\r\n    return null;\r\n  }\r\n};\r\n\r\n// Verify refresh token\r\nexport const verifyRefreshToken = (token: string): JWTPayload | null => {\r\n  try {\r\n    const decoded = jwt.verify(token, JWT_REFRESH_SECRET as string, {\r\n      issuer: 'poornasree-equipments-cloud',\r\n      audience: 'psr-client'\r\n    }) as JWTPayload;\r\n    return decoded;\r\n  } catch (error) {\r\n    console.error('Refresh token verification failed:', error);\r\n    return null;\r\n  }\r\n};\r\n\r\n// Generate random token\r\nexport const generateRandomToken = (length: number = 32): string => {\r\n  return crypto.randomBytes(length).toString('hex');\r\n};\r\n\r\n// Generate OTP\r\nexport const generateOTP = (length: number = 6): string => {\r\n  const digits = '0123456789';\r\n  let otp = '';\r\n  for (let i = 0; i < length; i++) {\r\n    otp += digits[Math.floor(Math.random() * digits.length)];\r\n  }\r\n  return otp;\r\n};\r\n\r\n// Hash token for database storage\r\nexport const hashToken = (token: string): string => {\r\n  return crypto.createHash('sha256').update(token).digest('hex');\r\n};\r\n\r\n// Role hierarchy checker\r\nexport const canManageRole = (userRole: UserRole, targetRole: UserRole): boolean => {\r\n  const roleHierarchy: Record<UserRole, number> = {\r\n    [UserRole.SUPER_ADMIN]: 0,\r\n    [UserRole.ADMIN]: 1,\r\n    [UserRole.DAIRY]: 2,\r\n    [UserRole.BMC]: 3,\r\n    [UserRole.SOCIETY]: 4,\r\n    [UserRole.FARMER]: 5\r\n  };\r\n\r\n  return roleHierarchy[userRole] < roleHierarchy[targetRole];\r\n};\r\n\r\n// Get allowed roles for user\r\nexport const getAllowedRoles = (userRole: UserRole): UserRole[] => {\r\n  const allRoles = [\r\n    UserRole.SUPER_ADMIN,\r\n    UserRole.ADMIN,\r\n    UserRole.DAIRY,\r\n    UserRole.BMC,\r\n    UserRole.SOCIETY,\r\n    UserRole.FARMER\r\n  ];\r\n\r\n  const roleHierarchy: Record<UserRole, number> = {\r\n    [UserRole.SUPER_ADMIN]: 0,\r\n    [UserRole.ADMIN]: 1,\r\n    [UserRole.DAIRY]: 2,\r\n    [UserRole.BMC]: 3,\r\n    [UserRole.SOCIETY]: 4,\r\n    [UserRole.FARMER]: 5\r\n  };\r\n\r\n  const userLevel = roleHierarchy[userRole];\r\n  return allRoles.filter(role => roleHierarchy[role] > userLevel);\r\n};\r\n\r\n// Check if user is super admin\r\nexport const isSuperAdmin = (user: { email?: string; role?: UserRole }): boolean => {\r\n  const superAdminEmail = process.env.SUPER_ADMIN_USERNAME || 'admin';\r\n  return (\r\n    user.email === superAdminEmail || \r\n    user.role === UserRole.SUPER_ADMIN\r\n  );\r\n};\r\n\r\n// Validate password strength\r\nexport const validatePassword = (password: string): { \r\n  isValid: boolean; \r\n  errors: string[] \r\n} => {\r\n  const errors: string[] = [];\r\n  \r\n  if (password.length < 8) {\r\n    errors.push('Password must be at least 8 characters long');\r\n  }\r\n  \r\n  if (!/[A-Z]/.test(password)) {\r\n    errors.push('Password must contain at least one uppercase letter');\r\n  }\r\n  \r\n  if (!/[a-z]/.test(password)) {\r\n    errors.push('Password must contain at least one lowercase letter');\r\n  }\r\n  \r\n  if (!/\\d/.test(password)) {\r\n    errors.push('Password must contain at least one number');\r\n  }\r\n  \r\n  if (!/[!@#$%^&*()_+\\-=\\[\\]{};':\"\\\\|,.<>\\/?]/.test(password)) {\r\n    errors.push('Password must contain at least one special character');\r\n  }\r\n\r\n  return {\r\n    isValid: errors.length === 0,\r\n    errors\r\n  };\r\n};\r\n\r\n// Generate secure session ID\r\nexport const generateSessionId = (): string => {\r\n  return crypto.randomBytes(64).toString('hex');\r\n};\r\n\r\nconst authUtils = {\r\n  generateTokens,\r\n  verifyToken,\r\n  verifyRefreshToken,\r\n  generateRandomToken,\r\n  generateOTP,\r\n  hashToken,\r\n  canManageRole,\r\n  getAllowedRoles,\r\n  isSuperAdmin,\r\n  validatePassword,\r\n  generateSessionId\r\n};\r\n\r\nexport default authUtils;"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK","vendored","React"],"mappings":"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","ignoreList":[0,1,2,3]}