module.exports=[136543,e=>{"use strict";var t=e.i(89171);e.i(79832),e.i(213075),e.s(["createErrorResponse",0,(e,r=400)=>t.NextResponse.json({success:!1,error:{message:e,code:r.toString()},timestamp:new Date().toISOString()},{status:r}),"createSuccessResponse",0,(e,r="Success",a=200)=>t.NextResponse.json({success:!0,message:r,data:e,timestamp:new Date().toISOString()},{status:a}),"validateRequiredFields",0,(e,t)=>{let r=t.filter(t=>!e[t]||"string"==typeof e[t]&&""===e[t].trim());return r.length>0?{success:!1,missing:r}:{success:!0}}])},233405,(e,t,r)=>{t.exports=e.x("child_process",()=>require("child_process"))},736987,e=>{"use strict";var t=e.i(233405);let r=(0,e.i(224361).promisify)(t.exec);class a{constructor(){}async up(){try{console.log("ðŸš€ Running database migrations...");let{stdout:e,stderr:t}=await r("npx sequelize-cli db:migrate");if(t&&!t.includes("WARNING"))throw Error(t);console.log("âœ… Migrations completed successfully"),e&&console.log(e)}catch(e){throw console.error("âŒ Migration failed:",e),e}}async down(){try{console.log("âª Rolling back last migration...");let{stdout:e,stderr:t}=await r("npx sequelize-cli db:migrate:undo");if(t&&!t.includes("WARNING"))throw Error(t);console.log("âœ… Rollback completed successfully"),e&&console.log(e)}catch(e){throw console.error("âŒ Rollback failed:",e),e}}async status(){try{console.log("ðŸ“Š Checking migration status..."),console.log("\n--- Executed Migrations ---");let{stdout:e}=await r("npx sequelize-cli db:migrate:status");console.log(e||"No migrations executed yet")}catch(e){throw console.error("âŒ Status check failed:",e),e}}async getMigrationStatus(){try{console.log("ðŸ“Š Getting migration status...");let{stdout:e}=await r("npx sequelize-cli db:migrate:status");return e||"No migrations executed yet"}catch(e){throw console.error("âŒ Get migration status failed:",e),e}}async runMigrations(){return this.up()}async undoLastMigration(){return this.down()}async runSeeders(){return this.seed()}async undoSeeders(){try{console.log("ðŸ”„ Undoing all seeders...");let{stdout:e,stderr:t}=await r("npx sequelize-cli db:seed:undo:all");if(t&&!t.includes("WARNING"))throw Error(t);console.log("âœ… All seeders undone successfully"),e&&console.log(e)}catch(e){throw console.error("âŒ Undo seeders failed:",e),e}}async initializeDatabase(){return this.init()}async seed(){try{console.log("ðŸŒ± Seeding database...");let{stdout:e,stderr:t}=await r("npx sequelize-cli db:seed:all");if(t&&!t.includes("WARNING"))throw Error(t);console.log("âœ… Seeding completed successfully"),e&&console.log(e)}catch(e){throw console.error("âŒ Seeding failed:",e),e}}async init(){try{console.log("ðŸ—ï¸  Initializing database..."),console.log("Creating database...");try{await r("npx sequelize-cli db:create")}catch(e){console.log("Database already exists or creation failed, continuing...")}await this.up(),await this.seed(),console.log("âœ… Database initialization completed successfully")}catch(e){throw console.error("âŒ Database initialization failed:",e),e}}async reset(){try{console.log("ðŸ”„ Resetting database...");let{stdout:e,stderr:t}=await r("npm run db:reset");if(t&&!t.includes("WARNING"))throw Error(t);console.log("âœ… Database reset completed successfully"),e&&console.log(e)}catch(e){throw console.error("âŒ Database reset failed:",e),e}}}let s=new a;e.s(["MigrationRunner",()=>a,"migrationRunner",0,s])},593148,e=>{"use strict";var t=e.i(747909),r=e.i(174017),a=e.i(996250),s=e.i(759756),n=e.i(561916),o=e.i(114444),i=e.i(837092),l=e.i(869741),c=e.i(316795),u=e.i(487718),d=e.i(995169),p=e.i(47587),g=e.i(666012),h=e.i(570101),R=e.i(626937),f=e.i(10372),m=e.i(193695);e.i(52474);var w=e.i(600220),y=e.i(136543),E=e.i(736987),v=e.i(79832),S=e.i(213075);async function b(e){let t=e.cookies.get("auth-token")?.value||e.headers.get("authorization")?.replace("Bearer ","");if(!t)return!1;let r=(0,v.verifyToken)(t);return!!r&&"string"!=typeof r&&r.role===S.UserRole.SUPER_ADMIN}async function x(e){try{if(!await b(e))return(0,y.createErrorResponse)("Unauthorized. Super admin access required.",403);let t=await E.migrationRunner.getMigrationStatus();return(0,y.createSuccessResponse)("Migration status retrieved successfully",JSON.stringify({status:t}))}catch(e){return console.error("Get migration status error:",e),(0,y.createErrorResponse)("Failed to get migration status",500)}}async function N(e){try{if(!await b(e))return(0,y.createErrorResponse)("Unauthorized. Super admin access required.",403);let{action:t}=await e.json();switch(t){case"migrate":return await E.migrationRunner.runMigrations(),(0,y.createSuccessResponse)("Migrations completed successfully","{}");case"migrate_undo":return await E.migrationRunner.undoLastMigration(),(0,y.createSuccessResponse)("Last migration undone successfully","{}");case"seed":return await E.migrationRunner.runSeeders(),(0,y.createSuccessResponse)("Seeders completed successfully","{}");case"seed_undo":return await E.migrationRunner.undoSeeders(),(0,y.createSuccessResponse)("All seeders undone successfully","{}");case"init":return await E.migrationRunner.initializeDatabase(),(0,y.createSuccessResponse)("Database initialized successfully","{}");case"status":let r=await E.migrationRunner.getMigrationStatus();return(0,y.createSuccessResponse)("Migration status retrieved successfully",JSON.stringify({status:r}));default:return(0,y.createErrorResponse)("Invalid action. Valid actions: migrate, migrate_undo, seed, seed_undo, init, status",400)}}catch(e){return console.error("Database management error:",e),(0,y.createErrorResponse)(`Database operation failed: ${e}`,500)}}e.s(["GET",()=>x,"POST",()=>N],501900);var A=e.i(501900);let C=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/superadmin/database/route",pathname:"/api/superadmin/database",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/superadmin/database/route.ts",nextConfigOutput:"",userland:A}),{workAsyncStorage:M,workUnitAsyncStorage:T,serverHooks:_}=C;function D(){return(0,a.patchFetch)({workAsyncStorage:M,workUnitAsyncStorage:T})}async function O(e,t,a){C.isDev&&(0,s.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let y="/api/superadmin/database/route";y=y.replace(/\/index$/,"")||"/";let E=await C.prepare(e,t,{srcPage:y,multiZoneDraftMode:!1});if(!E)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:v,params:S,nextConfig:b,parsedUrl:x,isDraftMode:N,prerenderManifest:A,routerServerContext:M,isOnDemandRevalidate:T,revalidateOnlyGenerated:_,resolvedPathname:D,clientReferenceManifest:O,serverActionsManifest:q}=E,I=(0,l.normalizeAppPath)(y),P=!!(A.dynamicRoutes[I]||A.routes[D]),U=async()=>((null==M?void 0:M.render404)?await M.render404(e,t,x,!1):t.end("This page could not be found"),null);if(P&&!N){let e=!!A.routes[D],t=A.dynamicRoutes[I];if(t&&!1===t.fallback&&!e){if(b.experimental.adapterPath)return await U();throw new m.NoFallbackError}}let k=null;!P||C.isDev||N||(k="/index"===(k=D)?"/":k);let z=!0===C.isDev||!P,H=P&&!z;q&&O&&(0,o.setReferenceManifestsSingleton)({page:y,clientReferenceManifest:O,serverActionsManifest:q,serverModuleMap:(0,i.createServerModuleMap)({serverActionsManifest:q})});let G=e.method||"GET",j=(0,n.getTracer)(),F=j.getActiveScopeSpan(),$={params:S,prerenderManifest:A,renderOpts:{experimental:{authInterrupts:!!b.experimental.authInterrupts},cacheComponents:!!b.cacheComponents,supportsDynamicResponse:z,incrementalCache:(0,s.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:b.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>C.onRequestError(e,t,a,M)},sharedContext:{buildId:v}},K=new c.NodeNextRequest(e),L=new c.NodeNextResponse(t),W=u.NextRequestAdapter.fromNodeNextRequest(K,(0,u.signalFromNodeResponse)(t));try{let o=async e=>C.handle(W,$).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=j.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${G} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${G} ${y}`)}),i=!!(0,s.getRequestMeta)(e,"minimalMode"),l=async s=>{var n,l;let c=async({previousCacheEntry:r})=>{try{if(!i&&T&&_&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await o(s);e.fetchMetrics=$.renderOpts.fetchMetrics;let l=$.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let c=$.renderOpts.collectedTags;if(!P)return await (0,g.sendResponse)(K,L,n,$.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,h.toNodeOutgoingHttpHeaders)(n.headers);c&&(t[f.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==$.renderOpts.collectedRevalidate&&!($.renderOpts.collectedRevalidate>=f.INFINITE_CACHE)&&$.renderOpts.collectedRevalidate,a=void 0===$.renderOpts.collectedExpire||$.renderOpts.collectedExpire>=f.INFINITE_CACHE?void 0:$.renderOpts.collectedExpire;return{value:{kind:w.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await C.onRequestError(e,t,{routerKind:"App Router",routePath:y,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:T})},M),t}},u=await C.handleResponse({req:e,nextConfig:b,cacheKey:k,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:A,isRoutePPREnabled:!1,isOnDemandRevalidate:T,revalidateOnlyGenerated:_,responseGenerator:c,waitUntil:a.waitUntil,isMinimalMode:i});if(!P)return null;if((null==u||null==(n=u.value)?void 0:n.kind)!==w.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(l=u.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});i||t.setHeader("x-nextjs-cache",T?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),N&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let d=(0,h.fromNodeOutgoingHttpHeaders)(u.value.headers);return i&&P||d.delete(f.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||t.getHeader("Cache-Control")||d.get("Cache-Control")||d.set("Cache-Control",(0,R.getCacheControlHeader)(u.cacheControl)),await (0,g.sendResponse)(K,L,new Response(u.value.body,{headers:d,status:u.value.status||200})),null};F?await l(F):await j.withPropagatedContext(e.headers,()=>j.trace(d.BaseServerSpan.handleRequest,{spanName:`${G} ${y}`,kind:n.SpanKind.SERVER,attributes:{"http.method":G,"http.target":e.url}},l))}catch(t){if(t instanceof m.NoFallbackError||await C.onRequestError(e,t,{routerKind:"App Router",routePath:I,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:T})}),P)throw t;return await (0,g.sendResponse)(K,L,new Response(null,{status:500})),null}}e.s(["handler",()=>O,"patchFetch",()=>D,"routeModule",()=>C,"serverHooks",()=>_,"workAsyncStorage",()=>M,"workUnitAsyncStorage",()=>T],593148)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__f5756574._.js.map