module.exports=[136543,e=>{"use strict";var t=e.i(89171);e.i(79832),e.i(213075),e.s(["createErrorResponse",0,(e,a=400)=>t.NextResponse.json({success:!1,error:{message:e,code:a.toString()},timestamp:new Date().toISOString()},{status:a}),"createSuccessResponse",0,(e,a="Success",r=200)=>t.NextResponse.json({success:!0,message:a,data:e,timestamp:new Date().toISOString()},{status:r}),"validateRequiredFields",0,(e,t)=>{let a=t.filter(t=>!e[t]||"string"==typeof e[t]&&""===e[t].trim());return a.length>0?{success:!1,missing:a}:{success:!0}}])},180725,553146,e=>{"use strict";var t=e.i(84168),a=e.i(213075),r=e.i(191273);class i extends r.Model{id;adminId;schemaKey;schemaName;status;configuration;createdAt;updatedAt;static associate(e){i.belongsTo(e.User,{foreignKey:"adminId",as:"admin"})}}var s=r;class n extends s.Model{id;userId;action;resource;resourceId;oldValues;newValues;ipAddress;userAgent;timestamp;static associate(e){n.belongsTo(e.User,{foreignKey:"userId",as:"user"})}}var o=r;class l extends o.Model{id;machineType;description;isActive}let c=e=>(l.init({id:{type:o.DataTypes.INTEGER,autoIncrement:!0,primaryKey:!0},machineType:{type:o.DataTypes.STRING(100),allowNull:!1,unique:!0,field:"machine_type",validate:{notEmpty:!0,len:[1,100]},comment:"Machine type/model identifier"},description:{type:o.DataTypes.TEXT,allowNull:!0,comment:"Optional description of the machine type"},isActive:{type:o.DataTypes.BOOLEAN,allowNull:!1,defaultValue:!0,field:"is_active",comment:"Whether this machine type is active"}},{sequelize:e,modelName:"Machine",tableName:"machinetype",timestamps:!1,indexes:[{unique:!0,fields:["machine_type"]},{fields:["is_active"]}]}),l);e.s(["Machine",()=>l,"default",0,l,"initMachineModel",0,c],553146),e.s(["getModels",0,()=>{let e=(0,t.default)();if(!e)throw Error("Database not initialized");let o=(0,a.initUserModel)(e),l=(i.init({id:{type:r.DataTypes.INTEGER,autoIncrement:!0,primaryKey:!0},adminId:{type:r.DataTypes.INTEGER,allowNull:!1,references:{model:"Users",key:"id"}},schemaKey:{type:r.DataTypes.STRING(50),allowNull:!1,unique:!0},schemaName:{type:r.DataTypes.STRING(255),allowNull:!1},status:{type:r.DataTypes.ENUM("active","inactive","suspended","maintenance"),allowNull:!1,defaultValue:"active"},configuration:{type:r.DataTypes.JSON,allowNull:!0}},{sequelize:e,modelName:"AdminSchema",tableName:"AdminSchemas",timestamps:!0,indexes:[{fields:["adminId"]},{fields:["schemaKey"]},{fields:["status"]}]}),i),d=(n.init({id:{type:s.DataTypes.INTEGER,autoIncrement:!0,primaryKey:!0},userId:{type:s.DataTypes.INTEGER,allowNull:!0,references:{model:"Users",key:"id"}},action:{type:s.DataTypes.STRING(100),allowNull:!1},resource:{type:s.DataTypes.STRING(100),allowNull:!1},resourceId:{type:s.DataTypes.STRING(50),allowNull:!0},oldValues:{type:s.DataTypes.JSON,allowNull:!0},newValues:{type:s.DataTypes.JSON,allowNull:!0},ipAddress:{type:s.DataTypes.STRING(45),allowNull:!0},userAgent:{type:s.DataTypes.TEXT,allowNull:!0},timestamp:{type:s.DataTypes.DATE,allowNull:!1,defaultValue:s.DataTypes.NOW}},{sequelize:e,modelName:"AuditLog",tableName:"AuditLogs",timestamps:!1,indexes:[{fields:["userId"]},{fields:["action"]},{fields:["resource"]},{fields:["resourceId"]},{fields:["timestamp"]},{fields:["ipAddress"]}]}),n),u=c(e),p={User:o,AdminSchema:l,AuditLog:d,Machine:u};return o.associate&&o.associate(p),l.associate&&l.associate(p),d.associate&&d.associate(p),{User:o,AdminSchema:l,AuditLog:d,Machine:u,sequelize:e}}],180725)},136571,e=>{"use strict";var t=e.i(747909),a=e.i(174017),r=e.i(996250),i=e.i(759756),s=e.i(561916),n=e.i(114444),o=e.i(837092),l=e.i(869741),c=e.i(316795),d=e.i(487718),u=e.i(995169),p=e.i(47587),m=e.i(666012),h=e.i(570101),y=e.i(626937),f=e.i(10372),R=e.i(193695);e.i(52474);var T=e.i(600220),E=e.i(84168),w=e.i(180725),v=e.i(136543);async function g(){try{await (0,E.connectDB)();let{Machine:e}=(0,w.getModels)(),t=await e.findAll({order:[["machineType","ASC"]],attributes:["id","machineType","description","isActive"]});return(0,v.createSuccessResponse)({machines:t,total:t.length},"Machines fetched successfully")}catch(e){return console.error("Error fetching machines:",e),(0,v.createErrorResponse)("Failed to fetch machines",500)}}async function N(e){try{await (0,E.connectDB)();let{Machine:t}=(0,w.getModels)(),a=await e.json();if(a.bulkData&&Array.isArray(a.bulkData)){let e={success:0,failed:0,duplicates:0,errors:[]};for(let r of a.bulkData)try{if(!r.machineType||"string"!=typeof r.machineType){e.failed++,e.errors.push(`Invalid machine type: ${r.machineType||"empty"}`);continue}let a=r.machineType.trim();if(!a){e.failed++,e.errors.push("Empty machine type");continue}if(await t.findOne({where:{machineType:a}})){e.duplicates++;continue}await t.create({machineType:a,description:r.description||"",isActive:!1!==r.isActive}),e.success++}catch(t){e.failed++,e.errors.push(`Error creating ${r.machineType}: ${t}`)}return(0,v.createSuccessResponse)(e,`Bulk upload completed: ${e.success} created, ${e.duplicates} duplicates, ${e.failed} failed`)}let r=(0,v.validateRequiredFields)(a,["machineType"]);if(!r.success)return(0,v.createErrorResponse)(`Missing required fields: ${r.missing?.join(", ")}`,400);let{machineType:i,description:s,isActive:n}=a;if(await t.findOne({where:{machineType:i.trim()}}))return(0,v.createErrorResponse)("Machine type already exists",409);let o=await t.create({machineType:i.trim(),description:s||"",isActive:!1!==n});return(0,v.createSuccessResponse)(o,"Machine created successfully")}catch(e){return console.error("Error creating machine:",e),(0,v.createErrorResponse)("Failed to create machine",500)}}async function A(e){try{await (0,E.connectDB)();let{Machine:t}=(0,w.getModels)(),a=await e.json(),r=(0,v.validateRequiredFields)(a,["id"]);if(!r.success)return(0,v.createErrorResponse)(`Missing required fields: ${r.missing?.join(", ")}`,400);let{id:i,machineType:s,description:n,isActive:o}=a,l=await t.findByPk(i);if(!l)return(0,v.createErrorResponse)("Machine not found",404);if(s&&s!==l.machineType&&await t.findOne({where:{machineType:s.trim()}}))return(0,v.createErrorResponse)("Machine type already exists",409);let c={};return s&&(c.machineType=s.trim()),void 0!==n&&(c.description=n),void 0!==o&&(c.isActive=o),await l.update(c),(0,v.createSuccessResponse)(l,"Machine updated successfully")}catch(e){return console.error("Error updating machine:",e),(0,v.createErrorResponse)("Failed to update machine",500)}}async function D(e){try{await (0,E.connectDB)();let{Machine:t}=(0,w.getModels)(),a=new URL(e.url).searchParams.get("id");if(!a)return(0,v.createErrorResponse)("Machine ID is required",400);let r=await t.findByPk(a);if(!r)return(0,v.createErrorResponse)("Machine not found",404);return await r.destroy(),(0,v.createSuccessResponse)(null,"Machine deleted successfully")}catch(e){return console.error("Error deleting machine:",e),(0,v.createErrorResponse)("Failed to delete machine",500)}}e.s(["DELETE",()=>D,"GET",()=>g,"POST",()=>N,"PUT",()=>A],816738);var S=e.i(816738);let I=new t.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/superadmin/machines/route",pathname:"/api/superadmin/machines",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/superadmin/machines/route.ts",nextConfigOutput:"",userland:S}),{workAsyncStorage:M,workUnitAsyncStorage:x,serverHooks:C}=I;function O(){return(0,r.patchFetch)({workAsyncStorage:M,workUnitAsyncStorage:x})}async function b(e,t,r){I.isDev&&(0,i.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let E="/api/superadmin/machines/route";E=E.replace(/\/index$/,"")||"/";let w=await I.prepare(e,t,{srcPage:E,multiZoneDraftMode:!1});if(!w)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:v,params:g,nextConfig:N,parsedUrl:A,isDraftMode:D,prerenderManifest:S,routerServerContext:M,isOnDemandRevalidate:x,revalidateOnlyGenerated:C,resolvedPathname:O,clientReferenceManifest:b,serverActionsManifest:P}=w,_=(0,l.normalizeAppPath)(E),q=!!(S.dynamicRoutes[_]||S.routes[O]),U=async()=>((null==M?void 0:M.render404)?await M.render404(e,t,A,!1):t.end("This page could not be found"),null);if(q&&!D){let e=!!S.routes[O],t=S.dynamicRoutes[_];if(t&&!1===t.fallback&&!e){if(N.experimental.adapterPath)return await U();throw new R.NoFallbackError}}let k=null;!q||I.isDev||D||(k="/index"===(k=O)?"/":k);let H=!0===I.isDev||!q,$=q&&!H;P&&b&&(0,n.setReferenceManifestsSingleton)({page:E,clientReferenceManifest:b,serverActionsManifest:P,serverModuleMap:(0,o.createServerModuleMap)({serverActionsManifest:P})});let G=e.method||"GET",K=(0,s.getTracer)(),F=K.getActiveScopeSpan(),j={params:g,prerenderManifest:S,renderOpts:{experimental:{authInterrupts:!!N.experimental.authInterrupts},cacheComponents:!!N.cacheComponents,supportsDynamicResponse:H,incrementalCache:(0,i.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:N.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,a,r)=>I.onRequestError(e,t,r,M)},sharedContext:{buildId:v}},B=new c.NodeNextRequest(e),L=new c.NodeNextResponse(t),V=d.NextRequestAdapter.fromNodeNextRequest(B,(0,d.signalFromNodeResponse)(t));try{let n=async e=>I.handle(V,j).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let a=K.getRootSpanAttributes();if(!a)return;if(a.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${a.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let r=a.get("next.route");if(r){let t=`${G} ${r}`;e.setAttributes({"next.route":r,"http.route":r,"next.span_name":t}),e.updateName(t)}else e.updateName(`${G} ${E}`)}),o=!!(0,i.getRequestMeta)(e,"minimalMode"),l=async i=>{var s,l;let c=async({previousCacheEntry:a})=>{try{if(!o&&x&&C&&!a)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let s=await n(i);e.fetchMetrics=j.renderOpts.fetchMetrics;let l=j.renderOpts.pendingWaitUntil;l&&r.waitUntil&&(r.waitUntil(l),l=void 0);let c=j.renderOpts.collectedTags;if(!q)return await (0,m.sendResponse)(B,L,s,j.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),t=(0,h.toNodeOutgoingHttpHeaders)(s.headers);c&&(t[f.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let a=void 0!==j.renderOpts.collectedRevalidate&&!(j.renderOpts.collectedRevalidate>=f.INFINITE_CACHE)&&j.renderOpts.collectedRevalidate,r=void 0===j.renderOpts.collectedExpire||j.renderOpts.collectedExpire>=f.INFINITE_CACHE?void 0:j.renderOpts.collectedExpire;return{value:{kind:T.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:a,expire:r}}}}catch(t){throw(null==a?void 0:a.isStale)&&await I.onRequestError(e,t,{routerKind:"App Router",routePath:E,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:$,isOnDemandRevalidate:x})},M),t}},d=await I.handleResponse({req:e,nextConfig:N,cacheKey:k,routeKind:a.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:S,isRoutePPREnabled:!1,isOnDemandRevalidate:x,revalidateOnlyGenerated:C,responseGenerator:c,waitUntil:r.waitUntil,isMinimalMode:o});if(!q)return null;if((null==d||null==(s=d.value)?void 0:s.kind)!==T.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(l=d.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",x?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),D&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let u=(0,h.fromNodeOutgoingHttpHeaders)(d.value.headers);return o&&q||u.delete(f.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||u.get("Cache-Control")||u.set("Cache-Control",(0,y.getCacheControlHeader)(d.cacheControl)),await (0,m.sendResponse)(B,L,new Response(d.value.body,{headers:u,status:d.value.status||200})),null};F?await l(F):await K.withPropagatedContext(e.headers,()=>K.trace(u.BaseServerSpan.handleRequest,{spanName:`${G} ${E}`,kind:s.SpanKind.SERVER,attributes:{"http.method":G,"http.target":e.url}},l))}catch(t){if(t instanceof R.NoFallbackError||await I.onRequestError(e,t,{routerKind:"App Router",routePath:_,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:$,isOnDemandRevalidate:x})}),q)throw t;return await (0,m.sendResponse)(B,L,new Response(null,{status:500})),null}}e.s(["handler",()=>b,"patchFetch",()=>O,"routeModule",()=>I,"serverHooks",()=>C,"workAsyncStorage",()=>M,"workUnitAsyncStorage",()=>x],136571)},453753,e=>{e.v(t=>Promise.all(["server/chunks/[root-of-the-server]__86f7d54e._.js"].map(t=>e.l(t))).then(()=>t(736987)))}];

//# sourceMappingURL=_ffa92b80._.js.map