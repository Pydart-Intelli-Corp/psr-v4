module.exports=[439565,e=>{"use strict";var t=e.i(747909),a=e.i(174017),i=e.i(996250),n=e.i(759756),E=e.i(561916),r=e.i(114444),c=e.i(837092),s=e.i(869741),o=e.i(316795),T=e.i(487718),d=e.i(995169),N=e.i(47587),l=e.i(666012),A=e.i(570101),_=e.i(626937),M=e.i(10372),C=e.i(193695);e.i(52474);var I=e.i(600220),R=e.i(180725),u=e.i(686599),L=e.i(136543),D=e.i(84168),h=e.i(213075);async function U(t){try{await (0,D.connectDB)();let{User:a}=await e.A(121985).then(e=>e.getModels());return!await a.findOne({where:{dbKey:t}})}catch(e){return console.error("Error checking dbKey uniqueness:",e),!1}}async function p(e){let t,a=0;do if(t=function(e){let t=e.replace(/[^a-zA-Z]/g,"").toUpperCase().substring(0,3).padEnd(3,"X"),a=Math.floor(1e3+9e3*Math.random());return`${t}${a}`}(e),++a>=10)throw Error("Failed to generate unique dbKey after maximum attempts");while(!await U(t))return t}async function m(t,a){try{await (0,D.connectDB)();let i=t.fullName.replace(/[^a-zA-Z0-9]/g,"").toLowerCase(),n=`${i}_${a.toLowerCase()}`;console.log(`ðŸ—ï¸ Creating schema: ${n} for admin: ${t.fullName}`);let{sequelize:E}=await e.A(121985).then(e=>e.getModels());await E.query(`CREATE SCHEMA IF NOT EXISTS \`${n}\``),console.log(`âœ… Schema created successfully: ${n}`),await O(n)}catch(e){throw console.error("âŒ Error creating admin schema:",e),Error(`Failed to create schema for admin: ${e}`)}}async function O(t){try{let{sequelize:a}=await e.A(121985).then(e=>e.getModels());for(let e of[`CREATE TABLE IF NOT EXISTS \`${t}\`.\`dairy_farms\` (
        \`id\` INT PRIMARY KEY AUTO_INCREMENT,
        \`name\` VARCHAR(255) NOT NULL,
        \`dairy_id\` VARCHAR(50) UNIQUE NOT NULL,
        \`password\` VARCHAR(255) NOT NULL,
        \`location\` VARCHAR(255),
        \`contact_person\` VARCHAR(255),
        \`phone\` VARCHAR(20),
        \`email\` VARCHAR(255),
        \`capacity\` INT DEFAULT 5000 COMMENT 'Storage capacity in liters',
        \`status\` ENUM('active', 'inactive', 'maintenance', 'suspended') DEFAULT 'active',
        \`monthly_target\` INT DEFAULT 5000 COMMENT 'Monthly production target in liters',
        \`created_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        \`updated_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
      )`,`CREATE TABLE IF NOT EXISTS \`${t}\`.\`bmcs\` (
        \`id\` INT PRIMARY KEY AUTO_INCREMENT,
        \`name\` VARCHAR(255) NOT NULL,
        \`bmc_id\` VARCHAR(50) UNIQUE NOT NULL,
        \`password\` VARCHAR(255) NOT NULL,
        \`location\` VARCHAR(255),
        \`contactPerson\` VARCHAR(255),
        \`phone\` VARCHAR(20),
        \`email\` VARCHAR(255),
        \`capacity\` INT DEFAULT 10000 COMMENT 'Storage capacity in liters',
        \`status\` ENUM('active', 'inactive', 'maintenance', 'suspended') DEFAULT 'active',
        \`monthly_target\` DECIMAL(10,2) DEFAULT 10000 COMMENT 'Monthly collection target in liters',
        \`dairy_farm_id\` INT,
        \`created_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        \`updated_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
        FOREIGN KEY (\`dairy_farm_id\`) REFERENCES \`${t}\`.\`dairy_farms\`(\`id\`) ON DELETE SET NULL ON UPDATE CASCADE,
        INDEX \`idx_bmc_id\` (\`bmc_id\`),
        INDEX \`idx_dairy_farm_id\` (\`dairy_farm_id\`),
        INDEX \`idx_status\` (\`status\`)
      )`,`CREATE TABLE IF NOT EXISTS \`${t}\`.\`societies\` (
        \`id\` INT PRIMARY KEY AUTO_INCREMENT,
        \`name\` VARCHAR(255) NOT NULL,
        \`society_id\` VARCHAR(50) UNIQUE NOT NULL,
        \`password\` VARCHAR(255) NOT NULL,
        \`location\` VARCHAR(255),
        \`president_name\` VARCHAR(255),
        \`contact_phone\` VARCHAR(20),
        \`email\` VARCHAR(255) NOT NULL,
        \`bmc_id\` INT,
        \`status\` ENUM('active', 'inactive', 'maintenance', 'suspended') DEFAULT 'active',
        \`created_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        \`updated_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
        FOREIGN KEY (\`bmc_id\`) REFERENCES \`${t}\`.\`bmcs\`(\`id\`),
        UNIQUE KEY \`unique_society_email\` (\`email\`),
        INDEX \`idx_society_id\` (\`society_id\`),
        INDEX \`idx_bmc_id\` (\`bmc_id\`),
        INDEX \`idx_status\` (\`status\`)
      )`,`CREATE TABLE IF NOT EXISTS \`${t}\`.\`machines\` (
        \`id\` INT PRIMARY KEY AUTO_INCREMENT,
        \`machine_id\` VARCHAR(50) NOT NULL,
        \`machine_type\` VARCHAR(100) NOT NULL,
        \`society_id\` INT,
        \`location\` VARCHAR(255),
        \`installation_date\` DATE,
        \`operator_name\` VARCHAR(100),
        \`contact_phone\` VARCHAR(15),
        \`status\` ENUM('active', 'inactive', 'maintenance', 'suspended') DEFAULT 'active',
        \`notes\` TEXT,
        \`is_master_machine\` TINYINT(1) NOT NULL DEFAULT 0 COMMENT 'Master machine flag: 1 = master, 0 = normal',
        \`user_password\` VARCHAR(255) COMMENT 'User password for external API access',
        \`supervisor_password\` VARCHAR(255) COMMENT 'Supervisor password for external API access',
        \`statusU\` TINYINT(1) NOT NULL DEFAULT 0 COMMENT 'User password status: 0 = not set, 1 = set',
        \`statusS\` TINYINT(1) NOT NULL DEFAULT 0 COMMENT 'Supervisor password status: 0 = not set, 1 = set',
        \`created_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        \`updated_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
        FOREIGN KEY (\`society_id\`) REFERENCES \`${t}\`.\`societies\`(\`id\`) ON DELETE SET NULL ON UPDATE CASCADE,
        UNIQUE KEY \`unique_machine_per_society\` (\`machine_id\`, \`society_id\`),
        INDEX \`idx_machine_type\` (\`machine_type\`),
        INDEX \`idx_society_id\` (\`society_id\`),
        INDEX \`idx_status\` (\`status\`),
        INDEX \`idx_is_master\` (\`is_master_machine\`),
        INDEX \`idx_statusU\` (\`statusU\`),
        INDEX \`idx_statusS\` (\`statusS\`),
        INDEX \`idx_created_at\` (\`created_at\`)
      )`,`CREATE TABLE IF NOT EXISTS \`${t}\`.\`farmers\` (
        \`id\` INT PRIMARY KEY AUTO_INCREMENT,
        \`name\` VARCHAR(255) NOT NULL,
        \`farmer_id\` VARCHAR(50) NOT NULL,
        \`rf_id\` VARCHAR(50),
        \`phone\` VARCHAR(20),
        \`email\` VARCHAR(255),
        \`sms_enabled\` ENUM('ON', 'OFF') DEFAULT 'OFF',
        \`email_notifications_enabled\` ENUM('ON', 'OFF') DEFAULT 'ON',
        \`bonus\` DECIMAL(10,2) DEFAULT 0.00,
        \`address\` TEXT,
        \`bank_name\` VARCHAR(100),
        \`bank_account_number\` VARCHAR(50),
        \`ifsc_code\` VARCHAR(15),
        \`status\` ENUM('active', 'inactive', 'suspended', 'maintenance') DEFAULT 'active',
        \`notes\` TEXT,
        \`password\` VARCHAR(255),
        \`society_id\` INT,
        \`machine_id\` INT,
        \`cattle_count\` INT,
        \`created_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        \`updated_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
        FOREIGN KEY (\`society_id\`) REFERENCES \`${t}\`.\`societies\`(\`id\`) ON DELETE SET NULL ON UPDATE CASCADE,
        FOREIGN KEY (\`machine_id\`) REFERENCES \`${t}\`.\`machines\`(\`id\`) ON DELETE SET NULL ON UPDATE CASCADE,
        UNIQUE KEY \`unique_farmer_per_society\` (\`farmer_id\`, \`society_id\`),
        UNIQUE KEY \`unique_rf_id\` (\`rf_id\`),
        UNIQUE KEY \`unique_email\` (\`email\`),
        INDEX \`idx_farmer_id\` (\`farmer_id\`),
        INDEX \`idx_society_id\` (\`society_id\`),
        INDEX \`idx_machine_id\` (\`machine_id\`),
        INDEX \`idx_status\` (\`status\`),
        INDEX \`idx_created_at\` (\`created_at\`)
      )`,`CREATE TABLE IF NOT EXISTS \`${t}\`.\`milk_collections\` (
        \`id\` INT PRIMARY KEY AUTO_INCREMENT,
        \`farmer_id\` VARCHAR(50),
        \`society_id\` INT,
        \`machine_id\` INT,
        \`collection_date\` DATE,
        \`collection_time\` TIME,
        \`shift_type\` ENUM('morning', 'evening'),
        \`farmer_name\` VARCHAR(255) DEFAULT NULL,
        \`channel\` VARCHAR(50) DEFAULT 'COW',
        \`quantity\` DECIMAL(10,2) DEFAULT 0,
        \`fat_percentage\` DECIMAL(5,2),
        \`snf_percentage\` DECIMAL(5,2),
        \`clr_value\` DECIMAL(5,2) DEFAULT 0,
        \`protein_percentage\` DECIMAL(5,2) DEFAULT 0,
        \`lactose_percentage\` DECIMAL(5,2) DEFAULT 0,
        \`salt_percentage\` DECIMAL(5,2) DEFAULT 0,
        \`water_percentage\` DECIMAL(5,2) DEFAULT 0,
        \`temperature\` DECIMAL(5,2) DEFAULT 0,
        \`rate_per_liter\` DECIMAL(10,2),
        \`total_amount\` DECIMAL(10,2),
        \`bonus\` DECIMAL(10,2) DEFAULT 0,
        \`machine_type\` VARCHAR(100),
        \`machine_version\` VARCHAR(50),
        \`created_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        \`updated_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
        INDEX \`idx_farmer_id\` (\`farmer_id\`),
        INDEX \`idx_society_id\` (\`society_id\`),
        INDEX \`idx_machine_id\` (\`machine_id\`),
        INDEX \`idx_collection_date\` (\`collection_date\`),
        INDEX \`idx_collection_time\` (\`collection_time\`),
        INDEX \`idx_shift_type\` (\`shift_type\`),
        INDEX \`idx_channel\` (\`channel\`),
        INDEX \`idx_created_at\` (\`created_at\`),
        UNIQUE KEY \`unique_collection\` (\`farmer_id\`, \`society_id\`, \`machine_id\`, \`collection_date\`, \`collection_time\`, \`shift_type\`)
      )`,`CREATE TABLE IF NOT EXISTS \`${t}\`.\`milk_dispatches\` (
        \`id\` INT PRIMARY KEY AUTO_INCREMENT,
        \`dispatch_id\` VARCHAR(50) NOT NULL,
        \`society_id\` INT NOT NULL,
        \`machine_id\` INT NOT NULL,
        \`dispatch_date\` DATE,
        \`dispatch_time\` TIME,
        \`shift_type\` ENUM('morning', 'evening') NOT NULL,
        \`channel\` VARCHAR(50) DEFAULT 'COW',
        \`fat_percentage\` DECIMAL(5,2),
        \`snf_percentage\` DECIMAL(5,2),
        \`clr_value\` DECIMAL(5,2) DEFAULT 0,
        \`quantity\` DECIMAL(10,2) DEFAULT 0,
        \`rate_per_liter\` DECIMAL(10,2),
        \`total_amount\` DECIMAL(10,2),
        \`machine_type\` VARCHAR(100),
        \`machine_version\` VARCHAR(50),
        \`created_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        \`updated_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
        INDEX \`idx_dispatch_id\` (\`dispatch_id\`),
        INDEX \`idx_society_id\` (\`society_id\`),
        INDEX \`idx_machine_id\` (\`machine_id\`),
        INDEX \`idx_dispatch_date\` (\`dispatch_date\`),
        INDEX \`idx_dispatch_time\` (\`dispatch_time\`),
        INDEX \`idx_shift_type\` (\`shift_type\`),
        INDEX \`idx_channel\` (\`channel\`),
        INDEX \`idx_created_at\` (\`created_at\`),
        UNIQUE KEY \`unique_dispatch\` (\`dispatch_id\`, \`society_id\`, \`machine_id\`, \`dispatch_date\`, \`dispatch_time\`, \`shift_type\`)
      )`,`CREATE TABLE IF NOT EXISTS \`${t}\`.\`milk_sales\` (
        \`id\` INT PRIMARY KEY AUTO_INCREMENT,
        \`count\` VARCHAR(50) NOT NULL,
        \`society_id\` INT NOT NULL,
        \`machine_id\` INT NOT NULL,
        \`sales_date\` DATE,
        \`sales_time\` TIME,
        \`shift_type\` VARCHAR(10) DEFAULT 'EV',
        \`channel\` VARCHAR(50) DEFAULT 'COW',
        \`quantity\` DECIMAL(10,2) DEFAULT 0,
        \`rate_per_liter\` DECIMAL(10,2),
        \`total_amount\` DECIMAL(10,2),
        \`machine_type\` VARCHAR(100),
        \`machine_version\` VARCHAR(50),
        \`created_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        \`updated_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
        INDEX \`idx_count\` (\`count\`),
        INDEX \`idx_society_id\` (\`society_id\`),
        INDEX \`idx_machine_id\` (\`machine_id\`),
        INDEX \`idx_sales_date\` (\`sales_date\`),
        INDEX \`idx_sales_time\` (\`sales_time\`),
        INDEX \`idx_shift_type\` (\`shift_type\`),
        INDEX \`idx_channel\` (\`channel\`),
        INDEX \`idx_created_at\` (\`created_at\`),
        UNIQUE KEY \`unique_sales\` (\`count\`, \`society_id\`, \`machine_id\`, \`sales_date\`, \`sales_time\`)
      )`,`CREATE TABLE IF NOT EXISTS \`${t}\`.\`machine_corrections\` (
        \`id\` INT PRIMARY KEY AUTO_INCREMENT,
        \`machine_id\` INT NOT NULL COMMENT 'Reference to machines table',
        \`society_id\` INT NOT NULL COMMENT 'Reference to societies table',
        \`machine_type\` VARCHAR(100) COMMENT 'Machine type/model for reference',
        \`channel1_fat\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Channel 1 Fat value',
        \`channel1_snf\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Channel 1 SNF (Solid Not Fat) value',
        \`channel1_clr\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Channel 1 CLR value',
        \`channel1_temp\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Channel 1 Temperature',
        \`channel1_water\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Channel 1 Water content',
        \`channel1_protein\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Channel 1 Protein value',
        \`channel2_fat\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Channel 2 Fat value',
        \`channel2_snf\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Channel 2 SNF (Solid Not Fat) value',
        \`channel2_clr\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Channel 2 CLR value',
        \`channel2_temp\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Channel 2 Temperature',
        \`channel2_water\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Channel 2 Water content',
        \`channel2_protein\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Channel 2 Protein value',
        \`channel3_fat\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Channel 3 Fat value',
        \`channel3_snf\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Channel 3 SNF (Solid Not Fat) value',
        \`channel3_clr\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Channel 3 CLR value',
        \`channel3_temp\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Channel 3 Temperature',
        \`channel3_water\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Channel 3 Water content',
        \`channel3_protein\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Channel 3 Protein value',
        \`status\` TINYINT(1) NOT NULL DEFAULT 1 COMMENT 'Status: 1 = Active/Current, 0 = Inactive/Old',
        \`created_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        \`updated_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
        INDEX \`idx_machine_id\` (\`machine_id\`),
        INDEX \`idx_society_id\` (\`society_id\`),
        INDEX \`idx_machine_type\` (\`machine_type\`),
        INDEX \`idx_status\` (\`status\`),
        INDEX \`idx_created_at\` (\`created_at\`)
      )`,`CREATE TABLE IF NOT EXISTS \`${t}\`.\`machine_corrections_from_machine\` (
        \`id\` INT PRIMARY KEY AUTO_INCREMENT,
        \`machine_id\` INT NOT NULL COMMENT 'Machine database ID',
        \`society_id\` INT NOT NULL COMMENT 'Society database ID',
        \`machine_type\` VARCHAR(50) DEFAULT NULL COMMENT 'Machine type',
        \`channel1_fat\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Fat correction for channel 1',
        \`channel1_snf\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'SNF correction for channel 1',
        \`channel1_clr\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'CLR correction for channel 1',
        \`channel1_temp\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Temperature correction for channel 1',
        \`channel1_water\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Water correction for channel 1',
        \`channel1_protein\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Protein correction for channel 1',
        \`channel2_fat\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Fat correction for channel 2',
        \`channel2_snf\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'SNF correction for channel 2',
        \`channel2_clr\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'CLR correction for channel 2',
        \`channel2_temp\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Temperature correction for channel 2',
        \`channel2_water\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Water correction for channel 2',
        \`channel2_protein\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Protein correction for channel 2',
        \`channel3_fat\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Fat correction for channel 3',
        \`channel3_snf\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'SNF correction for channel 3',
        \`channel3_clr\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'CLR correction for channel 3',
        \`channel3_temp\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Temperature correction for channel 3',
        \`channel3_water\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Water correction for channel 3',
        \`channel3_protein\` DECIMAL(5,2) DEFAULT 0.00 COMMENT 'Protein correction for channel 3',
        \`created_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT 'When correction was received from ESP32',
        \`updated_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'Last update timestamp',
        INDEX \`idx_machine_id\` (\`machine_id\`),
        INDEX \`idx_society_id\` (\`society_id\`),
        INDEX \`idx_created_at\` (\`created_at\`),
        INDEX \`idx_machine_society\` (\`machine_id\`, \`society_id\`)
      )`,`CREATE TABLE IF NOT EXISTS \`${t}\`.\`rate_charts\` (
        \`id\` INT PRIMARY KEY AUTO_INCREMENT,
        \`shared_chart_id\` INT NULL COMMENT 'Reference to master rate chart for shared data',
        \`society_id\` INT NOT NULL COMMENT 'Reference to societies table',
        \`channel\` ENUM('COW', 'BUF', 'MIX') NOT NULL COMMENT 'Milk channel type',
        \`uploaded_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        \`uploaded_by\` VARCHAR(255) NOT NULL COMMENT 'Admin user who uploaded',
        \`file_name\` VARCHAR(255) NOT NULL COMMENT 'Original CSV file name',
        \`record_count\` INT NOT NULL DEFAULT 0 COMMENT 'Number of rate records',
        \`status\` TINYINT(1) DEFAULT 1 COMMENT '1=Active/Ready to download, 0=Downloaded by machine',
        FOREIGN KEY (\`society_id\`) REFERENCES \`${t}\`.\`societies\`(\`id\`) ON DELETE CASCADE ON UPDATE CASCADE,
        UNIQUE KEY \`unique_society_channel\` (\`society_id\`, \`channel\`),
        INDEX \`idx_shared_chart_id\` (\`shared_chart_id\`),
        INDEX \`idx_society_id\` (\`society_id\`),
        INDEX \`idx_channel\` (\`channel\`),
        INDEX \`idx_uploaded_at\` (\`uploaded_at\`),
        INDEX \`idx_status\` (\`status\`)
      )`,`CREATE TABLE IF NOT EXISTS \`${t}\`.\`rate_chart_data\` (
        \`id\` INT PRIMARY KEY AUTO_INCREMENT,
        \`rate_chart_id\` INT NOT NULL COMMENT 'Reference to rate_charts table',
        \`clr\` DECIMAL(5,2) NOT NULL COMMENT 'Color/Degree value',
        \`fat\` DECIMAL(5,2) NOT NULL COMMENT 'Fat percentage',
        \`snf\` DECIMAL(5,2) NOT NULL COMMENT 'Solids-Not-Fat percentage',
        \`rate\` DECIMAL(10,2) NOT NULL COMMENT 'Rate per liter',
        \`created_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (\`rate_chart_id\`) REFERENCES \`${t}\`.\`rate_charts\`(\`id\`) ON DELETE CASCADE ON UPDATE CASCADE,
        INDEX \`idx_rate_chart_id\` (\`rate_chart_id\`),
        INDEX \`idx_clr_fat_snf\` (\`clr\`, \`fat\`, \`snf\`)
      )`,`CREATE TABLE IF NOT EXISTS \`${t}\`.\`rate_chart_download_history\` (
        \`id\` INT PRIMARY KEY AUTO_INCREMENT,
        \`rate_chart_id\` INT NOT NULL COMMENT 'Reference to rate_charts table',
        \`machine_id\` INT NOT NULL COMMENT 'Reference to machines table',
        \`society_id\` INT NOT NULL COMMENT 'Reference to societies table',
        \`channel\` ENUM('COW', 'BUF', 'MIX') NOT NULL COMMENT 'Milk channel type',
        \`downloaded_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (\`rate_chart_id\`) REFERENCES \`${t}\`.\`rate_charts\`(\`id\`) ON DELETE CASCADE ON UPDATE CASCADE,
        FOREIGN KEY (\`machine_id\`) REFERENCES \`${t}\`.\`machines\`(\`id\`) ON DELETE CASCADE ON UPDATE CASCADE,
        FOREIGN KEY (\`society_id\`) REFERENCES \`${t}\`.\`societies\`(\`id\`) ON DELETE CASCADE ON UPDATE CASCADE,
        UNIQUE KEY \`unique_machine_chart_channel\` (\`machine_id\`, \`rate_chart_id\`, \`channel\`),
        INDEX \`idx_machine_society_channel\` (\`machine_id\`, \`society_id\`, \`channel\`),
        INDEX \`idx_rate_chart_id\` (\`rate_chart_id\`),
        INDEX \`idx_downloaded_at\` (\`downloaded_at\`)
      )`,`CREATE TABLE IF NOT EXISTS \`${t}\`.\`machine_statistics\` (
        \`id\` INT PRIMARY KEY AUTO_INCREMENT,
        \`machine_id\` INT NOT NULL COMMENT 'Reference to machines table',
        \`society_id\` INT NOT NULL COMMENT 'Reference to societies table',
        \`machine_type\` VARCHAR(50) NOT NULL COMMENT 'Machine type',
        \`version\` VARCHAR(20) NOT NULL COMMENT 'Machine version',
        \`total_test\` INT DEFAULT 0 COMMENT 'Total tests (T parameter)',
        \`daily_cleaning\` INT DEFAULT 0 COMMENT 'Daily cleaning count (D parameter)',
        \`weekly_cleaning\` INT DEFAULT 0 COMMENT 'Weekly cleaning count (W parameter)',
        \`cleaning_skip\` INT DEFAULT 0 COMMENT 'Cleaning skip count (S parameter)',
        \`gain\` INT DEFAULT 0 COMMENT 'Gain value (G parameter)',
        \`auto_channel\` VARCHAR(20) DEFAULT NULL COMMENT 'Auto channel status (ENABLE/DISABLE)',
        \`statistics_date\` DATE NOT NULL COMMENT 'Date of statistics',
        \`statistics_time\` TIME NOT NULL COMMENT 'Time of statistics',
        \`created_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (\`machine_id\`) REFERENCES \`${t}\`.\`machines\`(\`id\`) ON DELETE CASCADE ON UPDATE CASCADE,
        FOREIGN KEY (\`society_id\`) REFERENCES \`${t}\`.\`societies\`(\`id\`) ON DELETE CASCADE ON UPDATE CASCADE,
        INDEX \`idx_machine_id\` (\`machine_id\`),
        INDEX \`idx_society_id\` (\`society_id\`),
        INDEX \`idx_statistics_date\` (\`statistics_date\`),
        INDEX \`idx_created_at\` (\`created_at\`)
      )`,`CREATE TABLE IF NOT EXISTS \`${t}\`.\`section_pulse\` (
        \`id\` INT PRIMARY KEY AUTO_INCREMENT,
        \`society_id\` INT NOT NULL,
        \`pulse_date\` DATE NOT NULL,
        \`first_collection_time\` DATETIME DEFAULT NULL COMMENT 'Section start pulse - first collection of the day',
        \`last_collection_time\` DATETIME DEFAULT NULL COMMENT 'Last collection recorded',
        \`section_end_time\` DATETIME DEFAULT NULL COMMENT 'Section end pulse - 60 min after last collection',
        \`pulse_status\` ENUM('not_started', 'active', 'paused', 'ended', 'inactive') DEFAULT 'not_started' COMMENT 'Current pulse status',
        \`total_collections\` INT DEFAULT 0 COMMENT 'Total collections for the day',
        \`total_farmers\` INT DEFAULT 0 COMMENT 'Total registered farmers in society',
        \`present_farmers\` INT DEFAULT 0 COMMENT 'Number of farmers who made collections',
        \`absent_farmers\` INT DEFAULT 0 COMMENT 'Number of farmers who did not make collections',
        \`inactive_days\` INT DEFAULT 0 COMMENT 'Number of consecutive days without pulse',
        \`last_checked\` DATETIME DEFAULT NULL COMMENT 'Last time status was checked/updated',
        \`created_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        \`updated_at\` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
        FOREIGN KEY (\`society_id\`) REFERENCES \`${t}\`.\`societies\`(\`id\`) ON DELETE CASCADE ON UPDATE CASCADE,
        UNIQUE KEY \`unique_society_date\` (\`society_id\`, \`pulse_date\`),
        INDEX \`idx_society_id\` (\`society_id\`),
        INDEX \`idx_pulse_date\` (\`pulse_date\`),
        INDEX \`idx_pulse_status\` (\`pulse_status\`),
        INDEX \`idx_last_checked\` (\`last_checked\`)
      )`])await a.query(e);console.log(`âœ… Admin tables created successfully in schema: ${t}`)}catch(e){throw console.error("âŒ Error creating admin tables:",e),e}}async function f(){try{await (0,D.connectDB)();let{User:e}=(0,R.getModels)(),t=await e.findAll({where:{role:"admin",status:h.UserStatus.PENDING_APPROVAL,isEmailVerified:!0},attributes:["id","uid","email","fullName","companyName","companyPincode","companyCity","companyState","createdAt","updatedAt"],order:[["createdAt","DESC"]]});return(0,L.createSuccessResponse)(t,"Pending admin approvals retrieved successfully")}catch(e){return console.error("Get pending approvals error:",e),(0,L.createErrorResponse)("Failed to retrieve pending approvals",500)}}async function F(e){try{await (0,D.connectDB)();let{User:t}=(0,R.getModels)(),a=await e.json(),{adminId:i,action:n,reason:E}=a,r=(0,L.validateRequiredFields)(a,["adminId","action"]);if(!r.success){let e=r.missing?.join(", ")||"Required fields missing";return(0,L.createErrorResponse)(`Missing required fields: ${e}`,400)}if(!["approve","reject"].includes(n))return(0,L.createErrorResponse)('Invalid action. Must be "approve" or "reject"',400);let c=await t.findOne({where:{id:i,role:"admin",status:h.UserStatus.PENDING_APPROVAL,isEmailVerified:!0}});if(!c)return(0,L.createErrorResponse)("Admin user not found or not pending approval",404);if("approve"===n){let e=await p(c.fullName);await c.update({status:h.UserStatus.ACTIVE,dbKey:e}),console.log(`ðŸ”‘ Generated dbKey for ${c.fullName}: ${e}`);try{await m(c.toJSON(),e),console.log(`âœ… Schema created successfully for admin: ${c.fullName}`)}catch(e){return console.error("âŒ Failed to create admin schema:",e),await c.update({status:h.UserStatus.PENDING_APPROVAL,dbKey:void 0}),(0,L.createErrorResponse)("Failed to create admin database schema. Please try again.",500)}try{await (0,u.sendAdminWelcomeEmail)(c.email,c.fullName,e),console.log("âœ… Admin welcome email with dbKey sent successfully")}catch(e){console.error("âš ï¸ Failed to send admin welcome email:",e)}let t={id:c.id,uid:c.uid,fullName:c.fullName,email:c.email,role:c.role,status:c.status,companyName:c.companyName};return(0,L.createSuccessResponse)("Admin account approved successfully",JSON.stringify(t))}await c.update({status:h.UserStatus.INACTIVE});try{await (0,u.sendAdminRejectionEmail)(c.email,c.fullName,E),console.log("âœ… Rejection email sent to admin")}catch(e){console.error("âš ï¸ Failed to send rejection email:",e)}return(0,L.createSuccessResponse)("Admin account rejected successfully",JSON.stringify({id:c.id,status:"rejected",reason:E}))}catch(e){return console.error("Admin approval error:",e),(0,L.createErrorResponse)("Failed to process admin approval",500)}}e.s(["GET",()=>f,"POST",()=>F],122706);var S=e.i(122706);let y=new t.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/superadmin/approvals/route",pathname:"/api/superadmin/approvals",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/superadmin/approvals/route.ts",nextConfigOutput:"",userland:S}),{workAsyncStorage:P,workUnitAsyncStorage:v,serverHooks:x}=y;function w(){return(0,i.patchFetch)({workAsyncStorage:P,workUnitAsyncStorage:v})}async function g(e,t,i){y.isDev&&(0,n.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let R="/api/superadmin/approvals/route";R=R.replace(/\/index$/,"")||"/";let u=await y.prepare(e,t,{srcPage:R,multiZoneDraftMode:!1});if(!u)return t.statusCode=400,t.end("Bad Request"),null==i.waitUntil||i.waitUntil.call(i,Promise.resolve()),null;let{buildId:L,params:D,nextConfig:h,parsedUrl:U,isDraftMode:p,prerenderManifest:m,routerServerContext:O,isOnDemandRevalidate:f,revalidateOnlyGenerated:F,resolvedPathname:S,clientReferenceManifest:P,serverActionsManifest:v}=u,x=(0,s.normalizeAppPath)(R),w=!!(m.dynamicRoutes[x]||m.routes[S]),g=async()=>((null==O?void 0:O.render404)?await O.render404(e,t,U,!1):t.end("This page could not be found"),null);if(w&&!p){let e=!!m.routes[S],t=m.dynamicRoutes[x];if(t&&!1===t.fallback&&!e){if(h.experimental.adapterPath)return await g();throw new C.NoFallbackError}}let X=null;!w||y.isDev||p||(X="/index"===(X=S)?"/":X);let H=!0===y.isDev||!w,V=w&&!H;v&&P&&(0,r.setReferenceManifestsSingleton)({page:R,clientReferenceManifest:P,serverActionsManifest:v,serverModuleMap:(0,c.createServerModuleMap)({serverActionsManifest:v})});let b=e.method||"GET",Y=(0,E.getTracer)(),K=Y.getActiveScopeSpan(),$={params:D,prerenderManifest:m,renderOpts:{experimental:{authInterrupts:!!h.experimental.authInterrupts},cacheComponents:!!h.cacheComponents,supportsDynamicResponse:H,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:h.cacheLife,waitUntil:i.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,a,i)=>y.onRequestError(e,t,i,O)},sharedContext:{buildId:L}},q=new o.NodeNextRequest(e),k=new o.NodeNextResponse(t),B=T.NextRequestAdapter.fromNodeNextRequest(q,(0,T.signalFromNodeResponse)(t));try{let r=async e=>y.handle(B,$).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let a=Y.getRootSpanAttributes();if(!a)return;if(a.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${a.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let i=a.get("next.route");if(i){let t=`${b} ${i}`;e.setAttributes({"next.route":i,"http.route":i,"next.span_name":t}),e.updateName(t)}else e.updateName(`${b} ${R}`)}),c=!!(0,n.getRequestMeta)(e,"minimalMode"),s=async n=>{var E,s;let o=async({previousCacheEntry:a})=>{try{if(!c&&f&&F&&!a)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let E=await r(n);e.fetchMetrics=$.renderOpts.fetchMetrics;let s=$.renderOpts.pendingWaitUntil;s&&i.waitUntil&&(i.waitUntil(s),s=void 0);let o=$.renderOpts.collectedTags;if(!w)return await (0,l.sendResponse)(q,k,E,$.renderOpts.pendingWaitUntil),null;{let e=await E.blob(),t=(0,A.toNodeOutgoingHttpHeaders)(E.headers);o&&(t[M.NEXT_CACHE_TAGS_HEADER]=o),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let a=void 0!==$.renderOpts.collectedRevalidate&&!($.renderOpts.collectedRevalidate>=M.INFINITE_CACHE)&&$.renderOpts.collectedRevalidate,i=void 0===$.renderOpts.collectedExpire||$.renderOpts.collectedExpire>=M.INFINITE_CACHE?void 0:$.renderOpts.collectedExpire;return{value:{kind:I.CachedRouteKind.APP_ROUTE,status:E.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:a,expire:i}}}}catch(t){throw(null==a?void 0:a.isStale)&&await y.onRequestError(e,t,{routerKind:"App Router",routePath:R,routeType:"route",revalidateReason:(0,N.getRevalidateReason)({isStaticGeneration:V,isOnDemandRevalidate:f})},O),t}},T=await y.handleResponse({req:e,nextConfig:h,cacheKey:X,routeKind:a.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:m,isRoutePPREnabled:!1,isOnDemandRevalidate:f,revalidateOnlyGenerated:F,responseGenerator:o,waitUntil:i.waitUntil,isMinimalMode:c});if(!w)return null;if((null==T||null==(E=T.value)?void 0:E.kind)!==I.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==T||null==(s=T.value)?void 0:s.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});c||t.setHeader("x-nextjs-cache",f?"REVALIDATED":T.isMiss?"MISS":T.isStale?"STALE":"HIT"),p&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let d=(0,A.fromNodeOutgoingHttpHeaders)(T.value.headers);return c&&w||d.delete(M.NEXT_CACHE_TAGS_HEADER),!T.cacheControl||t.getHeader("Cache-Control")||d.get("Cache-Control")||d.set("Cache-Control",(0,_.getCacheControlHeader)(T.cacheControl)),await (0,l.sendResponse)(q,k,new Response(T.value.body,{headers:d,status:T.value.status||200})),null};K?await s(K):await Y.withPropagatedContext(e.headers,()=>Y.trace(d.BaseServerSpan.handleRequest,{spanName:`${b} ${R}`,kind:E.SpanKind.SERVER,attributes:{"http.method":b,"http.target":e.url}},s))}catch(t){if(t instanceof C.NoFallbackError||await y.onRequestError(e,t,{routerKind:"App Router",routePath:x,routeType:"route",revalidateReason:(0,N.getRevalidateReason)({isStaticGeneration:V,isOnDemandRevalidate:f})}),w)throw t;return await (0,l.sendResponse)(q,k,new Response(null,{status:500})),null}}e.s(["handler",()=>g,"patchFetch",()=>w,"routeModule",()=>y,"serverHooks",()=>x,"workAsyncStorage",()=>P,"workUnitAsyncStorage",()=>v],439565)}];

//# sourceMappingURL=node_modules_next_dist_esm_build_templates_app-route_86c8e196.js.map