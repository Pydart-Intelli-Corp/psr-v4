(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,892892,e=>{"use strict";var t=e.i(843476),a=e.i(846932),r=e.i(88653);let s=(0,e.i(475254).default)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);function l({isOpen:e,onClose:l,onConfirm:i,title:n,message:o,confirmText:d="Continue",cancelText:c="Cancel"}){return e?(0,t.jsx)(r.AnimatePresence,{children:e&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:l,children:(0,t.jsxs)(a.motion.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{type:"spring",damping:25,stiffness:300},onClick:e=>e.stopPropagation(),className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-md w-full p-6",children:[(0,t.jsx)("div",{className:"flex justify-center mb-4",children:(0,t.jsx)("div",{className:"w-12 h-12 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center",children:(0,t.jsx)(s,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})})}),(0,t.jsxs)("div",{className:"text-center mb-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:n}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:o})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,t.jsx)("button",{onClick:l,className:"px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:c}),(0,t.jsx)("button",{onClick:i,className:"px-4 py-2 text-sm bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:d})]})]})})}):null}e.s(["default",()=>l],892892)},581418,e=>{"use strict";let t=(0,e.i(475254).default)("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["ShieldCheck",()=>t],581418)},514764,e=>{"use strict";let t=(0,e.i(475254).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);e.s(["Send",()=>t],514764)},154041,e=>{"use strict";var t=e.i(561219);e.s(["FormGrid",()=>t.default])},545292,e=>{"use strict";var t=e.i(785187);e.s(["FormInput",()=>t.default])},199083,e=>{"use strict";var t=e.i(216940);e.s(["StatusMessage",()=>t.default])},948168,e=>{"use strict";var t=e.i(524420);e.s(["EmptyState",()=>t.default])},506296,e=>{"use strict";var t=e.i(197238);e.s(["FormSelect",()=>t.default])},931194,e=>{"use strict";function t(e){if(!e||""===e.trim())return{isValid:!1,error:"Phone number is required"};let t=e.replace(/\D/g,"");return 10!==t.length?{isValid:!1,error:"Phone number must be exactly 10 digits"}:/^[6-9]/.test(t)?{isValid:!0,formatted:t}:{isValid:!1,error:"Phone number must start with 6, 7, 8, or 9"}}function a(e){return e.replace(/\D/g,"").slice(0,10)}function r(e){return e&&""!==e.trim()&&t(e).error||""}e.s(["formatPhoneInput",()=>a,"validateIndianPhone",()=>t,"validatePhoneOnBlur",()=>r])},504767,e=>{"use strict";var t=e.i(42649);e.s(["FormActions",()=>t.default])},939544,e=>{"use strict";let t=(0,e.i(475254).default)("droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);e.s(["Droplets",()=>t],939544)},935281,688462,e=>{"use strict";var t=e.i(379358);e.s(["PageHeader",()=>t.default],935281);var a=e.i(231788);e.s(["FilterControls",()=>a.default],688462)},806536,27808,e=>{"use strict";var t=e.i(843476),a=e.i(271645),r=e.i(846932),s=e.i(88653),l=e.i(37727),i=e.i(878894),n=e.i(607486),o=e.i(972520),d=e.i(761911),c=e.i(269638),m=e.i(263488),x=e.i(16715);function g({isOpen:e,onClose:g,onConfirm:h,bmcName:u,bmcId:b,societies:p,availableBMCs:y}){let[f,j]=(0,a.useState)(null),[k,v]=(0,a.useState)(!1),[N,w]=(0,a.useState)(!1),[C,S]=(0,a.useState)(!1),[T,F]=(0,a.useState)(["","","","","",""]),[M,I]=(0,a.useState)(!1),[B,P]=(0,a.useState)(""),[A,D]=(0,a.useState)(!1),L=(0,a.useRef)([]);(0,a.useEffect)(()=>{e&&(j(null),w(!1),S(!1),F(["","","","","",""]),I(!1),P(""))},[e]);let E=async()=>{D(!0),P("");try{let e=localStorage.getItem("authToken"),t=await fetch("/api/user/bmc/send-delete-otp",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({bmcId:b,bmcName:u})}),a=await t.json();t.ok?(I(!0),S(!0),setTimeout(()=>L.current[0]?.focus(),100)):P(a.error||"Failed to send OTP")}catch(e){console.error("Error sending OTP:",e),P("Failed to send OTP. Please try again.")}finally{D(!1)}},O=e=>{e.preventDefault();let t=e.clipboardData.getData("text").replace(/\D/g,"").slice(0,6);6===t.length&&F(t.split(""))},$=async()=>{if(!N&&!f)return;if(!M)return void await E();let e=T.join("");if(6!==e.length)return void P("Please enter the 6-digit OTP");v(!0);try{await h(f,N,e)}catch{P("Invalid OTP. Please try again."),F(["","","","","",""]),L.current[0]?.focus()}finally{v(!1)}},z=y.find(e=>e.id===f);return(0,t.jsx)(s.AnimatePresence,{children:e&&(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,t.jsx)(r.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:g,className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),(0,t.jsxs)(r.motion.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden",children:[(0,t.jsx)("div",{className:"sticky top-0 bg-gradient-to-r from-orange-500 to-red-500 px-6 py-4",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-white/20 rounded-lg",children:(0,t.jsx)(i.AlertTriangle,{className:"w-6 h-6 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-white",children:"Transfer Societies Required"}),(0,t.jsx)("p",{className:"text-sm text-white/90 mt-1",children:"Cannot delete BMC with active societies"})]})]}),(0,t.jsx)("button",{onClick:g,className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:(0,t.jsx)(l.X,{className:"w-5 h-5 text-white"})})]})}),(0,t.jsxs)("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-200px)]",children:[(0,t.jsx)("div",{className:"mb-6 p-4 bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg",children:(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)(i.AlertTriangle,{className:"w-5 h-5 text-orange-600 dark:text-orange-400 flex-shrink-0 mt-0.5"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{className:"font-semibold text-orange-900 dark:text-orange-100",children:[p.length," ",1===p.length?"Society":"Societies"," Under This BMC"]}),(0,t.jsxs)("p",{className:"text-sm text-orange-800 dark:text-orange-200 mt-1",children:["Before deleting ",(0,t.jsx)("strong",{children:u}),", you must either transfer all societies to another BMC or delete everything."]})]})]})}),(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsxs)("label",{className:"flex items-start gap-3 p-4 bg-red-50 dark:bg-red-900/20 border-2 border-red-200 dark:border-red-800 rounded-lg cursor-pointer hover:bg-red-100 dark:hover:bg-red-900/30 transition-colors",children:[(0,t.jsx)("input",{type:"checkbox",checked:N,onChange:e=>{w(e.target.checked),e.target.checked&&j(null)},className:"mt-0.5 w-5 h-5 text-red-600 bg-white dark:bg-gray-700 border-red-300 dark:border-red-700 rounded focus:ring-2 focus:ring-red-500 cursor-pointer"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(i.AlertTriangle,{className:"w-5 h-5 text-red-600 dark:text-red-400"}),(0,t.jsx)("span",{className:"font-semibold text-red-900 dark:text-red-100",children:"Delete All Data (Permanent)"})]}),(0,t.jsxs)("p",{className:"text-sm text-red-800 dark:text-red-200 mt-1",children:["Delete all societies, farmers, machines, machine statistics, machine corrections, rate charts, collections, sales, dispatches, and section pulse data under this BMC.",(0,t.jsx)("strong",{className:"block mt-1",children:"This action cannot be undone!"})]})]})]})}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 flex items-center gap-2",children:[(0,t.jsx)(d.Users,{className:"w-4 h-4"}),"Societies to Transfer (",p.length,")"]}),(0,t.jsx)("div",{className:"space-y-2 max-h-40 overflow-y-auto p-3 bg-gray-50 dark:bg-gray-900/50 rounded-lg border border-gray-200 dark:border-gray-700",children:p.map(e=>(0,t.jsx)("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-gray-800 rounded border border-gray-200 dark:border-gray-700",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:e.name}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["ID: ",e.society_id]})]})},e.id))})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:["Select Target BMC ",!N&&(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),N&&(0,t.jsx)("div",{className:"mb-3 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:(0,t.jsxs)("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:[(0,t.jsx)("strong",{children:"Delete All"})," is enabled. BMC selection is disabled."]})}),(0,t.jsx)("div",{className:`space-y-2 ${N?"opacity-50 pointer-events-none":""}`,children:0===y.length?(0,t.jsx)("div",{className:"p-4 text-center bg-gray-50 dark:bg-gray-900/50 rounded-lg border border-gray-200 dark:border-gray-700",children:(0,t.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["No other BMCs available. ",!N&&"Please create a new BMC first or use Delete All option."]})}):y.map(e=>(0,t.jsx)("button",{onClick:()=>j(e.id),disabled:N,className:`w-full p-4 rounded-lg border-2 transition-all text-left ${f===e.id?"border-green-500 bg-green-50 dark:bg-green-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 bg-white dark:bg-gray-800"}`,children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:`p-2 rounded-lg ${f===e.id?"bg-green-500":"bg-gray-100 dark:bg-gray-700"}`,children:(0,t.jsx)(n.Building2,{className:`w-5 h-5 ${f===e.id?"text-white":"text-gray-600 dark:text-gray-400"}`})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:e.name}),(0,t.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["ID: ",e.bmcId]})]})]}),f===e.id&&(0,t.jsx)(c.CheckCircle,{className:"w-5 h-5 text-green-500"})]})},e.id))})]}),z&&!N&&(0,t.jsxs)(r.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center justify-center gap-3 text-sm",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:u}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Current BMC"})]}),(0,t.jsx)(o.ArrowRight,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:z.name}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"New BMC"})]})]}),(0,t.jsxs)("p",{className:"text-xs text-center text-blue-800 dark:text-blue-200 mt-2",children:["All ",p.length," ",1===p.length?"society":"societies"," will be transferred"]})]}),N&&(0,t.jsx)(r.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-6 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(i.AlertTriangle,{className:"w-8 h-8 text-red-600 dark:text-red-400 flex-shrink-0"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h5",{className:"font-semibold text-red-900 dark:text-red-100 mb-1",children:"Complete Data Deletion"}),(0,t.jsx)("p",{className:"text-sm text-red-800 dark:text-red-200",children:"The following will be permanently deleted:"}),(0,t.jsxs)("ul",{className:"text-sm text-red-800 dark:text-red-200 mt-2 space-y-1 list-disc list-inside",children:[(0,t.jsxs)("li",{children:[p.length," ",1===p.length?"Society":"Societies"]}),(0,t.jsx)("li",{children:"All farmers under these societies"}),(0,t.jsx)("li",{children:"All machines linked to these societies"}),(0,t.jsx)("li",{children:"All machine statistics"}),(0,t.jsx)("li",{children:"All machine corrections (admin & device saved)"}),(0,t.jsx)("li",{children:"All rate charts and rate chart data"}),(0,t.jsx)("li",{children:"All milk collection records"}),(0,t.jsx)("li",{children:"All milk sales records"}),(0,t.jsx)("li",{children:"All milk dispatch records"}),(0,t.jsx)("li",{children:"All section pulse tracking data"}),(0,t.jsxs)("li",{children:["BMC: ",(0,t.jsx)("strong",{children:u})]})]})]})]})}),M&&C&&(0,t.jsx)(r.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-6 p-4 bg-orange-50 dark:bg-orange-900/20 border-2 border-orange-300 dark:border-orange-700 rounded-lg",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsxs)("h4",{className:"font-semibold text-orange-900 dark:text-orange-100 mb-2 flex items-center justify-center gap-2",children:[(0,t.jsx)(m.Mail,{className:"w-5 h-5"}),"OTP Verification Required"]}),(0,t.jsxs)("p",{className:"text-sm text-orange-800 dark:text-orange-200 mb-4",children:["We've sent a 6-digit OTP to your registered email. Please enter it below to confirm ",N?"deletion":"transfer","."]}),(0,t.jsx)("div",{className:"flex justify-center gap-2 mb-4",children:T.map((e,a)=>(0,t.jsx)("input",{ref:e=>{L.current[a]=e},type:"text",inputMode:"numeric",maxLength:1,value:e,onChange:e=>((e,t)=>{if(t.length>1||!/^\d*$/.test(t))return;let a=[...T];a[e]=t,F(a),t&&e<5&&L.current[e+1]?.focus()})(a,e.target.value),onKeyDown:e=>{"Backspace"===e.key&&!T[a]&&a>0&&L.current[a-1]?.focus()},onPaste:O,className:"w-12 h-14 text-center text-2xl font-bold border-2 border-orange-300 dark:border-orange-700 rounded-lg focus:border-orange-500 focus:ring-2 focus:ring-orange-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",disabled:k},a))}),B&&(0,t.jsx)("p",{className:"text-sm text-red-600 dark:text-red-400 mb-2",children:B}),(0,t.jsxs)("button",{onClick:E,disabled:A,className:"text-sm text-orange-700 dark:text-orange-300 hover:text-orange-900 dark:hover:text-orange-100 flex items-center justify-center gap-1 mx-auto transition-colors disabled:opacity-50",children:[(0,t.jsx)(x.RefreshCw,{className:"w-4 h-4"}),"Resend OTP"]})]})})]}),(0,t.jsx)("div",{className:"sticky bottom-0 bg-gray-50 dark:bg-gray-900/50 px-6 py-4 border-t border-gray-200 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:g,disabled:k,className:"flex-1 px-4 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),(0,t.jsx)("button",{onClick:$,disabled:!f&&!N||k||M&&6!==T.join("").length,className:`flex-1 px-4 py-2.5 text-sm font-medium text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 ${N?"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700":"bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600"}`,children:k?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),N?"Deleting All...":"Transferring..."]}):M?(0,t.jsxs)(t.Fragment,{children:[N?(0,t.jsx)(i.AlertTriangle,{className:"w-4 h-4"}):(0,t.jsx)(o.ArrowRight,{className:"w-4 h-4"}),"Verify OTP & ",N?"Delete All":"Transfer"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.Mail,{className:"w-4 h-4"}),"Send OTP to Confirm"]})})]})})]})]})})}e.s(["default",()=>g],806536);var h=e.i(727612),u=e.i(514764),b=e.i(581418);function p({isOpen:e,onClose:r,onConfirm:s,bmcName:n,loading:o=!1,societyCount:d=0,farmerCount:c=0,collectionCount:m=0,machineCount:x=0}){let[g,p]=(0,a.useState)("confirm"),[y,f]=(0,a.useState)(["","","","","",""]),[j,k]=(0,a.useState)(!1),[v,N]=(0,a.useState)(""),w=(0,a.useRef)([]),C=async()=>{try{k(!0),N("");let e=window.selectedBmcIdForDelete;if(!e)return void N("BMC ID not found. Please try again.");let t=await fetch("/api/user/bmc/send-delete-otp",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")}`},body:JSON.stringify({bmcId:e})}),a=await t.json();if(!t.ok)throw Error(a.error||"Failed to send OTP");p("otp"),setTimeout(()=>w.current[0]?.focus(),100)}catch(e){N(e instanceof Error?e.message:"Failed to send OTP")}finally{k(!1)}},S=e=>{e.preventDefault();let t=e.clipboardData.getData("text").slice(0,6);if(!/^\d+$/.test(t))return;let a=[...y];t.split("").forEach((e,t)=>{t<6&&(a[t]=e)}),f(a);let r=a.findIndex(e=>!e);-1!==r?w.current[r]?.focus():w.current[5]?.focus()},T=async()=>{let e=y.join("");if(6!==e.length)return void N("Please enter the complete 6-digit OTP");try{await s(e),F()}catch(e){N(e instanceof Error?e.message:"Invalid or expired OTP"),f(["","","","","",""]),w.current[0]?.focus()}},F=()=>{p("confirm"),f(["","","","","",""]),N(""),r()};return e?(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full overflow-hidden",children:[(0,t.jsxs)("div",{className:"bg-gradient-to-r from-red-500 to-red-600 px-6 py-4 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-white/20 rounded-lg",children:(0,t.jsx)(h.Trash2,{className:"w-5 h-5 text-white"})}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-white",children:"confirm"===g?"Delete BMC":"Verify OTP"})]}),(0,t.jsx)("button",{onClick:F,disabled:o||j,className:"text-white/80 hover:text-white transition-colors disabled:opacity-50",children:(0,t.jsx)(l.X,{className:"w-5 h-5"})})]}),(0,t.jsx)("div",{className:"p-6",children:"confirm"===g?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 mb-4",children:(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)(i.AlertTriangle,{className:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-red-900 dark:text-red-100 mb-1",children:"Warning: This action cannot be undone"}),(0,t.jsx)("p",{className:"text-sm text-red-700 dark:text-red-300",children:"Deleting this BMC will permanently remove:"})]})]})}),(0,t.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,t.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"BMC Name"}),(0,t.jsx)("p",{className:"font-semibold text-gray-900 dark:text-gray-100",children:n})]}),(0,t.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"The following data will be deleted:"}),(0,t.jsxs)("ul",{className:"space-y-1 text-sm text-gray-700 dark:text-gray-300",children:[d>0&&(0,t.jsxs)("li",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full"}),d," societ",d>1?"ies":"y"]}),c>0&&(0,t.jsxs)("li",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full"}),c," farmer",c>1?"s":""," and their data"]}),m>0&&(0,t.jsxs)("li",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full"}),m," collection record",m>1?"s":""]}),x>0&&(0,t.jsxs)("li",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full"}),x," machine",x>1?"s":""," and settings"]}),0===d&&0===c&&0===m&&0===x&&(0,t.jsxs)("li",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full"}),"The BMC details only"]})]})]})]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:F,disabled:o||j,className:"flex-1 px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors disabled:opacity-50",children:"Cancel"}),(0,t.jsx)("button",{onClick:C,disabled:o||j,className:"flex-1 px-4 py-2.5 bg-gradient-to-r from-red-500 to-red-600 rounded-lg font-medium text-white hover:from-red-600 hover:to-red-700 transition-all disabled:opacity-50 flex items-center justify-center gap-2",children:j?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Sending OTP..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.Send,{className:"w-4 h-4"}),"Send OTP"]})})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4 mb-6",children:(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)(b.ShieldCheck,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-blue-900 dark:text-blue-100 mb-1",children:"OTP Sent to Your Email"}),(0,t.jsx)("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Please enter the 6-digit OTP to confirm deletion. The code will expire in 10 minutes."})]})]})}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Enter OTP Code"}),(0,t.jsx)("div",{className:"flex gap-2 justify-center",children:y.map((e,a)=>(0,t.jsx)("input",{ref:e=>{w.current[a]=e},type:"text",inputMode:"numeric",maxLength:1,value:e,onChange:e=>((e,t)=>{if(t.length>1&&(t=t[0]),!/^\d*$/.test(t))return;let a=[...y];a[e]=t,f(a),t&&e<5&&w.current[e+1]?.focus()})(a,e.target.value),onKeyDown:e=>{"Backspace"===e.key&&!y[a]&&a>0&&w.current[a-1]?.focus()},onPaste:0===a?S:void 0,className:"w-12 h-14 text-center text-xl font-bold border-2 border-gray-300 dark:border-gray-600 rounded-lg focus:border-red-500 focus:ring-2 focus:ring-red-500/20 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",disabled:o},a))}),v&&(0,t.jsx)("p",{className:"text-sm text-red-600 dark:text-red-400 mt-2 text-center",children:v})]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:()=>{p("confirm"),f(["","","","","",""]),N("")},disabled:o,className:"flex-1 px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors disabled:opacity-50",children:"Back"}),(0,t.jsx)("button",{onClick:T,disabled:o||y.some(e=>!e),className:"flex-1 px-4 py-2.5 bg-gradient-to-r from-red-500 to-red-600 rounded-lg font-medium text-white hover:from-red-600 hover:to-red-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:o?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Deleting..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Trash2,{className:"w-4 h-4"}),"Delete BMC"]})})]})]})})]})}):null}e.s(["default",()=>p],27808)},782481,e=>{"use strict";var t=e.i(843476),a=e.i(271645),r=e.i(931194),s=e.i(618566),l=e.i(833277),i=e.i(111110),n=e.i(129228),o=e.i(555706),d=e.i(785183),c=e.i(93230),m=e.i(872526),x=e.i(234239),g=e.i(731195),h=e.i(580555),u=e.i(346897),b=e.i(343432),p=e.i(284614),y=e.i(87316),f=e.i(607486),j=e.i(339707),k=e.i(356909),v=e.i(283627),N=e.i(727612),w=e.i(761911),C=e.i(25652),S=e.i(842009),T=e.i(939544),F=e.i(286536),M=e.i(77705),I=e.i(107233),B=e.i(217923),P=e.i(37727);e.i(633999);var A=e.i(269111),D=e.i(344803),L=e.i(998253),E=e.i(545292),O=e.i(506296),$=e.i(504767),z=e.i(154041),R=e.i(935281),q=e.i(199083),V=e.i(688462),W=e.i(948168),Q=e.i(583560),U=e.i(598522),J=e.i(892892),G=e.i(806536),K=e.i(27808);let H={name:"",bmcId:"",password:"",dairyFarmId:"",location:"",contactPerson:"",phone:"",email:"",capacity:"",status:"active",monthlyTarget:""},X=(e,a)=>{if(!e&&0!==e)return e||"";if(!a)return e;let r=e.toString(),s=RegExp(`(${a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return r.split(s).map((e,a)=>s.test(e)?(0,t.jsx)("span",{className:"bg-yellow-200 dark:bg-yellow-800 px-0.5 rounded",children:e},a):e)};function Y(){let e,Y,_=(0,s.useRouter)(),Z=(0,s.useSearchParams)(),{user:ee}=(0,l.useUser)(),{t:et}=(0,i.useLanguage)(),[ea,er]=(0,a.useState)([]),[es,el]=(0,a.useState)([]),[ei,en]=(0,a.useState)(!0),[eo,ed]=(0,a.useState)(!0),[ec,em]=(0,a.useState)(!1),[ex,eg]=(0,a.useState)(!1),[eh,eu]=(0,a.useState)(!1),[eb,ep]=(0,a.useState)(!1),[ey,ef]=(0,a.useState)(!1),[ej,ek]=(0,a.useState)([]),[ev,eN]=(0,a.useState)([]),[ew,eC]=(0,a.useState)(null),[eS,eT]=(0,a.useState)(H),[eF,eM]=(0,a.useState)(!1),[eI,eB]=(0,a.useState)(""),[eP,eA]=(0,a.useState)("all"),[eD,eL]=(0,a.useState)([]),[eE,eO]=(0,a.useState)(""),[e$,ez]=(0,a.useState)(""),[eR,eq]=(0,a.useState)(!1),[eV,eW]=(0,a.useState)(""),[eQ,eU]=(0,a.useState)(!1),[eJ,eG]=(0,a.useState)({}),[eK,eH]=(0,a.useState)(!1),[eX,eY]=(0,a.useState)("quantity"),[e_,eZ]=(0,a.useState)(!1),[e0,e1]=(0,a.useState)(null),e2=(0,a.useCallback)(async()=>{try{ed(!0);let e=localStorage.getItem("authToken");if(!e)return;let t=await fetch("/api/user/dairy",{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(t.ok){let e=await t.json();el(e.data||[])}}catch(e){console.error("Error fetching dairies:",e)}finally{ed(!1)}},[]),e5=(0,a.useCallback)(async()=>{try{en(!0);let e=localStorage.getItem("authToken");if(!e)return void _.push("/login");let t=await fetch("/api/user/bmc",{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!t.ok){if(401===t.status||403===t.status){localStorage.removeItem("authToken"),_.push("/login");return}throw Error("Failed to fetch BMCs")}let a=await t.json();er(a.data||[])}catch(e){console.error("Error fetching BMCs:",e),eO("Failed to load BMC data")}finally{en(!1)}},[_]),e4=async e=>{if(e.preventDefault(),eM(!0),eO(""),!eS.dairyFarmId){eO("Please select a dairy farm"),eM(!1);return}try{let e=localStorage.getItem("authToken"),t=await fetch("/api/user/bmc",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({...eS,dairyFarmId:parseInt(eS.dairyFarmId),capacity:eS.capacity?parseInt(eS.capacity):void 0,monthlyTarget:eS.monthlyTarget?parseInt(eS.monthlyTarget):void 0})});if(t.ok)ez("BMC added successfully!"),em(!1),eT(H),await e5(),setTimeout(()=>ez(""),3e3);else{let e=(await t.json()).error||"Failed to add BMC";eG({}),e.toLowerCase().includes("bmc id")&&e.toLowerCase().includes("already exists")?eG({bmcId:"This BMC ID already exists"}):e.toLowerCase().includes("bmc name")&&e.toLowerCase().includes("already exists")?eG({name:"This BMC name already exists"}):eO(e)}}catch(e){console.error("Error adding BMC:",e),eO("Failed to add BMC")}finally{eM(!1)}},e3=async e=>{eC(e),eq(!1),eW("");try{let t=localStorage.getItem("authToken"),a=await fetch(`/api/user/bmc/password?id=${e.id}`,{headers:{Authorization:`Bearer ${t}`}});if(a.ok){let t=await a.json(),r=t.data?.password||t.password||"";eW(r),eT({name:e.name,bmcId:e.bmcId,password:r,dairyFarmId:e.dairyFarmId?.toString()||"",location:e.location||"",contactPerson:e.contactPerson||"",phone:e.phone||"",email:e.email||"",capacity:e.capacity?.toString()||"",status:e.status||"active",monthlyTarget:e.monthlyTarget?.toString()||""})}else eT({name:e.name,bmcId:e.bmcId,password:"",dairyFarmId:e.dairyFarmId?.toString()||"",location:e.location||"",contactPerson:e.contactPerson||"",phone:e.phone||"",email:e.email||"",capacity:e.capacity?.toString()||"",status:e.status||"active",monthlyTarget:e.monthlyTarget?.toString()||""})}catch(t){console.error("Error fetching password:",t),eT({name:e.name,bmcId:e.bmcId,password:"",dairyFarmId:e.dairyFarmId?.toString()||"",location:e.location||"",contactPerson:e.contactPerson||"",phone:e.phone||"",email:e.email||"",capacity:e.capacity?.toString()||"",status:e.status||"active",monthlyTarget:e.monthlyTarget?.toString()||""})}eg(!0)},e6=async e=>{if(e.preventDefault(),ew){if(eM(!0),eO(""),!eS.dairyFarmId){eO("Please select a dairy farm"),eM(!1);return}try{let e=localStorage.getItem("authToken"),t={id:ew.id,name:eS.name,dairyFarmId:parseInt(eS.dairyFarmId),location:eS.location,contactPerson:eS.contactPerson,phone:eS.phone,email:eS.email,capacity:eS.capacity?parseInt(eS.capacity):void 0,status:eS.status,monthlyTarget:eS.monthlyTarget?parseInt(eS.monthlyTarget):void 0};eS.password&&eS.password!==eV&&(t.password=eS.password);let a=await fetch("/api/user/bmc",{method:"PUT",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(t)});if(a.ok)ez("BMC updated successfully!"),eg(!1),eC(null),eT(H),await e5(),setTimeout(()=>ez(""),3e3);else{let e=(await a.json()).error||"Failed to update BMC";eG({}),e.toLowerCase().includes("bmc name")&&e.toLowerCase().includes("already exists")?eG({name:"This BMC name already exists"}):eO(e)}}catch(e){console.error("Error updating BMC:",e),eO("Failed to update BMC")}finally{eM(!1)}}},e9=async(e,t)=>{try{let a=localStorage.getItem("authToken"),r=await fetch("/api/user/bmc",{method:"PUT",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({id:e.id,status:t})});if(r.ok)ez(`Status updated to ${t}!`),await e5(),setTimeout(()=>ez(""),3e3);else{let e=await r.json();eO(e.error||"Failed to update status")}}catch(e){console.error("Error updating status:",e),eO("Failed to update status")}},e7=async e=>{eC(e);let t=await e8(e.id);t.length>0?(ek(t),eN(ea.filter(t=>t.id!==e.id)),ef(!0)):(window.selectedBmcIdForDelete=e.id,eu(!0))},e8=async e=>{try{let t=localStorage.getItem("authToken"),a=await fetch("/api/user/society",{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(a.ok){let t=await a.json();return t.data?.filter(t=>t.bmc_id===e)||[]}}catch(e){console.error("Error fetching societies:",e)}return[]},te=async e=>{if(ew)try{ep(!0);let t=localStorage.getItem("authToken"),a=await fetch("/api/user/bmc",{method:"DELETE",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({id:ew.id,otp:e})});if(a.ok)ez("BMC deleted successfully!"),eu(!1),eC(null),await e5(),setTimeout(()=>ez(""),3e3);else{let e=await a.json();throw Error(e.error||"Failed to delete BMC")}}catch(e){throw console.error("Error deleting BMC:",e),e}finally{ep(!1)}},tt=async(e,t,a)=>{if(ew)try{let r=localStorage.getItem("authToken"),s=await fetch("/api/user/bmc",{method:"DELETE",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify({id:ew.id,newBmcId:e,deleteAll:t,otp:a})}),l=await s.json();s.ok?(ef(!1),eC(null),t?ez("All data deleted successfully!"):ez(`Transferred ${l.data?.transferredSocieties||0} societies and deleted BMC successfully!`),await e5(),setTimeout(()=>ez(""),3e3)):eO(l.error||"Failed to delete BMC")}catch(e){console.error("Error deleting BMC:",e),eO("Failed to delete BMC")}},ta=(e,t)=>{if("bmcId"===e&&!ex){let e=t.replace(/^B-/i,"");t=`B-${e}`}eT(a=>({...a,[e]:t})),eJ[e]&&eG(t=>({...t,[e]:""}))},tr=ea.filter(e=>{let t=""===eI||e.name.toLowerCase().includes(eI.toLowerCase())||e.bmcId.toLowerCase().includes(eI.toLowerCase())||e.location?.toLowerCase().includes(eI.toLowerCase())||e.contactPerson?.toLowerCase().includes(eI.toLowerCase())||e.phone?.toLowerCase().includes(eI.toLowerCase())||e.email?.toLowerCase().includes(eI.toLowerCase())||e.dairyFarmName?.toLowerCase().includes(eI.toLowerCase()),a="all"===eP||e.status===eP,r=0===eD.length||eD.includes(e.dairyFarmId?.toString()||"");return t&&a&&r});return((0,a.useEffect)(()=>{e5(),e2()},[e5,e2]),(0,a.useEffect)(()=>{let e=e=>{eB(e.detail?.query||"")};return window.addEventListener("globalSearch",e),()=>window.removeEventListener("globalSearch",e)},[]),(0,a.useEffect)(()=>{let e=Z.get("dairyFilter");e&&es.length>0&&eL([e])},[Z,es]),ee)?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8 space-y-4 sm:space-y-6 lg:pb-8",children:[(0,t.jsx)(R.PageHeader,{title:"BMC Management",subtitle:"Manage your Bulk Milk Cooling Centers",icon:(0,t.jsx)(h.Factory,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"}),onRefresh:e5}),(0,t.jsx)(q.StatusMessage,{success:e$,error:eE&&!eE.includes("dairy farm first")?eE:void 0}),eE&&eE.includes("dairy farm first")&&(0,t.jsx)(q.StatusMessage,{error:eE}),ea.length>0&&(()=>{let e=ea.filter(e=>e.totalQuantity30d&&Number(e.totalQuantity30d)>0);if(0===e.length)return null;let a=[...e].sort((e,t)=>Number(t.totalQuantity30d||0)-Number(e.totalQuantity30d||0))[0],r=[...e].sort((e,t)=>Number(t.totalAmount30d||0)-Number(e.totalAmount30d||0))[0],s=[...e].sort((e,t)=>Number(t.weightedFat30d||0)-Number(e.weightedFat30d||0))[0],l=[...e].sort((e,t)=>Number(t.weightedSnf30d||0)-Number(e.weightedSnf30d||0))[0],i=[...e].sort((e,t)=>Number(t.totalCollections30d||0)-Number(e.totalCollections30d||0))[0],n=[...e].sort((e,t)=>Number(e.weightedWater30d||100)-Number(t.weightedWater30d||100))[0];return(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-3 sm:gap-4",children:[a&&(0,t.jsxs)("div",{className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 p-4 rounded-lg border border-green-200 dark:border-green-700 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>{eY("quantity"),eH(!0)},children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-green-900 dark:text-green-100",children:"Top Collection (30d)"}),(0,t.jsx)(w.Users,{className:"w-5 h-5 text-green-600 dark:text-green-400"})]}),(0,t.jsx)("p",{className:"text-lg font-bold text-green-800 dark:text-green-200",children:a.name}),(0,t.jsxs)("p",{className:"text-sm text-green-600 dark:text-green-400",children:[Number(a.totalQuantity30d||0).toFixed(2)," L"]})]}),r&&(0,t.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 p-4 rounded-lg border border-blue-200 dark:border-blue-700 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>{eY("revenue"),eH(!0)},children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100",children:"Top Revenue (30d)"}),(0,t.jsx)(f.Building2,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})]}),(0,t.jsx)("p",{className:"text-lg font-bold text-blue-800 dark:text-blue-200",children:r.name}),(0,t.jsxs)("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:["₹",Number(r.totalAmount30d||0).toFixed(2)]})]}),s&&(0,t.jsxs)("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-800/20 p-4 rounded-lg border border-purple-200 dark:border-purple-700 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>{eY("fat"),eH(!0)},children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-purple-900 dark:text-purple-100",children:"Best Quality (30d)"}),(0,t.jsx)(F.Eye,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})]}),(0,t.jsx)("p",{className:"text-lg font-bold text-purple-800 dark:text-purple-200",children:s.name}),(0,t.jsxs)("p",{className:"text-sm text-purple-600 dark:text-purple-400",children:[Number(s.weightedFat30d||0).toFixed(2),"% Fat"]})]}),l&&(0,t.jsxs)("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-800/20 p-4 rounded-lg border border-orange-200 dark:border-orange-700 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>{eY("snf"),eH(!0)},children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-orange-900 dark:text-orange-100",children:"Best SNF (30d)"}),(0,t.jsx)(C.TrendingUp,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"})]}),(0,t.jsx)("p",{className:"text-lg font-bold text-orange-800 dark:text-orange-200",children:l.name}),(0,t.jsxs)("p",{className:"text-sm text-orange-600 dark:text-orange-400",children:[Number(l.weightedSnf30d||0).toFixed(2),"% SNF"]})]}),i&&(0,t.jsxs)("div",{className:"bg-gradient-to-br from-pink-50 to-pink-100 dark:from-pink-900/20 dark:to-pink-800/20 p-4 rounded-lg border border-pink-200 dark:border-pink-700 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>{eY("collections"),eH(!0)},children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-pink-900 dark:text-pink-100",children:"Most Active (30d)"}),(0,t.jsx)(S.Award,{className:"w-5 h-5 text-pink-600 dark:text-pink-400"})]}),(0,t.jsx)("p",{className:"text-lg font-bold text-pink-800 dark:text-pink-200",children:i.name}),(0,t.jsxs)("p",{className:"text-sm text-pink-600 dark:text-pink-400",children:[Number(i.totalCollections30d||0)," Collections"]})]}),n&&(0,t.jsxs)("div",{className:"bg-gradient-to-br from-red-50 to-red-100 dark:from-red-900/20 dark:to-red-800/20 p-4 rounded-lg border border-red-200 dark:border-red-700 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>{eY("water"),eH(!0)},children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-red-900 dark:text-red-100",children:"Most Water (30d)"}),(0,t.jsx)(T.Droplets,{className:"w-5 h-5 text-red-600 dark:text-red-400"})]}),(0,t.jsx)("p",{className:"text-lg font-bold text-red-800 dark:text-red-200",children:n.name}),(0,t.jsxs)("p",{className:"text-sm text-red-600 dark:text-red-400",children:[Number(n.weightedWater30d||0).toFixed(2),"% Water"]})]})]})})(),(0,t.jsx)(V.FilterControls,{icon:(0,t.jsx)(f.Building2,{className:"w-4 h-4 flex-shrink-0"}),showingText:`Showing ${tr.length} of ${ea.length} BMCs`,filterLabel:"Filter:",filterValue:eP,filterOptions:[{value:"all",label:"All Status"},{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"maintenance",label:"Maintenance"}],onFilterChange:e=>eA(e)}),ei?(0,t.jsx)(D.LoadingSpinner,{}):tr.length>0?(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-6",children:tr.map(e=>(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-lg transition-all duration-200 overflow-visible border border-gray-200 dark:border-gray-700 hover:border-green-200 dark:hover:border-green-700 relative z-10 hover:z-20",children:[(0,t.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 p-4 border-b border-gray-200 dark:border-gray-700 rounded-t-lg",children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,t.jsx)("div",{className:"p-2 bg-gradient-to-r from-green-100 to-emerald-100 dark:from-green-900/30 dark:to-emerald-900/30 rounded-lg flex-shrink-0",children:(0,t.jsx)(h.Factory,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white truncate",children:X(e.name,eI)}),(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:X(e.bmcId,eI)})]})]}),(0,t.jsx)(Q.StatusDropdown,{currentStatus:e.status,onStatusChange:t=>e9(e,t),options:[{status:"active",label:"Active",color:"bg-green-500",bgColor:"hover:bg-green-50 dark:hover:bg-green-900/30"},{status:"inactive",label:"Inactive",color:"bg-red-500",bgColor:"hover:bg-red-50 dark:hover:bg-red-900/30"},{status:"maintenance",label:"Maintenance",color:"bg-yellow-500",bgColor:"hover:bg-yellow-50 dark:hover:bg-yellow-900/30"}],compact:!0})]})}),(0,t.jsxs)("div",{className:"p-4 space-y-3",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(p.User,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),(0,t.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300 truncate",children:X(e.contactPerson||"No Contact",eI)})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(b.Phone,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),(0,t.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300 truncate",children:X(e.phone||"No Phone",eI)})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(u.MapPin,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),(0,t.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300 truncate",children:X(e.location||"No Location",eI)})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(j.Milk,{className:"w-4 h-4 text-blue-500 flex-shrink-0"}),(0,t.jsx)("span",{className:"text-sm text-blue-600 dark:text-blue-400 font-medium truncate",children:X(e.dairyFarmName||"No Dairy",eI)})]})]}),(0,t.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700 my-3"}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:"Last 30 Days"}),(0,t.jsx)(y.Calendar,{className:"w-4 h-4 text-gray-400"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Collections"})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:Number(e.totalCollections30d||0)}),(0,t.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:[Number(e.totalQuantity30d||0).toFixed(2)," Liters"]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,t.jsxs)("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 rounded-lg p-2 text-center",children:[(0,t.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Fat"}),(0,t.jsxs)("div",{className:"text-sm font-bold text-indigo-600 dark:text-indigo-400",children:[Number(e.weightedFat30d||0).toFixed(2),"%"]})]}),(0,t.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-2 text-center",children:[(0,t.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"SNF"}),(0,t.jsxs)("div",{className:"text-sm font-bold text-purple-600 dark:text-purple-400",children:[Number(e.weightedSnf30d||0).toFixed(2),"%"]})]}),(0,t.jsxs)("div",{className:"bg-pink-50 dark:bg-pink-900/20 rounded-lg p-2 text-center",children:[(0,t.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"CLR"}),(0,t.jsx)("div",{className:"text-sm font-bold text-pink-600 dark:text-pink-400",children:Number(e.weightedClr30d||0).toFixed(1)})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between bg-emerald-50 dark:bg-emerald-900/20 rounded-lg p-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full bg-emerald-500"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Total Revenue"})]}),(0,t.jsxs)("div",{className:"text-lg font-bold text-emerald-600 dark:text-emerald-400",children:["₹",Number(e.totalAmount30d||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 px-4 py-3 border-t border-gray-100 dark:border-gray-700 flex items-center justify-between gap-2 rounded-b-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>e3(e),className:"p-2 text-gray-400 dark:text-gray-500 hover:text-green-600 dark:hover:text-green-400 transition-colors rounded-lg hover:bg-green-50 dark:hover:bg-green-900/30",title:"Edit",children:(0,t.jsx)(v.Edit3,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>e7(e),className:"p-2 text-gray-400 dark:text-gray-500 hover:text-red-600 dark:hover:text-red-400 transition-colors rounded-lg hover:bg-red-50 dark:hover:bg-red-900/30",title:"Delete",children:(0,t.jsx)(N.Trash2,{className:"w-4 h-4"})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("button",{onClick:()=>{e1(e),eZ(!0)},className:"flex items-center gap-2 px-3 py-1.5 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors group",title:`View ${e.societyCount||0} societies under ${e.name}`,children:[(0,t.jsx)(f.Building2,{className:"w-4 h-4 text-gray-400 group-hover:text-blue-500 transition-colors"}),(0,t.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-400 group-hover:text-blue-600 dark:group-hover:text-blue-400 font-medium transition-colors",children:[e.societyCount||0," Societies"]})]}),(0,t.jsxs)("button",{onClick:()=>_.push(`/admin/bmc/${e.id}`),className:"flex items-center px-3 py-1.5 text-sm text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/30 rounded-lg transition-colors",title:"View Details",children:[(0,t.jsx)(F.Eye,{className:"w-4 h-4 mr-1"}),(0,t.jsx)("span",{children:"View"})]})]})]})]},e.id))}):(0,t.jsx)(W.EmptyState,{icon:(0,t.jsx)(h.Factory,{className:"w-12 h-12 sm:w-16 sm:h-16 text-gray-400"}),title:"No BMCs found",message:"all"===eP?"Get started by adding your first BMC":"Try changing the filter to see more results",actionText:"all"===eP?"Add Your First BMC":void 0,onAction:"all"===eP?()=>{if(0===es.length){eO("Please add a dairy farm first before adding BMC"),setTimeout(()=>eO(""),5e3);return}eO(""),em(!0)}:void 0,showAction:"all"===eP})]}),(0,t.jsx)(U.default,{actions:[{icon:(0,t.jsx)(I.Plus,{className:"w-6 h-6 text-white"}),label:"Add BMC",onClick:()=>{eG({}),eO(""),em(!0),e2()},color:"bg-gradient-to-br from-green-500 to-green-600"}],directClick:!0}),(0,t.jsx)(L.FormModal,{isOpen:ec,onClose:()=>{em(!1),eT(H)},title:et.bmcManagement.addBMC,maxWidth:"lg",children:(0,t.jsxs)("form",{onSubmit:e4,className:"space-y-4 sm:space-y-6",children:[(0,t.jsxs)(z.FormGrid,{children:[(0,t.jsx)(E.FormInput,{label:"BMC Name",value:eS.name,onChange:e=>ta("name",e),placeholder:"Enter BMC name",required:!0,error:eJ.name,colSpan:1}),(0,t.jsx)(E.FormInput,{label:"BMC ID",value:eS.bmcId,onChange:e=>ta("bmcId",e),placeholder:"B-001",required:!0,disabled:ex,error:eJ.bmcId,colSpan:1}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Password ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:eQ?"text":"password",value:eS.password,onChange:e=>ta("password",e.target.value),placeholder:"Enter password",required:!ex,className:"form-input-custom w-full px-3 sm:px-4 py-2 sm:py-2.5 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-blue-500 dark:focus:border-blue-400 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-all duration-200 focus:outline-none"}),(0,t.jsx)("button",{type:"button",onClick:()=>eU(!eQ),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-colors",title:eQ?"Hide password":"Show password",children:eQ?(0,t.jsx)(M.EyeOff,{className:"w-5 h-5"}):(0,t.jsx)(F.Eye,{className:"w-5 h-5"})})]})]}),(0,t.jsx)(O.FormSelect,{label:"Dairy Farm",value:eS.dairyFarmId,onChange:e=>ta("dairyFarmId",e),options:es.map(e=>({value:e.id,label:`${e.name} (${e.dairyId})`})),placeholder:"Select dairy farm",required:!0,disabled:eo,colSpan:1}),(0,t.jsx)(E.FormInput,{label:"Capacity (Liters)",type:"number",value:eS.capacity,onChange:e=>ta("capacity",e),placeholder:"2000",colSpan:1}),(0,t.jsx)(E.FormInput,{label:"Monthly Target (Liters)",type:"number",value:eS.monthlyTarget,onChange:e=>ta("monthlyTarget",e),placeholder:"2000",colSpan:1}),(0,t.jsx)(E.FormInput,{label:"Contact Person",value:eS.contactPerson,onChange:e=>ta("contactPerson",e),placeholder:"Enter contact person",colSpan:1}),(0,t.jsx)(E.FormInput,{label:"Phone Number",type:"tel",value:eS.phone,onChange:e=>{ta("phone",(0,r.formatPhoneInput)(e))},onBlur:()=>{let e=(0,r.validatePhoneOnBlur)(eS.phone);e?eG(t=>({...t,phone:e})):eG(e=>({...e,phone:void 0}))},placeholder:"Enter 10-digit phone number",error:eJ.phone,colSpan:1}),(0,t.jsx)(E.FormInput,{label:"Email",type:"email",value:eS.email,onChange:e=>ta("email",e),placeholder:"bmc@example.com",colSpan:1}),(0,t.jsx)(O.FormSelect,{label:"Status",value:eS.status,onChange:e=>ta("status",e),options:[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"maintenance",label:"Maintenance"}],colSpan:1}),(0,t.jsx)(E.FormInput,{label:"Location",value:eS.location,onChange:e=>ta("location",e),placeholder:"Enter location",colSpan:2})]}),(0,t.jsx)($.FormActions,{onCancel:()=>{em(!1),eT(H)},submitText:et.bmcManagement.addBMC,isLoading:eF,cancelText:et.common.cancel})]})}),(0,t.jsx)(L.FormModal,{isOpen:ex&&!!ew,onClose:()=>{eg(!1),eC(null),eT(H)},title:ew?`${et.common.edit} ${ew.name}`:et.common.edit,maxWidth:"lg",children:(0,t.jsxs)("form",{onSubmit:e6,className:"space-y-4 sm:space-y-6",children:[(0,t.jsxs)(z.FormGrid,{children:[(0,t.jsx)(E.FormInput,{label:`${et.bmcManagement.bmcName}`,value:eS.name,onChange:e=>ta("name",e),placeholder:et.bmcManagement.enterBMCName,required:!0,error:eJ.name,colSpan:1}),(0,t.jsx)(E.FormInput,{label:`${et.bmcManagement.bmcId} (Read-only)`,value:eS.bmcId,onChange:()=>{},readOnly:!0,disabled:!0,colSpan:1}),(0,t.jsx)(O.FormSelect,{label:`${et.bmcManagement.dairyFarm}`,value:eS.dairyFarmId,onChange:e=>ta("dairyFarmId",e),options:es.map(e=>({value:e.id,label:`${e.name} (${e.dairyId})`})),placeholder:"Select dairy farm",required:!0,disabled:eo,colSpan:2}),(0,t.jsxs)("div",{className:"sm:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Password"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:eR?"text":"password",value:eS.password,onChange:e=>ta("password",e.target.value),placeholder:"Enter password",className:"form-input-custom w-full px-3 sm:px-4 py-2 sm:py-2.5 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-emerald-500 dark:focus:ring-emerald-400 focus:border-emerald-500 dark:focus:border-emerald-400 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-all duration-200 focus:outline-none"}),(0,t.jsx)("button",{type:"button",onClick:()=>eq(!eR),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-colors",title:eR?"Hide password":"Show password",children:eR?(0,t.jsx)(M.EyeOff,{className:"w-5 h-5"}):(0,t.jsx)(F.Eye,{className:"w-5 h-5"})})]}),(0,t.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Current password is pre-filled. Click eye icon to view or edit to change."})]}),(0,t.jsx)(E.FormInput,{label:et.bmcManagement.capacity,type:"number",value:eS.capacity,onChange:e=>ta("capacity",e),placeholder:et.bmcManagement.enterCapacity,colSpan:1}),(0,t.jsx)(E.FormInput,{label:et.bmcManagement.monthlyTarget,type:"number",value:eS.monthlyTarget,onChange:e=>ta("monthlyTarget",e),placeholder:et.bmcManagement.enterMonthlyTarget,colSpan:1}),(0,t.jsx)(E.FormInput,{label:et.bmcManagement.contactPerson,value:eS.contactPerson,onChange:e=>ta("contactPerson",e),placeholder:et.bmcManagement.enterContactPerson,colSpan:1}),(0,t.jsx)(E.FormInput,{label:et.bmcManagement.phone,type:"tel",value:eS.phone,onChange:e=>{ta("phone",(0,r.formatPhoneInput)(e))},onBlur:()=>{let e=(0,r.validatePhoneOnBlur)(eS.phone);e?eG(t=>({...t,phone:e})):eG(e=>({...e,phone:void 0}))},placeholder:et.bmcManagement.enterPhoneNumber,error:eJ.phone,colSpan:1}),(0,t.jsx)(E.FormInput,{label:et.bmcManagement.email,type:"email",value:eS.email,onChange:e=>ta("email",e),placeholder:et.bmcManagement.enterEmail,colSpan:1}),(0,t.jsx)(O.FormSelect,{label:et.bmcManagement.status,value:eS.status,onChange:e=>ta("status",e),options:[{value:"active",label:et.bmcManagement.active},{value:"inactive",label:et.bmcManagement.inactive},{value:"maintenance",label:et.bmcManagement.maintenance}],colSpan:1}),(0,t.jsx)(E.FormInput,{label:et.bmcManagement.location,value:eS.location,onChange:e=>ta("location",e),placeholder:et.bmcManagement.enterLocation,colSpan:2})]}),(0,t.jsx)($.FormActions,{onCancel:()=>{eg(!1),eC(null),eT(H)},submitText:et.bmcManagement.updateBMC,isLoading:eF,cancelText:et.common.cancel,loadingText:et.bmcManagement.updatingBMC,submitIcon:(0,t.jsx)(k.Save,{className:"w-4 h-4"})})]})}),(0,t.jsx)(K.default,{isOpen:eh&&!!ew,onClose:()=>{eu(!1),eC(null)},onConfirm:te,bmcName:ew?.name||"",loading:eb,societyCount:ew?.societyCount||0}),(0,t.jsx)(G.default,{isOpen:ey,onClose:()=>{ef(!1),eC(null)},onConfirm:tt,bmcName:ew?.name||"",bmcId:ew?.id||0,societies:ej,availableBMCs:ev}),(0,t.jsx)(J.default,{isOpen:e_&&!!e0,onClose:()=>{eZ(!1),e1(null)},onConfirm:()=>{eZ(!1),_.push(`/admin/society?bmcFilter=${e0?.id}`),e1(null)},title:"Navigate to Society Management",message:`View all societies from ${e0?.name} in the Society Management page with filters applied.`,confirmText:"Go to Society Management",cancelText:"Cancel"}),eK&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(B.BarChart3,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"}),(0,t.jsxs)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:["quantity"===eX&&"Collection Volume - Last 30 Days","revenue"===eX&&"Revenue - Last 30 Days","fat"===eX&&"Average Fat % - Last 30 Days","snf"===eX&&"Average SNF % - Last 30 Days","collections"===eX&&"Number of Collections - Last 30 Days","water"===eX&&"Average Water % - Last 30 Days"]})]}),(0,t.jsx)("button",{onClick:()=>eH(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:(0,t.jsx)(P.X,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(e=ea.filter(e=>e.totalQuantity30d&&e.totalQuantity30d>0).map(e=>({name:e.name,bmcId:e.bmcId,value:"quantity"===eX?e.totalQuantity30d||0:"revenue"===eX?e.totalAmount30d||0:"fat"===eX?e.weightedFat30d||0:"snf"===eX?e.weightedSnf30d||0:"collections"===eX?e.totalCollections30d||0:e.weightedWater30d||0})).sort((e,t)=>t.value-e.value),Y=()=>{switch(eX){case"quantity":return"#10b981";case"revenue":return"#3b82f6";case"fat":return"#8b5cf6";case"snf":return"#f97316";case"collections":return"#ec4899";case"water":return"#ef4444";default:return"#6b7280"}},e.length>0?(0,t.jsx)("div",{className:"w-full h-[500px]",children:(0,t.jsx)(g.ResponsiveContainer,{width:"100%",height:"100%",children:(0,t.jsxs)(n.LineChart,{data:e,margin:{top:5,right:30,left:20,bottom:80},children:[(0,t.jsx)(m.CartesianGrid,{strokeDasharray:"3 3",stroke:"#e5e7eb",className:"dark:stroke-gray-700"}),(0,t.jsx)(d.XAxis,{dataKey:"name",angle:-45,textAnchor:"end",height:100,interval:0,tick:{fontSize:11},stroke:"#6b7280",label:{value:"BMC Name",position:"insideBottom",offset:-5,style:{fontSize:13,fontWeight:500,fill:"#9ca3af"}}}),(0,t.jsx)(c.YAxis,{label:{value:"revenue"===eX?"Revenue (₹)":"fat"===eX||"snf"===eX||"water"===eX?"Percentage (%)":"quantity"===eX?"Volume (L)":"Count",angle:-90,position:"insideLeft",style:{fontSize:13,fontWeight:500,fill:"#9ca3af"}},stroke:"#6b7280"}),(0,t.jsx)(x.Tooltip,{contentStyle:{backgroundColor:"#1f2937",border:"none",borderRadius:"0.5rem",color:"#fff",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1)"},formatter:e=>"revenue"===eX?["₹"+Number(e).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]:"fat"===eX||"snf"===eX||"water"===eX?[Number(e).toFixed(2)+"%"]:"quantity"===eX?[Number(e).toFixed(2)+" L"]:[Number(e)],labelFormatter:e=>`BMC: ${e}`,cursor:{stroke:"#9ca3af",strokeWidth:1}}),(0,t.jsx)(o.Line,{type:"monotone",dataKey:"value",stroke:Y(),strokeWidth:2,dot:{fill:Y(),r:4},activeDot:{r:6},isAnimationActive:!0,name:"Value"})]})})}):(0,t.jsx)("div",{className:"flex items-center justify-center h-[500px]",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(B.BarChart3,{className:"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-lg",children:"No data available for this metric"})]})}))}),(0,t.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700 p-4 bg-gray-50 dark:bg-gray-700/50",children:(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Showing performance metrics for all BMCs over the last 30 days. Click the X to close this view."})})]})})]}):(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:(0,t.jsx)(A.FlowerSpinner,{})})}e.s(["default",()=>Y])}]);