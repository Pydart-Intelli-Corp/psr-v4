(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,813066,e=>{"use strict";var a=e.i(843476),t=e.i(271645),r=e.i(618566),s=e.i(111110),n=e.i(761911),o=e.i(882293),l=e.i(343432),i=e.i(263488),d=e.i(607486),m=e.i(239616),c=e.i(327025),u=e.i(75505),f=e.i(664659),h=e.i(463059),g=e.i(107233),b=e.i(569074),x=e.i(939544),p=e.i(25652),y=e.i(842009),N=e.i(217923),w=e.i(37727),k=e.i(129228),C=e.i(555706),I=e.i(785183),S=e.i(93230),j=e.i(872526),v=e.i(234239),F=e.i(731195),L=e.i(931194),M=e.i(906516);e.i(633999);var E=e.i(269111),A=e.i(998253),T=e.i(545292),O=e.i(506296),$=e.i(504767),D=e.i(154041),B=e.i(199083),z=e.i(818367),_=e.i(948168),P=e.i(426895),P=P;e.i(137996);var R=e.i(849686),U=e.i(462201),q=e.i(641041),V=e.i(833472),W=e.i(59590),Q=e.i(425091),G=e.i(693541),J=e.i(963290),K=e.i(105158),Y=e.i(885023),H=e.i(255749);let X=async(a,t,r,s,n)=>{if(0===a.length)return void alert("No data to download");let{default:o}=await e.A(298136),l=new H.default("landscape","pt","a4"),i=[41,128,185],d=[236,240,241],m=[44,62,80],c=[189,195,199];l.setFillColor(...d),l.rect(0,0,842,130,"F"),l.setFillColor(...i),l.rect(0,0,842,8,"F");try{let e=await fetch("/fulllogo.png"),a=await e.blob(),t=await new Promise(e=>{let t=new FileReader;t.onloadend=()=>e(t.result),t.readAsDataURL(a)});l.addImage(t,"PNG",50,25,120,40)}catch(e){console.warn("Could not load logo:",e)}if(s){l.setTextColor(52,73,94),l.setFontSize(24),l.setFont("helvetica","bold");let e=l.getTextWidth(s);l.text(s,(842-e)/2,80),l.setTextColor(...m),l.setFontSize(11),l.setFont("helvetica","normal");let a="Comprehensive Farmer Management Report",t=l.getTextWidth(a);l.text(a,(842-t)/2,100)}let u=160;if(n&&n.length>0){let e=18*n.length+25;l.setFillColor(...d),l.setDrawColor(...c),l.setLineWidth(.5),l.roundedRect(50,u-15,742,e,5,5,"FD"),l.setTextColor(...i),l.setFontSize(12),l.setFont("helvetica","bold");let a="Report Information",t=l.getTextWidth(a);l.text(a,(842-t)/2,u+5),l.setTextColor(...m),l.setFontSize(10),l.setFont("helvetica","normal"),n.forEach((e,a)=>{let t=u+25+18*a,r=(842-l.getTextWidth(e))/2;l.setFillColor(...i),l.circle(r-15,t-3,2,"F"),l.text(e,r,t)}),u+=e+20}let f=t.map(e=>e.header),h=a.map(e=>t.map(a=>{let t=e[a.key];return String((a.formatter?a.formatter(t):t)||"")})),g=t.map(e=>e.width?e.width:Math.max(60,Math.min(150,6*Math.max(e.header.length,Math.max(...h.map(a=>String(a[t.indexOf(e)]||"").length)))))),b=g.reduce((e,a)=>e+a,0);if(b>742){let e=742/b;g.forEach((a,t)=>{g[t]=a*e})}o(l,{head:[f],body:h,startY:u,margin:{left:50,right:50},columnStyles:t.reduce((e,a,t)=>(e[t]={cellWidth:g[t]},e),{}),styles:{fontSize:9,cellPadding:{top:8,right:6,bottom:8,left:6},lineColor:c,lineWidth:.5,textColor:m,font:"helvetica",overflow:"linebreak",valign:"middle",halign:"center"},headStyles:{fillColor:i,textColor:[255,255,255],fontStyle:"bold",fontSize:10,cellPadding:{top:12,right:8,bottom:12,left:8},halign:"center",valign:"middle"},alternateRowStyles:{fillColor:[249,250,251]},tableLineColor:c,tableLineWidth:.5});l.setFillColor(...d),l.rect(0,545,842,50,"F"),l.setDrawColor(...i),l.setLineWidth(2),l.line(50,550,792,550),l.setTextColor(...m),l.setFontSize(8),l.setFont("helvetica","normal");let x=new Date().toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}),p=`Generated on: ${x}`,y=l.getTextWidth(p);l.text(p,(842-y)/2,565),l.setFont("helvetica","bold");let N="Poornasree Equipments Cloud â€¢ Page 1",w=l.getTextWidth(N);l.text(N,(842-w)/2,577),l.setFont("helvetica","italic"),l.setFontSize(7);let k="This document contains confidential information",C=l.getTextWidth(k);l.text(k,(842-C)/2,587),l.save(`${r}.pdf`)},Z=e=>null==e?"0":e.toLocaleString("en-IN"),ee=e=>e.charAt(0).toUpperCase()+e.slice(1),ea=()=>[{key:"farmerId",header:"Farmer ID"},{key:"rfId",header:"RF-ID"},{key:"farmerName",header:"Farmer Name"},{key:"contactNumber",header:"Contact Number"},{key:"email",header:"Email"},{key:"societyInfo",header:"Society",formatter:e=>e?`${e.name} (${e.id})`:""},{key:"status",header:"Status",formatter:e=>ee(e)},{key:"smsEnabled",header:"SMS Enabled",formatter:e=>e?"ON":"OFF"},{key:"bonus",header:"Bonus",formatter:e=>Z(e)},{key:"address",header:"Address"},{key:"bankName",header:"Bank Name"},{key:"bankAccountNumber",header:"Account Number"},{key:"ifscCode",header:"IFSC Code"},{key:"notes",header:"Notes"}],et=async(e,a,t={},r)=>{let s=[{key:"farmerId",header:"ID",width:60},{key:"rfId",header:"RF-ID",width:60},{key:"farmerName",header:"Name",width:120},{key:"contactNumber",header:"Contact",width:80},{key:"email",header:"Email",width:80},{key:"societyInfo",header:"Society",width:120,formatter:e=>e?`${e.name}`:""},{key:"status",header:"Status",width:60,formatter:e=>ee(e)},{key:"smsEnabled",header:"SMS",width:40,formatter:e=>e?"ON":"OFF"},{key:"bonus",header:"Bonus",width:60,formatter:e=>Z(e)},{key:"address",header:"Address",width:100},{key:"bankName",header:"Bank",width:80},{key:"bankAccountNumber",header:"Account",width:80},{key:"ifscCode",header:"IFSC",width:60},{key:"notes",header:"Notes",width:80}],n=["farmerId","rfId","farmerName","contactNumber","societyInfo","status","smsEnabled","bonus"],o=r&&r.length>0?s.filter(e=>r.includes(e.key)):s.filter(e=>n.includes(e.key)),l=e.map(e=>({farmerId:e.farmerId||"",rfId:e.rfId||"",farmerName:e.farmerName||"",contactNumber:e.contactNumber||"",email:e.email||"",societyInfo:(e=>{if(!e)return{name:"",id:""};let t=a.find(a=>a.id.toString()===e.toString());return t?{name:t.name,id:t.society_id}:{name:"",id:""}})(e.societyId),status:e.status||"active",smsEnabled:e.smsEnabled,bonus:e.bonus||0,address:e.address||"",bankName:e.bankName||"",bankAccountNumber:e.bankAccountNumber||"",ifscCode:e.ifscCode||"",notes:e.notes||""})),i=er(t),d=es(t,a),m=[`Generated on: ${new Date().toLocaleString()}`,`Total Records: ${e.length}`,...d?[d]:[]],c=`farmers_report${i}_${new Date().toISOString().split("T")[0]}`;await X(l,o,c,"Farmers Report",m)},er=e=>{let a=[];return e.status&&"all"!==e.status&&a.push(e.status),e.society&&"all"!==e.society&&a.push("society_filtered"),e.selection&&a.push(e.selection),a.length>0?`_${a.join("_")}`:""},es=(e,a)=>{let t=[];if(e.status&&"all"!==e.status&&t.push(`Status: ${ee(e.status)}`),e.society&&"all"!==e.society){let r=a.find(a=>a.id.toString()===e.society);r&&t.push(`Society: ${r.name} (${r.society_id})`)}return e.selection&&t.push(`Selection: ${e.selection.replace("-"," ")}`),t.length>0?`Filters Applied: ${t.join(", ")}`:""},en=()=>{let e,H,{t:X}=(0,s.useLanguage)(),Z=(0,r.useRouter)(),ee=(0,r.useSearchParams)(),[es,en]=(0,t.useState)([]),[eo,el]=(0,t.useState)([]),[ei,ed]=(0,t.useState)([]),[em,ec]=(0,t.useState)([]),[eu,ef]=(0,t.useState)([]),[eh,eg]=(0,t.useState)(!0),[eb,ex]=(0,t.useState)(!1),[ep,ey]=(0,t.useState)("all"),[eN,ew]=(0,t.useState)([]),[ek,eC]=(0,t.useState)([]),[eI,eS]=(0,t.useState)([]),[ej,ev]=(0,t.useState)([]),[eF,eL]=(0,t.useState)(""),[eM,eE]=(0,t.useState)(""),[eA,eT]=(0,t.useState)(""),[eO,e$]=(0,t.useState)(!1),[eD,eB]=(0,t.useState)(!1),[ez,e_]=(0,t.useState)(!1),[eP,eR]=(0,t.useState)(!1),[eU,eq]=(0,t.useState)(null),[eV,eW]=(0,t.useState)(null),[eQ,eG]=(0,t.useState)(""),[eJ,eK]=(0,t.useState)(!1),[eY,eH]=(0,t.useState)({}),[eX,eZ]=(0,t.useState)(new Set),[e0,e1]=(0,t.useState)(!1),[e2,e5]=(0,t.useState)(!1),[e4,e3]=(0,t.useState)(null),[e6,e8]=(0,t.useState)(!1),[e9,e7]=(0,t.useState)(!1),[ae,aa]=(0,t.useState)(!1),[at,ar]=(0,t.useState)(!1),[as,an]=(0,t.useState)(!1),[ao,al]=(0,t.useState)(!1),[ai,ad]=(0,t.useState)(0),[am,ac]=(0,t.useState)(new Set),[au,af]=(0,t.useState)("folder"),[ah,ag]=(0,t.useState)(new Set),[ab,ax]=(0,t.useState)(!1),[ap,ay]=(0,t.useState)("quantity"),[aN,aw]=(0,t.useState)([]),[ak,aC]=(0,t.useState)("active"),[aI,aS]=(0,t.useState)({topCollector:null,bestFat:null,bestSnf:null,topRevenue:null,mostActive:null,bestQuality:null}),[aj,av]=(0,t.useState)({farmerId:"",rfId:"",farmerName:"",contactNumber:"",email:"",smsEnabled:"OFF",emailNotificationsEnabled:"ON",bonus:0,address:"",bankName:"",bankAccountNumber:"",ifscCode:"",societyId:"",machineId:"",status:"active",notes:""});(0,t.useEffect)(()=>{if(eA||eM){let e=setTimeout(()=>{eT(""),eE("")},5e3);return()=>clearTimeout(e)}},[eA,eM]),(0,t.useEffect)(()=>{let e=e=>{eL(e.detail?.query||"")};return window.addEventListener("globalSearch",e),()=>{window.removeEventListener("globalSearch",e)}},[]),(0,t.useEffect)(()=>{if(eI.length>0&&ej.length>0){let e=ej.filter(e=>{let a=ei.find(a=>a.id.toString()===e);return a&&eI.includes(a.societyId?.toString()||"")});e.length!==ej.length&&ev(e)}},[eI,ej,ei]),(0,t.useEffect)(()=>{let e=ee.get("societyId"),a=ee.get("societyName"),t=ee.get("dairyFilter"),r=ee.get("bmcFilter");e&&!eI.includes(e)&&(eS([e]),a&&eT(`Filter Applied: ${decodeURIComponent(a)}`)),t&&!eN.includes(t)&&(ew([t]),eT("Filter Applied: Dairy")),r&&!ek.includes(r)&&(eC([r]),eT("Filter Applied: BMC"))},[]);let aF=(0,t.useCallback)(async()=>{try{eg(!0);let e=localStorage.getItem("authToken");if(!e)return void Z.push("/login");let a=await fetch("/api/user/farmer",{headers:{Authorization:`Bearer ${e}`}});if(401===a.status){localStorage.removeItem("authToken"),Z.push("/login");return}if(a.ok){let e=await a.json();en(e.data||[])}}catch(e){console.error("Error fetching farmers:",e)}finally{eg(!1)}},[Z]),aL=(0,t.useCallback)(async()=>{try{let e=localStorage.getItem("authToken"),a=await fetch("/api/analytics/farmer-performance",{headers:{Authorization:`Bearer ${e}`}});if(a.ok){let e=await a.json();aS(e.stats||{topCollector:null,bestFat:null,bestSnf:null,topRevenue:null,mostActive:null,bestQuality:null})}}catch(e){console.error("Error fetching performance stats:",e)}},[]),aM=(0,t.useCallback)(async e=>{try{let a=localStorage.getItem("authToken"),t=await fetch("/api/analytics/farmer-performance?graphData=true",{headers:{Authorization:`Bearer ${a}`}});if(t.ok){let a=((await t.json()).farmers||[]).map(a=>({name:a.farmer_name,farmerId:a.farmer_id,societyName:a.society_name,value:"quantity"===e?parseFloat(a.total_quantity)||0:"revenue"===e?parseFloat(a.total_amount)||0:"fat"===e?parseFloat(a.avg_fat)||0:"snf"===e?parseFloat(a.avg_snf)||0:"collections"===e?parseInt(a.total_collections)||0:parseFloat(a.avg_rate)||0})).sort((e,a)=>a.value-e.value).slice(0,20);aw(a)}}catch(e){console.error("Error fetching graph data:",e),aw([])}},[]),aE=e=>{ay(e),aM(e),ax(!0)},aA=async()=>{try{let e=localStorage.getItem("authToken"),a=await fetch("/api/user/society",{headers:{Authorization:`Bearer ${e}`}});if(a.ok){let e=await a.json();el(e.data||[])}}catch(e){console.error("Error fetching societies:",e)}},aT=async()=>{try{let e=localStorage.getItem("authToken"),a=await fetch("/api/user/dairy",{headers:{Authorization:`Bearer ${e}`}});if(a.ok){let e=await a.json();ec(e.data||[])}}catch(e){console.error("Error fetching dairies:",e)}},aO=async()=>{try{let e=localStorage.getItem("authToken"),a=await fetch("/api/user/bmc",{headers:{Authorization:`Bearer ${e}`}});if(a.ok){let e=await a.json();ef(e.data||[])}}catch(e){console.error("Error fetching BMCs:",e)}},a$=async()=>{try{let e=localStorage.getItem("authToken"),a=await fetch("/api/user/machine",{headers:{Authorization:`Bearer ${e}`}});if(a.ok){let e=await a.json();ed(e.data||[])}}catch(e){console.error("Error fetching machines:",e),ed([])}},aD=async e=>{if(!e)return void ed([]);try{ex(!0);let a=localStorage.getItem("authToken"),t=await fetch(`/api/user/machine/by-society?societyId=${e}`,{headers:{Authorization:`Bearer ${a}`}});if(t.ok){let e=await t.json();ed(e.data||[])}else ed([])}catch(e){console.error("Error fetching machines:",e),ed([])}finally{ex(!1)}},aB=async(e,a)=>{an(!0),ad(0);try{let t=es.find(a=>a.id===e);if(!t)return;ad(30);let r=localStorage.getItem("authToken"),s=await fetch("/api/user/farmer",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({id:t.id,farmerId:t.farmerId,rfId:t.rfId,farmerName:t.farmerName,contactNumber:t.contactNumber,smsEnabled:t.smsEnabled,emailNotificationsEnabled:t.emailNotificationsEnabled||"ON",bonus:t.bonus,address:t.address,bankName:t.bankName,bankAccountNumber:t.bankAccountNumber,ifscCode:t.ifscCode,societyId:t.societyId,machineId:t.machineId,status:a,notes:t.notes})});ad(70),s.ok?(en(t=>t.map(t=>t.id===e?{...t,status:a}:t)),ad(100),eT("Farmer status updated successfully"),eE("")):(eE("Failed to update farmer status"),eT(""))}catch(e){console.error("Error updating status:",e),eE("Error updating farmer status"),eT("")}finally{an(!1)}},az=e=>{let a=es.find(a=>a.id===e);a&&(e3({id:a.id,name:a.farmerName,farmerId:a.farmerId}),e8(!0))},a_=async()=>{if(e4)try{let e=localStorage.getItem("authToken");(await fetch(`/api/user/farmer?id=${e4.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${e}`}})).ok?(en(e=>e.filter(e=>e.id!==e4.id)),eT(X.farmerManagement.deletedSuccessfully||"Farmer deleted successfully"),eE("")):(eE(X.farmerManagement.deleteError||"Failed to delete farmer. Please try again."),eT(""))}catch(e){console.error("Error deleting farmer:",e),eE(X.farmerManagement.deleteError||"Error deleting farmer. Please try again."),eT("")}finally{e8(!1),e3(null)}},aP=e=>{eZ(a=>{let t=new Set(a);if(t.has(e)){t.delete(e),e1(!1);let a=aH.find(a=>a.id===e);if(a&&a.societyId){let r=a.societyId;aH.filter(e=>e.societyId===r).every(a=>a.id!==e&&t.has(a.id))||ag(e=>{let a=new Set(e);return a.delete(r),a})}}else{t.add(e);let a=aH.find(a=>a.id===e);if(a&&a.societyId){let r=a.societyId;aH.filter(e=>e.societyId===r).every(a=>a.id===e||t.has(a.id))&&ag(e=>{let a=new Set(e);return a.add(r),a})}Array.from(new Set(aH.map(e=>e.id))).every(a=>a===e||t.has(a))&&e1(!0)}return t})};(0,t.useEffect)(()=>{if(eX.size>0){let e=es.filter(e=>{let a="all"===ep||e.status===ep,t=0===eI.length||eI.includes(e.societyId?.toString()||""),r=0===ej.length||ej.includes(e.machineId?.toString()||""),s=""===eF||e.farmerName.toLowerCase().includes(eF.toLowerCase())||e.farmerId.toLowerCase().includes(eF.toLowerCase())||e.contactNumber?.toLowerCase().includes(eF.toLowerCase())||e.rfId?.toLowerCase().includes(eF.toLowerCase())||e.societyName?.toLowerCase().includes(eF.toLowerCase())||e.societyIdentifier?.toLowerCase().includes(eF.toLowerCase())||e.address?.toLowerCase().includes(eF.toLowerCase())||e.bankName?.toLowerCase().includes(eF.toLowerCase())||e.bankAccountNumber?.toLowerCase().includes(eF.toLowerCase())||e.ifscCode?.toLowerCase().includes(eF.toLowerCase())||e.notes?.toLowerCase().includes(eF.toLowerCase());return a&&t&&r&&s}),a=new Set(e.map(e=>e.id)),t=new Set(Array.from(eX).filter(e=>a.has(e)));if(t.size!==eX.size){eZ(t),e1(!1);let a=new Set(e.map(e=>e.societyId).filter(Boolean)),r=new Set;a.forEach(a=>{let s=e.filter(e=>e.societyId===a);s.every(e=>t.has(e.id))&&s.length>0&&r.add(a)}),ag(r)}}else e1(!1),ag(new Set)},[ep,eI,ej,eF,es,eX]);let aR=async()=>{if(0!==eX.size){e5(!1),aa(!0),ad(0);try{let e=localStorage.getItem("authToken");ad(10);let a=Array.from(eX);ad(20);let t=await fetch(`/api/user/farmer?ids=${encodeURIComponent(JSON.stringify(a))}`,{method:"DELETE",headers:{Authorization:`Bearer ${e}`}});if(ad(60),t.ok)ad(80),await aF(),ad(95),eZ(new Set),e1(!1),eT(`Successfully deleted ${a.length} farmer(s)${"all"!==ep||eN.length>0||ek.length>0||eI.length>0||ej.length>0?" from filtered results":""}`),eS([]),eE(""),ad(100);else{let e=await t.json();eE(e.message||"Failed to delete selected farmers"),eT("")}}catch(e){console.error("Error deleting farmers:",e),eE("Error deleting selected farmers"),eT("")}finally{aa(!1),ad(0)}}},aU=async e=>{if(0===eX.size)return;let a=e||ak;al(!0),ad(0);try{let e=localStorage.getItem("authToken");ad(5);let t=Array.from(eX),r=t.length;ad(10),console.log(`ðŸ”„ Bulk updating ${r} farmers to status: ${a}`),ad(30);let s=await fetch("/api/user/farmer",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({bulkStatusUpdate:!0,farmerIds:t,status:a})});if(ad(70),!s.ok){let e=await s.json();throw Error(e.error||"Failed to update farmer status")}let n=await s.json(),o=n.data?.updated||r;ad(90),await aF(),ad(100),eZ(new Set),ag(new Set),e1(!1),console.log(`âœ… Successfully updated ${o} farmers`),eT(`Successfully updated status to "${a}" for ${o} farmer(s)${"all"!==ep||eN.length>0||ek.length>0||eI.length>0?" from filtered results":""}`),eE("")}catch(e){console.error("Error updating farmer status:",e),ad(100),eE(e instanceof Error?e.message:"Error updating farmer status. Please try again."),eT("")}finally{al(!1)}},aq=async(e,a)=>{e7(!0);try{let t=(eX.size>0?aH.filter(e=>eX.has(e.id)):aH).map(e=>({farmerId:e.farmerId,rfId:e.rfId,farmerName:e.farmerName,contactNumber:e.contactNumber,email:e.contactNumber,societyId:e.societyId,address:e.address,notes:e.notes,status:e.status,smsEnabled:"ON"===e.smsEnabled,bonus:e.bonus,bankName:e.bankName,bankAccountNumber:e.bankAccountNumber,ifscCode:e.ifscCode})),r=eo.map(e=>({id:e.id,name:e.name,society_id:e.society_id})),s={status:"all"!==ep?ep:void 0,society:eI.length>0?eI[0]:void 0,selection:eX.size>0?`${eX.size}-selected`:void 0},n=eX.size>0?`${eX.size} selected farmer(s) downloaded successfully`:`${t.length} farmer(s) downloaded successfully`;"csv"===a?(((e,a,t={},r)=>{let s=ea(),n=r&&r.length>0?s.filter(e=>r.includes(e.key)):s,o=e.map(e=>({farmerId:e.farmerId||"",rfId:e.rfId||"",farmerName:e.farmerName||"",contactNumber:e.contactNumber||"",email:e.email||"",societyInfo:(e=>{if(!e)return{name:"",id:""};let t=a.find(a=>a.id.toString()===e.toString());return t?{name:t.name,id:t.society_id}:{name:"",id:""}})(e.societyId),status:e.status||"active",smsEnabled:e.smsEnabled,bonus:e.bonus||0,address:e.address||"",bankName:e.bankName||"",bankAccountNumber:e.bankAccountNumber||"",ifscCode:e.ifscCode||"",notes:e.notes||""})),l=er(t);((e,a,t)=>{if(0===e.length)return alert("No data to download");let r=a.map(e=>e.header),s=new Blob([[r,...e.map(e=>a.map(a=>{let t=e[a.key],r=String((a.formatter?a.formatter(t):t)||"");return r.includes(",")||r.includes('"')?`"${r.replace(/"/g,'""')}"`:r}))].map(e=>e.join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),n=window.URL.createObjectURL(s),o=document.createElement("a");o.href=n,o.download=`${t}.csv`,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(n)})(o,n,`farmers_export${l}_${new Date().toISOString().split("T")[0]}`)})(t,r,s,e),eT(`${n} as CSV`)):(await et(t,r,s,e),eT(`${n} as PDF`))}catch(e){console.error(`Error downloading ${a.toUpperCase()}:`,e),eE(`Failed to download ${a.toUpperCase()} file`)}finally{e7(!1)}},aV=async e=>{if(e.preventDefault(),!aj.farmerId||!aj.farmerId.trim()){eE("Please enter a farmer ID."),eT("");return}if(!aj.farmerName||!aj.farmerName.trim()){eE("Please enter the farmer name."),eT("");return}if(!aj.societyId){eE("Please select a society for the farmer."),eT("");return}if(!aj.machineId){eE("Please select a machine for the farmer."),eT("");return}eK(!0);try{let e=localStorage.getItem("authToken"),a=await fetch("/api/user/farmer",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({...aj,societyId:aj.societyId?parseInt(aj.societyId):null,bonus:Number(aj.bonus)})});if(a.ok)e$(!1),av({farmerId:"",rfId:"",farmerName:"",contactNumber:"",email:"",smsEnabled:"OFF",emailNotificationsEnabled:"ON",bonus:0,address:"",bankName:"",bankAccountNumber:"",ifscCode:"",societyId:"",machineId:"",status:"active",notes:""}),eT("Farmer created successfully"),eE(""),aF();else{let e=await a.json(),t=e.error||e.message||"Failed to create farmer";eH({}),t.toLowerCase().includes("farmer id")&&t.toLowerCase().includes("already exists")?eH({farmerId:"This Farmer ID already exists"}):t.toLowerCase().includes("farmer name")&&t.toLowerCase().includes("already exists")?eH({farmerName:"This Farmer name already exists"}):t.toLowerCase().includes("email")&&t.toLowerCase().includes("already exists")?eH({email:"This email address already exists"}):eE(t),eT("")}}catch(e){console.error("Error creating farmer:",e),eE("Error creating farmer. Please try again."),eT("")}finally{eK(!1)}},aW=async e=>{if(e.preventDefault(),eU){if(!aj.farmerId||!aj.farmerId.trim()){eE("Please enter a farmer ID."),eT("");return}if(!aj.farmerName||!aj.farmerName.trim()){eE("Please enter the farmer name."),eT("");return}if(!aj.societyId){eE("Please select a society for the farmer."),eT("");return}if(!aj.machineId){eE("Please select a machine for the farmer."),eT("");return}eK(!0);try{let e=localStorage.getItem("authToken"),a=await fetch("/api/user/farmer",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({id:eU.id,...aj,societyId:aj.societyId?parseInt(aj.societyId):null,bonus:Number(aj.bonus)})});if(a.ok)eB(!1),eq(null),av({farmerId:"",rfId:"",farmerName:"",contactNumber:"",email:"",smsEnabled:"OFF",emailNotificationsEnabled:"ON",bonus:0,address:"",bankName:"",bankAccountNumber:"",ifscCode:"",societyId:"",machineId:"",status:"active",notes:""}),eT("Farmer updated successfully"),eE(""),aF();else{let e=await a.json(),t=e.error||e.message||"Failed to update farmer";eH({}),t.toLowerCase().includes("farmer id")&&t.toLowerCase().includes("already exists")?eH({farmerId:"This Farmer ID already exists"}):t.toLowerCase().includes("farmer name")&&t.toLowerCase().includes("already exists")?eH({farmerName:"This Farmer name already exists"}):t.toLowerCase().includes("email")&&t.toLowerCase().includes("already exists")?eH({email:"This email address already exists"}):eE(t),eT("")}}catch(e){console.error("Error updating farmer:",e),eE("Error updating farmer. Please try again."),eT("")}finally{eK(!1)}}},aQ=async e=>{if(e.preventDefault(),eV){if(!eQ){eE("Please select a default society for bulk upload."),eT("");return}eK(!0);try{let e=(await eV.text()).split("\n").filter(e=>e.trim()),a=e[0].split(",").map(e=>e.trim().replace(/"/g,"")),t=e.slice(1).map(e=>{let t=e.split(",").map(e=>e.trim().replace(/"/g,"")),r={};return a.forEach((e,a)=>{let s=t[a]||"";switch(e.toLowerCase()){case"id":case"farmer_id":case"farmerid":r.farmerId=s;break;case"rf-id":case"rfid":case"rf_id":r.rfId=s;break;case"name":case"farmer_name":case"farmername":r.farmerName=s;break;case"mobile":case"phone":case"contact":case"contact_number":r.contactNumber=s;break;case"sms":case"sms_enabled":r.smsEnabled="ON"===s.toUpperCase()?"ON":"OFF";break;case"bonus":r.bonus=parseFloat(s)||0;break;case"address":r.address=s;break;case"bank_name":case"bankname":r.bankName=s;break;case"bank_account_number":case"account_number":case"accountnumber":r.bankAccountNumber=s;break;case"ifsc_code":case"ifsc":r.ifscCode=s;break;case"society_id":case"societyid":case"society":let n=parseInt(s);n&&!isNaN(n)&&(r.societyId=n);break;case"machine-id":case"machine_id":case"machineid":let o=parseInt(s);o&&!isNaN(o)&&(r.machineId=o)}}),r.societyId||(r.societyId=parseInt(eQ)),r}).filter(e=>e.farmerId&&e.farmerName),r=localStorage.getItem("authToken"),s=await fetch("/api/user/farmer",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({farmers:t})});if(s.ok)e_(!1),eW(null),eG(""),eT("Farmers uploaded successfully"),eE(""),aF();else{let e=await s.json();eE(e.error||"Failed to upload farmers"),eT("")}}catch(e){console.error("Error uploading farmers:",e),eE("Error uploading farmers. Please try again."),eT("")}finally{eK(!1)}}},aG=()=>{av({farmerId:"",rfId:"",farmerName:"",contactNumber:"",email:"",smsEnabled:"OFF",emailNotificationsEnabled:"ON",bonus:0,address:"",bankName:"",bankAccountNumber:"",ifscCode:"",societyId:"",machineId:"",status:"active",notes:""}),e$(!0),eE(""),eT(""),eH({})},aJ=e=>{eq(e);let a=e.societyId?.toString()||"";av({farmerId:e.farmerId,rfId:e.rfId||"",farmerName:e.farmerName,contactNumber:e.contactNumber||"",email:e.email||"",smsEnabled:e.smsEnabled,emailNotificationsEnabled:e.emailNotificationsEnabled||"ON",bonus:e.bonus,address:e.address||"",bankName:e.bankName||"",bankAccountNumber:e.bankAccountNumber||"",ifscCode:e.ifscCode||"",societyId:a,machineId:e.machineId?.toString()||"",status:e.status,notes:e.notes||""}),a&&aD(a),eB(!0),eE(""),eT(""),eH({})},aK=()=>{e$(!1),av({farmerId:"",rfId:"",farmerName:"",contactNumber:"",email:"",smsEnabled:"OFF",emailNotificationsEnabled:"ON",bonus:0,address:"",bankName:"",bankAccountNumber:"",ifscCode:"",societyId:"",machineId:"",status:"active",notes:""}),eE(""),eT("")},aY=()=>{eB(!1),eq(null),av({farmerId:"",rfId:"",farmerName:"",contactNumber:"",email:"",smsEnabled:"OFF",emailNotificationsEnabled:"ON",bonus:0,address:"",bankName:"",bankAccountNumber:"",ifscCode:"",societyId:"",machineId:"",status:"active",notes:""}),eE(""),eT("")};(0,t.useEffect)(()=>{aF(),aT(),aO(),aA(),a$(),aL()},[aF,aL]);let aH=es.filter(e=>{if(!(""===eF||e.farmerName.toLowerCase().includes(eF.toLowerCase())||e.farmerId.toLowerCase().includes(eF.toLowerCase())||e.contactNumber?.toLowerCase().includes(eF.toLowerCase())||e.rfId?.toLowerCase().includes(eF.toLowerCase())||e.societyName?.toLowerCase().includes(eF.toLowerCase())||e.societyIdentifier?.toLowerCase().includes(eF.toLowerCase())||e.address?.toLowerCase().includes(eF.toLowerCase())||e.bankName?.toLowerCase().includes(eF.toLowerCase())||e.bankAccountNumber?.toLowerCase().includes(eF.toLowerCase())||e.ifscCode?.toLowerCase().includes(eF.toLowerCase())||e.notes?.toLowerCase().includes(eF.toLowerCase()))||"all"!==ep&&e.status!==ep)return!1;let a=eo.find(a=>a.id===e.societyId),t=a?.bmc_id?eu.find(e=>e.id===a.bmc_id):null,r=t?.dairyFarmId?em.find(e=>e.id===t.dairyFarmId):null;if(eN.length>0&&(!r||!eN.includes(r.id.toString()))||ek.length>0&&(!t||!ek.includes(t.id.toString()))||eI.length>0&&(!e.societyId||!eI.includes(e.societyId.toString())))return!1;if(ej.length>0){let a=e.machineId?.toString();if(!a||!ej.includes(a))return!1}return!0}),aX=(0,t.useMemo)(()=>{let e=new Set(es.filter(e=>{if(!(""===eF||e.farmerName?.toLowerCase().includes(eF.toLowerCase())||e.farmerId?.toLowerCase().includes(eF.toLowerCase())||e.contactNumber?.toLowerCase().includes(eF.toLowerCase())||e.rfId?.toLowerCase().includes(eF.toLowerCase())||e.societyName?.toLowerCase().includes(eF.toLowerCase())||e.societyIdentifier?.toLowerCase().includes(eF.toLowerCase())||e.address?.toLowerCase().includes(eF.toLowerCase())||e.bankName?.toLowerCase().includes(eF.toLowerCase())||e.bankAccountNumber?.toLowerCase().includes(eF.toLowerCase())||e.ifscCode?.toLowerCase().includes(eF.toLowerCase())||e.notes?.toLowerCase().includes(eF.toLowerCase()))||"all"!==ep&&e.status!==ep)return!1;if(ej.length>0){let a=e.machineId?.toString();if(!a||!ej.includes(a))return!1}return!0}).map(e=>e.societyId).filter(Boolean));return eo.filter(a=>e.has(a.id))},[es,eo,eF,ep,ej]),aZ=(0,t.useMemo)(()=>{let e=new Set(es.filter(e=>!!(""===eF||e.farmerName?.toLowerCase().includes(eF.toLowerCase())||e.farmerId?.toLowerCase().includes(eF.toLowerCase())||e.contactNumber?.toLowerCase().includes(eF.toLowerCase())||e.rfId?.toLowerCase().includes(eF.toLowerCase())||e.societyName?.toLowerCase().includes(eF.toLowerCase())||e.societyIdentifier?.toLowerCase().includes(eF.toLowerCase())||e.address?.toLowerCase().includes(eF.toLowerCase())||e.bankName?.toLowerCase().includes(eF.toLowerCase())||e.bankAccountNumber?.toLowerCase().includes(eF.toLowerCase())||e.ifscCode?.toLowerCase().includes(eF.toLowerCase())||e.notes?.toLowerCase().includes(eF.toLowerCase()))&&("all"===ep||e.status===ep)&&(!(eI.length>0)||!!eI.includes(e.societyId?.toString()||""))).map(e=>e.machineId).filter(Boolean));return ei.filter(a=>e.has(a.id))},[es,ei,eF,ep,eI]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(V.LoadingSnackbar,{isVisible:eJ||as||ao||ae,message:eJ?eU?X.farmerManagement.updatingFarmer:X.farmerManagement.addingFarmer:ae?X.farmerManagement.deletingFarmers:ao?X.farmerManagement.updatingFarmers:X.farmerManagement.updatingStatus,submessage:X.farmerManagement.pleaseWait,progress:ao||ae?ai:void 0,showProgress:ao||ae}),(0,a.jsxs)("div",{className:"p-3 xs:p-4 sm:p-6 lg:p-8 space-y-3 xs:space-y-4 sm:space-y-6 lg:pb-8",children:[(0,a.jsx)(J.ManagementPageHeader,{title:X.farmerManagement.title,subtitle:X.farmerManagement.subtitle,icon:(0,a.jsx)(n.Users,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"}),onRefresh:aF,hasData:aH.length>0}),(0,a.jsx)(B.StatusMessage,{success:eA,error:eM}),(aI.topCollector||aI.bestFat||aI.topRevenue)&&(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-3 sm:gap-4",children:[aI.topCollector&&(0,a.jsxs)("div",{onClick:()=>aE("quantity"),className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 p-4 rounded-lg border border-green-200 dark:border-green-700 hover:shadow-lg transition-shadow cursor-pointer",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-green-900 dark:text-green-100",children:"Top Collector (30d)"}),(0,a.jsx)(x.Droplets,{className:"w-5 h-5 text-green-600 dark:text-green-400"})]}),(0,a.jsx)("p",{className:"text-lg font-bold text-green-800 dark:text-green-200 truncate",children:aI.topCollector.farmer.farmerName}),(0,a.jsxs)("p",{className:"text-xs text-green-700 dark:text-green-300 truncate",children:["ID: ",aI.topCollector.farmer.farmerId]}),aI.topCollector.farmer.societyName&&(0,a.jsx)("p",{className:"text-xs text-green-600 dark:text-green-400 truncate",children:aI.topCollector.farmer.societyName}),(0,a.jsxs)("p",{className:"text-sm font-semibold text-green-600 dark:text-green-400 mt-1",children:[aI.topCollector.totalQuantity.toFixed(2)," L"]})]}),aI.topRevenue&&(0,a.jsxs)("div",{onClick:()=>aE("revenue"),className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 p-4 rounded-lg border border-blue-200 dark:border-blue-700 hover:shadow-lg transition-shadow cursor-pointer",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100",children:"Top Earner (30d)"}),(0,a.jsx)(p.TrendingUp,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})]}),(0,a.jsx)("p",{className:"text-lg font-bold text-blue-800 dark:text-blue-200 truncate",children:aI.topRevenue.farmer.farmerName}),(0,a.jsxs)("p",{className:"text-xs text-blue-700 dark:text-blue-300 truncate",children:["ID: ",aI.topRevenue.farmer.farmerId]}),aI.topRevenue.farmer.societyName&&(0,a.jsx)("p",{className:"text-xs text-blue-600 dark:text-blue-400 truncate",children:aI.topRevenue.farmer.societyName}),(0,a.jsxs)("p",{className:"text-sm font-semibold text-blue-600 dark:text-blue-400 mt-1",children:["â‚¹",aI.topRevenue.totalAmount.toFixed(2)]})]}),aI.bestFat&&(0,a.jsxs)("div",{onClick:()=>aE("fat"),className:"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-800/20 p-4 rounded-lg border border-purple-200 dark:border-purple-700 hover:shadow-lg transition-shadow cursor-pointer",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-purple-900 dark:text-purple-100",children:"Best Fat (30d)"}),(0,a.jsx)(y.Award,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})]}),(0,a.jsx)("p",{className:"text-lg font-bold text-purple-800 dark:text-purple-200 truncate",children:aI.bestFat.farmer.farmerName}),(0,a.jsxs)("p",{className:"text-xs text-purple-700 dark:text-purple-300 truncate",children:["ID: ",aI.bestFat.farmer.farmerId]}),aI.bestFat.farmer.societyName&&(0,a.jsx)("p",{className:"text-xs text-purple-600 dark:text-purple-400 truncate",children:aI.bestFat.farmer.societyName}),(0,a.jsxs)("p",{className:"text-sm font-semibold text-purple-600 dark:text-purple-400 mt-1",children:[aI.bestFat.avgFat.toFixed(2),"% Fat"]})]}),aI.bestSnf&&(0,a.jsxs)("div",{onClick:()=>aE("snf"),className:"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-800/20 p-4 rounded-lg border border-orange-200 dark:border-orange-700 hover:shadow-lg transition-shadow cursor-pointer",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-orange-900 dark:text-orange-100",children:"Best SNF (30d)"}),(0,a.jsx)(N.BarChart3,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"})]}),(0,a.jsx)("p",{className:"text-lg font-bold text-orange-800 dark:text-orange-200 truncate",children:aI.bestSnf.farmer.farmerName}),(0,a.jsxs)("p",{className:"text-xs text-orange-700 dark:text-orange-300 truncate",children:["ID: ",aI.bestSnf.farmer.farmerId]}),aI.bestSnf.farmer.societyName&&(0,a.jsx)("p",{className:"text-xs text-orange-600 dark:text-orange-400 truncate",children:aI.bestSnf.farmer.societyName}),(0,a.jsxs)("p",{className:"text-sm font-semibold text-orange-600 dark:text-orange-400 mt-1",children:[aI.bestSnf.avgSnf.toFixed(2),"% SNF"]})]}),aI.mostActive&&(0,a.jsxs)("div",{onClick:()=>aE("collections"),className:"bg-gradient-to-br from-pink-50 to-pink-100 dark:from-pink-900/20 dark:to-pink-800/20 p-4 rounded-lg border border-pink-200 dark:border-pink-700 hover:shadow-lg transition-shadow cursor-pointer",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-pink-900 dark:text-pink-100",children:"Most Active (30d)"}),(0,a.jsx)(n.Users,{className:"w-5 h-5 text-pink-600 dark:text-pink-400"})]}),(0,a.jsx)("p",{className:"text-lg font-bold text-pink-800 dark:text-pink-200 truncate",children:aI.mostActive.farmer.farmerName}),(0,a.jsxs)("p",{className:"text-xs text-pink-700 dark:text-pink-300 truncate",children:["ID: ",aI.mostActive.farmer.farmerId]}),aI.mostActive.farmer.societyName&&(0,a.jsx)("p",{className:"text-xs text-pink-600 dark:text-pink-400 truncate",children:aI.mostActive.farmer.societyName}),(0,a.jsxs)("p",{className:"text-sm font-semibold text-pink-600 dark:text-pink-400 mt-1",children:[aI.mostActive.totalCollections," Collections"]})]}),aI.bestQuality&&(0,a.jsxs)("div",{onClick:()=>aE("rate"),className:"bg-gradient-to-br from-indigo-50 to-indigo-100 dark:from-indigo-900/20 dark:to-indigo-800/20 p-4 rounded-lg border border-indigo-200 dark:border-indigo-700 hover:shadow-lg transition-shadow cursor-pointer",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-indigo-900 dark:text-indigo-100",children:"Best Rate (30d)"}),(0,a.jsx)(y.Award,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"})]}),(0,a.jsx)("p",{className:"text-lg font-bold text-indigo-800 dark:text-indigo-200 truncate",children:aI.bestQuality.farmer.farmerName}),(0,a.jsxs)("p",{className:"text-xs text-indigo-700 dark:text-indigo-300 truncate",children:["ID: ",aI.bestQuality.farmer.farmerId]}),aI.bestQuality.farmer.societyName&&(0,a.jsx)("p",{className:"text-xs text-indigo-600 dark:text-indigo-400 truncate",children:aI.bestQuality.farmer.societyName}),(0,a.jsxs)("p",{className:"text-sm font-semibold text-indigo-600 dark:text-indigo-400 mt-1",children:["â‚¹",aI.bestQuality.avgRate.toFixed(2),"/L"]})]})]}),(0,a.jsx)(G.StatsGrid,{allItems:es,filteredItems:aH,hasFilters:"all"!==ep||eN.length>0||ek.length>0||eI.length>0||ej.length>0,onStatusFilterChange:e=>ey(e),currentStatusFilter:ep}),(0,a.jsx)(Q.FilterDropdown,{statusFilter:ep,onStatusChange:e=>ey(e),dairyFilter:eN,onDairyChange:e=>ew(Array.isArray(e)?e:[e]),bmcFilter:ek,onBmcChange:e=>eC(Array.isArray(e)?e:[e]),societyFilter:eI,onSocietyChange:e=>eS(Array.isArray(e)?e:[e]),machineFilter:ej,onMachineChange:e=>ev(Array.isArray(e)?e:[e]),dairies:em,bmcs:eu,societies:aX,machines:aZ,filteredCount:aH.length,totalCount:es.length,searchQuery:eF,onSearchChange:eL,icon:(0,a.jsx)(n.Users,{className:"w-5 h-5"}),hideMainFilterButton:!0}),aH.length>0&&(0,a.jsxs)("div",{className:"flex flex-col xs:flex-row items-start xs:items-center justify-between gap-3 bg-white dark:bg-gray-800 p-3 sm:p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:[(0,a.jsxs)("label",{className:"flex items-center space-x-3 cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:e0,onChange:()=>{e0?(eZ(new Set),ag(new Set),e1(!1)):(eZ(new Set(aH.map(e=>e.id))),ag(new Set(aH.reduce((e,a)=>{let t=a.societyId||0;return e.includes(t)||e.push(t),e},[]))),e1(!0))},className:"w-4 h-4 text-green-600 bg-gray-100 border-gray-300 rounded focus:ring-green-500 dark:focus:ring-green-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[X.farmerManagement.selectAll," ",aH.length," ",1===aH.length?X.roles.farmer:X.farmerManagement.farmers,("all"!==ep||eN.length>0||ek.length>0||eI.length>0||ej.length>0)&&` (${X.common.filter.toLowerCase()})`]})]}),(0,a.jsx)("div",{className:"flex items-center gap-3",children:(0,a.jsx)(W.ViewModeToggle,{viewMode:au,onViewModeChange:af,folderLabel:"Folder View",listLabel:"Grid View"})})]}),eh?(0,a.jsx)("div",{className:"flex items-center justify-center py-12 sm:py-20",children:(0,a.jsx)(E.FlowerSpinner,{size:40})}):aH.length>0?"folder"===au?(0,a.jsx)("div",{className:"space-y-4",children:Object.values(aH.reduce((e,a)=>{let t=a.societyId||0,r=a.societyName||"Unassigned",s=a.societyIdentifier||"N/A";return e[t]||(e[t]={id:t,name:r,identifier:s,farmers:[]}),e[t].farmers.push(a),e},{})).sort((e,a)=>e.name.localeCompare(a.name)).map(e=>{let t=am.has(e.id),r=ah.has(e.id),s=e.farmers.length,d=e.farmers.filter(e=>"active"===e.status).length,g=e.farmers.filter(e=>"inactive"===e.status).length,b=e.farmers.map(e=>e.id);return(0,a.jsxs)("div",{className:`relative bg-white dark:bg-gray-800 rounded-lg border-2 transition-colors hover:z-10 ${r?"border-blue-500 dark:border-blue-400":"border-gray-200 dark:border-gray-700"}`,children:[(0,a.jsxs)("div",{className:"flex items-center p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[(0,a.jsx)("div",{onClick:a=>{var t;a.stopPropagation(),t=e.id,ag(e=>{let a=new Set(e);return a.has(t)?(a.delete(t),eZ(e=>{let a=new Set(e);return b.forEach(e=>a.delete(e)),e1(!1),a})):(a.add(t),eZ(e=>{let a=new Set(e);return b.forEach(e=>a.add(e)),Array.from(new Set(aH.map(e=>e.id))).every(e=>a.has(e))&&e1(!0),a})),a})},className:"flex items-center mr-3 cursor-pointer",children:(0,a.jsx)("input",{type:"checkbox",checked:r,onChange:()=>{},className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600 cursor-pointer"})}),(0,a.jsxs)("button",{onClick:()=>{var a;return a=e.id,void ac(e=>{let t=new Set(e);return t.has(a)?t.delete(a):t.add(a),t})},className:"flex-1 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[t?(0,a.jsx)(f.ChevronDown,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"}):(0,a.jsx)(h.ChevronRight,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"}),t?(0,a.jsx)(u.FolderOpen,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}):(0,a.jsx)(c.Folder,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-white",children:e.name}),(0,a.jsxs)("p",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400",children:["ID: ",e.identifier]})]})]}),(0,a.jsx)("div",{className:"flex items-center space-x-4",children:(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-xs sm:text-sm text-gray-600 dark:text-gray-400",children:[(0,a.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-500"}),(0,a.jsx)("span",{children:d})]}),(0,a.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full bg-red-500"}),(0,a.jsx)("span",{children:g})]})]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[s," ",1===s?"farmer":"farmers"]})]})})})]})]}),t&&(0,a.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700 p-4 bg-gray-50 dark:bg-gray-900/30",children:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.farmers.map(e=>(0,a.jsx)("div",{className:"relative hover:z-20",children:(0,a.jsx)(z.ItemCard,{id:e.id,name:e.farmerName,identifier:`ID: ${e.farmerId}`,status:e.status,icon:(0,a.jsx)(n.Users,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-600 dark:text-blue-400"}),details:[...e.contactNumber?[{icon:(0,a.jsx)(l.Phone,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),text:e.contactNumber}]:[],...e.email?[{icon:(0,a.jsx)(i.Mail,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),text:e.email}]:[],...e.machineName||e.machineType?[{icon:(0,a.jsx)(m.Settings,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),text:e.machineType&&e.machineName?`${e.machineType} (${e.machineName})`:e.machineName||e.machineType||"Machine Not Assigned",highlight:!e.machineName&&void 0}]:[{icon:(0,a.jsx)(m.Settings,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-gray-400"}),text:"No Machine Assigned",className:"text-gray-500 dark:text-gray-400"}],{icon:(0,a.jsx)(o.UserCheck,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),text:`Bonus: ${e.bonus}`}],onStatusChange:a=>aB(e.id,a),onView:()=>Z.push(`/admin/farmer/${e.id}`),onEdit:()=>aJ(e),onDelete:()=>az(e.id),viewText:"View Details",selectable:!0,selected:eX.has(e.id),onSelect:()=>aP(e.id),searchQuery:eF})},e.id))})})]},e.id)})}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:aH.map(e=>(0,a.jsx)(z.ItemCard,{id:e.id,name:e.farmerName,identifier:`ID: ${e.farmerId}`,status:e.status,icon:(0,a.jsx)(n.Users,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-600 dark:text-blue-400"}),details:[...e.contactNumber?[{icon:(0,a.jsx)(l.Phone,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),text:e.contactNumber}]:[],...e.email?[{icon:(0,a.jsx)(i.Mail,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),text:e.email}]:[],...e.societyName?[{icon:(0,a.jsx)(d.Building2,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),text:e.societyIdentifier?`${e.societyName} (${e.societyIdentifier})`:e.societyName,highlight:!0}]:[],...e.machineName||e.machineType?[{icon:(0,a.jsx)(m.Settings,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),text:e.machineType&&e.machineName?`${e.machineType} (${e.machineName})`:e.machineName||e.machineType||"Machine Not Assigned",highlight:!e.machineName&&void 0}]:[{icon:(0,a.jsx)(m.Settings,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-gray-400"}),text:"No Machine Assigned",className:"text-gray-500 dark:text-gray-400"}],{icon:(0,a.jsx)(o.UserCheck,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),text:`Bonus: ${e.bonus}`}],onStatusChange:a=>aB(e.id,a),onView:()=>Z.push(`/admin/farmer/${e.id}`),onEdit:()=>aJ(e),onDelete:()=>az(e.id),viewText:"View Details",selectable:!0,selected:eX.has(e.id),onSelect:()=>aP(e.id),searchQuery:eF},e.id))}):(0,a.jsx)(_.EmptyState,{icon:(0,a.jsx)(n.Users,{className:"w-12 h-12 sm:w-16 sm:h-16 text-gray-400"}),title:0===es.length?X.farmerManagement.noFarmersFound:X.farmerManagement.noMatchingFarmers,message:0===es.length?X.farmerManagement.getStartedMessage:eF?`${X.farmerManagement.noMatchingFarmers}. ${X.farmerManagement.tryChangingFilters}`:X.farmerManagement.tryChangingFilters,actionText:0===es.length?X.farmerManagement.addFarmer:void 0,onAction:0===es.length?aG:void 0,showAction:0===es.length})]}),(0,a.jsx)(A.FormModal,{isOpen:eO,onClose:aK,title:X.farmerManagement.addFarmer,children:(0,a.jsxs)("form",{onSubmit:aV,className:"space-y-4 sm:space-y-6",children:[(0,a.jsxs)(D.FormGrid,{children:[(0,a.jsx)(T.FormInput,{label:X.farmerManagement.farmerId,type:"text",value:aj.farmerId,onChange:e=>{let a=e.replace(/[^0-9]/g,"");av({...aj,farmerId:a})},placeholder:X.farmerManagement.enterFarmerId,required:!0,error:eY.farmerId}),(0,a.jsx)(T.FormInput,{label:X.farmerManagement.farmerName,type:"text",value:aj.farmerName,onChange:e=>av({...aj,farmerName:e}),placeholder:X.farmerManagement.enterFarmerName,required:!0,error:eY.farmerName}),(0,a.jsx)(O.FormSelect,{label:X.farmerManagement.society,value:aj.societyId,onChange:e=>{av({...aj,societyId:e,machineId:""}),aD(e)},options:eo.map(e=>({value:e.id.toString(),label:`${e.name} (${e.society_id})`})),placeholder:X.farmerManagement.selectSociety,required:!0,colSpan:1}),(0,a.jsx)(O.FormSelect,{label:X.farmerManagement.machine,value:aj.machineId,onChange:e=>av({...aj,machineId:e}),options:ei.map(e=>({value:e.id.toString(),label:`${e.machineId} - ${e.machineType}`})),placeholder:eb?X.common.loading:ei.length>0?X.farmerManagement.selectMachine:X.farmerManagement.unassigned,disabled:eb,required:!0,colSpan:1,className:"sm:max-w-[320px]"}),aj.societyId&&!eb&&0===ei.length&&(0,a.jsx)("div",{className:"col-span-2 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:["No machines found for this society. You can ",(0,a.jsx)("strong",{children:"add machines first"})," from the Machine Management section, or proceed without assigning a machine."]})}),(0,a.jsx)(T.FormInput,{label:X.farmerManagement.contactNumber,type:"tel",value:aj.contactNumber,onChange:e=>{let a=(0,L.formatPhoneInput)(e);av({...aj,contactNumber:a})},onBlur:()=>{let e=(0,L.validatePhoneOnBlur)(aj.contactNumber);if(e)eH(a=>({...a,contactNumber:e}));else{let{contactNumber:e,...a}=eY;eH(a)}},placeholder:X.farmerManagement.enterContactNumber,error:eY.contactNumber}),(0,a.jsx)(T.FormInput,{label:"Email",type:"email",value:aj.email,onChange:e=>av({...aj,email:e}),onBlur:()=>{let e=(0,M.validateEmailOnBlur)(aj.email);if(e)eH(a=>({...a,email:e}));else{let{email:e,...a}=eY;eH(a)}},placeholder:"Enter Email Address",error:eY.email}),(0,a.jsx)(O.FormSelect,{label:X.farmerManagement.smsEnabled,value:aj.smsEnabled,onChange:e=>av({...aj,smsEnabled:e}),options:[{value:"OFF",label:"OFF"},{value:"ON",label:"ON"}],placeholder:X.farmerManagement.selectStatus}),(0,a.jsx)(O.FormSelect,{label:"Email Notifications",value:aj.emailNotificationsEnabled,onChange:e=>av({...aj,emailNotificationsEnabled:e}),options:[{value:"OFF",label:"OFF"},{value:"ON",label:"ON"}],placeholder:"Select Option"}),(0,a.jsx)(T.FormInput,{label:X.farmerManagement.rfId,type:"text",value:aj.rfId,onChange:e=>av({...aj,rfId:e}),placeholder:X.farmerManagement.enterRfId}),(0,a.jsx)(T.FormInput,{label:X.farmerManagement.bonus,type:"number",value:aj.bonus,onChange:e=>av({...aj,bonus:Number(e)}),placeholder:X.farmerManagement.enterBonus}),(0,a.jsx)(O.FormSelect,{label:X.farmerManagement.status,value:aj.status,onChange:e=>av({...aj,status:e}),options:[{value:"active",label:X.farmerManagement.active},{value:"inactive",label:X.farmerManagement.inactive},{value:"suspended",label:X.farmerManagement.suspended},{value:"maintenance",label:X.farmerManagement.maintenance}],placeholder:X.farmerManagement.selectStatus}),(0,a.jsx)(T.FormInput,{label:X.farmerManagement.bankName,type:"text",value:aj.bankName,onChange:e=>av({...aj,bankName:e}),placeholder:X.farmerManagement.enterBankName}),(0,a.jsx)(T.FormInput,{label:X.farmerManagement.bankAccountNumber,type:"number",value:aj.bankAccountNumber,onChange:e=>{let a=e.replace(/\D/g,"");av({...aj,bankAccountNumber:a})},placeholder:X.farmerManagement.enterAccountNumber,pattern:"[0-9]*",inputMode:"numeric"}),(0,a.jsx)(T.FormInput,{label:X.farmerManagement.ifscCode,type:"text",value:aj.ifscCode,onChange:e=>av({...aj,ifscCode:e}),placeholder:X.farmerManagement.enterIfscCode}),(0,a.jsx)(T.FormInput,{label:X.farmerManagement.address,type:"text",value:aj.address,onChange:e=>av({...aj,address:e}),placeholder:X.farmerManagement.enterAddress}),(0,a.jsx)(T.FormInput,{label:X.farmerManagement.notes,type:"text",value:aj.notes,onChange:e=>av({...aj,notes:e}),placeholder:X.farmerManagement.enterNotes})]}),(0,a.jsx)($.FormActions,{onCancel:aK,submitText:X.farmerManagement.createFarmer,isLoading:eJ,isSubmitDisabled:!aj.societyId||!aj.machineId||!aj.farmerId||!aj.farmerName||Object.values(eY).some(e=>""!==e),submitType:"submit"})]})}),(0,a.jsx)(A.FormModal,{isOpen:eD&&!!eU,onClose:aY,title:X.farmerManagement.editFarmer,children:(0,a.jsxs)("form",{onSubmit:aW,className:"space-y-4 sm:space-y-6",children:[(0,a.jsxs)(D.FormGrid,{children:[(0,a.jsx)(T.FormInput,{label:X.farmerManagement.farmerId,type:"text",value:aj.farmerId,onChange:e=>av({...aj,farmerId:e}),placeholder:X.farmerManagement.enterUniqueFarmerId,required:!0,readOnly:!0,colSpan:1,error:eY.farmerId}),(0,a.jsx)(T.FormInput,{label:X.farmerManagement.farmerName,type:"text",value:aj.farmerName,onChange:e=>av({...aj,farmerName:e}),placeholder:X.farmerManagement.enterFarmerFullName,required:!0,colSpan:1,error:eY.farmerName}),(0,a.jsx)(O.FormSelect,{label:X.farmerManagement.society,value:aj.societyId,onChange:e=>{av({...aj,societyId:e,machineId:""}),aD(e.toString())},options:eo.map(e=>({value:e.id,label:`${e.name} (${e.society_id})`})),placeholder:X.farmerManagement.selectSociety,required:!0,colSpan:1}),(0,a.jsx)(O.FormSelect,{label:X.farmerManagement.machine,value:aj.machineId,onChange:e=>av({...aj,machineId:e}),options:ei.map(e=>({value:e.id.toString(),label:`${e.machineId} - ${e.machineType}`})),placeholder:eb?X.common.loading:ei.length>0?X.farmerManagement.selectMachine:X.farmerManagement.noMachinesAvailable,disabled:eb,required:!0,colSpan:1,className:"sm:max-w-[320px]"}),(0,a.jsx)(T.FormInput,{label:X.farmerManagement.rfId,type:"text",value:aj.rfId,onChange:e=>av({...aj,rfId:e}),placeholder:X.farmerManagement.enterRfIdOptional,colSpan:1}),(0,a.jsx)(T.FormInput,{label:X.farmerManagement.contactNumber,type:"tel",value:aj.contactNumber,onChange:e=>{let a=(0,L.formatPhoneInput)(e);av({...aj,contactNumber:a}),eY.contactNumber&&eH({...eY,contactNumber:""})},onBlur:()=>{let e=(0,L.validatePhoneOnBlur)(aj.contactNumber);e&&eH({...eY,contactNumber:e})},error:eY.contactNumber,placeholder:X.farmerManagement.enterMobileNumber,colSpan:1}),(0,a.jsx)(T.FormInput,{label:"Email",type:"email",value:aj.email,onChange:e=>{av({...aj,email:e}),eY.email&&eH({...eY,email:""})},onBlur:()=>{let e=(0,M.validateEmailOnBlur)(aj.email);e&&eH({...eY,email:e})},error:eY.email,placeholder:"Enter email address",colSpan:1}),(0,a.jsx)(O.FormSelect,{label:X.farmerManagement.smsEnabled,value:aj.smsEnabled,onChange:e=>av({...aj,smsEnabled:e}),options:[{value:"OFF",label:"OFF"},{value:"ON",label:"ON"}],colSpan:1}),(0,a.jsx)(O.FormSelect,{label:"Email Notifications",value:aj.emailNotificationsEnabled,onChange:e=>av({...aj,emailNotificationsEnabled:e}),options:[{value:"OFF",label:"OFF"},{value:"ON",label:"ON"}],colSpan:1}),(0,a.jsx)(T.FormInput,{label:X.farmerManagement.bonus,type:"number",value:aj.bonus,onChange:e=>av({...aj,bonus:parseFloat(e)||0}),placeholder:X.farmerManagement.enterBonus,colSpan:1}),(0,a.jsx)(T.FormInput,{label:X.farmerManagement.address,type:"text",value:aj.address,onChange:e=>av({...aj,address:e}),placeholder:X.farmerManagement.enterFarmerAddress,colSpan:2}),(0,a.jsx)(T.FormInput,{label:X.farmerManagement.bankName,type:"text",value:aj.bankName,onChange:e=>av({...aj,bankName:e}),placeholder:X.farmerManagement.enterBankName,colSpan:1}),(0,a.jsx)(T.FormInput,{label:X.farmerManagement.bankAccountNumber,type:"number",value:aj.bankAccountNumber,onChange:e=>{let a=e.replace(/\D/g,"");av({...aj,bankAccountNumber:a})},placeholder:X.farmerManagement.enterAccountNumber,pattern:"[0-9]*",inputMode:"numeric",colSpan:1}),(0,a.jsx)(T.FormInput,{label:X.farmerManagement.ifscCode,type:"text",value:aj.ifscCode,onChange:e=>av({...aj,ifscCode:e.toUpperCase()}),placeholder:X.farmerManagement.enterIfscCode,colSpan:1}),(0,a.jsx)(O.FormSelect,{label:X.farmerManagement.status,value:aj.status,onChange:e=>av({...aj,status:e}),options:[{value:"active",label:X.farmerManagement.active},{value:"inactive",label:X.farmerManagement.inactive},{value:"suspended",label:X.farmerManagement.suspended},{value:"maintenance",label:X.farmerManagement.maintenance}],colSpan:1}),(0,a.jsx)(T.FormInput,{label:X.farmerManagement.notes,type:"text",value:aj.notes,onChange:e=>av({...aj,notes:e}),placeholder:X.farmerManagement.enterNotes,colSpan:2})]}),(0,a.jsx)($.FormActions,{onCancel:aY,submitText:X.farmerManagement.updateFarmer,isLoading:eJ,isSubmitDisabled:!aj.societyId||!aj.machineId||!aj.farmerId||!aj.farmerName||Object.values(eY).some(e=>""!==e),submitType:"submit"})]})}),(0,a.jsx)(A.FormModal,{isOpen:ez,onClose:()=>{e_(!1),eG(""),eW(null)},title:"Bulk Upload Farmers",children:(0,a.jsxs)("form",{onSubmit:aQ,className:"space-y-4",children:[(0,a.jsx)(O.FormSelect,{label:"Default Society",value:eQ,onChange:e=>eG(e),options:[...eo.map(e=>({value:e.id.toString(),label:`${e.name} (${e.society_id})`}))],placeholder:"Select Society",required:!0}),(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:(0,a.jsx)("p",{children:"This society will be assigned to all farmers that don't have a society_id in the CSV"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"CSV File"}),(0,a.jsx)("input",{type:"file",accept:".csv",onChange:e=>eW(e.target.files?.[0]||null),className:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,a.jsx)("p",{className:"font-medium mb-2",children:"CSV Format Requirements:"}),(0,a.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,a.jsx)("li",{children:"Headers: ID, RF-ID, NAME, MOBILE, SMS, BONUS (minimum)"}),(0,a.jsx)("li",{children:"Optional: ADDRESS, BANK_NAME, ACCOUNT_NUMBER, IFSC_CODE, SOCIETY_ID, MACHINE-ID"}),(0,a.jsx)("li",{children:"SMS values: ON or OFF"}),(0,a.jsx)("li",{children:"MACHINE-ID should be a valid machine ID (optional)"}),(0,a.jsx)("li",{children:"All farmers must have a society - either from CSV SOCIETY_ID or the default above"}),(0,a.jsx)("li",{children:"File should be UTF-8 encoded"})]})]}),(0,a.jsx)($.FormActions,{onCancel:()=>e_(!1),submitText:"Upload Farmers",isLoading:eJ,isSubmitDisabled:!eV||!eQ,submitType:"submit"})]})}),(0,a.jsx)(R.BulkDeleteConfirmModal,{isOpen:e2,onClose:()=>e5(!1),onConfirm:aR,itemCount:eX.size,itemType:"farmer",hasFilters:"all"!==ep||eN.length>0||ek.length>0||eI.length>0}),(0,a.jsx)(Y.default,{isOpen:eP,onClose:()=>eR(!1),societies:eo,onUploadComplete:()=>{aF(),eT("CSV upload completed successfully!")}}),(0,a.jsx)(P.default,{isOpen:at,onClose:()=>ar(!1),onDownload:aq,availableColumns:ea().map(e=>({key:e.key,label:e.header,required:["farmerId"].includes(e.key)})),defaultColumns:["farmerId","rfId","farmerName","contactNumber","smsEnabled","bonus"],title:"Select Columns for Farmer Download",isDownloading:e9}),(0,a.jsx)(q.BulkActionsToolbar,{selectedCount:eX.size,totalCount:es.length,onBulkDelete:()=>e5(!0),onBulkDownload:()=>{0===eX.size?eE("No farmers selected"):ar(!0)},onBulkStatusUpdate:aU,onClearSelection:()=>{eZ(new Set),ag(new Set),e1(!1)},itemType:"farmer",showStatusUpdate:!0,currentBulkStatus:ak,onBulkStatusChange:e=>aC(e)}),(0,a.jsx)(U.ConfirmDeleteModal,{isOpen:e6,onClose:()=>{e8(!1),e3(null)},onConfirm:a_,itemName:e4?.farmerId||"",title:"Delete Farmer",message:"Are you sure you want to permanently delete farmer",confirmText:X.common.delete,cancelText:X.common.cancel}),(0,a.jsx)(K.FloatingActionButton,{actions:[{icon:(0,a.jsx)(g.Plus,{className:"w-6 h-6 text-white"}),label:X.farmerManagement.addFarmer,onClick:aG,color:"bg-gradient-to-br from-emerald-500 to-emerald-600"},{icon:(0,a.jsx)(b.Upload,{className:"w-6 h-6 text-white"}),label:X.farmerManagement.uploadCSV,onClick:()=>eR(!0),color:"bg-gradient-to-br from-blue-500 to-blue-600"}]}),ab&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(N.BarChart3,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"}),(0,a.jsxs)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:["quantity"===ap&&"Top Collectors - Last 30 Days","revenue"===ap&&"Top Earners - Last 30 Days","fat"===ap&&"Best Fat Percentage - Last 30 Days","snf"===ap&&"Best SNF Percentage - Last 30 Days","collections"===ap&&"Most Active Farmers - Last 30 Days","rate"===ap&&"Best Rates - Last 30 Days"]})]}),(0,a.jsx)("button",{onClick:()=>ax(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:(0,a.jsx)(w.X,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(e=()=>{switch(ap){case"quantity":return"#10b981";case"revenue":return"#3b82f6";case"fat":return"#8b5cf6";case"snf":return"#f59e0b";case"collections":return"#ec4899";case"rate":return"#6366f1";default:return"#6b7280"}},H=()=>{switch(ap){case"quantity":return"Quantity (L)";case"revenue":return"Revenue (â‚¹)";case"fat":return"Fat %";case"snf":return"SNF %";case"collections":return"Collections";case"rate":return"Rate (â‚¹/L)";default:return"Value"}},aN.length>0?(0,a.jsx)("div",{className:"w-full h-[500px]",children:(0,a.jsx)(F.ResponsiveContainer,{width:"100%",height:"100%",children:(0,a.jsxs)(k.LineChart,{data:aN,margin:{top:5,right:30,left:20,bottom:80},children:[(0,a.jsx)(j.CartesianGrid,{strokeDasharray:"3 3",stroke:"#e5e7eb",className:"dark:stroke-gray-700"}),(0,a.jsx)(I.XAxis,{dataKey:"name",angle:-45,textAnchor:"end",height:100,interval:0,tick:{fontSize:11},stroke:"#6b7280",label:{value:"Farmer Name",position:"insideBottom",offset:-5,style:{fontSize:13,fontWeight:500,fill:"#9ca3af"}}}),(0,a.jsx)(S.YAxis,{label:{value:H(),angle:-90,position:"insideLeft",style:{fontSize:14,fontWeight:600}},tick:{fontSize:12},stroke:"#6b7280"}),(0,a.jsx)(v.Tooltip,{content:(0,a.jsx)(({active:t,payload:r})=>{if(t&&r&&r.length){let t=r[0].payload;return(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("p",{className:"font-bold text-gray-900 dark:text-white mb-1",children:t.name}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:["ID: ",t.farmerId]}),t.societyName&&(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:t.societyName}),(0,a.jsxs)("p",{className:"font-semibold",style:{color:e()},children:["revenue"===ap&&"â‚¹",t.value.toFixed(2),"fat"===ap||"snf"===ap?"%":"","quantity"===ap?" L":"","rate"===ap?"/L":""]})]})}return null},{})}),(0,a.jsx)(C.Line,{type:"monotone",dataKey:"value",stroke:e(),strokeWidth:3,dot:{fill:e(),r:5},activeDot:{r:7},name:H()})]})})}):(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(N.BarChart3,{className:"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No data available for the last 30 days"})]}))})]})})]})};e.s(["default",0,()=>(0,a.jsx)(t.Suspense,{fallback:(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500"})}),children:(0,a.jsx)(en,{})})],813066)}]);